{"meta":{"title":"Alice's  wonderland","subtitle":"","description":"","author":"Alice","url":"http://delaprada.com","root":"/"},"pages":[{"title":"","date":"2022-12-23T04:10:09.941Z","updated":"2022-12-23T04:10:09.941Z","comments":true,"path":"about/index.html","permalink":"http://delaprada.com/about/index.html","excerpt":"","text":"Hi there ğŸ‘‹This is Alice!I am Alice and I am currently a master student in computer science at the National University of Singapore. I achieved my Bachelorâ€™s degree at SCUT and worked as a software engineer in Tencent for one year. My current research interest is computer vision. &lt;/br&gt; ğŸ›  Tech Stack Deep Learning: Front End Development: Back End Development: Tools: &lt;/br&gt;&lt;/br&gt;&lt;/br&gt;"},{"title":"categories","date":"2019-12-25T01:15:45.000Z","updated":"2019-12-26T12:39:40.000Z","comments":false,"path":"categories/index.html","permalink":"http://delaprada.com/categories/index.html","excerpt":"","text":""},{"title":"tags","date":"2019-12-25T01:50:31.000Z","updated":"2019-12-26T12:39:56.000Z","comments":false,"path":"tags/index.html","permalink":"http://delaprada.com/tags/index.html","excerpt":"","text":""}],"posts":[{"title":"å¯¹ Transformer çš„ç†è§£","slug":"å¯¹-Transformer-çš„ç†è§£","date":"2023-01-07T07:39:51.000Z","updated":"2023-01-07T08:45:31.983Z","comments":true,"path":"2023/01/07/å¯¹-Transformer-çš„ç†è§£/","link":"","permalink":"http://delaprada.com/2023/01/07/%E5%AF%B9-Transformer-%E7%9A%84%E7%90%86%E8%A7%A3/","excerpt":"","text":"Transformer æ¶æ„ Transformer ç”± Encoder å’Œ Decoder æ„æˆã€‚ Encoder æ˜¯ç”± N ä¸ªç›¸åŒçš„ layer æ„æˆï¼ˆN ä¸º 6ï¼‰ï¼Œæ¯ä¸ª layer æœ‰ä¸¤ä¸ªå­ layerï¼Œç¬¬ä¸€ä¸ªå­ layer æ˜¯ multi-head self-attentionï¼Œç¬¬äºŒä¸ªå­ layer æ˜¯ simple, position-wise fully connected feed-forward networkã€‚æ¯ä¸ªå­ layer éƒ½åº”ç”¨äº† residual-connectionï¼ˆresnetï¼‰ï¼Œç„¶åæ¥ç€åº”ç”¨ Layer Normalizationã€‚ Decoder åŒæ ·æ˜¯ç”± N ä¸ªç›¸åŒçš„ layer æ„æˆï¼ˆN ä¸º 6ï¼‰ï¼Œé™¤äº†åœ¨ Encoder ä¸­å‡ºç°çš„ä¸¤ä¸ªå­ layer ä»¥å¤–ï¼ŒDecoder è¿˜å¤šå¢åŠ äº†ä¸€ä¸ªå­ layerï¼Œç”¨äºå¯¹ Encoder çš„è¾“å‡ºåš masked multi-head self-attentionã€‚ åœ¨ masked multi-head self-attention æœºåˆ¶ä¸‹ï¼Œå½“å‰ä½ç½®çš„ query åªä¼šä¸ä¹‹å‰ä½ç½®çš„ key åš self-attentionï¼Œä¸ä¼šä¸ä¹‹åä½ç½®çš„ key åš self-attentionã€‚Transformer è¿™ä¹ˆåšçš„åŸå› æ˜¯ï¼Œå¯¹äº sequence model æ¥è¯´ï¼ˆæ¯”å¦‚ï¼šè¯­éŸ³è¯†åˆ«ï¼‰ï¼Œè¾“å‡ºæ˜¯ä¸€ä¸ªä¸€ä¸ªäº§ç”Ÿçš„ï¼Œæ‰€ä»¥å®ƒåªèƒ½å¤Ÿè€ƒè™‘åˆ°åœ¨å½“å‰è¾“å‡ºä¹‹å‰çš„ä¿¡æ¯ã€‚ ä¸æ­¤åŒæ—¶ï¼ŒEncoder å’Œ Decoder ä¸­é—´çš„è¡”æ¥å¤„è¿˜ä¼šåš cross attentionï¼š å…¶ä¸­ Decoder æä¾› query å»æå– Encoder ä¸­çš„ä¿¡æ¯ä½œä¸ºæ¥ä¸‹æ¥ fully-connected feed forward network çš„è¾“å…¥ï¼š è¿™ä¸ªå›¾å¯ä»¥çœ‹å¾—æ›´æ¸…æ™°ï¼ˆå¿½ç•¥å…¶ä¸­ Decoder è¾“å…¥çš„ object queryï¼Œè¿™ä¸ªæ˜¯ object detection ä»»åŠ¡ç‰¹æœ‰çš„ï¼‰ï¼š Q K V æ˜¯ä»€ä¹ˆ æ¯ä¸ª input aâ€™ ä¼šå¯¹åº”ç”Ÿæˆ query, key, valueï¼Œquery æ˜¯ input aâ€™ ä¹˜ matrix Wq , key æ˜¯ input aâ€™ ä¹˜ matrix Wk , value æ˜¯ input aâ€™ ä¹˜ matrix Wv , è¿™ä¸‰ä¸ª matrix æ˜¯ä¸ä¸€æ ·çš„ï¼Œåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­æ¯ä¸ª matrix çš„å‚æ•°ä¼šä¸æ–­æ›´æ–°ã€‚ output æ˜¯ weighted sum of valuesï¼Œæ¯ä¸ª weight æ˜¯é€šè¿‡ query å’Œå¯¹åº” key ç‚¹ä¹˜å†ç»è¿‡ softmax å¾—åˆ°ï¼Œä¹Ÿå¯ä»¥ç§°ä¸ºæ˜¯ attention scoreã€‚å› æ­¤ï¼Œä¸å½“å‰ input è¶Šç›¸è¿‘çš„ inputï¼ˆå³ attention score è¶Šé«˜ï¼‰ï¼Œå°±ä¼šä¸»å¯¼å½“å‰çš„ outputã€‚ ä»€ä¹ˆæ˜¯ position-wise feed-forward networkposition-wise æ˜¯æŒ‡å¯¹æ¯ä¸ªä½ç½®çš„æ“ä½œæ˜¯åˆ†å¼€å¹¶ä¸”ç›¸åŒçš„ã€‚ attention is all you need åŸæ–‡æè¿°å¦‚ä¸‹ï¼š dot productï¼ˆå†…ç§¯ï¼‰æ¯ä¸ª query å’Œ key ä¹‹é—´è¿›è¡Œçš„æ“ä½œæ˜¯ dot productï¼Œé‚£ä¹ˆä»€ä¹ˆæ˜¯ dot productï¼Œä¸ºä»€ä¹ˆè¦åš dot product å‘¢ï¼Ÿ dot product æŒ‡çš„æ˜¯å†…ç§¯ï¼Œå®ƒæœ‰ä¸¤ç§å®šä¹‰æ–¹å¼ï¼Œä¸€ç§æ˜¯ä»£æ•°æ–¹å¼ï¼Œå¦ä¸€ç§æ˜¯å‡ ä½•æ–¹å¼ã€‚ ä»ä»£æ•°è§’åº¦å‡ºå‘è®¾äºŒç»´ç©ºé—´å†…æœ‰ä¸¤ä¸ªå‘é‡ $\\overrightarrow{a} = (x_1, y_1)$ å’Œ $\\overrightarrow{b} = (x_2, y_2)$ ï¼Œå®šä¹‰å®ƒä»¬çš„æ•°é‡ç§¯ï¼ˆåˆå«å†…ç§¯ã€ç‚¹ç§¯ï¼‰ä¸ºä»¥ä¸‹å®æ•°ï¼š \\overrightarrow{a} \\cdot \\overrightarrow{b} = x_1x_2 + y_1y_2æ›´ä¸€èˆ¬åœ°ï¼Œnç»´å‘é‡çš„å†…ç§¯å®šä¹‰å¦‚ä¸‹ï¼š \\overrightarrow{a} \\cdot \\overrightarrow{b} = \\sum\\limits_{i=1}^n a_ib_i = a_1b_1 + a_2b_2 + a_3b_3 + ... + a_nb_nä»å‡ ä½•è§’åº¦å‡ºå‘è®¾äºŒç»´ç©ºé—´å†…æœ‰ä¸¤ä¸ªå‘é‡ $\\overrightarrow{a} = (x_1, y_1)$ å’Œ $\\overrightarrow{b} = (x_2, y_2)$ï¼Œ$\\mid a \\mid$ å’Œ $\\mid b \\mid $ è¡¨ç¤ºå‘é‡ a å’Œ b çš„å¤§å°ï¼Œå®ƒä»¬çš„å¤¹è§’ä¸º $\\phi $( $0 &lt;= \\phi &lt;= Ï€$) ï¼Œåˆ™å†…ç§¯å®šä¹‰ä¸ºä»¥ä¸‹å®æ•°ï¼š ç›¸å½“äº a å‘é‡åœ¨ b å‘é‡æŠ•å½±ï¼š \\overrightarrow{a} \\cdot \\overrightarrow{b} = \\mid\\overrightarrow{a}\\mid \\mid \\overrightarrow{b} \\mid cos\\phiç›¸å½“äº a å‘é‡åœ¨ b å‘é‡æŠ•å½±ï¼š è¯¥å®šä¹‰åªå¯¹äºŒç»´å’Œä¸‰ç»´ç©ºé—´æœ‰æ•ˆã€‚ positional Encodingï¼ˆä½ç½®ç¼–ç ï¼‰ ä»€ä¹ˆæ˜¯ Positional Encodingåœ¨ä»»ä½•ä¸€é—¨è¯­è¨€ä¸­ï¼Œè¯è¯­çš„ä½ç½®å’Œé¡ºåºå¯¹å¥å­çš„æ„æ€è¡¨è¾¾æ˜¯è‡³å…³é‡è¦çš„ã€‚ä¼ ç»Ÿçš„ RNN æ¨¡å‹åœ¨å¤„ç†å¥å­çš„æ—¶å€™ï¼Œä¼šä»¥åºåˆ—çš„æ¨¡å¼é€ä¸ªå¤„ç†å¥å­ä¸­çš„è¯è¯­ï¼Œè¿™ä½¿å¾—è¯è¯­çš„é¡ºåºä¿¡æ¯åœ¨å¤„ç†è¿‡ç¨‹ä¸­è¢«å¤©ç„¶çš„ä¿å­˜ä¸‹æ¥ï¼Œå¹¶ä¸éœ€è¦é¢å¤–çš„å¤„ç†ã€‚ è€Œå¯¹äº Transformer æ¥è¯´ï¼Œç”±äºå¥å­ä¸­çš„è¯è¯­æ˜¯åŒæ—¶è¿›å…¥ç½‘ç»œè¿›è¡Œå¤„ç†çš„ï¼Œé¡ºåºä¿¡æ¯åœ¨è¾“å…¥ç½‘ç»œæ—¶å°±å·²ç»ä¸¢å¤±äº†ã€‚å› æ­¤ï¼ŒTransformer æ˜¯éœ€è¦é¢å¤–çš„å¤„ç†å‘ŠçŸ¥æ¯ä¸ªè¯è¯­å…¶ç›¸å¯¹ä½ç½®æ˜¯ä»€ä¹ˆã€‚Attention is all you need è¿™ç¯‡æ–‡ç« å°±ä½¿ç”¨äº† Positional Encoding å°†ä½ç½®ä¿¡æ¯ç¼–ç æ·»åŠ åˆ°è¾“å…¥ä¸­ï¼Œè®©ç½‘ç»œæ¨¡å‹çŸ¥é“æ¯ä¸ªè¯çš„ä½ç½®å’Œé¡ºåºã€‚ åº”è¯¥å¦‚ä½•åš Positional Encodingä¸€å¼€å§‹æˆ‘ä»¬èƒ½æƒ³åˆ°çš„æ–¹æ³•ï¼Œæ˜¯ç»™å¥å­ä¸­çš„æ¯ä¸ªè¯èµ‹äºˆä¸€ä¸ªç›¸ä½ï¼Œä¹Ÿå°±æ˜¯ [0, 1] ä¸­é—´çš„ä¸€ä¸ªå€¼ï¼Œç¬¬ä¸€ä¸ªè¯æ˜¯ 0ï¼Œæœ€åä¸€ä¸ªè¯æ˜¯ 1ï¼Œä¸­é—´çš„è¯åœ¨ 0 åˆ° 1 ä¹‹é—´å–å€¼ã€‚ä½†è¿™ç§æ–¹æ³•çš„ä¸€ä¸ªé—®é¢˜åœ¨äºï¼Œä½ ä¸çŸ¥é“ä½ è¦åœ¨è¿™ä¸ªç‰¹å®šçš„èŒƒå›´ [0, 1] ä¹‹é—´è¡¨è¾¾å¤šå°‘ä¸ªè¯ã€‚æ¢è€Œè¨€ä¹‹ï¼Œå¯¹äºä¸åŒé•¿åº¦çš„å¥å­æ¥è¯´ï¼Œè¯è¯­ä¹‹é—´çš„é—´éš”è¡¨è¾¾çš„å«ä¹‰å°±ä¸ä¸€è‡´ã€‚ å¦ä¸€ç§å¯ä»¥æƒ³åˆ°çš„æ–¹å¼æ˜¯ï¼Œç”¨çº¿æ€§å¢é•¿çš„æ–¹å¼æ¥è¿›è¡Œä½ç½®ç¼–ç ã€‚æ¯”å¦‚ï¼Œç¬¬ä¸€ä¸ªè¯çš„ä½ç½®æ˜¯ 0ï¼Œç¬¬äºŒä¸ªè¯çš„ä½ç½®æ˜¯ 1ï¼Œä»¥æ­¤ç±»æ¨ã€‚ä½†è¿™æ ·çš„é—®é¢˜åœ¨äºï¼Œä½ç½®ç¼–ç çš„å–å€¼å¯èƒ½å¾ˆå¤§ï¼Œæ•´ä¸ªæ¨¡å‹æ‰€æ¥å—çš„åºåˆ—ä¹Ÿä¼šæ›´é•¿ã€‚æ¨¡å‹çš„æ³›åŒ–æ€§èƒ½ä¹Ÿä¼šå‡å¼±ã€‚ å› æ­¤ï¼Œç†æƒ³æƒ…å†µä¸‹ï¼Œç¼–ç æ–¹å¼è¦æ»¡è¶³ä»¥ä¸‹æ ‡å‡†ï¼š1.å¯¹äºå¥å­ä¸­å¤„åœ¨ä¸åŒä½ç½®ä¸Šçš„è¯ï¼Œè¦èµ‹äºˆç‹¬ä¸€æ— äºŒçš„ä½ç½®ç¼–ç 2.åœ¨ä¸åŒé•¿åº¦çš„å¥å­ä¸­ï¼Œä¸¤ä¸ªè¯è¯­é—´çš„é—´éš”æ‰€ä»£è¡¨çš„å«ä¹‰æ˜¯ä¸€è‡´çš„3.æ¨¡å‹èƒ½å¤Ÿç®€ä¾¿åœ°å»¶ä¼¸åˆ°æ›´é•¿çš„å¥å­ã€‚ å› æ­¤ï¼ŒAttention is all you need è¿™ç¯‡æ–‡ç« æå‡ºäº†ä¸€ä¸ªæ»¡è¶³ä»¥ä¸Šæ ‡å‡†çš„ä½ç½®ç¼–ç æ–¹å¼ã€‚ å…¬å¼t è¡¨ç¤ºè¾“å…¥å¥å­çš„æŸä¸ªä½ç½®ï¼Œpt è¡¨ç¤ºè¯¥ä½ç½®å¯¹åº”çš„ Positional Encodingï¼Œd ä»£è¡¨ Encoding çš„ç»´åº¦ï¼Œf è¡¨ç¤ºç”Ÿæˆè¾“å‡ºçš„ Positional Encoding çš„æ–¹æ³•ï¼š","categories":[],"tags":[{"name":"Artificial Intelligence","slug":"Artificial-Intelligence","permalink":"http://delaprada.com/tags/Artificial-Intelligence/"}]},{"title":"pytorch|è®°å½•è·‘æ¨¡å‹è¿‡ç¨‹ä¸­é‡åˆ°çš„é—®é¢˜","slug":"pytorch-è®°å½•è·‘æ¨¡å‹è¿‡ç¨‹ä¸­é‡åˆ°çš„é—®é¢˜","date":"2022-12-08T02:24:59.000Z","updated":"2022-12-08T02:45:01.055Z","comments":true,"path":"2022/12/08/pytorch-è®°å½•è·‘æ¨¡å‹è¿‡ç¨‹ä¸­é‡åˆ°çš„é—®é¢˜/","link":"","permalink":"http://delaprada.com/2022/12/08/pytorch-%E8%AE%B0%E5%BD%95%E8%B7%91%E6%A8%A1%E5%9E%8B%E8%BF%87%E7%A8%8B%E4%B8%AD%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98/","excerpt":"","text":"å¦‚ä½•ä½¿ç”¨å¤š gpu è·‘æ¨¡å‹å•ä¸ª gpu è·‘æ¨¡å‹ï¼Œbatch sizeï¼Œæ¨¡å‹å‚æ•°éƒ½ä¼šä¸€å®šç¨‹åº¦å—åˆ°é™åˆ¶ï¼Œbatch size ä¸èƒ½è®¾ç½®çš„å¤ªå¤§ï¼Œæ¨¡å‹çš„å‚æ•°ä¹Ÿä¸èƒ½å¤ªå¤šã€‚ä¸€ä¸ªè§£å†³æ–¹æ³•å°±æ˜¯ï¼Œç”¨å¤šä¸ª gpu æ¥è·‘ã€‚ è®¾ç½® gpu å¼€å§‹çš„ç¼–å·gpu å¼€å§‹çš„ç¼–å·é»˜è®¤ä¸º 0ï¼Œå¦‚æœç¬¬ 0 ä¸ª gpu å·²ç»è¢«å ç”¨äº†ï¼Œæˆ‘ä»¬éœ€è¦å…ˆè®¾ç½®èµ·å§‹å¯ç”¨ gpu ç¼–å·ï¼Œæ‰èƒ½ä½¿ç”¨å¤šä¸ª gpuã€‚ä¾‹å¦‚ï¼ŒæœåŠ¡å™¨ä¸­å¯ç”¨çš„ gpu ä¸º 4 å’Œ 5ï¼Œé‚£ä¹ˆèµ·å§‹ gpu ç¼–å·ä¸º 4ï¼Œåœ¨ import ååŠ å…¥ä»¥ä¸‹ä»£ç ï¼š 1torch.cuda.set_device(4) è®¾ç½® CUDA_VISIBLE_DEVICESè®¾ç½®å¯ç”¨çš„å¤šä¸ª gpuï¼š 1os.environ['CUDA_VISIBLE_DEVICES'] ='4, 5' è®¾ç½® device_ids 1model = torch.nn.DataParallel(model, device_ids=[4, 5]).cuda() ç„¶åå°±å¯ä»¥é¡ºåˆ©ä½¿ç”¨å¤šä¸ª gpu æ¥è·‘æ¨¡å‹å•¦ã€‚å¦‚æœä¸æŒ‰ç…§ä¸Šè¿°å‡ æ­¥æ¥åšï¼Œä¼šæŠ¥ä»¥ä¸‹é”™è¯¯ï¼š 1AssertionError: Invalid device id å¦‚ä½• kill æ‰ vscode ä»ç„¶åœ¨è·‘çš„ç¨‹åºè¿›ç¨‹ä»Šå¤©è·‘æ¨¡å‹çš„æ—¶å€™å‘ç° vscode çªç„¶ disconnect æœåŠ¡å™¨äº†ï¼Œå¯¼è‡´æ•´ä¸ªæ­£åœ¨è·‘çš„æ¨¡å‹éœ€è¦ reloadï¼Œreload å®Œå vscode çš„ terminal ç›¸å½“äºé‡å¯äº†ï¼Œæ¨¡å‹æŒ‰é“ç†æ¥è¯´åº”è¯¥ terminate äº†æ‰å¯¹ï¼Œä½†å‘ç° gpu è¿˜æ˜¯è¢«å æ»¡ï¼Œè¯´æ˜ vscode ç¨‹åºä»åœ¨èƒŒåœ°é‡Œè·‘ã€‚ è§£å†³åŠæ³•ï¼š 1pgrep -lf python æŸ¥çœ‹æ­£åœ¨è·‘çš„ python è¿›ç¨‹ï¼Œlist å¯¹åº”å±æ€§å¦‚ä¸‹ï¼š 12UID PID PPID C STIME TTY TIME BIN CMDuser 3985 3960 0 19:46 pts/4 00:00:07 path/to/python python foo.py ç„¶å kill æ‰å¯¹åº”è¿›ç¨‹å³å¯ã€‚ GPU åˆ©ç”¨ç‡å§‹ç»ˆåœ¨ 0-50% ä¹‹é—´é—ªåŠ¨å‚è€ƒï¼šæ·±åº¦å­¦ä¹ GPUåˆ©ç”¨ç‡ä½é—®é¢˜åˆ†æ å‚è€ƒçš„æ–‡ç« é‡Œå¤§ä½¬å†™çš„å¾ˆè¯¦ç»†äº†ï¼ŒGPU å†…å­˜å æœ‰ç‡å’Œ GPU åˆ©ç”¨ç‡æ˜¯ä¸¤å›äº‹ã€‚ GPU å†…å­˜å æœ‰ç‡GPU å†…å­˜å æœ‰ç‡é€šå¸¸æ˜¯ç”±æ¨¡å‹å¤§å°å’Œ batch_size å¤§å°å†³å®šã€‚ GPU å†…å­˜å æœ‰ç‡ä¸»è¦ç”±æ¨¡å‹çš„å¤§å°å†³å®šï¼ŒåŒ…æ‹¬ç½‘ç»œçš„æ·±åº¦ã€å®½åº¦ã€å‚æ•°é‡ä»¥åŠä¸­é—´çš„æ¯ä¸€å±‚ç¼“å­˜ï¼Œéƒ½ä¼šåœ¨å†…å­˜å¼€è¾Ÿç©ºé—´æ¥è¿›è¡Œä¿å­˜ï¼Œæ‰€ä»¥æ¨¡å‹æœ¬èº«ä¼šå æ®å¾ˆå¤§ä¸€éƒ¨åˆ†å†…å­˜ã€‚ å…¶æ¬¡æ˜¯ batch_size çš„å¤§å°ï¼Œbatch_size è®¾ç½®å¾—è¶Šå¤§ï¼ŒGPU å†…å­˜å æœ‰ç‡è¶Šé«˜ã€‚æ¯”å¦‚ï¼Œbatch_size è®¾ç½®ä¸º 128 çš„å†…å­˜å æœ‰ç‡ä¼šæ˜¯è®¾ç½®ä¸º 256 çš„ä¸€åŠã€‚å› æ­¤ï¼Œå¦‚æœè·‘æ¨¡å‹çš„è¿‡ç¨‹ä¸­æŠ¥ â€œout of memoryâ€ çš„é”™è¯¯ï¼Œå¯ä»¥è¯•ç€å°† batch_size è®¾ç½®å¾—å°ä¸€ç‚¹ã€‚ GPU åˆ©ç”¨ç‡ åœ¨å‘½ä»¤è¡Œé‡Œæ‰§è¡Œ watch -n 0.5 nvidia-smi èƒ½å¤Ÿå±•ç¤ºå½“å‰æœåŠ¡å™¨çš„ GPU æƒ…å†µï¼Œå…¶ä¸­ Memory-Usage å°±æ˜¯ GPU å†…å­˜å æœ‰ç‡ï¼Œè€Œ Volatile GPU-Util å°±æ˜¯ GPU åˆ©ç”¨ç‡ã€‚ å½“æ²¡æœ‰è®¾ç½®å¥½CPUçš„çº¿ç¨‹æ•°æ—¶ï¼ŒVolatile GPU-Util å‚æ•°æ˜¯åœ¨åå¤çš„è·³åŠ¨çš„ï¼Œ0%ï¼Œ20%ï¼Œ70%ï¼Œ95%ï¼Œ0%ã€‚è¿™æ ·åœæ¯1-2ç§’ç„¶ååˆé‡å¤èµ·æ¥ã€‚å…¶å®æ˜¯GPUåœ¨ç­‰å¾…æ•°æ®ä»CPUä¼ è¾“è¿‡æ¥ï¼Œå½“ä»æ€»çº¿ä¼ è¾“åˆ°GPUä¹‹åï¼ŒGPUé€æ¸èµ·è®¡ç®—æ¥ï¼Œåˆ©ç”¨ç‡ä¼šçªç„¶å‡é«˜ï¼Œä½†æ˜¯GPUçš„ç®—åŠ›å¾ˆå¼ºå¤§ï¼Œ0.5ç§’å°±åŸºæœ¬èƒ½å¤„ç†å®Œæ•°æ®ï¼Œæ‰€ä»¥åˆ©ç”¨ç‡æ¥ä¸‹æ¥åˆä¼šé™ä¸‹å»ï¼Œç­‰å¾…ä¸‹ä¸€ä¸ªbatchçš„ä¼ å…¥ã€‚å› æ­¤ï¼Œè¿™ä¸ªGPUåˆ©ç”¨ç‡ç“¶é¢ˆåœ¨å†…å­˜å¸¦å®½å’Œå†…å­˜ä»‹è´¨ä¸Šä»¥åŠCPUçš„æ€§èƒ½ä¸Šé¢ã€‚æœ€å¥½å½“ç„¶å°±æ˜¯æ¢æ›´å¥½çš„å››ä»£æˆ–è€…æ›´å¼ºå¤§çš„å†…å­˜æ¡ï¼Œé…åˆæ›´å¥½çš„CPUã€‚ å¦å¤–çš„ä¸€ä¸ªæ–¹æ³•æ˜¯ï¼Œåœ¨PyTorchè¿™ä¸ªæ¡†æ¶é‡Œé¢ï¼Œæ•°æ®åŠ è½½Dataloaderä¸Šåšæ›´æ”¹å’Œä¼˜åŒ–ï¼ŒåŒ…æ‹¬num_workersï¼ˆçº¿ç¨‹æ•°ï¼‰ï¼Œpin_memoryï¼Œä¼šæå‡é€Ÿåº¦ã€‚è§£å†³å¥½æ•°æ®ä¼ è¾“çš„å¸¦å®½ç“¶é¢ˆå’Œ GPU çš„è¿ç®—æ•ˆç‡ä½çš„é—®é¢˜ã€‚åœ¨TensorFlowä¸‹é¢ï¼Œä¹Ÿæœ‰è¿™ä¸ªåŠ è½½æ•°æ®çš„è®¾ç½®ã€‚ 12345torch.utils.data.DataLoader(image_datasets[x], batch_size=batch_size, shuffle=True, num_workers=8, pin_memory=True) ä¸ºäº†æé«˜åˆ©ç”¨ç‡ï¼Œé¦–å…ˆè¦å°†num_workersï¼ˆçº¿ç¨‹æ•°ï¼‰è®¾ç½®å¾—ä½“ï¼Œ4,8,16æ˜¯å‡ ä¸ªå¸¸é€‰çš„å‡ ä¸ªå‚æ•°ã€‚æœ¬äººæµ‹è¯•è¿‡ï¼Œå°†num_workersè®¾ç½®çš„éå¸¸å¤§ï¼Œä¾‹å¦‚ï¼Œ24ï¼Œ32,ç­‰ï¼Œå…¶æ•ˆç‡åè€Œé™ä½ï¼Œå› ä¸ºæ¨¡å‹éœ€è¦å°†æ•°æ®å¹³å‡åˆ†é…åˆ°å‡ ä¸ªå­çº¿ç¨‹å»è¿›è¡Œé¢„å¤„ç†ï¼Œåˆ†å‘ç­‰æ•°æ®æ“ä½œï¼Œè®¾é«˜äº†åè€Œå½±å“æ•ˆç‡ã€‚ å½“ç„¶ï¼Œçº¿ç¨‹æ•°è®¾ç½®ä¸º1ï¼Œæ˜¯å•ä¸ªCPUæ¥è¿›è¡Œæ•°æ®çš„é¢„å¤„ç†å’Œä¼ è¾“ç»™GPUï¼Œæ•ˆç‡ä¹Ÿä¼šä½ã€‚å…¶æ¬¡ï¼Œå½“ä½ çš„æœåŠ¡å™¨æˆ–è€…ç”µè„‘çš„å†…å­˜è¾ƒå¤§ï¼Œæ€§èƒ½è¾ƒå¥½çš„æ—¶å€™ï¼Œå»ºè®®æ‰“å¼€pin_memoryæ‰“å¼€ï¼Œå°±çœæ‰äº†å°†æ•°æ®ä»CPUä¼ å…¥åˆ°ç¼“å­˜RAMé‡Œé¢ï¼Œå†ç»™ä¼ è¾“åˆ°GPUä¸Šï¼›ä¸ºTrueæ—¶æ˜¯ç›´æ¥æ˜ å°„åˆ°GPUçš„ç›¸å…³å†…å­˜å—ä¸Šï¼Œçœæ‰äº†ä¸€ç‚¹æ•°æ®ä¼ è¾“æ—¶é—´ã€‚ è®¾ç½®äº† num_workers å’Œ pin_memory ä¹‹å GPU åˆ©ç”¨ç‡ä»ç„¶å¾ˆä½æ€ä¹ˆåŠæˆ‘åœ¨è®¾ç½®äº† num_workers ä¸º 8 æˆ– 16 ä»¥åŠå°† pin_memory ä¸º True ä¹‹åï¼ŒVolatile GPU-Util ä»ç„¶åœ¨ 0 - 50% ä¹‹é—´é—ªåŠ¨ï¼Œä¸èƒ½å¤Ÿä¸€ç›´ç»´æŒåœ¨ä¸€ä¸ªå¾ˆé«˜çš„åˆ©ç”¨ç‡ã€‚ åœ¨çœ‹äº†è¿™ç¯‡ VideoTransformer-pytorch README.md ä¹‹åï¼Œæˆ‘å‘ç°é‡Œé¢æåˆ°ï¼Œå¦‚æœè¦æé«˜ GPU åˆ©ç”¨ç‡ï¼Œè¦é¿å… CPU åˆ° GPU çš„è½¬æ¢è®¡ç®—ï¼ˆæ¯”å¦‚ï¼šåœ¨ tensor ä¸Šæ‰§è¡Œ item(), cpu(), .numpy() çš„æ“ä½œï¼‰ï¼Œæˆ–è€…å°† log å†™å…¥ç£ç›˜ã€‚ å›çœ‹äº†ä¸€ä¸‹è‡ªå·±çš„ä»£ç ä¹‹åï¼Œå‘ç°è®¡ç®— loss çš„æ—¶å€™æ‰§è¡Œäº† .item() æ“ä½œï¼š 1losses.update(loss.item(), input.size(0)) è®¡ç®— accuracy çš„æ—¶å€™æ‰§è¡Œäº† .cpu() æ“ä½œï¼š 1_, avg_acc, cnt, pred = accuracy(output.detach().cpu().numpy(), target.detach().cpu().numpy()) å¹¶ä¸”æ¯è½® iteration éƒ½ä¼šå°† logå†™å…¥ç£ç›˜ã€‚ å› æ­¤å¯¼è‡´äº† GPU åˆ©ç”¨ç‡çš„é—ªåŠ¨é—®é¢˜ã€‚ï¼ˆä½†è¿™äº›å¯å¦é¿å…ï¼Ÿæœ‰å¾…æ¢ç´¢ ingï¼‰ RuntimeError: Attempting to deserialize object on CUDA device 3 but torch.cuda.device_count() is 1. Please use torch.load with map_location to map your storages to an existing device.å‡ºç°è¿™ä¸ªæŠ¥é”™çš„åŸå› æ˜¯ï¼Œä¸€å¼€å§‹è®¾ç½®äº† os.environ[&#39;CUDA_VISIBLE_DEVICES&#39;] = &#39;3&#39; ï¼Œä½†æ˜¯å¯ç”¨çš„ cuda device åªæœ‰ 1 ä¸ªã€‚ä½†åç»­å°† os.environ[&#39;CUDA_VISIBLE_DEVICES&#39;] è®¾ç½®ä¸º &#39;0&#39;ï¼Œä½†è¿˜æ˜¯æŠ¥åŒæ ·çš„é”™è¯¯ã€‚è¿™ä¸ªæ˜¯ä¸åˆç†çš„ç°è±¡ï¼ŒçŒœæµ‹æ˜¯æ›´æ”¹æ²¡æœ‰ç”Ÿæ•ˆã€‚ å‚è€ƒäº†è¿™ä¸ªé—®é¢˜çš„è§£ç­”ï¼šhttps://discuss.pytorch.org/t/cuda-visible-device-is-of-no-use/10018/10 ç®€è€Œè¨€ä¹‹å°±æ˜¯ï¼šos.environ[&#39;CUDA_VISIBLE_DEVICES&#39;] çš„è®¾ç½®è¦æ”¾åœ¨è¦æ‰§è¡Œçš„ program ä¹‹å¤–ï¼Œå¹¶ä¸”è¦æ”¾åœ¨ import torch ä¹‹å‰ã€‚å› æ­¤ï¼Œæˆ‘å•ç‹¬è®¾ç½®äº†ä¸€ä¸ª python æ–‡ä»¶ç”¨äºè®¾ç½® os.environ[&#39;CUDA_VISIBLE_DEVICES&#39;]ï¼Œç„¶ååˆ‡æ¢ä¸€ä¸‹ jupyter kernelï¼Œåˆ·æ–° kernelï¼Œå†æ‰§è¡Œ jupyter æ–‡ä»¶ï¼Œæ²¡æœ‰æŠ¥é”™äº†ã€‚ â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”2022.12.06 æ›´æ–°â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” å‘ç°ä¹‹å‰å¯¹è¿™ä¸ªé—®é¢˜çš„ç†è§£è¿˜æ˜¯æœ‰ä¸è¶³çš„åœ°æ–¹ã€‚å¦‚æœä½ çš„æ¨¡å‹ä½¿ç”¨ gpu 5 å·è®­ç»ƒå‡ºæ¥çš„ï¼Œè€Œä½ åœ¨ä¸€ä¸ªåªæœ‰ 1 ä¸ªå¯ç”¨ gpu çš„æœºå™¨ä¸Šè·‘æ—¶ï¼Œå¤§æ¦‚ç‡ä¼šå‡ºç° RuntimeError: Attempting to deserialize object on CUDA device 5 but torch.cuda.device_count() is 1. çš„æŠ¥é”™ã€‚ è§£å†³åŠæ³•å°±æ˜¯é€šè¿‡ map_location æŒ‡å®šå½“å‰å¯ç”¨çš„ gpu æ˜¯å“ªä¸€å—ï¼š 1model.load_state_dict(torch.load(cfg.TEST.MODEL_FILE, map_location='cuda:0'), strict=True) æ›´æ¢ kernel æ˜¯ä¸€ä¸ªæ¯”è¾ƒå¥½çš„æ–¹å¼å¦‚æœå½“å‰çš„ jupyter notebook æ²¡æœ‰è¯†åˆ«åˆ°æœ€æ–°çš„æ›´æ”¹ã€‚","categories":[{"name":"Artificial Intelligence","slug":"Artificial-Intelligence","permalink":"http://delaprada.com/categories/Artificial-Intelligence/"}],"tags":[{"name":"Artificial Intelligence","slug":"Artificial-Intelligence","permalink":"http://delaprada.com/tags/Artificial-Intelligence/"}]},{"title":"å¯¹å›æº¯ç®—æ³•çš„ä¸€ç‚¹æ–°è®¤è¯†","slug":"å¯¹å›æº¯ç®—æ³•çš„ä¸€ç‚¹æ–°è®¤è¯†","date":"2021-05-15T01:51:27.000Z","updated":"2021-05-15T03:52:36.000Z","comments":true,"path":"2021/05/15/å¯¹å›æº¯ç®—æ³•çš„ä¸€ç‚¹æ–°è®¤è¯†/","link":"","permalink":"http://delaprada.com/2021/05/15/%E5%AF%B9%E5%9B%9E%E6%BA%AF%E7%AE%97%E6%B3%95%E7%9A%84%E4%B8%80%E7%82%B9%E6%96%B0%E8%AE%A4%E8%AF%86/","excerpt":"","text":"å‰è¨€æ˜¨å¤©åˆ·é¢˜çš„æ—¶å€™ï¼Œæ°å¥½åˆ·åˆ°äº†ä¸¤é“ä¸å›æº¯ç›¸å…³çš„é¢˜ç›®ã€‚ä¹‹å‰åšé¢˜çš„æ—¶å€™é‡åˆ°å’Œå›æº¯ç®—æ³•ç›¸å…³çš„é¢˜éƒ½å¾ˆæ€•ï¼Œä¸»è¦åˆ·é¢˜é‡ä¸å¤Ÿä¸”æ²¡æœ‰æŒæ¡å›æº¯çš„è§„å¾‹å’Œè§£é¢˜æ–¹æ³•ã€‚åœ¨çœ‹åˆ°è¯„è®ºåŒºå¤§ä½¬çš„ä¸€äº›è§£æåè§‰å¾—å¾ˆæœ‰æ„Ÿæ‚Ÿï¼Œæƒ³å€Ÿæ­¤æ€»ç»“ä¸€ä¸‹ ğŸ™Œã€‚ å›æº¯ç®—æ³•çš„ä½¿ç”¨åœºæ™¯å›æº¯ç®—æ³•ç»å¸¸è¢«åº”ç”¨äºè¦æ±‚æ‰€æœ‰ç»„åˆæˆ–è€…ç¬¦åˆæ¡ä»¶çš„æ‰€æœ‰ç»„åˆçš„é¢˜ç›®ä¸­ã€‚ å›æº¯ç®—æ³•çš„æ ¸å¿ƒæ˜¯å›æº¯ã€‚åœ¨æœç´¢åˆ°æŸä¸€èŠ‚ç‚¹çš„æ—¶å€™ï¼Œå¦‚æœæˆ‘ä»¬å‘ç°ç›®å‰çš„èŠ‚ç‚¹å¹¶ä¸æ˜¯éœ€æ±‚ç›®æ ‡æ—¶ï¼Œæˆ‘ä»¬å›é€€åˆ°åŸæ¥çš„èŠ‚ç‚¹ç»§ç»­æœç´¢ï¼Œå¹¶ä¸”æŠŠåœ¨ç›®å‰èŠ‚ç‚¹ä¿®æ”¹çš„çŠ¶æ€è¿˜åŸã€‚ å…·ä½“çš„å†™æ³•çš„æ­¥éª¤ä¸ºï¼š[ä¿®æ”¹å½“å‰èŠ‚ç‚¹çŠ¶æ€]-&gt;[é€’å½’å­èŠ‚ç‚¹]-&gt;[å›æ”¹å½“å‰èŠ‚ç‚¹çŠ¶æ€]ã€‚ æ¢å¥è¯è¯´å°±æ˜¯ï¼š å¼•ç”¨ä¼ çŠ¶æ€ æ‰€æœ‰çš„çŠ¶æ€ä¿®æ”¹åœ¨é€’å½’å®Œæˆåå›æ”¹ å›æº¯ç®—æ³•ä¸æ·±åº¦ä¼˜å…ˆæœç´¢å½“å›æº¯ç”¨äºæ ‘çš„æ—¶å€™ï¼Œå°±æ˜¯æ·±åº¦ä¼˜å…ˆæœç´¢ã€‚å…¶å®å‡ ä¹æ‰€æœ‰å¯ä»¥ç”¨å›æº¯è§£å†³çš„é—®é¢˜éƒ½å¯ä»¥è¡¨ç¤ºä¸ºæ ‘ã€‚é‚£ä¹ˆå›æº¯å’Œæ·±åº¦ä¼˜å…ˆæœç´¢åœ¨è¿™é‡Œå°±å‡ ä¹åŒä¹‰äº†ã€‚ å¦‚æœä¸€ä¸ªé—®é¢˜è§£å†³çš„æ—¶å€™æ˜¾å¼åœ°ä½¿ç”¨äº†æ ‘ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å«å®ƒdfsã€‚ å¾ˆå¤šæ—¶å€™æ²¡æœ‰ç”¨æ ‘æˆ‘ä»¬ä¹Ÿç®¡å®ƒå«dfsä¸¥æ ¼æ¥è¯´æ˜¯ä¸å¯¹çš„ï¼Œå®é™…ä¸Šä¸¤è€…éƒ½å¯ä»¥å‰ªæï¼Œæ‰€ä»¥ç”¨å‰ªææ¥åŒºåˆ†å›æº¯å’Œæ·±æœæ˜¯ä¸å¯¹çš„ã€‚ æ·±æœçš„é¢˜ç›®å¯ä»¥åˆ†ä¸ºä¸»å‡½æ•°å’Œè¾…å‡½æ•°ï¼Œä¸»å‡½æ•°ç”¨äºéå†æ‰€æœ‰çš„æœç´¢ä½ç½®ï¼Œåˆ¤æ–­æ˜¯å¦å¯ä»¥å¼€å§‹æœç´¢ï¼Œå¦‚æœå¯ä»¥å³åœ¨è¾…å‡½æ•°è¿›è¡Œæœç´¢ã€‚ å¦‚æœæ²¡æœ‰è§„å®šè¯´å“ªäº›ä½ç½®ä¸å¯ä»¥è¿›è¡Œæœç´¢ï¼Œé‚£ä¸»å‡½æ•°å°±ç”¨äºç›´æ¥ä¼ å‚å¹¶è°ƒç”¨è¾…å‡½æ•°ã€‚ æ·±æœçš„leetcodeé¢˜ç›®ï¼š 695. å²›å±¿çš„æœ€å¤§é¢ç§¯ å›æº¯çš„æ¨¡æ¿å›æº¯ç®—æ³•çš„å…¬å¼ï¼š 1234567891011// pythonå†™æ³•result = []def backtrack(è·¯å¾„, é€‰æ‹©åˆ—è¡¨): if æ»¡è¶³ç»“æŸæ¡ä»¶: result.add(è·¯å¾„) return for é€‰æ‹© in é€‰æ‹©åˆ—è¡¨: åšé€‰æ‹© backtrack(è·¯å¾„, é€‰æ‹©åˆ—è¡¨) æ’¤é”€é€‰æ‹© æ­¥éª¤å¦‚ä¸‹ï¼š æ‰¾ç»“æŸé€’å½’çš„æ¡ä»¶ forå¾ªç¯éå† åšé€‰æ‹©å¹¶é€’å½’ æ’¤é”€é€‰æ‹©ï¼Œå³å›æº¯ï¼ˆå›åˆ°ä¸Šä¸€æ­¥ï¼‰ ä¾‹ä¸€ï¼šå…¨æ’åˆ—é¢˜ç›®é“¾æ¥ï¼š46. å…¨æ’åˆ— ç”¨å›æº¯çš„æ¨¡æ¿è§£ä¸€ä¸‹è¿™é¢˜ï¼š é€’å½’ç»“æŸçš„æ¡ä»¶ï¼šæ’åˆ—æ•°ç»„çš„é•¿åº¦ä¸ºnums.lengthçš„æ—¶å€™ï¼Œå°†æ’åˆ—æ•°ç»„pushåˆ°ç»“æœæ•°ç»„ä¸­ï¼Œç„¶åreturnã€‚ forå¾ªç¯éå†ï¼šéå†numsæ•°ç»„ã€‚ åšé€‰æ‹©å¹¶é€’å½’ï¼šå¦‚æœå½“å‰éå†åˆ°çš„æ•°å·²ç»åœ¨æ’åˆ—æ•°ç»„ä¸­ï¼Œåˆ™continueè·³è¿‡è¯¥æ•°ï¼›å¦‚æœä¸åœ¨ï¼Œåˆ™pushè¿›æ’åˆ—æ•°ç»„ï¼Œç„¶åè¿›è¡Œé€’å½’ã€‚ æ’¤é”€é€‰æ‹©ï¼šç”¨popæ–¹æ³•å°†åˆšåˆšpushè¿›æ’åˆ—æ•°ç»„çš„æ•°åˆ æ‰ï¼ˆä¸è¦å‚»å‚»ç”¨spliceğŸ˜¥ï¼Œæ›´ä¸è¦ç”¨sliceğŸ˜“ã€‚sliceæ˜¯åˆ›å»ºä¸€ä¸ªæ–°çš„æ•°ç»„ï¼Œå¹¶ä¸ä¼šåŸåœ°ä¿®æ”¹æ•°ç»„æœ¬èº«ã€‚ï¼‰ 1234567891011121314151617181920212223242526272829/** * @param &#123;number[]&#125; nums * @return &#123;number[][]&#125; */var permute = function(nums) &#123; let res = []; let curRes = []; backtrack(res, curRes, nums); return res;&#125;;var backtrack = function(res, curRes, nums) &#123; if(curRes.length === nums.length) &#123; res.push(curRes.slice()); return; &#125; for(let i = 0; i &lt; nums.length; ++i) &#123; if(curRes.includes(nums[i]))&#123; continue; &#125; curRes.push(nums[i]); backtrack(res, curRes, nums); curRes.pop(); &#125;&#125; è¿™é¢˜ä¹Ÿå¯ä»¥åˆ›å»ºä¸€ä¸ªvisitedæ•°ç»„ç”¨äºè®°å½•éå†åˆ°çš„è¿™ä¸ªæ•°æ˜¯å¦å·²åœ¨æ•°ç»„ä¸­ï¼Œä½†è¿™é‡Œæ›´ç®€å•çš„æ“ä½œæ˜¯ç”¨jsçš„includesæ–¹æ³•åˆ¤æ–­ã€‚ åˆ›å»ºvisitedæ•°ç»„çš„å†™æ³•ï¼š 1234567891011121314151617181920212223242526272829303132/** * @param &#123;number[]&#125; nums * @return &#123;number[][]&#125; */var permute = function(nums) &#123; let res = []; let curRes = []; let visited = [0, 0, 0]; backtrack(res, curRes, nums, visited); return res;&#125;;var backtrack = function(res, curRes, nums, visited) &#123; if(curRes.length === nums.length) &#123; res.push(curRes.slice()); return; &#125; for(let i = 0; i &lt; nums.length; ++i) &#123; if(visited[i] === 1) &#123; continue; &#125; curRes.push(nums[i]); visited[i] = 1; backtrack(res, curRes, nums, visited); curRes.splice(curRes.length - 1, 1); visited[i] = 0; &#125;&#125; ä¾‹äºŒï¼šç»„åˆæ€»æ•°é¢˜ç›®é“¾æ¥ï¼š39. ç»„åˆæ€»å’Œ ç”¨å›æº¯çš„æ¨¡æ¿è§£ä¸€ä¸‹è¿™é¢˜ï¼š é€’å½’ç»“æŸçš„æ¡ä»¶ï¼šç»„åˆæ•°ç»„çš„å’Œä¸ºtargetæ—¶ï¼Œå°†ç»„åˆæ•°ç»„pushè¿›ç»“æœæ•°ç»„ï¼Œç„¶åreturnï¼›å½“ç»„åˆæ•°ç»„çš„å’Œå¤§äºtargetæ—¶ï¼Œç›´æ¥returnã€‚ forå¾ªç¯éå†ï¼šéå†candidatesæ•°ç»„ã€‚ åšé€‰æ‹©å¹¶é€’å½’ï¼šå°†å½“å‰éå†åˆ°çš„æ•°pushè¿›ç»„åˆæ•°ç»„ä¸­ï¼Œé€’å½’ï¼Œé€’å½’æ—¶æ³¨æ„è¦ä¼ å…¥å½“å‰éå†åˆ°çš„iå€¼ï¼ˆç»„åˆå’Œæ’åˆ—ä¸åŒï¼Œç»„åˆçš„è¯ä¸éœ€è¦è€ƒè™‘é¡ºåºï¼‰ã€‚ æ’¤é”€é€‰æ‹©ï¼šç”¨popæ–¹æ³•å°†åˆšåˆšpushè¿›ç»„åˆæ•°ç»„çš„æ•°åˆ æ‰ã€‚ 123456789101112131415161718192021222324252627282930/** * @param &#123;number[]&#125; candidates * @param &#123;number&#125; target * @return &#123;number[][]&#125; */var combinationSum = function(candidates, target) &#123; let res = []; backtrack(res, [], candidates, 0, target); return res;&#125;;var backtrack = function(res, curRes, candidates, index, target) &#123; let curSum = curRes.reduce((acc, cur) =&gt; (acc + cur), 0); if(curSum === target) &#123; res.push(curRes.slice()); return; &#125; if(curSum &gt; target) &#123; return; &#125; for(let i = index; i &lt; candidates.length; ++i) &#123; curRes.push(candidates[i]); backtrack(res, curRes, candidates, i, target); curRes.pop(); // curRes = curRes.slice(0, curRes.length - 1)å¹¶ä¸èƒ½å¯¹curResè¿›è¡ŒåŸåœ°åˆ é™¤æ“ä½œï¼Œå› ä¸ºsliceæ“ä½œä¼šåˆ›å»ºä¸€ä¸ªæ–°æ•°ç»„ &#125;&#125; ä¾‹ä¸‰ï¼šç”µè¯å·ç çš„å­—æ¯ç»„åˆé¢˜ç›®é“¾æ¥ï¼š17. ç”µè¯å·ç çš„å­—æ¯ç»„åˆ è¿™é¢˜çš„ä¸åŒç‚¹åœ¨äºï¼Œå®ƒçš„éå†å¯¹è±¡ä¸æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå› ä¸ºæ¯ä¸ªæ•°å­—éƒ½å¯¹åº”ä¸€ç³»åˆ—å­—æ¯ï¼Œç›¸å½“äºä¸€ä¸ªå­—æ¯æ•°ç»„ï¼Œæ‰€ä»¥æ˜¯å¯¹å¤šä¸ªæ•°ç»„è¿›è¡Œç»„åˆã€‚ å’Œä¸Šé¢˜ç±»ä¼¼ï¼Œæˆ‘ä»¬éœ€è¦åœ¨é€’å½’ä¸­ä¼ å…¥ä¸€ä¸ªposå˜é‡ï¼Œç”¨äºè®°å½•éå†åˆ°å“ªä¸ªå­—æ¯ç»„åˆã€‚ ç”¨å›æº¯çš„æ¨¡æ¿è§£ä¸€ä¸‹è¿™é¢˜ï¼š é€’å½’ç»“æŸçš„æ¡ä»¶ï¼šå½“posçš„å€¼ç­‰äºdigits.lengthæ—¶ï¼Œè¡¨æ˜tmpå­—ç¬¦ä¸²é•¿åº¦å·²ä¸ºdigits.lengthï¼Œå°†tmpå­—ç¬¦ä¸²pushè¿›ç»“æœæ•°ç»„ä¸­ï¼Œç„¶åreturnã€‚ è¿™é‡Œæ²¡æœ‰å°†tmpä½œä¸ºå‚æ•°ä¼ å…¥é€’å½’ä¸­çš„åŸå› æ˜¯ï¼Œå­—ç¬¦ä¸²åªæ˜¯åŸºæœ¬æ•°æ®ç±»å‹ï¼Œè€Œä¸æ˜¯å¼•ç”¨æ•°ç»„ç±»å‹ï¼Œé‚£ä¹ˆæ¯æ¬¡é€’å½’çš„tmpå¹¶ä¸æ˜¯åŒä¸€ä¸ªtmpï¼Œæ— æ³•å®ç°å›æº¯ï¼Œå›æº¯æ˜¯è¦åŸºäºåŒä¸€ä¸ªå˜é‡è¿›è¡Œæ“ä½œï¼Œä¸Šé¢çš„é¢˜ç›®ä¸­ä¼ å…¥é€’å½’çš„å‚æ•°éƒ½æ˜¯æ•°ç»„ï¼Œæ•°ç»„æ˜¯å¼•ç”¨æ•°ç»„ç±»å‹ï¼Œå¯ä»¥å®ç°ã€‚ æ‰€ä»¥tmpè¦ä½œä¸ºä¸€ä¸ªä½œç”¨åŸŸå˜é‡ï¼Œå¹¶å°†å›æº¯çš„å‡½æ•°åœ¨è¿™ä¸ªä½œç”¨åŸŸå†…å®šä¹‰ã€‚ forå¾ªç¯éå†ï¼šéå†å½“å‰çš„å­—æ¯ç»„åˆã€‚ åšé€‰æ‹©å¹¶é€’å½’ï¼štmpå­—ç¬¦ä¸²æ‹¼æ¥å½“å‰éå†åˆ°çš„å­—æ¯ï¼Œé€’å½’ï¼Œä¼ å…¥pos+1ï¼Œè¡¨ç¤ºéå†ä¸‹ä¸€ä¸ªå­—æ¯ç»„åˆã€‚ æ’¤é”€é€‰æ‹©ï¼šç”¨sliceæ–¹æ³•åˆ é™¤åˆšåˆšæ‹¼æ¥çš„å­—æ¯ã€‚ 12345678910111213141516171819202122232425262728293031323334/** * @param &#123;string&#125; digits * @return &#123;string[]&#125; */var letterCombinations = function(digits) &#123; const map = ['', '', 'abc', 'def', 'ghi', 'jkl', 'mno', 'pqrs', 'tuv', 'wxyz']; const res = []; let tmp = ''; const dfs = (pos, digits) =&gt; &#123; if(pos === digits.length) &#123; res.push(tmp); return; &#125; let curNum = Number(digits[pos]); for(let i = 0; i &lt; map[curNum].length; ++i) &#123; tmp += map[curNum][i]; dfs(pos + 1, digits); tmp = tmp.slice(0, tmp.length - 1); &#125; &#125; if(digits === '') &#123; return res; &#125; // ç”±äºæ¯ä¸ªæ•°å­—å¯¹åº”çš„æ¯ä¸ªå­—æ¯éƒ½å¯èƒ½è¿›å…¥å­—æ¯ç»„åˆï¼Œå› æ­¤ä¸å­˜åœ¨ä¸å¯è¡Œçš„è§£ï¼Œç›´æ¥ç©·ä¸¾æ‰€æœ‰çš„è§£å³å¯ã€‚ dfs(0, digits); return res;&#125;; æ€»ç»“å›æº¯ç®—æ³•æ˜¯å¾ˆå¸¸è§çš„ç®—æ³•ï¼ŒæŒæ¡å®ƒçš„è§£é¢˜æ€è·¯åï¼Œåšé¢˜çš„æ—¶å€™æ€è·¯å°±æ¸…æ™°å¾ˆå¤šäº†ğŸ˜‰ã€‚ ç±»ä¼¼é¢˜ç›®ï¼š 40. ç»„åˆæ€»å’Œ II 47. å…¨æ’åˆ— II 78. å­é›† 90. å­é›† II","categories":[{"name":"leetcode","slug":"leetcode","permalink":"http://delaprada.com/categories/leetcode/"}],"tags":[{"name":"leetcode","slug":"leetcode","permalink":"http://delaprada.com/tags/leetcode/"}]},{"title":"å¯¹é€’å½’çš„ä¸€ç‚¹æ–°è®¤è¯†","slug":"å¯¹é€’å½’çš„ä¸€ç‚¹æ–°è®¤è¯†","date":"2021-05-12T06:49:47.000Z","updated":"2021-05-12T08:59:26.000Z","comments":true,"path":"2021/05/12/å¯¹é€’å½’çš„ä¸€ç‚¹æ–°è®¤è¯†/","link":"","permalink":"http://delaprada.com/2021/05/12/%E5%AF%B9%E9%80%92%E5%BD%92%E7%9A%84%E4%B8%80%E7%82%B9%E6%96%B0%E8%AE%A4%E8%AF%86/","excerpt":"","text":"å‰è¨€è™½ç„¶èº«ä¸ºä¸€åè½¯å·¥çš„å­¦ç”Ÿï¼Œä½†ç®—æ³•ä¸€ç›´æ˜¯æˆ‘çš„è½¯è‚‹ğŸ˜“ï¼Œæ‰€ä»¥æœ€è¿‘æ‰“ç®—è¶è¿˜æ²¡æˆä¸ºæ‰“å·¥äººï¼Œå¤šåˆ·åˆ·é¢˜ğŸ’ªã€‚ ä»Šå¤©åˆ·åˆ°ä¸€ä¸ªé¢˜ç›®ï¼šLeetcode 24. ä¸¤ä¸¤äº¤æ¢é“¾è¡¨ä¸­çš„èŠ‚ç‚¹ï¼Œçœ‹åˆ°è¯„è®ºåŒºæœ‰å¤§ä½¬ç”¨é€’å½’çš„æ–¹æ³•åšå‡ºè¿™é“é¢˜ï¼Œçœ‹å®Œå¤§ä½¬çš„è§£æåè§‰å¾—è·ç›ŠåŒªæµ…ï¼Œäºæ˜¯æƒ³å†™ä¸ªç¬”è®°è®°å½•ä¸€ä¸‹ã€‚ é€’å½’è§£é¢˜ä¸‰éƒ¨æ›²ä»€ä¹ˆæ˜¯é€’å½’ï¼Ÿç¨‹åºåå¤è°ƒç”¨è‡ªèº«å³æ˜¯é€’å½’ã€‚ åˆå­¦è€…åœ¨æ¥è§¦é€’å½’çš„æ—¶å€™å¸¸å¸¸é™·å…¥å›°å¢ƒï¼Œæ€»æ˜¯ä¼šçº ç»“è¿™ä¸€å±‚å‡½æ•°åšäº†ä»€ä¹ˆï¼Œå®ƒè°ƒç”¨è‡ªèº«åä¸‹ä¸€å±‚å‡½æ•°åˆåšäº†ä»€ä¹ˆã€‚ç„¶åå°±ä¼šè§‰å¾—å®ç°ä¸€ä¸ªé€’å½’è§£æ³•ååˆ†å¤æ‚ï¼Œæ— ä»ä¸‹æ‰‹ã€‚ è¿™å…¶å®æ˜¯ä¸€ä¸ªæ€ç»´è¯¯åŒºã€‚æ—¢ç„¶é€’å½’æ˜¯ä¸€ä¸ªåå¤è°ƒç”¨è‡ªèº«çš„è¿‡ç¨‹ï¼Œè¿™å°±è¯´æ˜å®ƒæ¯ä¸€çº§å®ç°çš„åŠŸèƒ½éƒ½æ˜¯ä¸€æ ·çš„ï¼Œå› æ­¤æˆ‘ä»¬åªéœ€è¦å…³æ³¨ä¸€çº§é€’å½’çš„è§£å†³è¿‡ç¨‹å³å¯ã€‚ å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œåœ¨é€’å½’ä¸­æˆ‘ä»¬éœ€è¦å…³å¿ƒçš„ä¸»è¦æ˜¯ä»¥ä¸‹3ç‚¹ï¼š é€’å½’çš„ç»ˆæ­¢æ¡ä»¶ã€‚ åº”è¯¥è¿”å›ç»™ä¸Šä¸€çº§çš„è¿”å›å€¼æ˜¯ä»€ä¹ˆï¼Ÿ ä¸€çº§é€’å½’éœ€è¦åšä»€ä¹ˆï¼Ÿ å› æ­¤ï¼Œå°±æœ‰äº†é€’å½’è§£é¢˜ä¸‰éƒ¨æ›²ï¼š æ‰¾æ•´ä¸ªé€’å½’çš„ç»ˆæ­¢æ¡ä»¶ï¼šé€’å½’åº”è¯¥åœ¨ä»€ä¹ˆæ—¶å€™ç»“æŸï¼Ÿ æ‰¾è¿”å›å€¼ï¼šåº”è¯¥ç»™ä¸Šä¸€çº§è¿”å›ä»€ä¹ˆä¿¡æ¯ï¼Ÿ æœ¬çº§é€’å½’åº”è¯¥åšä»€ä¹ˆï¼šåœ¨è¿™ä¸€çº§é€’å½’ä¸­ï¼Œåº”è¯¥å®Œæˆä»€ä¹ˆä»»åŠ¡ï¼Ÿ ä¸‹é¢é€šè¿‡4é“leetcodeæ¥å……åˆ†ç†è§£é€’å½’ã€‚ ä¾‹ä¸€ï¼šä¸¤ä¸¤äº¤æ¢é“¾è¡¨ä¸­çš„èŠ‚ç‚¹é¢˜ç›®é“¾æ¥ï¼šLeetcode 24. ä¸¤ä¸¤äº¤æ¢é“¾è¡¨ä¸­çš„èŠ‚ç‚¹ã€‚ ç”¨ä¸‰éƒ¨æ›²åˆ†æè¿™é“é¢˜ç›®ï¼š æ‰¾ç»ˆæ­¢æ¡ä»¶ï¼šä»€ä¹ˆæƒ…å†µä¸‹é€’å½’ç»ˆæ­¢ï¼Ÿæ²¡å¾—äº¤æ¢çš„æ—¶å€™ï¼Œé€’å½’å°±ç»ˆæ­¢äº†ã€‚å› æ­¤å½“é“¾è¡¨åªå‰©ä¸‹ä¸€ä¸ªèŠ‚ç‚¹æˆ–è€…æ²¡æœ‰èŠ‚ç‚¹çš„æ—¶å€™ï¼Œè‡ªç„¶é€’å½’å°±ç»ˆæ­¢äº†ã€‚ æ‰¾è¿”å›å€¼ï¼šæˆ‘ä»¬å¸Œæœ›å‘ä¸Šä¸€çº§é€’å½’è¿”å›ä»€ä¹ˆä¿¡æ¯ï¼Ÿç”±äºæˆ‘ä»¬çš„ç›®çš„æ˜¯ä¸¤ä¸¤äº¤æ¢é“¾è¡¨ä¸­ç›¸é‚»çš„èŠ‚ç‚¹ï¼Œå› æ­¤äº¤ç»™ä¸Šä¸€çº§é€’å½’çš„æ˜¯å·²ç»å®Œæˆäº¤æ¢å¤„ç†å¥½çš„é“¾è¡¨ã€‚ æœ¬çº§é€’å½’åº”è¯¥åšä»€ä¹ˆï¼Ÿåªè€ƒè™‘æœ¬çº§é€’å½’çš„è¯ï¼Œæˆ‘ä»¬è¦åšçš„å°±æ˜¯äº¤æ¢çš„å·¥ä½œã€‚ç”±äºåªè€ƒè™‘æœ¬çº§é€’å½’ï¼Œæ‰€ä»¥è¿™ä¸ªé“¾è¡¨åœ¨æˆ‘ä»¬çœ¼é‡Œå…¶å®ä¹Ÿå°±æ˜¯ä¸‰ä¸ªèŠ‚ç‚¹ï¼šheadã€head.nextã€å·²ç»å¤„ç†å®Œçš„é“¾è¡¨éƒ¨åˆ†ã€‚è€Œæœ¬çº§é€’å½’çš„ä»»åŠ¡å°±æ˜¯äº¤æ¢è¿™3ä¸ªèŠ‚ç‚¹ä¸­çš„å‰ä¸¤ä¸ªèŠ‚ç‚¹ã€‚ é¢˜è§£ï¼š 12345678910111213141516171819202122/** * Definition for singly-linked list. * function ListNode(val, next) &#123; * this.val = (val===undefined ? 0 : val) * this.next = (next===undefined ? null : next) * &#125; *//** * @param &#123;ListNode&#125; head * @return &#123;ListNode&#125; */var swapPairs = function(head) &#123; if(head === null || head.next === null) &#123; return head; &#125; let next = head.next; head.next = swapPairs(next.next); next.next = head; return next;&#125;; ä¾‹äºŒï¼šåˆå¹¶ä¸¤ä¸ªæœ‰åºé“¾è¡¨é¢˜ç›®é“¾æ¥ï¼š21. åˆå¹¶ä¸¤ä¸ªæœ‰åºé“¾è¡¨ã€‚ åŒæ ·çš„ç”¨ä¸‰éƒ¨æ›²åˆ†æè¿™é“é¢˜ï¼š ç»ˆæ­¢æ¡ä»¶ï¼šä¸¤ä¸ªé“¾è¡¨åˆå¹¶å¿…å®šä¼šæœ‰ä¸€ä¸ªé“¾è¡¨å…ˆéå†å®Œï¼Œæ‰€ä»¥å½“l1ä¸ºnullæ—¶ï¼Œè¿”å›l2ï¼Œå½“l2ä¸ºnullæ—¶ï¼Œè¿”å›l1ã€‚ è¿”å›ç»™ä¸Šä¸€çº§é€’å½’çš„è¿”å›å€¼æ˜¯ä»€ä¹ˆï¼šè¿”å›åˆå¹¶å¥½çš„é“¾è¡¨ï¼Œä¹Ÿå°±æ˜¯é“¾è¡¨çš„å¤´æŒ‡é’ˆã€‚ æœ¬çº§é€’å½’åº”è¯¥åšä»€ä¹ˆï¼šæ¯”è¾ƒä¸¤ä¸ªé“¾è¡¨çš„å¤´ç»“ç‚¹çš„å€¼ï¼Œå¦‚æœl1çš„å¤´ç»“ç‚¹å€¼å°äºl2çš„å¤´ç»“ç‚¹å€¼ï¼Œåˆ™l1çš„nextæŒ‡é’ˆæŒ‡å‘l1.nextä¸l2åˆå¹¶åçš„ç»“æœï¼Œåä¹‹äº¦ç„¶ã€‚ é¢˜è§£ï¼š 1234567891011121314151617181920212223242526272829/** * Definition for singly-linked list. * function ListNode(val, next) &#123; * this.val = (val===undefined ? 0 : val) * this.next = (next===undefined ? null : next) * &#125; *//** * @param &#123;ListNode&#125; l1 * @param &#123;ListNode&#125; l2 * @return &#123;ListNode&#125; */var mergeTwoLists = function(l1, l2) &#123; if(l1 === null) &#123; return l2; &#125; if(l2 === null) &#123; return l1; &#125; if(l1.val &lt; l2.val) &#123; l1.next = mergeTwoLists(l1.next, l2); return l1; &#125; else &#123; l2.next = mergeTwoLists(l1, l2.next); return l2; &#125;&#125;; ä¾‹ä¸‰ï¼šäºŒå‰æ ‘çš„æœ€å¤§æ·±åº¦é¢˜ç›®é“¾æ¥ï¼š104. äºŒå‰æ ‘çš„æœ€å¤§æ·±åº¦ã€‚ ç”¨ä¸‰éƒ¨æ›²åˆ†æè¯¥é¢˜ï¼š ç»ˆæ­¢æ¡ä»¶ï¼šä»€ä¹ˆæƒ…å†µä¸‹é€’å½’ç»“æŸï¼Ÿå½“æ ‘ä¸ºç©ºçš„æ—¶å€™ï¼Œæ­¤æ—¶æ ‘çš„æ·±åº¦ä¸º0ï¼Œé€’å½’å°±ç»“æŸäº†ã€‚ æ‰¾è¿”å›å€¼ï¼šè¿™ä¸€çº§å¯¹åº”çš„æ ‘çš„æœ€å¤§æ·±åº¦ã€‚ æœ¬çº§é€’å½’åº”è¯¥åšä»€ä¹ˆï¼šé¦–å…ˆï¼Œæˆ‘ä»¬è¦èµ°å‡ºä¹‹å‰æ‰€è¯´çš„æ€ç»´è¯¯åŒºï¼Œé€’å½’åæˆ‘ä»¬çœ¼ä¸­çš„æ ‘ä¸€å®šæ˜¯ä¸‹é¢è¿™ä¸ªæ ·å­çš„ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚æ­¤æ—¶åªæœ‰ä¸‰ä¸ªèŠ‚ç‚¹ï¼šrootã€root.leftã€root.rightã€‚root.leftå’Œroot.rightåˆ†åˆ«è®°å½•çš„æ˜¯rootçš„å·¦å³å­æ ‘çš„æœ€å¤§æ·±åº¦ã€‚å› æ­¤ï¼Œæœ¬çº§é€’å½’åº”è¯¥åœ¨rootçš„å·¦å³å­æ ‘ä¸­é€‰æ‹©è¾ƒå¤§é‚£ä¸ªï¼Œå†åŠ ä¸Š1å°±æ˜¯ä»¥rootä¸ºæ ¹çš„å­æ ‘çš„æœ€å¤§æ·±åº¦ï¼Œç„¶åå†è¿”å›è¿™ä¸ªæ·±åº¦å³å¯ã€‚ â€‹ é¢˜è§£ï¼š 12345678910111213141516171819202122/** * Definition for a binary tree node. * function TreeNode(val, left, right) &#123; * this.val = (val===undefined ? 0 : val) * this.left = (left===undefined ? null : left) * this.right = (right===undefined ? null : right) * &#125; *//** * @param &#123;TreeNode&#125; root * @return &#123;number&#125; */var maxDepth = function(root) &#123; if(root === null) &#123; return 0; &#125; let leftDepth = maxDepth(root.left); let rightDepth = maxDepth(root.right); return Math.max(leftDepth, rightDepth) + 1;&#125;; ä¾‹å››ï¼šå¹³è¡¡äºŒå‰æ ‘é¢˜ç›®é“¾æ¥ï¼š110. å¹³è¡¡äºŒå‰æ ‘ã€‚ è¿™é¢˜å’Œä¸Šé¢ä¸‰é“é¢˜æœ‰ç‚¹ä¸åŒã€‚å› ä¸ºé¢˜ç›®éœ€è¦åˆ¤æ–­è¿™ä¸ªæ ‘æ˜¯å¦æ˜¯å¹³è¡¡çš„äºŒå‰æ ‘ï¼Œä¹Ÿå°±æ˜¯è¿”å›å€¼æ˜¯booleanï¼Œä½†æ˜¯åœ¨è¿™é“é¢˜ä¸­ç»ˆæ­¢æ¡ä»¶æ˜¯ï¼š 123if(root &#x3D;&#x3D;&#x3D; null) &#123; return 0;&#125; è¿”å›å€¼æ˜¯numberç±»å‹çš„ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦è¿›è¡Œä¸€ä¸ªè½¬æ¢ï¼Œé€šè¿‡è¿”å›çš„æ ‘çš„é«˜åº¦æ¥åˆ¤æ–­æ˜¯å¦æ˜¯å¹³è¡¡äºŒå‰æ ‘ã€‚ é¢˜è§£ï¼š 12345678910111213141516171819202122232425262728293031/** * Definition for a binary tree node. * function TreeNode(val, left, right) &#123; * this.val = (val===undefined ? 0 : val) * this.left = (left===undefined ? null : left) * this.right = (right===undefined ? null : right) * &#125; *//** * @param &#123;TreeNode&#125; root * @return &#123;boolean&#125; */var isBalanced = function(root) &#123; return height(root) &gt;= 0;&#125;;var height = function(root) &#123; // ç»ˆæ­¢æ¡ä»¶ if(root === null) &#123; return 0; &#125; let left = height(root.left); let right = height(root.right); if(left &gt;= 0 &amp;&amp; right &gt;= 0 &amp;&amp; Math.abs(left - right) &lt;= 1) &#123; return Math.max(left, right) + 1; &#125; else &#123; return -1; &#125;&#125; æ€»ç»“è¿™é‡Œåªæ˜¯æ€»ç»“äº†ä¸€äº›æ¯”è¾ƒç®€å•çš„é€’å½’åº”ç”¨ï¼Œæœ‰äº›é€’å½’é¢˜ç›®ä¼šæ›´åŠ å¤æ‚ï¼Œæ¶‰åŠåˆ°å›æº¯æˆ–è€…æ ‘çš„éå†ç­‰é—®é¢˜ï¼Œå°±ä¸èƒ½ç®€å•åœ°å¥—æ¨¡æ¿äº†ï¼Œå¾—çµæ´»åº”ç”¨ğŸ‘€ã€‚ å‚è€ƒä¸‰é“é¢˜å¥—è·¯è§£å†³é€’å½’é—®é¢˜","categories":[{"name":"leetcode","slug":"leetcode","permalink":"http://delaprada.com/categories/leetcode/"}],"tags":[{"name":"leetcode","slug":"leetcode","permalink":"http://delaprada.com/tags/leetcode/"}]},{"title":"babelå…¥é—¨","slug":"babelå…¥é—¨","date":"2021-05-05T08:57:35.000Z","updated":"2021-05-05T09:18:12.000Z","comments":true,"path":"2021/05/05/babelå…¥é—¨/","link":"","permalink":"http://delaprada.com/2021/05/05/babel%E5%85%A5%E9%97%A8/","excerpt":"","text":"ç®€ä»‹Babelæ˜¯ä¸€ä¸ªJSç¼–è¯‘å™¨ï¼Œç”¨äºå°†ES6åŠä»¥ä¸Šçš„JSä»£ç è½¬æ¢ä¸ºå‘åå…¼å®¹çš„JSè¯­æ³•ï¼Œä»¥ä¾¿èƒ½å¤Ÿè¿è¡Œåœ¨å½“å‰å’Œæ—§ç‰ˆæœ¬çš„æµè§ˆå™¨æˆ–å…¶ä»–ç¯å¢ƒä¸­ï¼ˆæ¶‰åŠæ–°è¯­æ³•çš„è½¬æ¢å’Œç¼ºå¤±ç‰¹æ€§çš„ä¿®è¡¥ï¼‰ã€‚ ä½¿ç”¨babelçš„ä¸€èˆ¬æ­¥éª¤ å®‰è£…æ‰€éœ€çš„åŒ… 1npm install --save-dev @babel/core @babel/cli @babel/preset-env åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»ºä¸€ä¸ªåä¸ºbabel.config.jsonçš„é…ç½®æ–‡ä»¶ï¼ˆä»¥ä¸‹ä»…ä¸ºç¤ºä¾‹ï¼‰ 1234567891011121314151617&#123; \"presets\": [ [ \"@babel/env\", &#123; \"targets\": &#123; \"edge\": \"17\", \"firefox\": \"60\", \"chrome\": \"67\", \"safari\": \"11.1\" &#125;, \"useBuiltIns\": \"usage\", \"corejs\": \"3.6.5\" &#125; ] ]&#125; å¦‚æœä½¿ç”¨çš„æ˜¯Babelæ—§ç‰ˆæœ¬ï¼Œåˆ™æ–‡ä»¶åä¸ºbabel.config.js 1234567891011121314151617const presets = [ [ \"@babel/env\", &#123; targets: &#123; edge: \"17\", firefox: \"60\", chrome: \"67\", safari: \"11.1\", &#125;, useBuiltIns: \"usage\", corejs: \"3.6.4\", &#125;, ],];module.exports = &#123; presets &#125;; è¿è¡Œå‘½ä»¤å°†srcç›®å½•ä¸‹çš„æ‰€æœ‰ä»£ç ç¼–è¯‘åˆ°libç›®å½• 1./node_modules/.bin/babel src --out-dir lib ä½ å¯ä»¥åˆ©ç”¨ npm@5.2.0 æ‰€è‡ªå¸¦çš„ npm åŒ…è¿è¡Œå™¨å°† ./node_modules/.bin/babel å‘½ä»¤ç¼©çŸ­ä¸º npx babelã€‚ babelçš„æ ¸å¿ƒåŠŸèƒ½åœ¨@babel/coreæ¨¡å—ä¸­ @babel/cliæ˜¯ä¸€ä¸ªèƒ½å¤Ÿä»ç»ˆç«¯ï¼ˆå‘½ä»¤è¡Œï¼‰ä½¿ç”¨çš„å·¥å…·ï¼ˆæ¯”å¦‚ä¸Šé¢çš„--out-dirå‚æ•°ï¼‰ã€‚å¯ä»¥é€šè¿‡--helpå‚æ•°æ¥æŸ¥çœ‹å‘½ä»¤è¡Œå·¥å…·æ‰€èƒ½æ¥å—çš„æ‰€æœ‰å‚æ•°åˆ—è¡¨ï¼Œæœ€é‡è¦çš„æ˜¯--pluginså’Œ--presetsè¿™ä¸¤ä¸ªå‚æ•° æ’ä»¶ï¼ˆpluginsï¼‰å’Œé¢„è®¾ï¼ˆpresetï¼‰pluginsbabelçš„ä»£ç è½¬æ¢åŠŸèƒ½æ˜¯ä»¥æ’ä»¶çš„å½¢å¼å‡ºç°çš„ã€‚æ’ä»¶æ˜¯å°å‹çš„JSç¨‹åºï¼Œç”¨äºæŒ‡å¯¼babelå¦‚ä½•å¯¹ä»£ç è¿›è¡Œè½¬æ¢ã€‚ ä¾‹å¦‚å°†ES6åŠä»¥ä¸Šçš„è¯­æ³•è½¬æ¢ä¸ºES5è¯­æ³•ï¼Œå¯ä»¥ä½¿ç”¨è¯¸å¦‚@babel/plugin-transform-arrow-functionsä¹‹ç±»çš„å®˜æ–¹æ’ä»¶ã€‚ presetå› ä¸ºå¦‚æœæ¯æ¬¡éƒ½è¦å¼€å‘è€…ä¸€ä¸ªä¸ªæ·»åŠ å¹¶å®‰è£…æ’ä»¶ï¼Œé…ç½®æ–‡ä»¶ä¼šå¾ˆé•¿ï¼Œå¹¶ä¸”å®‰è£…æ—¶é—´ä¹Ÿä¼šå¾ˆé•¿ã€‚ presetæ˜¯ä¸€ç»„é¢„å…ˆè®¾å®šçš„æ’ä»¶ã€‚æˆ‘ä»¬å¯ä»¥æ ¹æ®è‡ªå·±æ‰€éœ€è¦çš„æ’ä»¶ç»„åˆåˆ›å»ºä¸€ä¸ªè‡ªå·±çš„presetå¹¶å°†å…¶åˆ†äº«å‡ºå»ã€‚ presetåŒ…æ‹¬ï¼šenvã€reactã€flowã€minifyç­‰ã€‚è¿™é‡Œæœ€é‡è¦çš„æ˜¯envã€‚ åœ¨æ‰§è¡Œé¡ºåºæ–¹é¢ï¼ŒåŸåˆ™æ˜¯ï¼š pluginä¼šåœ¨presetä¹‹å‰è¿è¡Œ pluginä¼šä»å‰å¾€åé¡ºåºæ‰§è¡Œ presetçš„é¡ºåºåˆ™æ­£å¥½ç›¸åï¼ˆä»åå‘å‰ï¼‰ ä¾‹å¦‚ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªåç§°ä¸ºenvçš„presetï¼š 123npm install --save-dev @babel/preset-env./node_modules/.bin/babel src --out-dir lib --presets=@babel/env å¦‚æœä¸è¿›è¡Œä»»ä½•é…ç½®ï¼Œä¸Šè¿°presetæ‰€åŒ…å«çš„æ’ä»¶å°†æ”¯æŒæ‰€æœ‰æœ€æ–°çš„JSï¼ˆES2015ã€ES2016ç­‰ï¼‰ç‰¹æ€§ã€‚ ä½†presetä¹Ÿæ˜¯æ”¯æŒå‚æ•°çš„ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡é…ç½®æ–‡ä»¶æ¥ä¼ é€’å‚æ•°ã€‚ é…ç½®ä¾‹å¦‚ä¸‹é¢è¿™ä¸ªbabel.config.jsonï¼š 123456789101112131415&#123; \"presets\": [ [ \"@babel/env\", &#123; \"targets\": &#123; \"edge\": \"17\", \"firefox\": \"60\", \"chrome\": \"67\", \"safari\": \"11.1\" &#125; &#125; ] ]&#125; ç°åœ¨ï¼Œåä¸º env çš„ preset åªä¼šä¸ºç›®æ ‡æµè§ˆå™¨ä¸­æ²¡æœ‰çš„åŠŸèƒ½åŠ è½½è½¬æ¢æ’ä»¶ã€‚ envenvæ˜¯æœ€ä¸ºå¸¸ç”¨ä¹Ÿæ˜¯æœ€é‡è¦çš„ã€‚envçš„æ ¸å¿ƒç›®çš„æ˜¯é€šè¿‡é…ç½®å¾—çŸ¥ç›®æ ‡ç¯å¢ƒçš„ç‰¹ç‚¹ï¼Œç„¶ååªåšå¿…è¦çš„è½¬æ¢ã€‚ ä¾‹å¦‚ç›®æ ‡æµè§ˆå™¨æ˜¯æ”¯æŒES2015çš„ï¼Œé‚£ä¹ˆå°±ä¸éœ€è¦ES2015è¿™ä¸ªpresetï¼Œäºæ˜¯ä»£ç å°±å¯ä»¥å°ä¸€ç‚¹ï¼ˆä¸€èˆ¬è½¬åŒ–åçš„ä»£ç æ€»ä¼šæ›´é•¿ï¼‰ï¼Œæ„å»ºæ—¶é—´ä¹Ÿå¯ä»¥ç¼©çŸ­ä¸€äº›ã€‚ å¦‚æœä¸å†™ä»»ä½•é…ç½®é¡¹ï¼Œenvç­‰ä»·äºlatestï¼Œç­‰ä»·äºES2015 + ES2016 + ES2017 ä¸‰ä¸ªç›¸åŠ ã€‚ æ¯”è¾ƒå¸¸ç”¨çš„é…ç½®æ–¹æ³•å¦‚ä¸‹ï¼š 123456789&#123; \"presets\": [ [\"env\", &#123; \"targets\": &#123; \"browsers\": [\"last 2 versions\", \"safari &gt;= 7\"] &#125; &#125;] ]&#125; å¦‚ä¸Šé…ç½®å°†è€ƒè™‘æ‰€æœ‰æµè§ˆå™¨çš„æœ€æ–°2ä¸ªç‰ˆæœ¬(safariå¤§äºç­‰äº7.0çš„ç‰ˆæœ¬)çš„ç‰¹æ€§ï¼Œå°†å¿…è¦çš„ä»£ç è¿›è¡Œè½¬æ¢ã€‚è€Œè¿™äº›ç‰ˆæœ¬å·²æœ‰çš„åŠŸèƒ½å°±ä¸è¿›è¡Œè½¬åŒ–äº†ã€‚ å¦ä¸€ç§é…ç½®å¦‚ä¸‹ï¼š 123456789&#123; \"presets\": [ [\"env\", &#123; \"targets\": &#123; \"node\": \"6.10\" &#125; &#125;] ]&#125; å¦‚ä¸Šé…ç½®å°†ç›®æ ‡è®¾ç½®ä¸º nodejsï¼Œå¹¶ä¸”æ”¯æŒ 6.10 åŠä»¥ä¸Šçš„ç‰ˆæœ¬ã€‚ä¹Ÿå¯ä»¥ä½¿ç”¨ node: &#39;current&#39; æ¥æ”¯æŒæœ€æ–°ç¨³å®šç‰ˆæœ¬ã€‚ä¾‹å¦‚ç®­å¤´å‡½æ•°åœ¨ nodejs 6 åŠä»¥ä¸Šå°†ä¸è¢«è½¬åŒ–ï¼Œä½†å¦‚æœæ˜¯ nodejs 0.12 å°±ä¼šè¢«è½¬åŒ–äº†ã€‚ é…å¥—å·¥å…·babel-polyfillbabelé»˜è®¤åªè½¬æ¢jsè¯­æ³•ï¼Œè€Œä¸è½¬æ¢æ–°çš„APIï¼Œæ¯”å¦‚Iteratorã€Generatorã€Setã€Mapã€Proxyã€Reflectã€Symbolã€Promiseç­‰å…¨å±€å¯¹è±¡ï¼Œä»¥åŠä¸€äº›å®šä¹‰åœ¨å…¨å±€å¯¹è±¡ä¸Šçš„æ–¹æ³•ï¼ˆæ¯”å¦‚Object.assignï¼‰éƒ½ä¸ä¼šè½¬ç ã€‚ æ¯”å¦‚ï¼ŒES2015åœ¨Arrayå¯¹è±¡ä¸Šæ–°å¢äº†Array.fromæ–¹æ³•ï¼Œbabelä¸ä¼šè½¬ç è¿™ä¸ªæ–¹æ³•ã€‚å¦‚æœæƒ³è®©è¿™ä¸ªæ–¹æ³•è¿è¡Œï¼Œå¿…é¡»ä½¿ç”¨babel-polyfillï¼ˆå†…éƒ¨é›†æˆäº†core-jså’Œregeneratorï¼‰ã€‚ ä½¿ç”¨æ—¶ï¼Œåœ¨æ‰€æœ‰ä»£ç è¿è¡Œä¹‹å‰å¢åŠ  require(&#39;babel-polyfill&#39;)ã€‚æˆ–è€…æ›´å¸¸è§„çš„æ“ä½œæ˜¯åœ¨ webpack.config.js ä¸­å°† babel-polyfill ä½œä¸ºç¬¬ä¸€ä¸ª entryã€‚å› æ­¤å¿…é¡»æŠŠ babel-polyfill ä½œä¸º dependencies è€Œä¸æ˜¯ devDependenciesã€‚ ä½†babel-polyfillæœ‰ä¸¤ä¸ªä¸»è¦çš„ç¼ºç‚¹ï¼š ä½¿ç”¨babel-polyfillä¼šå¯¼è‡´æ‰“å‡ºæ¥çš„åŒ…éå¸¸å¤§ babel-polyfillä¼šæ±¡æŸ“å…¨å±€å˜é‡ï¼Œç»™å¾ˆå¤šç±»çš„åŸå‹é“¾ä½œäº†ä¿®æ”¹ã€‚å¦‚æœæˆ‘ä»¬å¼€å‘çš„ä¹Ÿæ˜¯ä¸€ä¸ªç±»åº“ä¾›å…¶ä»–å¼€å‘è€…ä½¿ç”¨ï¼Œè¿™ç§æƒ…å†µå°±ä¼šå˜å¾—éå¸¸ä¸å¯æ§ã€‚ åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œå¦‚æœæˆ‘ä»¬æ— æ³•å¿å—è¿™ä¸¤ä¸ªç¼ºç‚¹ï¼ˆé€šå¸¸æ˜¯ç¬¬äºŒä¸ªï¼‰ï¼Œæˆ‘ä»¬ä¼šå€¾å‘äºä½¿ç”¨babel-plugin-transform-runtimeã€‚ babel-runtimeå’Œbabel-plugin-transform-runtimeæˆ‘ä»¬æ—¶å¸¸åœ¨é¡¹ç›®ä¸­çœ‹åˆ° .babelrc ä¸­ä½¿ç”¨ babel-plugin-transform-runtimeï¼Œè€Œ package.json ä¸­çš„ dependencies (æ³¨æ„ä¸æ˜¯ devDependencies) åˆåŒ…å«äº† babel-runtimeï¼Œå…¶å®ä¸¤è€…æ˜¯éœ€è¦æˆå¥—ä½¿ç”¨çš„ã€‚ babel-plugin-transform-runtimeå¯ä»¥å°†å®šä¹‰æ–¹æ³•æ”¹æˆå¼•ç”¨ï¼Œé‚£ä¹ˆé‡å¤å®šä¹‰å°±èƒ½å¤Ÿè½¬æ¢æˆé‡å¤å¼•ç”¨ï¼Œå°±ä¸å­˜åœ¨ä»£ç é‡å¤çš„é—®é¢˜äº†ã€‚ babel-runtimeå°±æ˜¯è¿™äº›å®šä¹‰æ–¹æ³•çš„é›†åˆå¤„ï¼Œå› æ­¤ï¼Œåœ¨ä½¿ç”¨ babel-plugin-transform-runtime çš„æ—¶å€™å¿…é¡»æŠŠ babel-runtime å½“åšä¾èµ–ã€‚ babel-runtimeï¼Œå®ƒå†…éƒ¨é›†æˆäº† core-js: è½¬æ¢ä¸€äº›å†…ç½®ç±» (Promise, Symbolsç­‰ç­‰) å’Œé™æ€æ–¹æ³• (Array.from ç­‰)ã€‚ç»å¤§éƒ¨åˆ†è½¬æ¢æ˜¯è¿™é‡Œåšçš„ã€‚è‡ªåŠ¨å¼•å…¥ã€‚ regenerator: ä½œä¸º core-js çš„æ‹¾é—è¡¥æ¼ï¼Œä¸»è¦æ˜¯ generator/yield å’Œ async/await ä¸¤ç»„çš„æ”¯æŒã€‚å½“ä»£ç ä¸­æœ‰ä½¿ç”¨ generators/async æ—¶è‡ªåŠ¨å¼•å…¥ã€‚ helpers, asyncToGenerator å°±æ˜¯å…¶ä¸­ä¹‹ä¸€ï¼Œå…¶ä»–è¿˜æœ‰å¦‚ jsx, classCallCheck ç­‰ç­‰ï¼Œå¯ä»¥æŸ¥çœ‹ babel-helpersã€‚ babel-plugin-transform-runtime ä¸æ”¯æŒ å®ä¾‹æ–¹æ³• (ä¾‹å¦‚ [1,2,3].includes(1)) å…¶ä»–æ’ä»¶çš„æ€»ç»“ï¼š babelå®è·µå…³äºé…ç½®jestç¯å¢ƒæ—¶é‡åˆ°babelç›¸å…³é—®é¢˜çš„è§£å†³æ–¹æ¡ˆï¼šJest encountered an unexpected token This usually means that you are trying to import a file å‚è€ƒ ä¸€å£ï¼ˆå¾ˆé•¿çš„ï¼‰æ°”äº†è§£ babel babelå®˜ç½‘","categories":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://delaprada.com/categories/JavaScript/"}],"tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://delaprada.com/tags/JavaScript/"}]},{"title":"React-Reduxæœ€ä½³å®è·µ","slug":"React-Reduxæœ€ä½³å®è·µ","date":"2021-04-06T01:03:24.000Z","updated":"2021-04-06T01:29:18.000Z","comments":true,"path":"2021/04/06/React-Reduxæœ€ä½³å®è·µ/","link":"","permalink":"http://delaprada.com/2021/04/06/React-Redux%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/","excerpt":"","text":"å‰è¨€reduxä½œä¸ºreactçš„çŠ¶æ€ç®¡ç†å·¥å…·ï¼Œè®©å¾ˆå¤šå¼€å‘è€…æ•¬è€Œè¿œä¹‹ï¼Œä¸»è¦æ˜¯å› ä¸ºå®ƒæ¯”è¾ƒç¹æ‚çš„ç”¨æ³•è¿˜æœ‰å„ç§ç»„æˆéƒ¨åˆ†ï¼ŒåƒStoreã€Reducerç­‰ã€‚è¿™æ¬¡æ¯•è®¾æ°å¥½ç”¨åˆ°äº†reduxæ¥è¿›è¡Œé¡¹ç›®çš„çŠ¶æ€ç®¡ç†ï¼Œä½¿å¾—ç¨‹åºå˜å¾—æ›´åŠ ä¼˜é›…ï¼Œäºæ˜¯è¶æ­¤æœºä¼šæ€»ç»“ä¸€ä¸‹ã€‚ ä»€ä¹ˆæƒ…å†µä¸‹éœ€è¦ç”¨reduxå®é™…ä¸Šï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¸éœ€è¦ç”¨åˆ°reduxï¼Œå› ä¸ºå®é™…çš„åº”ç”¨åœºæ™¯æ²¡æœ‰å¤æ‚åˆ°éœ€è¦ç”¨reduxã€‚ æ‰€ä»¥ï¼Œå¦‚æœä½ çš„UIå±‚å¾ˆç®€å•ï¼Œæ²¡æœ‰å¾ˆå¤šäº’åŠ¨ï¼Œreduxå°±æ˜¯æ²¡æœ‰å¿…è¦çš„ï¼Œç”¨äº†åè€Œä¼šå¢åŠ å¤æ‚æ€§ã€‚ é‚£åœ¨ä»€ä¹ˆæƒ…å†µä¸‹éœ€è¦ç”¨reduxå‘¢ï¼Ÿåœ¨å¤šäº¤äº’ã€å¤šæ•°æ®æºçš„åœºæ™¯ä¸‹éœ€è¦ç”¨åˆ°reduxï¼Œä¾‹å¦‚ï¼š ç”¨æˆ·çš„ä½¿ç”¨æ–¹å¼å¤æ‚ ä¸åŒèº«ä»½çš„ç”¨æˆ·æœ‰ä¸åŒçš„ä½¿ç”¨æ–¹å¼ å¤šä¸ªç”¨æˆ·ä¹‹é—´å¯ä»¥åä½œ ä¸æœåŠ¡å™¨å¤§é‡äº¤äº’ï¼Œæˆ–è€…ä½¿ç”¨äº†WebSocket Viewè¦ä»å¤šä¸ªæ¥æºè·å–æ•°æ® åœ¨æˆ‘çš„é¡¹ç›®ä¸­ï¼Œè€ƒè™‘ä½¿ç”¨reduxçš„åœºæ™¯æ˜¯è¿™æ ·çš„ï¼š åœºæ™¯ï¼šåœ¨è¯—è¯é¡µé¢å‘åå°è¯·æ±‚è¯—è¯çš„ä¿¡æ¯ï¼Œç‚¹å‡»è¯—è¯é¡µé¢çš„æŸä¸ªæŒ‰é’®ï¼Œä¼šè·³è½¬åˆ°å¦ä¸€ä¸ªé¡µé¢ï¼Œè¿™ä¸ªé¡µé¢ä¹Ÿéœ€è¦ç”¨åˆ°è¿™ä¸ªè¯—è¯çš„ä¿¡æ¯ã€‚ å¸¸ç”¨çš„åšæ³•æ˜¯ï¼šåœ¨ä¸¤ä¸ªé¡µé¢componentWillMountç”Ÿå‘½å‘¨æœŸé‡Œå‘åå°è¯·æ±‚è¯—è¯ä¿¡æ¯ã€‚ä½†è¿™ç§åšæ³•çš„ç¼ºç‚¹æ˜¯å¤šæ¬¡å‘åå°å‘é€è¯·æ±‚ï¼Œä¼šé€ æˆé¡µé¢åŠ è½½è¿‡æ…¢ï¼Œæ€§èƒ½è¾ƒå·®ç­‰é—®é¢˜ã€‚ æ­¤æ—¶å°±å¯ä»¥è€ƒè™‘ä½¿ç”¨reduxï¼šåœ¨è¯—è¯é¡µé¢å‘åå°è¯·æ±‚åˆ°è¯—è¯çš„ä¿¡æ¯æ—¶ï¼Œå°†è¿™ä¸ªä¿¡æ¯å­˜å‚¨åœ¨reduxçš„storeä¸­ï¼Œè·³è½¬åˆ°å¦ä¸€ä¸ªé¡µé¢æ—¶ï¼Œç›´æ¥ä»storeé‡Œè·å–è¿™ä¸ªè¯—è¯ä¿¡æ¯å³å¯ã€‚è¿™æ ·å¯ä»¥å‡å°‘httpè¯·æ±‚çš„æ¬¡æ•°ã€‚ å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®è‡ªå·±çš„å®é™…æƒ…å†µé€‰æ‹©æ˜¯å¦è¦ä½¿ç”¨reduxã€‚ è®¾è®¡æ€æƒ³reduxçš„è®¾è®¡æ€æƒ³å¯ä»¥æ€»ç»“ä¸ºï¼š Webåº”ç”¨æ—¶ä¸€ä¸ªçŠ¶æ€æœºï¼Œè§†å›¾ä¸çŠ¶æ€æ˜¯ä¸€ä¸€å¯¹åº”çš„ã€‚ æ‰€æœ‰çš„çŠ¶æ€ï¼Œä¿å­˜åœ¨ä¸€ä¸ªå¯¹è±¡é‡Œé¢ã€‚ è§†å›¾ä¸çŠ¶æ€æ˜¯ä¸€ä¸€å¯¹åº”æ„å‘³ç€ï¼šçŠ¶æ€æ”¹å˜ä¼šå¯¼è‡´è§†å›¾æ”¹å˜ã€‚ æ‰€æœ‰çš„çŠ¶æ€éƒ½ä¿å­˜åœ¨ä¸€ä¸ªå¯¹è±¡é‡Œé¢ï¼Œè¿™ä¸ªå¯¹è±¡å°±æ˜¯ä¹‹åä¼šæåˆ°çš„Storeã€‚ åŸºæœ¬æ¦‚å¿µä¸APIæ­¤å¤„å‚ç…§é˜®ä¸€å³°è€å¸ˆçš„åšå®¢ã€‚ StoreStoreå°±æ˜¯ä¿å­˜æ•°æ®çš„åœ°æ–¹ï¼Œå¯ä»¥æŠŠå®ƒçœ‹æˆä¸€ä¸ªå®¹å™¨ï¼Œæ•´ä¸ªåº”ç”¨åªèƒ½æœ‰ä¸€ä¸ªStoreã€‚ reduxæä¾›createStoreè¿™ä¸ªå‡½æ•°ï¼Œç”¨æ¥ç”ŸæˆStoreï¼š 12import &#123; createStore &#125; from 'redux';const store = createStore(fn); StateStoreå¯¹è±¡åŒ…å«æ‰€æœ‰æ•°æ®ã€‚å¦‚æœæƒ³è¦å¾—åˆ°æŸä¸ªæ—¶é—´èŠ‚ç‚¹çš„æ•°æ®ï¼Œå°±è¦å¯¹Storeç”Ÿæˆå¿«ç…§ã€‚è¿™ç§æ—¶é—´èŠ‚ç‚¹çš„æ•°æ®é›†åˆï¼Œå°±å«åšStateã€‚ reduxè§„å®šï¼Œä¸€ä¸ªStateå¯¹åº”ä¸€ä¸ªViewã€‚åªè¦Stateç›¸åŒï¼ŒViewå°±ç›¸åŒã€‚ ActionStateçš„å˜åŒ–ï¼Œä¼šå¯¼è‡´Viewçš„å˜åŒ–ã€‚ä½†æ˜¯ç”¨æˆ·æ¥è§¦ä¸åˆ°Stateï¼Œåªèƒ½æ¥è§¦åˆ°Viewã€‚æ‰€ä»¥Stateçš„å˜åŒ–å¿…é¡»æ˜¯Viewå¯¼è‡´çš„ï¼ŒActionå°±æ˜¯Viewå‘Stateå‘å‡ºçš„é€šçŸ¥ï¼Œè¡¨ç¤ºStateè¦å˜åŒ–äº†ã€‚ Actionå¿…é¡»æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œä¸”å…¶ä¸­çš„typeå±æ€§å¿…é¡»å£°æ˜ï¼Œè¡¨ç¤ºActionçš„åç§°ã€‚å…¶ä»–å±æ€§å¯ä»¥è‡ªç”±è®¾ç½®ï¼Œè¯¦æƒ…å¯è§ç¤¾åŒºã€‚ Action CreatorActionæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œæˆ‘ä»¬å¿…é¡»è¦åœ¨ä¸€å¼€å§‹å°±å®šä¹‰å¥½è¿™ä¸ªActionçš„typeå’Œdataï¼Œä½†ä¸€èˆ¬dataæ˜¯åœ¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­æ‰è·å–åˆ°ï¼ˆæ¯”å¦‚ä»åå°è·å–åˆ°æ•°æ®ï¼‰ï¼Œèµ‹å€¼ç»™Actionï¼Œæ‰€ä»¥å¯ä»¥å®šä¹‰ä¸€ä¸ªå‡½æ•°æ¥ç”ŸæˆActionï¼Œè¿™ä¸ªå‡½æ•°å°±å«åšAction Creatorã€‚ 1234export const changeAudioInfo = (data) =&gt; (&#123; type: GET_AUDIO_INFO, data: data, // æ­¤å¤„å¯æ•´è¡Œç®€å†™ä¸ºdataæ­¤å¤„å±æ€§å†™æˆpayloadæˆ–è€…dataéƒ½å¯ä»¥ï¼Œéƒ½è¡¨ç¤ºè¿™ä¸ªactionæ‰¿è½½çš„æ•°æ®&#125;); store.dispatch()store.dispatch()æ˜¯Viewå‘å‡ºActionçš„å”¯ä¸€æ–¹æ³•ã€‚ 1234567import &#123; createStore &#125; from 'redux';const store = createStore(fn);store.dispatch(&#123; type: 'ADD_TODO', payload: 'Learn Redux'&#125;); store.dispatchæ¥å—ä¸€ä¸ªActionå¯¹è±¡ä½œä¸ºå‚æ•°ï¼Œå°†å®ƒå‘é€å‡ºå»ã€‚ ç»“åˆAction Creatorï¼Œä»£ç å¯ä»¥å†™ä¸ºï¼š1store.dispatch(changeAudioInfo(data)); ReducerStoreæ”¶åˆ°Actionä»¥åï¼Œå¿…é¡»ç»™å‡ºä¸€ä¸ªæ–°çš„Stateï¼Œè¿™æ ·Viewæ‰ä¼šå‘ç”Ÿå˜åŒ–ã€‚è¿™ç§Stateçš„è®¡ç®—è¿‡ç¨‹å°±å«åšReducerã€‚ Reduceræ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒæ¥å—Actionå’Œå½“å‰Stateä½œä¸ºå‚æ•°ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„Stateã€‚ 123456789101112131415161718192021import * as actionTypes from './constants';import &#123; fromJS &#125; from 'immutable';const defaultState = fromJS(&#123; poemInfo: &#123;&#125;, authorInfo: &#123;&#125;, audioInfo: &#123;&#125;, like: false, collect: false,&#125;);export default (state = defaultState, action) =&gt; &#123; switch (action.type) &#123; case actionTypes.GET_CURRENT_POEM: return state.set('poemInfo', action.data); case actionTypes.GET_AUTHOR_INFO: return state.set('authorInfo', action.data); default: return state; &#125;&#125;; Reducerå‡½æ•°ä¸éœ€è¦æ‰‹åŠ¨è°ƒç”¨ï¼Œstore.dispatchæ–¹æ³•ä¼šè§¦å‘Reducerçš„è‡ªåŠ¨æ‰§è¡Œã€‚å› æ­¤ï¼ŒStoreéœ€è¦çŸ¥é“Reducerå‡½æ•°ï¼Œåšæ³•å°±æ˜¯åœ¨ç”ŸæˆStoreçš„æ—¶å€™ï¼Œå°†Reducerä¼ å…¥createStoreæ–¹æ³•ã€‚ 12import &#123; createStore &#125; from 'redux';const store = createStore(reducer); è¿™ä¸ªå‡½æ•°ä¹‹æ‰€ä»¥å«åšReducerï¼Œæ˜¯å› ä¸ºå®ƒå¯ä»¥ä½œä¸ºæ•°ç»„çš„reduceæ–¹æ³•çš„å‚æ•°ï¼š12345678910111213141516171819const defaultState = 0;// stateå¯ä»¥çœ‹ä½œreduceå›è°ƒå‡½æ•°çš„accï¼Œactionå¯ä»¥çœ‹ä½œreduceå›è°ƒå‡½æ•°çš„curconst reducer = (state = defaultState, action) =&gt; &#123; switch (action.type) &#123; case 'ADD': return state + action.payload; default: return state; &#125;&#125;;const actions = [ &#123; type: 'ADD', payload: 0 &#125;, &#123; type: 'ADD', payload: 1 &#125;, &#123; type: 'ADD', payload: 2 &#125;];const total = actions.reduce(reducer, 0); // 3 Reducerå‡½æ•°æœ€é‡è¦çš„ç‰¹å¾æ˜¯ï¼Œå®ƒæ˜¯ä¸€ä¸ªçº¯å‡½æ•°ï¼ŒåŒæ ·çš„è¾“å…¥ï¼Œå¿…å®šå¾—åˆ°åŒæ ·çš„è¾“å‡ºã€‚ç”±äºReduceræ˜¯çº¯å‡½æ•°ï¼Œå°±å¯ä»¥ä¿è¯åŒæ ·çš„Stateï¼Œå¿…å®šå¾—åˆ°åŒæ ·çš„Viewã€‚ä½†ä¹Ÿå› ä¸ºè¿™ä¸€ç‚¹ï¼ŒReducerå‡½æ•°é‡Œé¢ä¸èƒ½æ”¹å˜Stateï¼Œå¿…é¡»è¿”å›ä¸€ä¸ªå…¨æ–°çš„å¯¹è±¡ï¼š 1234567891011121314151617181920212223// State æ˜¯ä¸€ä¸ªå¯¹è±¡function reducer(state, action) &#123; return Object.assign(&#123;&#125;, state, &#123; thingToChange &#125;); // æˆ–è€… return &#123; ...state, ...newState &#125;;&#125;// State æ˜¯ä¸€ä¸ªæ•°ç»„function reducer(state, action) &#123; return [...state, newItem];&#125;// ä½¿ç”¨immutableæ•°æ®æµçš„è¯ï¼Œä¼šè¿”å›æ–°çš„stateå¯¹è±¡export default (state = defaultState, action) =&gt; &#123; switch (action.type) &#123; case actionTypes.GET_CURRENT_POEM: return state.set('poemInfo', action.data); case actionTypes.GET_AUTHOR_INFO: return state.set('authorInfo', action.data); default: return state; &#125;&#125;; Reducerçš„æ‹†åˆ†åœ¨å®é™…åº”ç”¨ä¸­ï¼Œé€šå¸¸æ¯ä¸ªç»„ä»¶æœ‰è‡ªå·±çš„Reducerï¼Œç„¶åå…¨å±€å°†è¿™äº›Reduceråˆå¹¶åå†ä¼ å…¥createStoreæ–¹æ³•ï¼š 123456789101112import &#123; combineReducers &#125; from 'redux-immutable';import &#123; reducer as searchReducer &#125; from '@pages/Search/store/index';import &#123; reducer as playerReducer &#125; from '@pages/Player/store/index';import &#123; reducer as poemReducer &#125; from '@pages/Poem/store/index';import &#123; reducer as recordReducer &#125; from '@pages/Record/store/index';export default combineReducers(&#123; search: searchReducer, player: playerReducer, poem: poemReducer, record: recordReducer,&#125;); combineReducers()åšçš„å°±æ˜¯äº§ç”Ÿä¸€ä¸ªæ•´ä½“çš„Reducerå‡½æ•°ã€‚è¯¥å‡½æ•°æ ¹æ®Stateçš„keyå»æ‰§è¡Œç›¸åº”çš„å­Reducerï¼Œå¹¶å°†è¿”å›ç»“æœåˆå¹¶æˆä¸€ä¸ªå¤§çš„Stateå¯¹è±¡ã€‚ è·å–å…¨å±€Storeçš„æ•°æ®ä¹Ÿä¼šæ ¹æ®keyå€¼æ¥è·å–ï¼š 123456const mapStateToProps = (state) =&gt; (&#123; poemInfo: state.getIn(['poem', 'poemInfo']), authorInfo: state.getIn(['poem', 'authorInfo']), like: state.getIn(['poem', 'like']), collect: state.getIn(['poem', 'collect']),&#125;); Reduxçš„å·¥ä½œæµç¨‹ é¦–å…ˆï¼Œç”¨æˆ·å‘å‡ºActionâ€”â€”&gt; ç„¶åï¼ŒStoreè‡ªåŠ¨è°ƒç”¨Reducerï¼Œå¹¶ä¼ å…¥ä¸¤ä¸ªå‚æ•°ï¼šå½“å‰Stateå’Œæ”¶åˆ°çš„Actionâ€”â€”&gt;Reducerä¼šè¿”å›æ–°çš„Stateâ€”â€”&gt;Stateä¸€æ—¦æœ‰å˜åŒ–ï¼ŒStoreå°±ä¼šè°ƒç”¨ç›‘å¬å‡½æ•°ï¼ˆstore.subscribe(listener)ï¼‰é‡æ–°æ¸²æŸ“Viewã€‚ ä¸­é—´ä»¶å’Œå¼‚æ­¥æ“ä½œå¦‚æœç¨‹åºä¸­æ¶‰åŠå¼‚æ­¥æ“ä½œçš„è¯ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ä¸­é—´ä»¶ä½¿å¾—Reduceråœ¨å¼‚æ­¥æ“ä½œç»“æŸåè‡ªåŠ¨æ‰§è¡Œã€‚ ä¸­é—´ä»¶å°±æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå¯¹store.dispatchæ–¹æ³•è¿›è¡Œäº†æ”¹é€ ï¼Œåœ¨å‘å‡ºActionå’Œæ‰§è¡ŒReducerè¿™ä¸¤æ­¥ä¹‹é—´ï¼Œæ·»åŠ äº†å…¶ä»–åŠŸèƒ½ã€‚ ä¸­é—´ä»¶çš„ç”¨æ³•æ¯”å¦‚æ·»åŠ è¾“å‡ºæ—¥å¿—åŠŸèƒ½ï¼š 12345678import &#123; applyMiddleware, createStore &#125; from 'redux';import createLogger from 'redux-logger';const logger = createLogger();const store = createStore( reducer, applyMiddleware(logger)); è¿™é‡Œæœ‰ä¸¤ç‚¹è¦æ³¨æ„ï¼š createStoreæ–¹æ³•å¯ä»¥æ¥å—æ•´ä¸ªåº”ç”¨çš„åˆå§‹çŠ¶æ€ä½œä¸ºå‚æ•°ï¼Œé‚£æ ·çš„è¯ï¼ŒapplyMiddlewareå°±æ˜¯ç¬¬ä¸‰ä¸ªå‚æ•°ï¼š 12345const store = createStore( reducer, initial_state, applyMiddleware(logger)); ä¸­é—´ä»¶çš„æ¬¡åºæœ‰è®²ç©¶ 1234const store = createStore( reducer, applyMiddleware(thunk, promise, logger)); loggerè¦æ”¾åœ¨æœ€åã€‚ applyMiddlewaresæ˜¯Reduxçš„åŸç”Ÿæ–¹æ³•ï¼Œä½œç”¨æ˜¯å°†æ‰€æœ‰ä¸­é—´ä»¶ç»„æˆä¸€ä¸ªæ•°ç»„ï¼Œä¾æ¬¡æ‰§è¡Œã€‚ redux-thunkä¸­é—´ä»¶æˆ‘ä»¬å…ˆçœ‹ä¸€ä¸ªç”¨dispatchå‘å‡ºå¼‚æ­¥è¯·æ±‚çš„ä¾‹å­ï¼š1234567class AsyncApp extends Component &#123; componentDidMount() &#123; const &#123; dispatch, selectedPost &#125; = this.props dispatch(fetchPosts(selectedPost)) &#125;// ...è¿™ä¸ªç»„ä»¶åœ¨componentDidMountç”Ÿå‘½å‘¨æœŸé‡Œæ‰§è¡Œdispatchæ“ä½œï¼Œå‘æœåŠ¡å™¨è¯·æ±‚æ•°æ®fetchPosts(selectedPost)ã€‚è¿™é‡Œçš„fetchPostså°±æ˜¯Action Creatorã€‚ è¿™ä¸ªfetchPosts``Action Creatoræ˜¯è¿™æ ·çš„ï¼š 1234567891011121314const fetchPosts = postTitle =&gt; (dispatch, getState) =&gt; &#123; dispatch(requestPosts(postTitle)); // å…ˆå‘å‡ºä¸€ä¸ªActionï¼Œè¡¨ç¤ºæ“ä½œå¼€å§‹ return fetch(`/some/API/$&#123;postTitle&#125;.json`) .then(response =&gt; response.json()) .then(json =&gt; dispatch(receivePosts(postTitle, json))); // å†å‘å‡ºä¸€ä¸ªActionè¡¨ç¤ºæ“ä½œç»“æŸ &#125;;&#125;;// ä½¿ç”¨æ–¹æ³•ä¸€store.dispatch(fetchPosts('reactjs'));// ä½¿ç”¨æ–¹æ³•äºŒstore.dispatch(fetchPosts('reactjs')).then(() =&gt; console.log(store.getState())); åœ¨ä¸Šé¢ä»£ç ä¸­ï¼ŒfetchPostsæ˜¯ä¸€ä¸ªAction Creatorï¼Œè¿”å›ä¸€ä¸ªå‡½æ•°ã€‚ç„¶åå†å‡½æ•°å†…éƒ¨æ‰§è¡Œå¼‚æ­¥æ“ä½œï¼ˆfetchï¼‰ï¼Œè·å–åˆ°å¼‚æ­¥æ“ä½œç»“æœåï¼Œå†é€šè¿‡dispatchå‘å‡ºActionï¼Œæ›´æ–°storeä¸­å˜é‡çš„å€¼ã€‚ ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæœ‰å‡ ç‚¹è¦æ³¨æ„ï¼š fetchPostsè¿”å›äº†ä¸€ä¸ªå‡½æ•°ï¼Œè€Œæ™®é€šçš„Action Creatoré»˜è®¤è¿”å›ä¸€ä¸ªå¯¹è±¡ã€‚ è¿”å›çš„å‡½æ•°çš„å‚æ•°æ˜¯dispatchå’ŒgetStateè¿™ä¸¤ä¸ªReduxæ–¹æ³•ï¼Œæ™®é€šçš„Action Creatorçš„å‚æ•°æ˜¯Actionçš„å†…å®¹ã€‚ åœ¨è¿”å›çš„å‡½æ•°ä¹‹ä¸­ï¼Œå…ˆå‘å‡ºä¸€ä¸ªActionè¡¨ç¤ºæ“ä½œå¼€å§‹ã€‚ å¼‚æ­¥æ“ä½œç»“æŸä¹‹åï¼Œå†å‘å‡ºä¸€ä¸ªActionè¡¨ç¤ºæ“ä½œç»“æŸã€‚ æˆ‘ä»¬çŸ¥é“ï¼ŒActionæ˜¯ç”±store.dispatchæ–¹æ³•å‘é€çš„ã€‚è€Œstore.dispatchæ–¹æ³•æ­£å¸¸æƒ…å†µä¸‹ï¼Œå‚æ•°åªèƒ½æ˜¯å¯¹è±¡ï¼Œä¸èƒ½æ˜¯å‡½æ•°ã€‚å› æ­¤ï¼Œè¿™æ—¶å°±è¦ä½¿ç”¨ä¸­é—´ä»¶redux-thunkã€‚ 123456789import &#123; createStore, applyMiddleware &#125; from 'redux';import thunk from 'redux-thunk';import reducer from './reducers';// Note: this API requires redux@&gt;=3.1.0const store = createStore( reducer, applyMiddleware(thunk)); ä½¿ç”¨redux-thunkä¸­é—´ä»¶ï¼Œæ”¹é€ store.dispatchä½¿å¾—åè€…å¯ä»¥æ¥å—å‡½æ•°ä½œä¸ºå‚æ•°ã€‚ React-Reduxçš„ç”¨æ³•React-Reduxå°†æ‰€æœ‰ç»„ä»¶åˆ†æˆä¸¤å¤§ç±»ï¼šUIç»„ä»¶å’Œå®¹å™¨ç»„ä»¶ã€‚ UIç»„ä»¶ åªè´Ÿè´£UIçš„å‘ˆç°ï¼Œä¸å¸¦æœ‰ä»»ä½•ä¸šåŠ¡é€»è¾‘ æ²¡æœ‰çŠ¶æ€ï¼ˆå³ä¸ä½¿ç”¨this.stateè¿™ä¸ªå˜é‡ï¼‰ æ‰€æœ‰æ•°æ®éƒ½ç”±å‚æ•°ï¼ˆthis.propsï¼‰æä¾› ä¸ä½¿ç”¨ä»»ä½•Reduxçš„API å› ä¸ºä¸å«æœ‰çŠ¶æ€ï¼ŒUIç»„ä»¶åˆç§°ä¸ºâ€œçº¯ç»„ä»¶â€ï¼Œå³å®ƒå’Œçº¯å‡½æ•°ä¸€æ ·ï¼Œçº¯ç²¹ç”±å‚æ•°å†³å®šå®ƒçš„å€¼ï¼ˆå‚æ•°ç›¸åŒè¿”å›çš„ç»“æœä¹Ÿç›¸åŒï¼‰ã€‚ å®¹å™¨ç»„ä»¶ è´Ÿè´£ç®¡ç†æ•°æ®å’Œä¸šåŠ¡é€»è¾‘ï¼Œä¸è´Ÿè´£UIçš„å‘ˆç° å¸¦æœ‰å†…éƒ¨çŠ¶æ€ ä½¿ç”¨Reduxçš„API å¯ä»¥è¯´ï¼šUIç»„ä»¶è´Ÿè´£UIçš„å‘ˆç°ï¼Œå®¹å™¨ç»„ä»¶è´Ÿè´£ç®¡ç†æ•°æ®å’Œé€»è¾‘ã€‚ å¦‚æœä¸€ä¸ªç»„ä»¶æ—¢æœ‰UIåˆæœ‰ä¸šåŠ¡é€»è¾‘çš„è¯ï¼Œæˆ‘ä»¬çš„åšæ³•æ˜¯ï¼Œå°†å…¶æ‹†åˆ†æˆå¤–é¢æ˜¯ä¸€ä¸ªå®¹å™¨ç»„ä»¶ï¼Œé‡Œé¢åŒ…ç€UIç»„ä»¶ã€‚å‰è€…è´Ÿè´£ä¸å¤–éƒ¨çš„é€šä¿¡ï¼Œå°†æ•°æ®ä¼ ç»™åè€…ï¼Œç”±åè€…æ¸²æŸ“å‡ºè§†å›¾ã€‚ React-Reduxè§„å®šï¼Œæ‰€æœ‰çš„UIç»„ä»¶éƒ½ç”±ç”¨æˆ·æä¾›ï¼Œå®¹å™¨ç»„ä»¶åˆ™æ˜¯ç”±React-Reduxè‡ªåŠ¨ç”Ÿæˆï¼Œç”¨æˆ·è´Ÿè´£è§†è§‰å±‚ï¼ŒçŠ¶æ€ç®¡ç†åˆ™å…¨éƒ¨äº¤ç»™å®ƒã€‚ connect()React-Reduxæä¾›connectæ–¹æ³•ï¼Œç”¨äºä»UIç»„ä»¶ç”Ÿæˆå®¹å™¨ç»„ä»¶ã€‚å…¶å®Œæ•´APIå¦‚ä¸‹ï¼š123456import &#123; connect &#125; from 'react-redux'const VisibleTodoList = connect( mapStateToProps, mapDispatchToProps)(TodoList) connectæ–¹æ³•æ¥å—ä¸¤ä¸ªå‚æ•°ï¼šmapStateToPropså’ŒmapDispatchToPropsã€‚å®ƒä»¬å®šä¹‰äº†UIç»„ä»¶çš„ä¸šåŠ¡é€»è¾‘ï¼š mapStateToPropsè´Ÿè´£è¾“å…¥é€»è¾‘ï¼Œå°†stateæ˜ å°„åˆ°UIç»„ä»¶çš„å‚æ•°ï¼ˆpropsï¼‰ mapDispatchToPropsè´Ÿè´£è¾“å‡ºé€»è¾‘ï¼Œå³å°†ç”¨æˆ·å¯¹UIç»„ä»¶çš„æ“ä½œæ˜ å°„æˆAction å…·ä½“ç”¨æ³•å¦‚ä¸‹ï¼š12345678910111213141516171819202122232425262728293031const mapStateToProps = (state) =&gt; (&#123; poemInfo: state.getIn(['poem', 'poemInfo']), authorInfo: state.getIn(['poem', 'authorInfo']), like: state.getIn(['poem', 'like']), collect: state.getIn(['poem', 'collect']),&#125;);const mapDispatchToProps = (dispatch) =&gt; &#123; return &#123; getPoem(poem_id, category) &#123; return dispatch(getPoemInfo(poem_id, category)); // dispatch Action Creator &#125;, getAuthor(author_id, category) &#123; dispatch(getAuthorInfo(author_id, category)); &#125;, getAudio(poem_id, category) &#123; return dispatch(getAudioInfo(poem_id, category)); &#125;, getDynamic(poem_id, category) &#123; dispatch(getDynamicInfo(poem_id, category)); &#125;, changeLikeStatus(status) &#123; dispatch(changeLike(status)); &#125;, changeCollectStatus(status) &#123; dispatch(changeCollect(status)); &#125;, &#125;;&#125;;export default connect(mapStateToProps, mapDispatchToProps)(React.memo(Poem));å®šä¹‰å¥½mapStateToPropså°†å…¶ä½œä¸ºå‚æ•°ä¼ å…¥connectä»¥åï¼Œåœ¨ç»„ä»¶Poemä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä»propsè·å–poemInfoã€authorInfoã€likeã€collectæ•°æ®ï¼Œè¿™å°±ä½“ç°äº†è¾“å…¥é€»è¾‘ã€‚ ä¸æ­¤åŒæ—¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨ç»„ä»¶Poemä¸­ä»propsè·å–getPoemã€getAuthorç­‰æ–¹æ³•ï¼Œå½“ç»„ä»¶å†…é€šè¿‡äº‹ä»¶è§¦å‘è¿™äº›æ–¹æ³•æ—¶ï¼Œå°±å¯ä»¥é€šè¿‡dispatchæ‰§è¡Œå¯¹åº”çš„Actionï¼Œæ”¹å˜storeä¸­å˜é‡çš„å€¼ï¼Œä»è€Œè¿›ä¸€æ­¥ä»propsä¸­è·å–æ”¹å˜ä¹‹åçš„å˜é‡å€¼ã€‚ mapStateToPropsæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå»ºç«‹ä¸€ä¸ªä»ï¼ˆå¤–éƒ¨çš„ï¼‰stateå¯¹è±¡åˆ°ï¼ˆUIç»„ä»¶çš„ï¼‰propså¯¹è±¡çš„æ˜ å°„å…³ç³»ã€‚å®ƒè¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œé‡Œé¢çš„æ¯ä¸€ä¸ªé”®å€¼å¯¹å°±æ˜¯ä¸€ä¸ªæ˜ å°„ã€‚ mapDispatchToPropså¯ä»¥æ˜¯å‡½æ•°ä¹Ÿå¯ä»¥æ˜¯å¯¹è±¡ï¼Œä¸€èˆ¬ä½œä¸ºå‡½æ•°æ¥ä½¿ç”¨ï¼Œå®ƒè¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œè¯¥å¯¹è±¡çš„æ¯ä¸ªé”®å€¼å¯¹éƒ½æ˜¯ä¸€ä¸ªæ˜ å°„ï¼Œå®šä¹‰äº†æ¯ä¸ªæ–¹æ³•å¯¹åº”å‘å‡ºæ€æ ·çš„Actionã€‚ï¼ˆå¯ä»¥å†™æˆé”®å€¼å¯¹çš„å½¢å¼ï¼Œä¹Ÿå¯ä»¥å†™æˆä¸Šé¢ä»£ç çš„å½¢å¼ï¼‰ Providerç»„ä»¶connectæ–¹æ³•ç”Ÿæˆå®¹å™¨ç»„ä»¶ä»¥åï¼Œéœ€è¦è®©å®¹å™¨ç»„ä»¶æ‹¿åˆ°stateå¯¹è±¡ï¼Œæ‰èƒ½ç”Ÿæˆ UI ç»„ä»¶çš„å‚æ•°ã€‚ ä¸€ç§è§£å†³æ–¹æ³•æ˜¯å°†stateå¯¹è±¡ä½œä¸ºå‚æ•°ï¼Œä¼ å…¥å®¹å™¨ç»„ä»¶ã€‚ä½†æ˜¯ï¼Œè¿™æ ·åšæ¯”è¾ƒéº»çƒ¦ï¼Œå°¤å…¶æ˜¯å®¹å™¨ç»„ä»¶å¯èƒ½åœ¨å¾ˆæ·±çš„å±‚çº§ï¼Œä¸€çº§çº§å°†stateä¼ ä¸‹å»å°±å¾ˆéº»çƒ¦ã€‚ React-Redux æä¾›Providerç»„ä»¶ï¼Œå¯ä»¥è®©å®¹å™¨ç»„ä»¶æ‹¿åˆ°stateã€‚ 123456789101112import &#123; Provider &#125; from 'react-redux'import &#123; createStore &#125; from 'redux'import todoApp from './reducers'import App from './components/App'let store = createStore(todoApp);render( &lt;Provider store=&#123;store&#125;&gt; &lt;App /&gt; &lt;/Provider&gt;, document.getElementById('root') ä¸Šé¢ä»£ç ä¸­ï¼ŒProvideråœ¨æ ¹ç»„ä»¶å¤–é¢åŒ…äº†ä¸€å±‚ï¼Œè¿™æ ·ä¸€æ¥ï¼ŒAppçš„æ‰€æœ‰å­ç»„ä»¶å°±é»˜è®¤éƒ½å¯ä»¥æ‹¿åˆ°stateäº†ã€‚å®ƒçš„åŸç†æ˜¯Reactç»„ä»¶çš„contextå±æ€§ã€‚ React Reduxå®è·µé¡¹ç›®ä¸­æƒ³è¦ä½¿ç”¨React-Reduxä¸€èˆ¬éµå¾ªä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š å®‰è£…é¡¹ç›®ä¾èµ–1npm install redux redux-thunk redux-immutable react-redux immutable --save å¦‚æœé¡¹ç›®ä¸­ä½¿ç”¨åˆ°immutable.jsä¸­çš„æ•°æ®ç»“æ„ï¼Œåˆ™éœ€è¦å®‰è£…redux-immutableï¼Œåœ¨åˆå¹¶ä¸åŒæ¨¡å—çš„reducerçš„æ—¶å€™éœ€è¦ç”¨åˆ°redux-immutableä¸­çš„æ–¹æ³•ã€‚ åˆ›å»ºstoreåœ¨srcç›®å½•æˆ–è€…appç›®å½•ä¸‹åˆ›å»ºstoreæ–‡ä»¶å¤¹ï¼Œå¹¶åœ¨å…¶ä¸­æ–°å»ºindex.jså’Œreducer.jsæ–‡ä»¶ã€‚ 123456//reducer.jsimport &#123; combineReducers &#125; from 'redux-immutable';export default combineReducers (&#123;// ä¹‹åå¼€å‘å…·ä½“åŠŸèƒ½æ¨¡å—çš„æ—¶å€™æ·»åŠ  reducer&#125;); 1234567891011//index.jsimport &#123; createStore, compose, applyMiddleware &#125; from 'redux'import thunk from 'redux-thunk'import reducer from './reducer'const composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;const store = createStore (reducer, composeEnhancers ( applyMiddleware (thunk)));export default store; åœ¨é¡¹ç›®ä¸­æ³¨å…¥store1234567891011121314import React from 'react'import &#123; Provider &#125; from 'react-redux'import store from './store/index'import routes from './routes/index.js'function App () &#123; return ( &lt;Provider store=&#123;store&#125;&gt; ... &lt;/Provider&gt; )&#125;export default App; ä¸ºéœ€è¦ä½¿ç”¨reduxçš„ç»„ä»¶åˆ›å»ºå„è‡ªçš„store 1234567// constants.ts// å®šä¹‰å„ç§Actionexport const GET_CURRENT_POEM = 'poem/GET_CURRENT_POEM';export const GET_AUTHOR_INFO = 'poem/GET_AUTHOR_INFO';export const GET_AUDIO_INFO = 'poem/GET_AUDIO_INFO';export const GET_LIKE = 'poem/GET_LIKE';export const GET_COLLECT = 'poem/GET_COLLECT'; 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111// actionCreators.ts// å®šä¹‰å„ç§Actionå’ŒAction Creatorimport &#123; GET_CURRENT_POEM, GET_AUTHOR_INFO, GET_AUDIO_INFO, GET_LIKE, GET_COLLECT,&#125; from './constants';import &#123; fromJS &#125; from 'immutable';import &#123; getPoemDetail, getAuthorDetail, getAudio, getDynamic,&#125; from '@servers/servers';export const changePoemInfo = (data) =&gt; (&#123; type: GET_CURRENT_POEM, data: fromJS(data),&#125;);export const changeAuthorInfo = (data) =&gt; (&#123; type: GET_AUTHOR_INFO, data: fromJS(data),&#125;);export const changeAudioInfo = (data) =&gt; (&#123; type: GET_AUDIO_INFO, data: fromJS(data),&#125;);export const changeLike = (data) =&gt; (&#123; type: GET_LIKE, data: fromJS(data),&#125;);export const changeCollect = (data) =&gt; (&#123; type: GET_COLLECT, data: fromJS(data),&#125;);export const getPoemInfo = (poem_id, category) =&gt; &#123; return (dispatch) =&gt; &#123; return getPoemDetail(poem_id, category) .then((res) =&gt; &#123; const curPoem = res[0]; if (category === '0') &#123; curPoem.dynasty = 'S'; &#125; else if (category === '1') &#123; curPoem.dynasty = 'T'; &#125; dispatch(changePoemInfo(curPoem)); &#125;) .catch((err) =&gt; &#123; console.error(err); &#125;); &#125;;&#125;;export const getAuthorInfo = (author_id, category) =&gt; &#123; return (dispatch) =&gt; &#123; if(author_id === undefined) &#123; dispatch(changeAuthorInfo(&#123;&#125;)); &#125; getAuthorDetail(author_id, category) .then((res) =&gt; &#123; if (res) &#123; dispatch(changeAuthorInfo(res[0])); &#125; &#125;) .catch((err) =&gt; &#123; console.error(err); &#125;); &#125;;&#125;;export const getAudioInfo = (poem_id, category) =&gt; &#123; return (dispatch) =&gt; &#123; return new Promise((resolve, reject) =&gt; &#123; getAudio(poem_id, category) .then((data: any) =&gt; &#123; if (data.length &gt; 0) &#123; dispatch(changeAudioInfo(data[0])); resolve(true); &#125; else &#123; resolve(false); &#125; &#125;) .catch((err) =&gt; &#123; console.error(err); &#125;); &#125;); &#125;;&#125;;export const getDynamicInfo = (poem_id, category) =&gt; &#123; return (dispatch) =&gt; &#123; getDynamic(poem_id, category) .then((res: any) =&gt; &#123; const &#123; like, collect &#125; = res; dispatch(changeLike(like)); dispatch(changeCollect(collect)); &#125;) .catch((err) =&gt; &#123; console.error(err); &#125;); &#125;;&#125;; 1234567891011121314151617181920212223242526272829// reducer.ts// å®šä¹‰defaultStateå’Œreducerimport * as actionTypes from './constants';import &#123; fromJS &#125; from 'immutable';const defaultState = fromJS(&#123; poemInfo: &#123;&#125;, authorInfo: &#123;&#125;, audioInfo: &#123;&#125;, like: false, collect: false,&#125;);export default (state = defaultState, action) =&gt; &#123; switch (action.type) &#123; case actionTypes.GET_CURRENT_POEM: return state.set('poemInfo', action.data); case actionTypes.GET_AUTHOR_INFO: return state.set('authorInfo', action.data); case actionTypes.GET_AUDIO_INFO: return state.set('audioInfo', action.data); case actionTypes.GET_LIKE: return state.set('like', action.data); case actionTypes.GET_COLLECT: return state.set('collect', action.data); default: return state; &#125;&#125;; 1234567// index.ts// å°†reducerã€actionCreators exportå‡ºå»import reducer from './reducer';import * as actionCreators from './actionCreators';import * as constants from './constants';export &#123; reducer, actionCreators, constants &#125;; exportå‡ºå»ä¹‹åï¼Œè¦åœ¨å…¨å±€çš„storeæ–‡ä»¶å¤¹ä¸‹çš„reducerå†…å¯¼å…¥æ¯ä¸ªç»„ä»¶çš„reducerï¼Œå°†æ‰€æœ‰ç»„ä»¶çš„reducerè¿›è¡Œåˆå¹¶ï¼Œæ‰èƒ½èµ·åˆ°ä½œç”¨ï¼š 12345678910111213// store/reducer.tsimport &#123; combineReducers &#125; from 'redux-immutable';import &#123; reducer as searchReducer &#125; from '@pages/Search/store/index';import &#123; reducer as playerReducer &#125; from '@pages/Player/store/index';import &#123; reducer as poemReducer &#125; from '@pages/Poem/store/index';import &#123; reducer as recordReducer &#125; from '@pages/Record/store/index';export default combineReducers(&#123; search: searchReducer, player: playerReducer, poem: poemReducer, record: recordReducer,&#125;); ç»„ä»¶ä¸­ä½¿ç”¨12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152...import &#123; connect &#125; from 'react-redux';...function Poem(props) &#123; ... const &#123; poemInfo: poem, authorInfo: author, like, collect &#125; = props; // è·å–ä»mapStateToPropsä¼ å…¥çš„å¤–éƒ¨ï¼ˆstoreï¼‰çš„stateå¯¹è±¡ const &#123; getPoem, getAuthor, getAudio, getDynamic, changeLikeStatus, changeCollectStatus, &#125; = props; // è·å–ä»mapDispatchToPropsä¼ å…¥çš„æ–¹æ³• let poemInfo = poem ? poem.toJS() : &#123;&#125;; // å¯¹è±¡ç±»å‹æ•°æ®éœ€è¦è¿›è¡Œè¿›ä¸€æ­¥çš„toJSæ“ä½œ let authorInfo = author ? author.toJS() : &#123;&#125;; ...&#125;const mapStateToProps = (state) =&gt; (&#123; poemInfo: state.getIn(['poem', 'poemInfo']), authorInfo: state.getIn(['poem', 'authorInfo']), like: state.getIn(['poem', 'like']), collect: state.getIn(['poem', 'collect']),&#125;);const mapDispatchToProps = (dispatch) =&gt; &#123; return &#123; getPoem(poem_id, category) &#123; return dispatch(getPoemInfo(poem_id, category)); &#125;, getAuthor(author_id, category) &#123; dispatch(getAuthorInfo(author_id, category)); &#125;, getAudio(poem_id, category) &#123; return dispatch(getAudioInfo(poem_id, category)); &#125;, getDynamic(poem_id, category) &#123; dispatch(getDynamicInfo(poem_id, category)); &#125;, changeLikeStatus(status) &#123; dispatch(changeLike(status)); &#125;, changeCollectStatus(status) &#123; dispatch(changeCollect(status)); &#125;, &#125;;&#125;;export default connect(mapStateToProps, mapDispatchToProps)(React.memo(Poem)); é‡åˆ°çš„å¤æ‚åœºæ™¯ ä¹‹å‰é‡åˆ°çš„åœºæ™¯æ˜¯è¿™æ ·çš„ï¼šæˆ‘è¦é€šè¿‡å¼‚æ­¥è¯·æ±‚è·å–éŸ³é¢‘ï¼Œè¿™ä¸ªéŸ³é¢‘æƒ³è®©å®ƒå­˜å‚¨åœ¨å…¨å±€storeä¸­çš„ï¼Œæ‰€ä»¥è¦é€šè¿‡dispatchæ“ä½œæ¥å‘èµ·è¯·æ±‚ã€‚ä¸æ­¤åŒæ—¶ï¼Œæˆ‘æƒ³åœ¨è¯·æ±‚å®Œæˆåï¼Œé€šè¿‡è·å–çš„æ•°æ®æ˜¯å¦ä¸ºç©ºæ¥åˆ¤æ–­è¿™ä¸ªéŸ³é¢‘æ˜¯å¦å­˜åœ¨ï¼Œå­˜åœ¨çš„è¯è·³è½¬è‡³æ’­æ”¾å™¨Playeré¡µé¢ï¼Œä¸å­˜åœ¨çš„è¯å°±å¼¹å‡ºtoastæç¤ºã€‚ ä¸€å¼€å§‹æƒ³åˆ°çš„è§£å†³æ–¹æ¡ˆæ˜¯ï¼šåœ¨storeä¸­å­˜æ”¾ä¸€ä¸ªstatuså˜é‡æ¥è¡¨ç¤ºæ•°æ®æ˜¯å¦ä¸ºç©ºï¼Œè·å–åˆ°æ•°æ®å°±dispatchè¿™ä¸ªstatusä¸ºtrueã€‚ä½†å¯èƒ½å› ä¸ºdispatchæ˜¯å¼‚æ­¥æ›´æ–°çš„åŸå› ï¼Œåœ¨ç»„ä»¶ä¸­è·å–è¿™ä¸ªä»propsä¸­ä¼ æ¥çš„å˜é‡çš„å€¼å› å»¶è¿Ÿè€Œæœ‰è¯¯ï¼Œæ— æ³•å®ç°æ•ˆæœã€‚ å› ä¸ºæƒ³è¦åœ¨è¯·æ±‚å®Œæˆåå»åˆ¤æ–­æ•°æ®æ˜¯å¦ä¸ºç©ºï¼Œå¾ˆè‡ªç„¶ä¼šæƒ³åˆ°ç”¨.thenã€‚ä½†å¦‚æœä¸åšä»»ä½•æ”¹å†™ï¼Œç›´æ¥åœ¨æ–¹æ³•åæ·»åŠ .thenï¼Œä¼šæŠ¥é”™store.dispatch(...).then is not a functionã€‚ ç»¼ä¸Šæ‰€è¿°ï¼Œé—®é¢˜å¯ä»¥å½’ç»“ä¸ºä¸¤ç‚¹ï¼š1. å¦‚ä½•ä¼ é€’è¯·æ±‚è·å–çš„æ•°æ®ä¸ºç©ºè¿™ä¸ªä¿¡æ¯ï¼›2. å¦‚ä½•è§£å†³store.dispatch(â€¦).thençš„æŠ¥é”™ å…ˆçœ‹ç¬¬äºŒä¸ªé—®é¢˜ï¼Œæœ‰.thençš„æŠ¥é”™ï¼Œè¯´æ˜è¿™ä¸ªæ–¹æ³•å®ƒä¸æ˜¯thenableçš„ï¼Œé‚£ä»€ä¹ˆæ˜¯.thenableçš„å‘¢ï¼Ÿå¾ˆè‡ªç„¶æˆ‘ä»¬ä¼šæƒ³åˆ°Promiseã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°†åŸæœ¬çš„Action Creatorï¼š 123456789101112131415161718export const getAudioInfo = (poem_id, category) =&gt; &#123; return (dispatch) =&gt; &#123; getAudio(poem_id, category) .then((data) =&gt; &#123; if (data.length &gt; 0) &#123; dispatch(changeAudioStatus(true)); dispatch(changeAudioInfo(data[0])); resolve(true); &#125; else &#123; dispatch(changeAudioStatus(false)); resolve(false); &#125; &#125;) .catch((err) =&gt; &#123; console.error(err); &#125;); &#125;;&#125;; æ”¹å†™æˆï¼š 123456789101112131415161718export const getAudioInfo = (poem_id, category) =&gt; &#123; return (dispatch) =&gt; &#123; return new Promise((resolve, reject) =&gt; &#123; getAudio(poem_id, category) .then((data) =&gt; &#123; if (data.length &gt; 0) &#123; dispatch(changeAudioStatus(true)); dispatch(changeAudioInfo(data[0])); &#125; else &#123; dispatch(changeAudioStatus(false)); &#125; &#125;) .catch((err) =&gt; &#123; console.error(err); &#125;); &#125;); &#125;;&#125;; ç„¶ååœ¨mapDispatchToPropsä¸­ï¼Œå°†dispatch(xxx)æ”¹å†™æˆreturn dispatch(xxx)ï¼š1234567const mapDispatchToProps = (dispatch) =&gt; &#123; return &#123; getAudio(poem_id, category) &#123; return dispatch(getAudioInfo(poem_id, category)); &#125;, &#125;;&#125;; è¿™ä¹ˆå†™å®Œåï¼Œå°±ä¸ä¼šæŠ¥.thençš„é”™è¯¯äº†ã€‚ï¼ˆå‚è€ƒï¼šstore.dispatch(â€¦).then is not a functionï¼‰ æˆ‘ä»¬å†æ¥çœ‹ç¬¬ä¸€ä¸ªé—®é¢˜ã€‚æˆ‘ä»¬ç°åœ¨ä¸èƒ½å¤Ÿé€šè¿‡åœ¨storeä¸­å­˜å‚¨statuså˜é‡æ¥ä¼ é€’æ•°æ®æ˜¯å¦å­˜åœ¨çš„ä¿¡æ¯ï¼Œå› ä¸ºdispatchå¼‚æ­¥æ›´æ–°æœ‰å»¶è¿Ÿï¼Œåœ¨Promiseä¸­ï¼Œæˆ‘ä»¬ä¼šä½¿ç”¨resolveå’Œrejectæ¥ä¼ é€’ä¿¡æ¯ï¼Œå¯ä»¥åœ¨ä¹‹åçš„.thenå›è°ƒä¸­è·å–è¿™ä¸ªä¿¡æ¯ã€‚ æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡resolveæ¥ä¼ é€’æ•°æ®æ˜¯å¦å­˜åœ¨çš„ä¿¡æ¯ï¼Œå­˜åœ¨åˆ™resolve(true)ï¼Œä¸å­˜åœ¨åˆ™reject(false)ï¼š 123456789101112131415161718export const getAudioInfo = (poem_id, category) =&gt; &#123; return (dispatch) =&gt; &#123; return new Promise((resolve, reject) =&gt; &#123; getAudio(poem_id, category) .then((data: any) =&gt; &#123; if (data.length &gt; 0) &#123; dispatch(changeAudioInfo(data[0])); resolve(true); // æ•°æ®å­˜åœ¨ &#125; else &#123; resolve(false); // æ•°æ®ä¸å­˜åœ¨ &#125; &#125;) .catch((err) =&gt; &#123; console.error(err); &#125;); &#125;); &#125;;&#125;; å‰ç«¯éƒ¨åˆ†é€šè¿‡.thenå›è°ƒä¼ å…¥çš„å‚æ•°statusæ¥åˆ¤æ–­æ˜¯è·³è½¬é¡µé¢è¿˜æ˜¯å¼¹å‡ºæç¤ºï¼š 1234567891011const handleListen = () =&gt; &#123; getAudio(id, category).then((status) =&gt; &#123; if (status) &#123; Taro.navigateTo(&#123; url: '/pages/Player/index', &#125;); &#125; else &#123; setShowToast(true); &#125; &#125;); &#125;; æ€»ç»“React-Reduxæ˜¯Reactçš„çŠ¶æ€ç®¡ç†å·¥å…·ï¼Œå®ƒä¸»è¦æ˜¯ä¸ºäº†è§£å†³åœ¨å¤§å‹é¡¹ç›®ä¸­ï¼Œä¸€äº›çŠ¶æ€çš„å…±äº«é—®é¢˜ã€‚å¦‚æœä¸ä½¿ç”¨React-Reduxï¼Œç»„ä»¶ä¹‹é—´å…±äº«çŠ¶æ€åªèƒ½é€šè¿‡è·¯ç”±æˆ–è€…contextæ¥å®ç°ï¼Œå¾ˆéº»çƒ¦ã€‚æœ‰äº†React-Reduxï¼Œä¸€äº›ä¼šåœ¨å¤šä¸ªç»„ä»¶ä¸­ä½¿ç”¨çš„å˜é‡å°±å¯ä»¥å­˜å‚¨åœ¨storeä¸­ï¼Œç»„ä»¶å†…å¯ä»¥ä»storeä¸­è·å–è¿™ä¸ªå˜é‡æ¥ä½¿ç”¨ï¼Œè¿™ä¹ˆåšä»£ç æ•´ä½“ç»“æ„æ›´ä¼˜é›…ï¼Œä»£ç å¯è¯»æ€§ä¹Ÿæ›´å¥½ã€‚","categories":[{"name":"React","slug":"React","permalink":"http://delaprada.com/categories/React/"}],"tags":[{"name":"React","slug":"React","permalink":"http://delaprada.com/tags/React/"}]},{"title":"å¼‚æ­¥ä»¥åŠå¼‚æ­¥ç¼–ç¨‹è§£å†³æ–¹æ¡ˆ","slug":"å¼‚æ­¥ä»¥åŠå¼‚æ­¥ç¼–ç¨‹è§£å†³æ–¹æ¡ˆ","date":"2021-03-18T06:54:11.000Z","updated":"2021-03-18T06:55:18.000Z","comments":true,"path":"2021/03/18/å¼‚æ­¥ä»¥åŠå¼‚æ­¥ç¼–ç¨‹è§£å†³æ–¹æ¡ˆ/","link":"","permalink":"http://delaprada.com/2021/03/18/%E5%BC%82%E6%AD%A5%E4%BB%A5%E5%8F%8A%E5%BC%82%E6%AD%A5%E7%BC%96%E7%A8%8B%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/","excerpt":"","text":"ä»€ä¹ˆæ˜¯å¼‚æ­¥æ‰€è°“â€å¼‚æ­¥â€ï¼Œç®€å•è¯´å°±æ˜¯ä¸€ä¸ªä»»åŠ¡ä¸æ˜¯è¿ç»­å®Œæˆçš„ï¼Œå¯ä»¥ç†è§£æˆè¯¥ä»»åŠ¡è¢«äººä¸ºåˆ†æˆä¸¤æ®µï¼Œå…ˆæ‰§è¡Œç¬¬ä¸€æ®µï¼Œç„¶åè½¬è€Œæ‰§è¡Œå…¶ä»–ä»»åŠ¡ï¼Œç­‰åšå¥½äº†å‡†å¤‡ï¼Œå†å›è¿‡å¤´æ‰§è¡Œç¬¬äºŒæ®µã€‚ ç›¸åº”åœ°ï¼Œè¿ç»­çš„æ‰§è¡Œå°±å«åšåŒæ­¥ã€‚ç”±äºæ˜¯è¿ç»­æ‰§è¡Œï¼Œä¸èƒ½æ’å…¥å…¶ä»–ä»»åŠ¡ã€‚ ä¾‹å¦‚ï¼š1234setTimeout(function()&#123; XXX;&#125;,1000)console.log(\"complete!\");setTimeoutå°±æ˜¯ä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡ï¼Œä»»åŠ¡åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼Œä¸€ä¸ªéƒ¨åˆ†æ˜¯å»¶è¿Ÿ1000msï¼Œå¦ä¸€ä¸ªéƒ¨åˆ†æ˜¯æ‰§è¡ŒXXXã€‚setTimeoutæ˜¯å…ˆæ‰§è¡Œ1000msçš„å»¶è¿Ÿï¼Œç„¶åå†å»¶è¿ŸæœŸé—´å°†æ‰§è¡Œæƒäº¤ç»™äº†console.logï¼Œè¾“å‡ºäº†â€œcomplete!â€ä¹‹åï¼Œå†å»æ‰§è¡ŒsetTimeoutä»»åŠ¡çš„ç¬¬äºŒéƒ¨åˆ†ï¼Œæ‰§è¡ŒXXXã€‚ å¦‚æœæ˜¯åŒæ­¥çš„è¯ï¼Œå®ƒä¼šç­‰åˆ°1000msè¿‡å»ï¼Œæ‰§è¡ŒXXXä¹‹åï¼Œå†è¾“å‡ºâ€complete!â€ï¼Œæ˜¾ç„¶JavaScriptä¸æƒ³è¿™æ ·æµªè´¹æ—¶é—´ã€‚ å¼‚æ­¥ç¼–ç¨‹æ–¹æ¡ˆå¼‚æ­¥ç¼–ç¨‹ä¹Ÿæœ‰å¤šç§è§£å†³æ–¹æ¡ˆï¼Œå…¶æ¼”å˜è¿‡ç¨‹æ˜¯ï¼šå›è°ƒå‡½æ•° â€”&gt; Promise â€”&gt; Generator â€”&gt; async/awaitï¼Œæ¯ä¸ªæ–°çš„æ¼”å˜éƒ½è§£å†³äº†ä¹‹å‰çš„ä¸€äº›ç—›ç‚¹ã€‚ å›è°ƒå‡½æ•°æ‰€è°“å›è°ƒå‡½æ•°ï¼Œå°±æ˜¯æŠŠä»»åŠ¡çš„ç¬¬äºŒæ®µå•ç‹¬å†™åœ¨ä¸€ä¸ªå‡½æ•°é‡Œé¢ï¼Œç­‰åˆ°é‡æ–°æ‰§è¡Œè¿™ä¸ªä»»åŠ¡çš„æ—¶å€™ï¼Œå°±ç›´æ¥è°ƒç”¨è¿™ä¸ªå‡½æ•°ã€‚callbackçš„æ„æ€å°±æ˜¯â€œé‡æ–°è°ƒç”¨â€ã€‚ è¯»å–æ–‡ä»¶è¿›è¡Œå¤„ç†ï¼Œæ˜¯è¿™æ ·å†™çš„ï¼š1234fs.readFile('/etc/passwd', 'utf-8', function (err, data) &#123; if (err) throw err; console.log(data);&#125;);ä¸Šé¢ä»£ç ä¸­ï¼ŒreadFileå‡½æ•°çš„ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œå°±æ˜¯å›è°ƒå‡½æ•°ï¼Œä¹Ÿå°±æ˜¯ä»»åŠ¡çš„ç¬¬äºŒæ®µã€‚ç­‰åˆ°æ“ä½œç³»ç»Ÿè¿”å›äº†/etc/passwdè¿™ä¸ªæ–‡ä»¶ä»¥åï¼Œå›è°ƒå‡½æ•°æ‰ä¼šæ‰§è¡Œã€‚ ä¹Ÿå°±æ˜¯è¯´åœ¨æ‰§è¡ŒreadFileçš„æ—¶å€™ï¼Œæ‰§è¡Œæƒäº¤ç»™äº†ä¸»çº¿ç¨‹æ‰§è¡Œæ ˆçš„åŒæ­¥ä»»åŠ¡ï¼ŒåŒæ­¥ä»»åŠ¡æ‰§è¡Œå®Œæ¯•åæ‰ä¼šæ‰§è¡Œè¿™ä¸ªreadFileçš„å›è°ƒã€‚ å›è°ƒå‡½æ•°çš„ç¼ºç‚¹å›è°ƒå‡½æ•°ä¼šå¯¼è‡´å›è°ƒåœ°ç‹±ã€‚ æ¯”å¦‚ç°åœ¨æœ‰å¤šä¸ªå¼‚æ­¥ä»»åŠ¡ï¼Œä¸”ä»»åŠ¡æœ‰ä¾èµ–å…³ç³»ï¼ˆä¸€ä¸ªä»»åŠ¡éœ€è¦æ‹¿åˆ°å¦ä¸€ä¸ªä»»åŠ¡æˆåŠŸåçš„ç»“æœæ‰èƒ½å¼€å§‹æ‰§è¡Œï¼‰çš„æ—¶å€™ï¼Œå›è°ƒçš„æ–¹å¼å†™å‡ºæ¥çš„ä»£ç å°±ä¼šåƒè¿™æ ·ï¼š1234567891011getData1(data1 =&gt; &#123; getData2(data1, data2 =&gt; &#123; getData3(data2, data3 =&gt; &#123; getData4(data3, data4 =&gt; &#123; getData5(data4, data5 =&gt; &#123; // ç»ˆäºå–åˆ°data5äº† &#125;) &#125;) &#125;) &#125;)&#125;)è¿™ç§å¤šå±‚åµŒå¥—çš„ç»“æ„å°±æ˜¯å›è°ƒåœ°ç‹±ï¼Œè¿™ç§æƒ…å†µä¸‹ä»£ç çš„å¯è¯»æ€§å¾ˆå·®ã€‚ Promiseå› æ­¤å°±å‡ºç°äº†Promiseã€‚Promiseçš„å…³é”®ç‚¹å°±æ˜¯å°†å›è°ƒå‡½æ•°çš„åµŒå¥—æ”¹ä¸ºäº†é“¾å¼è°ƒç”¨ã€‚ æˆ‘ä»¬ä½¿ç”¨new Promiseå»åˆ›å»ºä¸€ä¸ªPromiseå®ä¾‹ï¼Œè¿™ä¸ªPromiseå®ä¾‹ä¼šä¼ å…¥ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œå‡½æ•°åˆæœ‰ä¸¤ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œåˆ†åˆ«æ˜¯ï¼šresolveã€rejectã€‚ æ‰§è¡Œresolveå‡½æ•°ï¼ŒPromiseå®ä¾‹çš„çŠ¶æ€ä¼šå˜ä¸ºfulfilledï¼Œåç»­å°±ä¼šå»æ‰§è¡Œ.thenå›è°ƒå‡½æ•° æ‰§è¡Œrejectå‡½æ•°ï¼ŒPromiseå®ä¾‹çš„çŠ¶æ€ä¼šå˜ä¸ºrejectedï¼Œåç»­å°±ä¼šå»æ‰§è¡Œ.catchå›è°ƒå‡½æ•°ï¼Œæˆ–è€….thençš„ç¬¬äºŒä¸ªå›è°ƒå‡½æ•°ã€‚ 3ç§çŠ¶æ€Promiseå®ä¾‹æœ‰ä¸‰ç§çŠ¶æ€ï¼š pendingï¼ˆè¿›è¡Œä¸­ï¼‰ fulfilledï¼ˆå·²æˆåŠŸï¼‰ rejectedï¼ˆå·²å¤±è´¥ï¼‰fulfilledå’Œrejectedè¿™ä¸¤ç§çŠ¶æ€åˆå½’ä¸ºå·²å®ŒæˆçŠ¶æ€ã€‚ resolveå’Œrejectè°ƒç”¨resolveå’Œrejectèƒ½å°†åˆ†åˆ«å°†promiseå®ä¾‹çš„çŠ¶æ€å˜æˆfulfilledå’Œrejectedï¼Œåªæœ‰çŠ¶æ€å˜æˆå·²å®Œæˆï¼ˆå³fulfilledå’Œrejectedä¹‹ä¸€ï¼‰ï¼Œæ‰èƒ½è§¦å‘çŠ¶æ€çš„å›è°ƒã€‚ resolveå’Œrejectä¸¤ç§å‡½æ•°åªä¼šæ‰§è¡Œä¸€ç§ï¼Œæ‰§è¡Œäº†å…¶ä¸­ä¸€ä¸ªä¹‹åå°±ä¸ä¼šæ‰§è¡Œå¦ä¸€ä¸ªäº†ã€‚ Promiseè‡³å¤šåªèƒ½æœ‰ä¸€ä¸ªå†³è®®å€¼ï¼ˆå®Œæˆæˆ–æ‹’ç»ï¼‰ã€‚å¦‚æœä½ æ²¡æœ‰ç”¨ä»»ä½•å€¼æ˜¾å¼å†³è®®ï¼Œé‚£ä¹ˆè¿™ä¸ªå€¼å°±æ˜¯undefinedï¼Œè¿™æ˜¯jså¸¸è§çš„å¤„ç†æ–¹å¼ã€‚ å¦‚æœä½¿ç”¨å¤šä¸ªå‚æ•°è°ƒç”¨resolve(..)æˆ–è€…reject(..)ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¹‹åçš„æ‰€æœ‰å‚æ•°éƒ½ä¼šè¢«é»˜é»˜å¿½ç•¥ã€‚ å› æ­¤ï¼Œå¦‚æœè¦ä¼ é€’å¤šä¸ªå€¼ï¼Œä½ å°±å¿…é¡»è¦æŠŠå®ƒä»¬å°è£…åœ¨å•ä¸ªå€¼ä¸­ä¼ é€’ï¼Œæ¯”å¦‚é€šè¿‡ä¸€ä¸ªæ•°ç»„æˆ–å¯¹è±¡ã€‚ åŸºæœ¬ç»“æ„123456789101112131415let p = new Promise((resolve,reject)=&gt;&#123; //åšä¸€äº›äº‹æƒ… //ç„¶ååœ¨æŸäº›æ¡ä»¶ä¸‹resolveï¼Œæˆ–è€…rejectï¼ˆä»¥ä¸‹ä»£ç ï¼‰ if(/* æ¡ä»¶éšä¾¿å†™ */)&#123; resolve() &#125; else&#123; reject() &#125;&#125;)p.then(()=&gt;&#123; //å¦‚æœpçš„çŠ¶æ€è¢«resolveäº†ï¼Œå°±è¿›å…¥è¿™é‡Œ&#125;,()=&gt;&#123; //å¦‚æœpçš„çŠ¶æ€è¢«reject&#125;) ç®€å•æ¥è¯´ï¼Œè¿™ç§.then.then.thençš„ç¼–ç æ–¹å¼ï¼Œå°±æ˜¯Promiseã€‚ å®ƒçš„å¼‚æ­¥ä½“ç°åœ¨ï¼Œnew Promiseéƒ¨åˆ†æ˜¯ç«‹å³æ‰§è¡Œçš„ï¼Œé‚£æ‰§è¡Œå®Œæ¯•åï¼Œå°±ä¼šå°†æ‰§è¡Œæƒäº¤ç»™ä¸»çº¿ç¨‹æ‰§è¡Œæ ˆçš„åŒæ­¥ä»»åŠ¡ï¼ŒåŒæ­¥ä»»åŠ¡æ‰§è¡Œå®Œæ¯•åæ‰ä¼šå»æ‰§è¡Œ.thenå›è°ƒã€‚è¿™é‡Œæ¶‰åŠJavaScriptäº‹ä»¶æ‰§è¡Œæœºåˆ¶Eventloopã€‚ åæ‰é”™è¯¯æˆ–å¼‚å¸¸123456789var p = new Promise(function(resolve, reject) &#123; foo.bar(); // fooæœªå®šä¹‰ï¼Œè¿™é‡Œä¼šå‡ºé”™ resolve(42); // æ°¸è¿œä¸ä¼šåˆ°è¾¾è¿™é‡Œ&#125;);p.then(function fulfilled() &#123; // æ°¸è¿œä¸ä¼šåˆ°è¿™é‡Œ&#125;, function rejected() &#123; // errå°†ä¼šæ˜¯ä¸€ä¸ªæ¥è‡ªfoo.bar()è¿™ä¸€è¡Œçš„TypeErrorå¼‚å¸¸å¯¹è±¡&#125;) foo.bar()ä¸­å‘ç”Ÿjsé”™è¯¯å¯¼è‡´äº†Promiseæ‹’ç»ï¼Œä½ å¯ä»¥æ•æ‰å¹¶å¯¹å…¶ä½œå‡ºå“åº”ã€‚ ä½†å¦‚æœæ˜¯åœ¨then(..)æ³¨å†Œçš„å›è°ƒä¸­å‡ºç°jså¼‚å¸¸é”™è¯¯å‘¢ï¼Ÿä»¥ä¸Šè¿™ç§å†™æ³•æ˜¯æ²¡æœ‰åŠæ³•æ•æ‰åˆ°é”™è¯¯çš„ï¼š123456789var p = new Promise(function(resolve, reject) &#123; resolve(42);&#125;);p.then(function fulfilled(msg) &#123; foo.bar(); // å‡ºé”™ console.log(msg); // æ°¸è¿œä¸ä¼šåˆ°è¾¾è¿™é‡Œ&#125;, function rejected(err) &#123; // æ°¸è¿œä¸ä¼šåˆ°è¾¾è¿™é‡Œ&#125;); å› ä¸º.thençš„ç¬¬äºŒä¸ªfunctionæ˜¯ä¾¦å¬new Promiseä¸­æ˜¯å¦æœ‰å‡ºé”™çš„ï¼Œè€Œä¸æ˜¯ä¾¦å¬.thenå›è°ƒè¿™ä¸ªPromiseæ˜¯å¦æœ‰å‡ºé”™çš„ã€‚æ‰€ä»¥å¦‚æœæƒ³è¦ä¾¦å¬è¿™ä¸ªå›è°ƒé‡Œæ˜¯å¦æœ‰å‡ºé”™ï¼Œéœ€è¦åé¢å†åŠ ä¸€ä¸ª.thenç”¨äºå»ä¾¦å¬p.thenè¿™ä¸ªPromiseæ˜¯å¦æœ‰å‡ºé”™ã€‚ è€Œä¸”æ ¹æ®Promiseæœ€åŸºæœ¬çš„ç‰¹å¾ï¼šPromiseä¸€æ—¦å†³è®®å°±ä¸å¯å†å˜ã€‚på·²ç»å®Œæˆä¸ºå€¼42ï¼Œæ‰€ä»¥ä¹‹åæŸ¥çœ‹pçš„å†³è®®æ—¶ï¼Œå¹¶ä¸èƒ½å› ä¸ºå‡ºé”™å°±æŠŠpå˜ä¸ºä¸€ä¸ªæ‹’ç»ã€‚ Promiseå®ç°å¤šä¸ªå¼‚æ­¥ä»»åŠ¡é¡ºåºæ‰§è¡Œå¦‚æœPromiseçš„.thenå›è°ƒå†…çš„å‡½æ•°æ‰§è¡Œçš„æ˜¯åŒæ­¥ä»»åŠ¡ï¼Œé‚£ä¹ˆåœ¨å‡½æ•°å†…ç›´æ¥ç”¨returnå°†ç»“æœè¿”å›ï¼Œä¸‹ä¸€ä¸ª.thenå›è°ƒèƒ½å¤Ÿæ­£å¸¸è·å–returnçš„å€¼ï¼š123456789var p = Promise.resolve(21);p.then(function(v) &#123; console.log(v); // 21 return v*2;&#125;)// è¿™é‡Œæ˜¯é“¾æ¥çš„promise.then(function(v) &#123; console.log(v); // 42&#125;); ä½†å¦‚æœç¬¬ä¸€ä¸ª.thenå›è°ƒçš„å‡½æ•°å†…æ‰§è¡Œçš„æ˜¯å¼‚æ­¥ä»»åŠ¡ï¼Œæƒ³è®©ç¬¬äºŒä¸ª.thenå›è°ƒç­‰å¾…ç¬¬ä¸€ä¸ª.thenå›è°ƒæ‰§è¡Œå®Œåå†æ‰§è¡Œåˆ™ä¸èƒ½ç›´æ¥ä½¿ç”¨returnï¼Œéœ€è¦è¿”å›ä¸€ä¸ªnew Promiseï¼ŒåŒ…è£¹ä½å¼‚æ­¥ä»»åŠ¡æ¥å®ç°ç­‰å¾…ï¼š 1234567891011121314var result=new Promise(function(resolve,reject)&#123; setTimeout(function()&#123; resolve(\"one\"); &#125;,3000)&#125;).then(function(data)&#123; console.log(data); return new Promise(function(resolve,reject)&#123; setTimeout(function()&#123; resolve(\"two\"); &#125;,3000) &#125;)&#125;).then(function(data)&#123; console.log(data);&#125;) Promiseå®ç°å¤šä»»åŠ¡å¹¶è¡Œï¼ˆå³Aã€Bä»»åŠ¡éƒ½æ‰§è¡Œå®Œæ¯•äº†æ‰èƒ½æ‰§è¡ŒCä»»åŠ¡ï¼‰ï¼š123456789101112var p1=new Promise((resolve,reject)=&gt;&#123; resolve('hello');&#125;)p1.then(result=&gt;result);var p2=new Promise((resolve,reject)=&gt;&#123; resolve('hi');&#125;)p1.then(result=&gt;result);var p=Promise.all([p1,p2]);p.then(result=&gt;console.log(result)); è¿™é‡Œä¸»è¦ç”¨åˆ°Promise.allè¿™ç§ç»“æ„ã€‚Promise.all([p1,p2])æ¥å—ä¸€ä¸ªæ•°ç»„ä½œä¸ºå‚æ•°ï¼Œæ•°ç»„çš„å…ƒç´ éƒ½æ˜¯Promiseå®ä¾‹ï¼Œåªæœ‰å½“æ•°ç»„ä¸­æ‰€æœ‰Promiseå®ä¾‹çš„çŠ¶æ€éƒ½å˜ä¸ºfulfilledçš„æ—¶å€™ï¼Œè¿™ä¸ªPromise.allçš„å®ä¾‹æ‰ä¼šå˜ä¸ºfulfilledï¼Œæ‰èƒ½æ‰§è¡Œåç»­çš„.thenæ“ä½œã€‚ å’ŒPromise.allç›¸å…³çš„è¿˜æœ‰Promise.raceï¼Œé‚£Promise.raceå®ä¾‹çš„çŠ¶æ€æ˜¯ç­‰äºå…¶å‚æ•°ä¸­ç¬¬ä¸€ä¸ªæ‰§è¡Œå®Œæ¯•çš„Promiseå®ä¾‹çš„çŠ¶æ€ï¼Œå®ƒæœ‰å¯èƒ½æ˜¯rejectedï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯fulfilledã€‚ å»ºç«‹å¯ä¿¡ä»»çš„Promiseä¸‹é¢è¿™ç§æƒ…å†µä¸‹ï¼Œpromise p1å’Œpromise p2çš„è¡Œä¸ºæ˜¯å®Œå…¨ä¸€æ ·çš„ï¼š1234var p1 = new Promise(function(resolve, reject) &#123; resolve(42);&#125;);var p2 = Promise.resolve(42);è€Œå¦‚æœå‘Promise.resolve(..)ä¼ é€’ä¸€ä¸ªçœŸæ­£çš„Promiseï¼Œå°±åªä¼šè¿”å›åŒä¸€ä¸ªpromiseï¼š123var p1 = Promise.resolve(42);var p2 = Promise.resolve(p1);p1 === p2; // true Promiseçš„ç¼ºç‚¹Promiseçš„æœ€å¤§é—®é¢˜æ˜¯ä»£ç å†—ä½™ï¼šåŸæ¥çš„ä»»åŠ¡è¢«PromiseåŒ…è£…äº†ä¸€ä¸‹ï¼Œä¸ç®¡ä»€ä¹ˆæ“ä½œï¼Œä¸€çœ¼çœ‹å»éƒ½æ˜¯ä¸€å †thenï¼ŒåŸæ¥çš„è¯­ä¹‰å˜å¾—å¾ˆä¸æ¸…æ¥šã€‚ GeneratorGeneratorå‡½æ•°æ˜¯ES6æä¾›çš„ä¸€ç§å¼‚æ­¥ç¼–ç¨‹è§£å†³æ–¹æ¡ˆï¼ŒGeneratorå°±èƒ½å¤Ÿè§£å†³ä¸Šè¿°Promiseä»£ç å†—ä½™çš„é—®é¢˜ã€‚å®ƒèƒ½å¤Ÿä»¥ä¸€ç§ç±»ä¼¼åŒæ­¥çš„å†™æ³•æ¥æ‰§è¡Œä¸€äº›å¼‚æ­¥æ“ä½œã€‚ å½¢å¼ä¸ŠGeneratorå‡½æ•°æ˜¯ä¸€ä¸ªæ™®é€šå‡½æ•°ï¼Œæœ‰ä¸¤ä¸ªç‰¹å¾ï¼š1ï¼‰functionå…³é”®å­—ä¸å‡½æ•°åä¹‹é—´æœ‰ä¸ªæ˜Ÿå·ï¼› 2ï¼‰å‡½æ•°å†…éƒ¨ä½¿ç”¨yieldè¡¨è¾¾å¼ï¼Œå®šä¹‰ä¸åŒçš„å†…éƒ¨çŠ¶æ€ æ‰§è¡ŒGeneratorå‡½æ•°ä¼šè¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡ è°ƒç”¨Generatorå‡½æ•°åï¼Œè¯¥å‡½æ•°å¹¶ä¸æ‰§è¡Œï¼Œè¿”å›çš„ä¸æ˜¯å‡½æ•°è¿è¡Œç»“æœï¼Œè€Œæ˜¯ä¸€ä¸ªæŒ‡å‘å†…éƒ¨çŠ¶æ€çš„æŒ‡é’ˆå¯¹è±¡ å¿…é¡»è°ƒç”¨éå†å™¨å¯¹è±¡çš„nextæ–¹æ³•ï¼Œä½¿å¾—æŒ‡é’ˆç§»å‘ä¸‹ä¸€ä¸ªçŠ¶æ€ï¼Œè¾“å‡ºè¿”å›çš„ç»“æœ Generatorå‡½æ•°çš„å†™æ³•1234567function* helloWorldGenerator() &#123; yield 'hello'; yield 'world'; return 'ending';&#125;var hw = helloWorldGenerator(); 1234567891011hw.next()// &#123; value: 'hello', done: false &#125;hw.next()// &#123; value: 'world', done: false &#125;hw.next()// &#123; value: 'ending', done: true &#125;hw.next()// &#123; value: undefined, done: true &#125; è¾“å…¥å’Œè¾“å‡ºç”Ÿæˆå™¨å‡½æ•°è™½ç„¶æ˜¯ç‰¹æ®Šçš„å‡½æ•°ï¼Œæœ‰æ–°çš„æ‰§è¡Œæ¨¡å¼ï¼Œä½†æ˜¯å®ƒä»ç„¶æœ‰ä¸€äº›åŸºæœ¬çš„ç‰¹æ€§æ²¡æœ‰æ”¹å˜ã€‚æ¯”å¦‚ï¼Œå®ƒä»ç„¶å¯ä»¥æ¥å—å‚æ•°ï¼ˆå³è¾“å…¥ï¼‰ï¼Œä¹Ÿèƒ½å¤Ÿè¿”å›å€¼ï¼ˆå³è¾“å‡ºï¼‰ã€‚ ç”Ÿæˆå™¨æä¾›æ›´å¼ºå¤§çš„å†…å»ºæ¶ˆæ¯è¾“å…¥è¾“å‡ºèƒ½åŠ›ï¼Œé€šè¿‡yieldå’Œnext(..)å®ç°ï¼š123456789function *foo(x) &#123; var y = x * (yield); return y;&#125;var it = foo(6);// å¯åŠ¨foo(..)it.next();var res = it.next(7);res.value; // 42ç¬¬ä¸€ä¸ªit.next()çš„ä½œç”¨æ˜¯å¯åŠ¨fooç”Ÿæˆå™¨ï¼Œé‡åˆ°ä¸€ä¸ªyieldè¡¨è¾¾å¼æ—¶æš‚åœï¼Œå¹¶åœ¨æœ¬è´¨ä¸Šè¦æ±‚è°ƒç”¨ä»£ç ä¸ºyieldè¡¨è¾¾å¼æä¾›ä¸€ä¸ªç»“æœå€¼ã€‚ æ¥ä¸‹æ¥è°ƒç”¨it.next(7)ï¼Œè¿™ä¸€å¥æŠŠå€¼7ä¼ å›ä½œä¸ºè¢«æš‚åœçš„yieldè¡¨è¾¾å¼çš„ç»“æœã€‚æ­¤æ—¶y=6*7=42ã€‚æ‰€ä»¥è¿”å›42ã€‚ æ¶ˆæ¯æ˜¯åŒå‘ä¼ é€’çš„â€”â€”yield..ä½œä¸ºä¸€ä¸ªè¡¨è¾¾å¼å¯ä»¥å‘å‡ºæ¶ˆæ¯å“åº”next(..)è°ƒç”¨ï¼Œnext(..)ä¹Ÿå¯ä»¥å‘æš‚åœçš„yieldè¡¨è¾¾å¼å‘é€å€¼ã€‚ 123456789function *foo(x) &#123; var y = x * (yield \"Hello\"); // yieldä¸€ä¸ªå€¼ return y;&#125;var it = foo(6);var res = it.next();res.value; // \"Hello\"res = it.next(7); // å°†7ä¼ é€’ç»™æš‚åœçš„yieldè¡¨è¾¾å¼res.value; // 42 yield..å’Œnext(..)è¿™ä¸€å¯¹ç»„åˆèµ·æ¥ï¼Œåœ¨ç”Ÿæˆå™¨æ‰§è¡Œè¿‡ç¨‹ä¸­æ„æˆäº†ä¸€ä¸ªåŒå‘æ¶ˆæ¯ä¼ é€’ç³»ç»Ÿã€‚ æˆ‘ä»¬å¹¶æ²¡æœ‰å‘ç¬¬ä¸€ä¸ªnext()è°ƒç”¨å‘é€å€¼ï¼Œè¿™æ˜¯æœ‰æ„ä¸ºä¹‹ã€‚åªæœ‰æš‚åœçš„yieldæ‰èƒ½æ¥å—è¿™æ ·ä¸€ä¸ªé€šè¿‡next(..)ä¼ é€’çš„å€¼ï¼Œè€Œåœ¨ç”Ÿæˆå™¨çš„èµ·å§‹å¤„æˆ‘ä»¬è°ƒç”¨ç¬¬ä¸€ä¸ªnext()æ—¶ï¼Œè¿˜æ²¡æœ‰æš‚åœçš„yieldæ¥æ¥å—è¿™æ ·ä¸€ä¸ªå€¼ã€‚ç¬¬ä¸€ä¸ªnext()ä¸€èˆ¬æ˜¯ç”¨äºå¯åŠ¨ç”Ÿæˆå™¨ï¼Œè·å¾—ç¬¬ä¸€ä¸ªyieldå‡ºæ¥çš„å€¼ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰ã€‚ å¼‚æ­¥åº”ç”¨å› ä¸ºyieldèƒ½å¤Ÿä¸­æ–­æ‰§è¡Œä»£ç çš„ç‰¹æ€§ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬æ¥æ§åˆ¶å¼‚æ­¥ä»£ç çš„æ‰§è¡Œé¡ºåºã€‚ ä¾‹å¦‚æœ‰ä¸¤ä¸ªå¼‚æ­¥çš„å‡½æ•° A å’Œ B, å¹¶ä¸” B çš„å‚æ•°æ˜¯ A çš„è¿”å›å€¼ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœ A æ²¡æœ‰æ‰§è¡Œç»“æŸï¼Œæˆ‘ä»¬ä¸èƒ½æ‰§è¡Œ Bã€‚ é‚£è¿™æ—¶å€™æˆ‘ä»¬å†™ä¸€æ®µä¼ªä»£ç ï¼š 12345function* effect() &#123; const &#123; param &#125; = yield A(); const &#123; result &#125; = yield B(param); console.table(result);&#125; 123const iterator = effect()iterator.next()iterator.next() coåº“å¯ä»¥ç”¨æ¥æ¯æ¬¡æ‰§è¡ŒA()/b()çš„è¯·æ±‚ç»“æŸä¹‹åï¼Œéƒ½ä¼šè‡ªåŠ¨æ‰§è¡Œnext()æ–¹æ³•ã€‚ ä½¿ç”¨Generatorå»å®ç°Promiseçš„ä»»åŠ¡é¡ºåºæ‰§è¡Œæˆ‘ä»¬å†å›é¡¾ä¸€ä¸‹Promiseç‰ˆæœ¬ï¼š1234567891011121314var result=new Promise(function(resolve,reject)&#123; setTimeout(function()&#123; resolve(\"one\"); &#125;,3000)&#125;).then(function(data)&#123; console.log(data); return new Promise(function(resolve,reject)&#123; setTimeout(function()&#123; resolve(\"two\"); &#125;,3000) &#125;)&#125;).then(function(data)&#123; console.log(data);&#125;)Generatorç‰ˆæœ¬ï¼š123456789101112131415161718192021function f1() &#123; setTimeout(function() &#123; g.next(\"one\"); //å°†å‚æ•°ä¼ ç»™data1 &#125;, 3000);&#125;function f2(data1) &#123; console.log(\"æ¥æ”¶åˆ°äº†\" + data1); setTimeout(function()&#123; g.next(\"two\"); //å°†å‚æ•°ä¼ ç»™data2 &#125;,3000)&#125;function* mygenerator() &#123; var data1 = yield f1(); var data2=yield f2(data1); console.log(data2);&#125;var g = mygenerator();g.next();åœ¨å…¨å±€ä½œç”¨åŸŸä¸‹çš„g.next()æ˜¯ç”¨äºå¼€å§‹è¿­ä»£å™¨çš„éå†ï¼Œæ‰§è¡Œf1()ã€‚å½“f1()æ‰§è¡Œåˆ°g.next(&quot;one&quot;)æ—¶ï¼Œç¬¬ä¸€ä¸ªyieldè¡¨è¾¾å¼çš„å€¼å°±ä¼šè¢«èµ‹å€¼ä¸º&quot;one&quot;ï¼Œç„¶åæ‰§è¡Œf2(data1)ã€‚å½“f2()æ‰§è¡Œåˆ°g.next(&quot;two&quot;)æ—¶ï¼Œç¬¬äºŒä¸ªyieldè¡¨è¾¾å¼çš„å€¼å°±ä¼šè¢«èµ‹å€¼ä¸º&quot;two&quot;ã€‚ æ•è·é”™è¯¯ä½¿ç”¨try...catchï¼š12345678910111213function* gen(x)&#123; try &#123; var y = yield x + 2; &#125; catch (e)&#123; console.log(e); &#125; return y;&#125;var g = gen(1);g.next();g.throw('å‡ºé”™äº†');// å‡ºé”™äº†try...catchæ˜¯æ— æ³•æ•è·promiseæŠ›å‡ºçš„å¼‚å¸¸çš„ï¼ŒpromiseæŠ›å‡ºçš„å¼‚å¸¸åªèƒ½ç”±å…¶.catchå›è°ƒæˆ–è€….thençš„ç¬¬äºŒä¸ªå›è°ƒæ•è·ã€‚ æŒ‰ç†æ¥è¯´try...catchæ˜¯æ²¡æœ‰åŠæ³•æ•è·å¼‚æ­¥é”™è¯¯çš„ï¼Œè€Œyieldæš‚åœä½¿å¾—Generatorèƒ½å¤Ÿæ•è·é”™è¯¯ã€‚ asyncå’Œawaitasyncå‡½æ•°å°±æ˜¯Generatorçš„è¯­æ³•ç³–ã€‚ å½¢å¼ä¸Šçš„ä¸åŒï¼š asyncå‡½æ•°å°†Generatorå‡½æ•°çš„æ˜Ÿå·ï¼ˆ*ï¼‰æ›¿æ¢æˆasync å°†yieldæ›¿æ¢æˆawait å†…ç½®æ‰§è¡Œå™¨ä¹Ÿå°±æ˜¯è¯´asyncå‡½æ•°çš„æ‰§è¡Œï¼Œå’Œæ™®é€šå‡½æ•°ä¸€æ ·ï¼Œåªéœ€è¦ä¸€è¡Œå°±å¯ä»¥ã€‚ä¸ç”¨åƒGeneratorå‡½æ•°éœ€è¦è°ƒç”¨nextæ–¹æ³•æ‰èƒ½çœŸæ­£æ‰§è¡Œã€‚ ä¾‹å¦‚å¯¹äºä¸€ä¸ªasyncå‡½æ•°æ¥è¯´ï¼š 123456const asyncReadFile = async function () &#123; const f1 = await readFile('/etc/fstab'); const f2 = await readFile('/etc/shells'); console.log(f1.toString()); console.log(f2.toString());&#125;; è°ƒç”¨æ—¶åªéœ€è¦ï¼š1asyncReadFile(); æ›´å¥½çš„è¯­ä¹‰asyncå’Œawaitæ¯”èµ·æ˜Ÿå·å’Œyieldï¼Œè¯­ä¹‰æ›´åŠ æ¸…æ¥šäº†ã€‚asyncè¡¨ç¤ºå‡½æ•°é‡Œæœ‰å¼‚æ­¥æ“ä½œï¼Œawaitè¡¨ç¤ºç´§è·Ÿåœ¨åé¢çš„è¡¨è¾¾å¼éœ€è¦ç­‰å¾…ç»“æœã€‚ è¿”å›å€¼æ˜¯Promiseasyncå‡½æ•°çš„è¿”å›å€¼æ˜¯Promiseå¯¹è±¡ï¼Œè¿™æ¯”Generatorå‡½æ•°çš„è¿”å›å€¼æ˜¯Iteratorå¯¹è±¡æ–¹ä¾¿å¤šäº†ã€‚ä½ å¯ä»¥ç”¨thenæ–¹æ³•æŒ‡å®šä¸‹ä¸€æ­¥çš„æ“ä½œã€‚ asyncå‡½æ•°åŸºæœ¬ç”¨æ³•asyncå‡½æ•°è¿”å›ä¸€ä¸ªPromiseå¯¹è±¡ï¼Œå¯ä»¥ä½¿ç”¨thenæ–¹æ³•æ·»åŠ å›è°ƒå‡½æ•°ã€‚å½“å‡½æ•°æ‰§è¡Œçš„æ—¶å€™ï¼Œä¸€æ—¦é‡åˆ°awaitå°±ä¼šå…ˆè¿”å›ï¼Œç­‰åˆ°å¼‚æ­¥æ“ä½œå®Œæˆï¼Œå†æ¥ç€æ‰§è¡Œå‡½æ•°ä½“å†…åé¢çš„è¯­å¥ã€‚ 123456789async function getStockPriceByName(name) &#123; const symbol = await getStockSymbol(name); const stockPrice = await getStockPrice(symbol); return stockPrice;&#125;getStockPriceByName('goog').then(function (result) &#123; console.log(result);&#125;); å…ˆæ‰§è¡Œäº†ç¬¬ä¸€ä¸ªawaitåçš„getStockSymbol(name)å‡½æ•°ï¼›å¾—åˆ°äº†è‚¡ç¥¨çš„åç§°symbolåï¼Œå°†symbolä¼ ç»™ç¬¬äºŒä¸ªawaitåé¢çš„getStockPrice(symbol)ä½œä¸ºå‚æ•°ï¼›æœ€åè¿”å›è‚¡ç¥¨ä»·æ ¼stockPriceã€‚ async/awaité”™è¯¯å¤„ç†ä½¿ç”¨tryå°†awaitè¯­å¥åŒ…å«èµ·æ¥ï¼Œå¦‚æœawaitåçš„è¯­å¥æ‰§è¡Œé”™è¯¯ï¼Œåˆ™é”™è¯¯ä¼šè¢«catchæ•è·ï¼š123456789run();async function run() &#123; try &#123; await Promise.reject(new Error(\"Oops!\")); &#125; catch (error) &#123; error.message; // \"Oops!\" &#125;&#125; 123456789101112run();async function run() &#123; const v = null; try &#123; await Promise.resolve(\"foo\"); v.thisWillThrow; &#125; catch (error) &#123; // \"TypeError: Cannot read property 'thisWillThrow' of null\" error.message; &#125;&#125; æ‰§è¡Œé¡ºåºé—®é¢˜1234567891011121314async function async1()&#123; console.log('async1 start'); await async2(); console.log('async1 end')&#125;async function async2()&#123; console.log('async2')&#125;console.log('script start');async1();console.log('script end')// è¾“å‡ºé¡ºåºï¼šscript start-&gt;async1 start-&gt;async2-&gt;script end-&gt;async1 end å½“asyncå‡½æ•°æ‰§è¡Œçš„æ—¶å€™ï¼Œä¸€æ—¦é‡åˆ°awaitå°±ä¼šå…ˆè¿”å›ï¼Œç­‰åˆ°è§¦å‘çš„å¼‚æ­¥æ“ä½œå®Œæˆåï¼Œå†æ‰§è¡Œå‡½æ•°ä½“åé¢çš„è¯­å¥ã€‚å¯ä»¥ç†è§£ä¸ºï¼Œæ˜¯è®©å‡ºäº†çº¿ç¨‹ï¼Œè·³å‡ºäº†asyncå‡½æ•°ä½“ã€‚ 1234567891011121314151617181920async function async1() &#123; console.log('async1 start'); await async2(); console.log('async1 end');&#125;async function async2() &#123; console.log('async2');&#125;console.log('script start');setTimeout(function() &#123; console.log('setTimeout');&#125;, 0)async1();new Promise(function(resolve) &#123; console.log('promise1'); resolve();&#125;).then(function() &#123; console.log('promise2');&#125;);console.log('script end'); æ‰§è¡Œé¡ºåºä¸ºï¼š æ‰§è¡Œasync1çš„æ—¶å€™é‡åˆ°awaitå…ˆå»æ‰§è¡Œasync2ï¼Œç„¶åè·³å‡ºäº†å‡½æ•°ä½“ï¼Œå»æ‰§è¡Œåç»­çš„ä»£ç ï¼Œç„¶åå†å›åˆ°å½“å‰async1å‡½æ•°å½“ä¸­æ‰§è¡Œawaitåç»­è¯­å¥ã€‚","categories":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://delaprada.com/categories/JavaScript/"}],"tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://delaprada.com/tags/JavaScript/"}]},{"title":"æ•°æ®é‡å¤§å¯¼è‡´ä¼ è¾“é€Ÿåº¦æ…¢è§£å†³æ–¹æ¡ˆâ€”â€”è¯·æ±‚åˆ†ç‰‡","slug":"æ•°æ®é‡å¤§å¯¼è‡´ä¼ è¾“é€Ÿåº¦æ…¢è§£å†³æ–¹æ¡ˆâ€”â€”è¯·æ±‚åˆ†ç‰‡","date":"2021-03-14T00:55:27.000Z","updated":"2021-03-17T02:05:54.000Z","comments":true,"path":"2021/03/14/æ•°æ®é‡å¤§å¯¼è‡´ä¼ è¾“é€Ÿåº¦æ…¢è§£å†³æ–¹æ¡ˆâ€”â€”è¯·æ±‚åˆ†ç‰‡/","link":"","permalink":"http://delaprada.com/2021/03/14/%E6%95%B0%E6%8D%AE%E9%87%8F%E5%A4%A7%E5%AF%BC%E8%87%B4%E4%BC%A0%E8%BE%93%E9%80%9F%E5%BA%A6%E6%85%A2%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%E2%80%94%E2%80%94%E8%AF%B7%E6%B1%82%E5%88%86%E7%89%87/","excerpt":"","text":"å‰è¨€åœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œé‡åˆ°è¦è¯·æ±‚å‡ åƒè¡Œæ•°æ®çš„éœ€æ±‚ï¼Œå› ä¸ºå‰ç«¯éƒ¨åˆ†å·²ç»ä½¿ç”¨äº†VirtualListè™šæ‹Ÿåˆ—è¡¨åªæ¸²æŸ“å½“å‰å¯è§†åŒºåŸŸçš„è§†å›¾ï¼Œéå¯è§†åŒºåŸŸçš„è§†å›¾åœ¨ç”¨æˆ·æ»šåŠ¨åˆ°å¯è§†åŒºåŸŸå†æ¸²æŸ“ï¼šä½†ä»ä¸èƒ½è§£å†³æ•°æ®åŠ è½½ç¼“æ…¢é—®é¢˜ã€‚åŸå› æ˜¯æ•°æ®é‡æœ¬èº«å¤ªå¤§ï¼Œå¯¼è‡´ä¼ è¾“çš„é€Ÿåº¦è¿‡æ…¢ï¼Œæ‰€ä»¥æ¸²æŸ“åˆ°é¡µé¢ä¸Šçš„é€Ÿåº¦ä¹Ÿå¾ˆæ…¢ã€‚ è§£å†³æ–¹æ¡ˆç”¨è¯·æ±‚åˆ†ç‰‡çš„æ–¹å¼ï¼Œå…ˆåŠ è½½å‰50æ¡æ•°æ®ï¼Œç›‘å¬æ»‘åŠ¨åˆ°åº•éƒ¨çš„äº‹ä»¶ï¼Œå½“åˆ—è¡¨ä¸‹æ‹‰åˆ°åº•éƒ¨çš„æ—¶å€™ï¼Œå†å»è¯·æ±‚å50æ¡æ•°æ®ã€‚è¿™ä¹ˆåšæ¯æ¬¡åªè¯·æ±‚50æ¡æ•°æ®ï¼Œä¼ è¾“é€Ÿåº¦å°±ä¼šå¾ˆå¿«ã€‚ å‰ç«¯å…·ä½“å®ç°å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758function PoemList() &#123; ... // è®¾ç½®è¯·æ±‚åç§»é‡ const [offset, setOffset] = useState&lt;number&gt;(0); useEffect(() =&gt; &#123; ... // ç¬¬ä¸€æ¬¡è¯·æ±‚ getPoemList(category, offset) .then((res) =&gt; &#123; setList(res); &#125;) .catch((err) =&gt; &#123; console.error(err); &#125;); &#125; &#125;, []); // ç›‘å¬æ»‘åŠ¨åˆ°åº•éƒ¨çš„äº‹ä»¶ const handleScrollToLower = () =&gt; &#123; console.log('scroll to lower!!'); const curOffset = offset + 1; setOffset(curOffset); // åç»­è¯·æ±‚ï¼Œæ¯æ¬¡è¯·æ±‚50æ¡æ•°æ®ï¼Œè¿™ä¸ª50æ¡æ˜¯åœ¨åç«¯æ ¹æ®offsetæ§åˆ¶çš„ getPoemList(category, curOffset) .then((res) =&gt; &#123; setList(list.concat(res)); &#125;) .catch((err) =&gt; &#123; console.error(err); &#125;); &#125;; ...... return ( &lt;View className=\"poemList-container\"&gt; &lt;View className=\"top\"&gt; &lt;View className=\"title\"&gt;&#123;title&#125;&lt;/View&gt; &lt;View className=\"desc\"&gt;&#123;desc&#125;&lt;/View&gt; &lt;/View&gt; &#123;list.length &gt; 0 &amp;&amp; ( &lt;VirtualList height=&#123;800&#125; /* åˆ—è¡¨çš„é«˜åº¦ */ width=\"100%\" /* åˆ—è¡¨çš„å®½åº¦ */ itemData=&#123;list&#125; /* æ¸²æŸ“åˆ—è¡¨\bçš„æ•°æ® */ itemCount=&#123;list.length&#125; /* æ¸²æŸ“åˆ—è¡¨çš„é•¿åº¦ */ itemSize=&#123;80&#125; /* åˆ—è¡¨å•é¡¹çš„é«˜åº¦ */ onScrollToLower=&#123;handleScrollToLower&#125;&gt; &#123;listItem&#125; &lt;/VirtualList&gt; )&#125; &lt;/View&gt; );&#125;export default React.memo(PoemList); åç«¯å…·ä½“å®ç°ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546const Service = require('egg').Service;class PoemListService extends Service &#123; async getPoemList(category, offset) &#123; const res = await this.findPoemList(category, offset*50); return res; &#125; async findPoemList(category, offset) &#123; const &#123; ctx &#125; = this; // åˆ†ç‰‡è·å–æ•°æ® switch (category) &#123; case 0: &#123; const res = await ctx.model.Poems.findAll(&#123; offset: offset, limit: 50, &#125;); return res; &#125; case 1: &#123; const res = await ctx.model.Poetry.findAll(&#123; offset: offset, limit: 50, &#125;); return res; &#125; case 2: &#123; const res = await ctx.model.Lunyu.findAll(&#123; offset: offset, limit: 50, &#125;); return res; &#125; case 3: &#123; const res = await ctx.model.Shijing.findAll(&#123; offset: offset, limit: 50, &#125;); return res; &#125; &#125; &#125;&#125;module.exports = PoemListService; è¿™é‡Œç”¨åˆ°sequelizeORMã€‚offsetç”¨äºè®¾ç½®å¼€å§‹è¯·æ±‚çš„åç§»é‡ï¼ˆæ¯”å¦‚ï¼Œå¦‚æœoffsetä¸º50ï¼Œè¡¨ç¤ºè·³è¿‡å‰é¢49æ¡æ•°æ®ï¼Œä»ç¬¬50æ¡æ•°æ®å¼€å§‹è·å–ï¼‰ï¼Œlimitè¡¨ç¤ºæ•°é‡ã€‚","categories":[{"name":"å°ç¨‹åº","slug":"å°ç¨‹åº","permalink":"http://delaprada.com/categories/%E5%B0%8F%E7%A8%8B%E5%BA%8F/"}],"tags":[{"name":"å°ç¨‹åº","slug":"å°ç¨‹åº","permalink":"http://delaprada.com/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F/"}]},{"title":"React useEffect Hookçš„å¯¹è±¡ & æ•°ç»„ä¾èµ–","slug":"React-useEffect-Hookçš„å¯¹è±¡-æ•°ç»„ä¾èµ–","date":"2021-03-13T02:21:53.000Z","updated":"2021-03-13T02:23:04.000Z","comments":true,"path":"2021/03/13/React-useEffect-Hookçš„å¯¹è±¡-æ•°ç»„ä¾èµ–/","link":"","permalink":"http://delaprada.com/2021/03/13/React-useEffect-Hook%E7%9A%84%E5%AF%B9%E8%B1%A1-%E6%95%B0%E7%BB%84%E4%BE%9D%E8%B5%96/","excerpt":"","text":"å‰è¨€useEffectå¯ä»¥è¯´æ˜¯ä½¿ç”¨React Hookæ—¶æœ€å¸¸ç”¨çš„hookï¼Œå¯ä»¥ç”¨äºå®ç°ä¸€äº›ç”Ÿå‘½å‘¨æœŸæ“ä½œå’Œå¯¹å˜é‡çš„ç›‘å¬ã€‚ æœ¬æ–‡æ˜¯å¯¹Object &amp; array dependencies in the React useEffect Hookçš„ç¿»è¯‘ï¼Œå¸®åŠ©è‡ªå·±æ›´å¥½åœ°ç†è§£useEffectçš„åŒæ—¶ï¼Œä¹Ÿå¸Œæœ›å¸®åŠ©åˆ°å¤§å®¶ã€‚ useEffectuseEffectåœ¨æ²¡æœ‰è®¾ç½®ç¬¬äºŒä¸ªå‚æ•°çš„æ—¶å€™ï¼Œä¼šåœ¨æ¯æ¬¡æ¸²æŸ“çš„æ—¶å€™æ‰§è¡Œå…¶å›è°ƒï¼š 1234567891011121314const Example = () =&gt; &#123; const [count, setCount] = useState(0) useEffect(() =&gt; &#123; document.title = `You clicked $&#123;count&#125; times` &#125;) return ( &lt;div&gt; &lt;p&gt;You clicked &#123;count&#125; times&lt;/p&gt; &lt;button onClick=&#123;() =&gt; setCount(count + 1)&#125;&gt;Click me&lt;/button&gt; &lt;/div&gt; )&#125; ç„¶è€Œï¼Œæˆ‘ä»¬ä¸€èˆ¬å¾ˆå°‘è¿™ä¹ˆç”¨ï¼Œå› ä¸ºé€šå¸¸æˆ‘ä»¬å¹¶ä¸éœ€è¦åœ¨æ¯æ¬¡æ¸²æŸ“çš„æ—¶å€™éƒ½æ‰§è¡Œå›è°ƒï¼Œè¿™æ ·ä¼šæ‰§è¡Œä¸å¿…è¦æ¬¡æ•°å¯¼è‡´æ€§èƒ½ä¸‹é™ã€‚ useEffectæœ‰ç¬¬äºŒä¸ªå‚æ•°ï¼Œç§°ä¸ºä¾èµ–æ•°ç»„ï¼Œåªæœ‰å½“ä¾èµ–æ•°ç»„å†…çš„å…ƒç´ å‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼Œæ‰ä¼šæ‰§è¡ŒuseEffectçš„å›è°ƒã€‚è¿™ä¹ˆåšå°±èƒ½å¤Ÿä¼˜åŒ–effectæ‰§è¡Œçš„æ¬¡æ•°ã€‚1234567891011121314const Example = () =&gt; &#123; const [count, setCount] = useState(0) useEffect(() =&gt; &#123; document.title = `You clicked $&#123;count&#125; times` &#125;, [count]) // Only re-run the effect if count changes return ( &lt;div&gt; &lt;p&gt;You clicked &#123;count&#125; times&lt;/p&gt; &lt;button onClick=&#123;() =&gt; setCount(count + 1)&#125;&gt;Click me&lt;/button&gt; &lt;/div&gt; )&#125;è¿™ç§åšæ³•åœ¨æ•°ç»„å…ƒç´ ç±»å‹ä¸ºåŸºæœ¬æ•°æ®ç±»å‹æ—¶å¯ä»¥èµ·åˆ°ä½œç”¨ã€‚ä½†å¯¹äºå¤æ‚æ•°æ®ç±»å‹å¦‚ï¼šå¯¹è±¡ï¼Œæ•°ç»„å’Œå‡½æ•°æ¥è¯´ï¼ŒReactä¼šä½¿ç”¨referential equalityæ¥å¯¹æ¯”å‰åæ˜¯å¦æœ‰ä¸åŒã€‚ Reactä¼šæ£€æŸ¥å½“å‰æ¸²æŸ“ä¸‹çš„è¿™ä¸ªå¯¹è±¡å’Œä¸Šä¸€æ¬¡æ¸²æŸ“ä¸‹çš„å¯¹è±¡çš„å†…å­˜åœ°å€æ˜¯å¦ä¸€è‡´ã€‚ä¸¤ä¸ªå¯¹è±¡å¿…é¡»æ˜¯åŒä¸€ä¸ªå¯¹è±¡useEffectæ‰ä¼šè·³è¿‡æ‰§è¡Œeffectã€‚æ‰€ä»¥ï¼Œå³ä½¿å†…å®¹å®Œå…¨ç›¸åŒï¼Œå†…å­˜åœ°å€ä¸åŒçš„è¯ï¼ŒuseEffectè¿˜æ˜¯ä¼šæ‰§è¡Œeffectã€‚ Option 1 - ä¾èµ–äºå¯¹è±¡å±æ€§åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå½“å‰ç»„ä»¶ä¼šä»propsè·å–ä¸€ä¸ªå¯¹è±¡ï¼Œå¹¶åœ¨useEffectçš„ä¾èµ–æ•°ç»„ä¸­ä½¿ç”¨è¿™ä¸ªå¯¹è±¡ï¼š123456789101112131415import React, &#123; useState, useEffect &#125; from 'react'import &#123; getPlayers &#125; from '../api'import Players from '../components/Players'const Team = (&#123; team &#125;) =&gt; &#123; const [players, setPlayers] = useState([]) useEffect(() =&gt; &#123; if (team.active) &#123; getPlayers(team.id).then(setPlayers) &#125; &#125;, [team]) return &lt;Players team=&#123;team&#125; players=&#123;players&#125; /&gt;&#125;ç†æƒ³æƒ…å†µä¸‹ï¼Œpropsä¼ å…¥çš„teamçš„å†…å®¹æ˜¯ä¸€æ ·çš„è¯ï¼Œå…¶å†…å­˜åœ°å€ä¹Ÿä¼šç›¸åŒã€‚ä½†è¿™å…¶å®æ˜¯æ— æ³•ä¿è¯çš„ã€‚ æ‰€ä»¥ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥åªä½¿ç”¨teamå¯¹è±¡é‡Œçš„ä¸€äº›å±æ€§ï¼Œè€Œä¸æ˜¯ä½¿ç”¨æ•´ä¸ªå¯¹è±¡ã€‚123456789101112131415import React, &#123; useState, useEffect &#125; from 'react'import &#123; getPlayers &#125; from '../api'import Players from '../components/Players'const Team = (&#123; team &#125;) =&gt; &#123; const [players, setPlayers] = useState([]) useEffect(() =&gt; &#123; if (team.active) &#123; getPlayers(team.id).then(setPlayers) &#125; &#125;, [team.id, team.active]) return &lt;Players team=&#123;team&#125; players=&#123;players&#125; /&gt;&#125;å‡è®¾teamå¯¹è±¡ä¸­çš„idå’Œactiveå±æ€§éƒ½æ˜¯åŸºæœ¬æ•°æ®ç±»å‹ï¼Œeffectå°±åªä¼šåœ¨idæˆ–è€…activeå±æ€§å‘ç”Ÿå˜åŒ–çš„æ—¶å€™æ‰§è¡Œï¼ˆæ³¨æ„æ˜¯æˆ–ï¼Œä¸æ˜¯ä¸”ï¼‰ã€‚ teamå¯¹è±¡å¦‚æœæ˜¯åœ¨ç»„ä»¶å†…è¢«åˆ›å»ºçš„è¯ä¹Ÿèƒ½å¤Ÿèµ·åˆ°ä½œç”¨ï¼š1234567891011121314151617import React, &#123; useState, useEffect &#125; from 'react'import &#123; getPlayers &#125; from '../api'import Players from '../components/Players'const Team = (&#123; id, name, active &#125;) =&gt; &#123; // construct the object from props and/or state const team = &#123; id, name, active &#125; const [players, setPlayers] = useState([]) useEffect(() =&gt; &#123; if (team.active) &#123; getPlayers(team.id).then(setPlayers) &#125; &#125;, [team.id, team.active]) return &lt;Players team=&#123;team&#125; players=&#123;players&#125; /&gt;&#125;æ‰€ä»¥ï¼Œå³ä½¿teamå¯¹è±¡åœ¨æ¯æ¬¡æ¸²æŸ“è¿‡ç¨‹ä¸­éƒ½é‡æ–°è¢«åˆ›å»ºï¼Œä¹Ÿä¸ä¼šå¯¼è‡´effectæ¯æ¬¡æ¸²æŸ“éƒ½ä¼šæ‰§è¡Œï¼Œå› ä¸ºuseEffectåªä¾èµ–äºidå’Œactiveå±æ€§ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸ªæ–¹æ¡ˆä¸é€‚ç”¨äºä¾èµ–å…ƒç´ ä¸ºæ•°ç»„çš„æƒ…å†µã€‚ Option2 - åœ¨å†…éƒ¨åˆ›å»ºå¯¹è±¡åœ¨ä¸Šä¸€ä¸ªä¾‹å­ä¸­ï¼Œå¦‚æœeffectä¸æ˜¯ä½¿ç”¨å¯¹è±¡é‡Œçš„å…ƒç´ ï¼Œè€Œæ˜¯ä»¥æ•´ä¸ªå¯¹è±¡ä½œä¸ºä¾èµ–ä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿ1234567891011121314151617import React, &#123; useState, useEffect &#125; from 'react'import &#123; getPlayers &#125; from '../api'import Players from '../components/Players'const Team = (&#123; id, name, active &#125;) =&gt; &#123; // construct the object from props/state const team = &#123; id, name, active &#125; const [players, setPlayers] = useState([]) useEffect(() =&gt; &#123; if (team.active) &#123; getPlayers(team).then(setPlayers) &#125; &#125;, [team]) return &lt;Players team=&#123;team&#125; players=&#123;players&#125; /&gt;&#125;teamå¯¹è±¡æ˜¯åœ¨æ¯æ¬¡æ¸²æŸ“ä¸‹é‡æ–°åˆ›å»ºçš„ï¼Œæ‰€ä»¥useEffectåœ¨æ¯æ¬¡é‡æ–°æ¸²æŸ“æ—¶éƒ½ä¼šæ‰§è¡Œã€‚ å¹¸è¿çš„æ˜¯ï¼Œreact-hooks/exhaustive-depsESLint ruleæç¤ºé“ï¼š123The &#39;team&#39; object makes the dependencies of useEffect Hookchange on every render. To fix this, wrap the initializationof &#39;team&#39; in its own useMemo() Hook. åœ¨æˆ‘ä»¬ä½¿ç”¨ESLintæ¨èçš„ä½¿ç”¨useMemo Hookä¹‹å‰ï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•æ›´åŠ ç®€å•çš„æ“ä½œã€‚æˆ‘ä»¬å¯ä»¥å°è¯•ä¸¤æ¬¡åˆ›å»ºteamå¯¹è±¡ï¼Œä¸€ä¸ªç”¨äºä¼ é€’ç»™Playerå­ç»„ä»¶ï¼Œä¸€ä¸ªç”¨äºuseEffectå†…éƒ¨ã€‚123456789101112131415161718192021import React, &#123; useState, useEffect &#125; from 'react'import &#123; getPlayers &#125; from '../api'import Players from '../components/Players'const Team = (&#123; id, name, active &#125;) =&gt; &#123; const [players, setPlayers] = useState([]) useEffect(() =&gt; &#123; // recreate the `team` object within `useEffect` // from props/state const team = &#123; id, name, active &#125; if (team.active) &#123; getPlayers(team).then(setPlayers) &#125; &#125;, [id, name, active]) const team = &#123; id, name, active &#125; return &lt;Players team=&#123;team&#125; players=&#123;players&#125; /&gt;&#125;ç°åœ¨teamå¯¹è±¡æ˜¯åœ¨useEffectå†…éƒ¨è¢«åˆ›å»ºï¼Œå¹¶ä¸”åªåœ¨effectè¦è¢«æ‰§è¡Œçš„æ—¶å€™è¢«åˆ›å»ºã€‚idã€nameã€activeä½œä¸ºä¾èµ–ï¼Œåªæœ‰å½“è¿™äº›å€¼å‘ç”Ÿå˜åŒ–çš„æ—¶å€™effectæ‰ä¼šæ‰§è¡Œã€‚ åˆ›å»ºå¯¹è±¡ç›¸å¯¹æ¥è¯´å¼€é”€æ˜¯æ¯”è¾ƒå°çš„ï¼Œæ‰€ä»¥åœ¨useEffectä¸­é‡æ–°åˆ›å»ºä¸€ä¸ªteamå¯¹è±¡æ˜¯å¯ä»¥æ¥å—çš„ã€‚ä¼˜åŒ–useEffectæ‰€å¸¦æ¥çš„æ€§èƒ½æå‡è¿œè¿œå¤§äºåˆ›å»ºä¸¤ä¸ªå¯¹è±¡æ‰€å¸¦æ¥çš„æ€§èƒ½æŸè€—ã€‚ Option3 - è®°å¿†å¯¹è±¡ç„¶è€Œï¼Œå¦‚æœåˆ›å»ºå¯¹è±¡æˆ–æ•°ç»„çš„å¼€é”€æ˜¯æ˜‚è´µçš„ï¼Œé‚£é‡å¤åˆ›å»ºå¯¹è±¡å°±ä¼šæ¯”æ‰§è¡Œå¤šæ¬¡effectæ›´ç³Ÿç³•ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éœ€è¦â€œç¼“å­˜â€åˆ›å»ºçš„å¯¹è±¡æˆ–æ•°ç»„ï¼Œè¿™æ ·å½“å…¶ä¸­çš„æ•°æ®æ²¡æœ‰å‘ç”Ÿå˜åŒ–æ—¶ï¼Œè¿™ä¸ªå¯¹è±¡æˆ–æ•°ç»„å°±ä¸ä¼šåœ¨æ¸²æŸ“è¿‡ç¨‹ä¸­å‘ç”Ÿå˜åŒ–ã€‚è¿™ä¸ªè¿‡ç¨‹ç§°ä¸ºâ€œè®°å¿†â€ï¼ˆmemoizationï¼‰ï¼Œæˆ‘ä»¬é€šè¿‡useMemoæ¥å®ç°ã€‚1234567891011121314151617181920212223import React, &#123; useState, useEffect, useMemo &#125; from 'react'import &#123; createTeam &#125; from '../utils'import &#123; getPlayers &#125; from '../api'import Players from '../components/Players'const Team = (&#123; id, name, active &#125;) =&gt; &#123; // memoize calling `createTeam` because it's // an expensive operation const team = useMemo(() =&gt; createTeam(&#123; id, name, active &#125;), [ id, name, active, ]) const [players, setPlayers] = useState([]) useEffect(() =&gt; &#123; if (team.active) &#123; getPlayers(team).then(setPlayers) &#125; &#125;, [team]) return &lt;Players team=&#123;team&#125; players=&#123;players&#125; /&gt;&#125;å‡è®¾è¿™ä¸ªcreateTeam()æ–¹æ³•å¼€é”€æ˜‚è´µï¼Œé‚£æˆ‘ä»¬è‡ªç„¶ä¼šå¸Œæœ›å®ƒæ‰§è¡Œçš„æ¬¡æ•°è¶Šå°‘è¶Šå¥½ã€‚useMemo Hookå¯ä»¥å®ç°åªæœ‰åœ¨idã€nameæˆ–è€…activeåœ¨æ¸²æŸ“è¿‡ç¨‹ä¸­å‘ç”Ÿå˜åŒ–æ—¶ï¼Œæ‰ä¼šå†æ¬¡åˆ›å»ºteamã€‚ä½†å¦‚æœåœ¨Teamç»„ä»¶é‡æ–°æ¸²æŸ“è¿‡ç¨‹ä¸­ï¼Œä»¥ä¸Šå±æ€§æ²¡æœ‰ä¸€ä¸ªå‘ç”Ÿå˜åŒ–ï¼Œteamå¯¹è±¡å°±ä¼šæ˜¯åŒä¸€ä¸ªå¯¹è±¡ã€‚å› ä¸ºæ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ”¾å¿ƒåœ°ä½¿ç”¨useEffectï¼Œä¸ç”¨æ‹…å¿ƒä¼šæ‰§è¡Œä¸å¿…è¦çš„æ¬¡æ•°ã€‚ Option 4 - è‡ªå·±åˆ›å»ºå¦‚æœä»¥ä¸Šæ–¹æ¡ˆéƒ½æ— æ³•è§£å†³é—®é¢˜æ€ä¹ˆåŠï¼Ÿæ¯”å¦‚ä»propsä¸­ä¼ å…¥äº†å¯¹è±¡æˆ–è€…æ•°ç»„ï¼Œè¿™ä¸ªå¯¹è±¡æˆ–æ•°ç»„ä¼šæˆä¸ºuseEffectçš„ä¾èµ–æ•°ç»„å…ƒç´ ï¼Œè€Œä¸”æˆ‘ä»¬å¹¶ä¸çŸ¥é“åˆ›å»ºä¸€ä¸ªæ–°çš„teamå¯¹è±¡æ‰€éœ€çš„å±æ€§ã€‚ä½†æˆ‘ä»¬è¿˜æ˜¯æƒ³è¦å®ç°åœ¨ç»„ä»¶æ¸²æŸ“è¿‡ç¨‹ä¸­â€œç¼“å­˜â€è¿™ä¸ªå¯¹è±¡çš„å€¼ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨useRef Hookæ›¿ä»£useMemo Hookã€‚123456789101112131415161718192021import React, &#123; useState, useEffect, useRef &#125; from 'react'import isDeepEqual from 'fast-deep-equal/react'import &#123; getPlayers &#125; from '../api'import Players from '../components/Players'const Team = (&#123; team &#125;) =&gt; &#123; const [players, setPlayers] = useState([]) const teamRef = useRef(team) if (!isDeepEqual(teamRef.current, team)) &#123; teamRef.current = team &#125; useEffect(() =&gt; &#123; if (team.active) &#123; getPlayers(team).then(setPlayers) &#125; &#125;, [teamRef.current]) return &lt;Players team=&#123;team&#125; players=&#123;players&#125; /&gt;&#125;è¿™é‡Œä½¿ç”¨äº†isDeepEqualæ¥åˆ¤æ–­teamRef.currentå’Œteamçš„å€¼æ˜¯å¦ä¸€è‡´ï¼Œè€Œä¸æ˜¯æ¯”è¾ƒä¸¤è€…çš„å†…å­˜åœ°å€ã€‚æ‰€ä»¥ï¼Œå³ä½¿åœ¨æ¯æ¬¡æ¸²æŸ“è¿‡ç¨‹ä¸­teamå¯¹è±¡æ˜¯ä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œå¦‚æœå®ƒçš„å†…å®¹æ˜¯ä¸€è‡´çš„ï¼ŒisDeepEqual()ä¹Ÿä¼šè¿”å›trueã€‚ æ‰€ä»¥å½“ä¸¤è€…åœ¨åšæ·±æ¯”è¾ƒçš„æ—¶å€™ï¼Œå¦‚æœå†…å®¹ä¸€è‡´ï¼ŒisDeepEqualä¼šè¿”å›trueï¼ŒteamRef.currentä¼šç»§ç»­æŒ‡å‘åŸæœ¬teamå¯¹è±¡çš„å†…å­˜åœ°å€ã€‚é‚£ä¾èµ–æ•°ç»„é‡Œçš„å…ƒç´ teamRef.currentå°±æ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼ŒuseEffectä¹Ÿä¸ä¼šå†æ‰§è¡Œã€‚å¦‚æœisDeepEqualè¿”å›falseï¼ŒteamRef.currentå°±ä¼šè¢«èµ‹äºˆæ–°çš„teamå€¼ï¼Œeffectå°±ä¼šæ‰§è¡Œã€‚ å¦‚æœä½ å‘ç°è‡ªå·±é‡åˆ°äº†Option4è¿™æ ·çš„æƒ…å†µï¼Œæˆ‘å»ºè®®å®‰è£…react-usenpmåŒ…ï¼Œä½¿ç”¨å…¶ä¸­çš„useDeepCompareEffect Hookæ¥è§£å†³é—®é¢˜ï¼Œè¿˜èƒ½å¤Ÿé¿å…react-hooks/exhaustive-depslint ruleæŠ¥é”™ã€‚ æ€»ç»“å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘èƒ½ç”¨Option1æ¥è§£å†³é—®é¢˜ã€‚å¦‚æœOption1æ— æ³•è§£å†³ï¼Œæˆ‘å°±ä¼šä½¿ç”¨react-useåŒ…é‡Œçš„helper Hookæ¥è§£å†³é—®é¢˜ã€‚","categories":[{"name":"React","slug":"React","permalink":"http://delaprada.com/categories/React/"}],"tags":[{"name":"React","slug":"React","permalink":"http://delaprada.com/tags/React/"}]},{"title":"å°ç¨‹åºå½•éŸ³åŠŸèƒ½å®ç°","slug":"å°ç¨‹åºå½•éŸ³åŠŸèƒ½å®ç°","date":"2021-03-07T02:01:15.000Z","updated":"2021-03-07T02:02:30.000Z","comments":true,"path":"2021/03/07/å°ç¨‹åºå½•éŸ³åŠŸèƒ½å®ç°/","link":"","permalink":"http://delaprada.com/2021/03/07/%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%BD%95%E9%9F%B3%E5%8A%9F%E8%83%BD%E5%AE%9E%E7%8E%B0/","excerpt":"","text":"å‰è¨€åœ¨å¼€å‘å°ç¨‹åºè¿‡ç¨‹ä¸­ï¼Œæœ‰ä¸€ä¸ªå®ç°å½•éŸ³åŠŸèƒ½å¹¶æ’­æ”¾å½•éŸ³ï¼Œå°†å½•éŸ³ä¸Šä¼ è‡³æœåŠ¡å™¨çš„éœ€æ±‚ã€‚å¼€å‘è¿‡ç¨‹ä¸­ä½¿ç”¨äº†Taroæ¡†æ¶ï¼Œå½•éŸ³åŠŸèƒ½é€šè¿‡Taro.getRecorderManager()æ¥å£å®ç°ï¼Œä¸Šä¼ å½•éŸ³è‡³æœåŠ¡å™¨é€šè¿‡Taro.uploadFileæ¥å£å®ç°ï¼Œæ’­æ”¾å½•éŸ³ä½¿ç”¨Taro.createInnerAudioContext()æ¥å£å®ç°ã€‚ä¸‹é¢å°±è¯¦ç»†ä»‹ç»æ•´ä¸ªæµç¨‹æ˜¯å¦‚ä½•å®ç°çš„ã€‚ å°ç¨‹åºå½•éŸ³é¦–å…ˆè·å–å½•éŸ³ç®¡ç†å™¨æ¨¡å—ï¼š1const recorderManager = Taro.getRecorderManager(); åœ¨ç»„ä»¶æŒ‚è½½å®Œæ¯•æ—¶æ³¨å†Œå½•éŸ³ç›‘å¬äº‹ä»¶ï¼š1234567891011121314151617181920212223242526272829303132333435useEffect(() =&gt; &#123; // ç›‘å¬å½•éŸ³å¼€å§‹ recorderManager.onStart(() =&gt; &#123; console.log('å¼€å§‹å½•éŸ³'); &#125;); // ç›‘å¬å½•éŸ³æš‚åœ recorderManager.onPause(() =&gt; &#123; console.log('æš‚åœå½•éŸ³'); &#125;); // ç›‘å¬å½•éŸ³ç»§ç»­ recorderManager.onResume(() =&gt; &#123; console.log('ç»§ç»­å½•éŸ³'); &#125;); // ç›‘å¬å½•éŸ³åœæ­¢ recorderManager.onStop((res) =&gt; &#123; if (res.duration &lt; 1000) &#123; Taro.showToast(&#123; title: 'å½•éŸ³æ—¶é—´å¤ªçŸ­', duration: 1000, icon: 'none', &#125;); &#125; else &#123; console.log('åœæ­¢å½•éŸ³'); fileUpload(res.tempFilePath); &#125; &#125;); recorderManager.onError(() =&gt; &#123; Taro.showToast(&#123; title: 'å½•éŸ³å¤±è´¥ï¼', duration: 1000, icon: 'none', &#125;); &#125;); &#125;, []);åœ¨å½•éŸ³onStopçš„å›è°ƒå‡½æ•°ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è·å–åˆ°å½•éŸ³çš„ä¸´æ—¶åœ°å€res.tempFilePathï¼Œä½†è¿™ä¸ªåœ°å€æ˜¯æœ‰æœ‰æ•ˆæœŸé™çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å°†è¿™ä¸ªå½•éŸ³ä¸Šä¼ è‡³æœåŠ¡å™¨åå°ï¼Œè¿›è¡Œä¿å­˜ï¼Œåç»­æ‰èƒ½æ­£å¸¸ä½¿ç”¨ã€‚ onStopå›è°ƒå‡½æ•°ä¸­æˆ‘ä»¬è°ƒç”¨äº†fileUploadå‡½æ•°å®ç°æ–‡ä»¶ä¸Šä¼ ï¼ŒfileUploadå‡½æ•°çš„å®ç°å¦‚ä¸‹ï¼š1234567891011121314151617181920212223242526const fileUpload = (tempFilePath) =&gt; &#123; Taro.uploadFile(&#123; url: 'http://127.0.0.1:7001/record', // æœåŠ¡å™¨åœ°å€ filePath: tempFilePath, name: 'file', // è¿™ä¸ªéšä¾¿å¡« header: &#123; 'content-type': 'multipart/form-data', // æ ¼å¼å¿…é¡»æ˜¯è¿™ä¸ª Authorization: Taro.getStorageSync('token'), &#125;, // formDataç”¨äºä¼ è¾“é™¤æ–‡ä»¶ä»¥å¤–çš„ä¸€äº›ä¿¡æ¯ formData: &#123; record_name: 'æœ—è¯µä½œå“', poem_id: poemInfo.id, category: poemInfo.category, &#125;, success: (res) =&gt; &#123; console.log(res); const url = res.data; playAudio(url); // æ’­æ”¾å½•éŸ³ &#125;, fail: (error) =&gt; &#123; console.log('failed!'); console.error(error); &#125;, &#125;); &#125;;éœ€è¦æ³¨æ„çš„ç‚¹æ˜¯ï¼šheaderä¸­çš„content-typeå¿…é¡»æ˜¯multipart/form-dataã€‚ å½•éŸ³äº‹ä»¶çš„å¤„ç†ç¬¬ä¸€æ¬¡ç‚¹å‡»handleClickå°±ä¼šè§¦å‘å¼€å§‹å½•éŸ³ï¼Œä¹‹åä¼šé€šè¿‡å½“å‰çŠ¶æ€åˆ¤æ–­æ˜¯æš‚åœå½•éŸ³è¿˜æ˜¯ç»§ç»­å½•éŸ³ã€‚handleCompleteç”¨äºåœæ­¢å½•éŸ³ã€‚12345678910111213141516171819202122232425262728293031323334const handleClick = () =&gt; &#123; const curPause = pause; setPause(!curPause); if (firstRecord) &#123; setfirstRecord(false); recorderManager.start(&#123; duration: 60000, sampleRate: 44100, numberOfChannels: 1, encodeBitRate: 192000, format: 'mp3', frameSize: 50, &#125;); Taro.showToast(&#123; title: 'å¼€å§‹å½•éŸ³', duration: 1000, icon: 'none', &#125;); &#125; else &#123; if (curPause) &#123; recorderManager.pause(); // æš‚åœå½•éŸ³ &#125; else &#123; recorderManager.resume(); // ç»§ç»­å½•éŸ³ &#125; &#125; &#125;; const handleComplete = () =&gt; &#123; recorderManager.stop(); // åœæ­¢å½•éŸ³ &#125;; åå°å®ç°å½•éŸ³å­˜å‚¨å¹¶è¿”å›å½•éŸ³åœ°å€ç½‘ä¸Šå¤§å¤šæ•°åšå®¢éƒ½æ²¡æœ‰æ¶‰åŠè¿™å—å†…å®¹ï¼Œä¸‹é¢å°±ä»‹ç»ä¸€ä¸‹å¦‚ä½•å®ç°ï¼Œåå°æ¡†æ¶æˆ‘ç”¨çš„æ˜¯é˜¿é‡Œçš„egg.jsã€‚ æ–‡ä»¶ä¸Šä¼ éœ€è¦é…ç½®çš„ä¸œè¥¿å¯è§å®˜æ–¹æ–‡æ¡£ï¼šegg.jsæ–‡ä»¶ä¸Šä¼ ã€‚æˆ‘ä»¬è¿™é‡Œä½¿ç”¨å®ƒçš„ç¬¬ä¸€ç§Fileæ¨¡å¼æ¥å®ç°ã€‚ å› ä¸ºegg.jsæ¡†æ¶å†…ç½®äº†Multipartæ’ä»¶ï¼Œå¯ä»¥è§£æä¸Šä¼ çš„multipart/form-dataç±»å‹çš„æ•°æ®ã€‚ é¦–å…ˆï¼Œç°åœ¨é…ç½®æ–‡ä»¶config.default.jsä¸­å†™å…¥multiparté…ç½®ï¼š12345678910111213141516module.exports = (app) =&gt; &#123; const config = (exports = &#123;&#125;); ... config.multipart = &#123; mode: 'file', fileSize: '50mb', &#125; ... return &#123; ...config, ...userConfig, &#125;;&#125;; ç„¶åï¼Œåœ¨router.jsä¸­å®šä¹‰è·¯ç”±ï¼š12// æäº¤å½•éŸ³router.post('/record', auth, controller.record.postRecord); åœ¨controllerç›®å½•ä¸‹å®šä¹‰record.jsæ–‡ä»¶å†™å…¥å¦‚ä¸‹å†…å®¹ï¼š123456789101112131415const Controller = require('egg').Controller;class RecordController extends Controller &#123; async postRecord() &#123; const &#123; ctx &#125; = this; const file = ctx.request.files[0]; const &#123; record_name, poem_id, category &#125; = ctx.request.body; const res = await ctx.service.record.postRecord(file, record_name, poem_id, category); ctx.body = res; &#125;&#125;module.exports = RecordController; åœ¨serviceç›®å½•ä¸‹å®šä¹‰record.jså†™å…¥å…·ä½“å®ç°ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253const Service = require('egg').Service;let OSS = require('ali-oss');let aliInfo = &#123; // https://help.aliyun.com/document_detail/31837.html region: 'oss-cn-guangzhou', bucket: 'poem-mini-program', accessKeyId: 'xxx', // å¡«å…¥é˜¿é‡Œäº‘çš„accessKeyId accessKeySecret: 'xxx', // å¡«å…¥é˜¿é‡Œäº‘çš„accessKeySecret&#125;;let client = new OSS(aliInfo);class RecordService extends Service &#123; async postRecord(file, record_name, poem_id, category) &#123; const url = await this.uploadOSS(file); await this.updateRecord(url, record_name, poem_id, category); return url; &#125; async uploadOSS(file) &#123; const &#123; ctx &#125; = this; let result; try &#123; // å¤„ç†æ–‡ä»¶ï¼Œæ¯”å¦‚ä¸Šä¼ åˆ°äº‘ç«¯ result = await client.put(file.filename, file.filepath); &#125; finally &#123; // éœ€è¦åˆ é™¤ä¸´æ—¶æ–‡ä»¶ await ctx.cleanupRequestFiles(); &#125; return result.url; &#125; async updateRecord(url, record_name, poem_id, category) &#123; const &#123; ctx &#125; = this; console.log('ä»ctx.localsä¸­å–openid'); console.log(ctx.locals.openid); const openid = ctx.locals.openid; // å°†ç”¨æˆ·ä¿¡æ¯è®°å½•åˆ°æ•°æ®åº“ä¸­ const res = await ctx.model.Record.create(&#123; record_name: record_name, record_url: url, poem_id: poem_id, category: category, openid: openid, &#125;); &#125;&#125;module.exports = RecordService;è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼š éœ€è¦æ³¨å†Œé˜¿é‡Œäº‘è´¦å·ï¼Œå¹¶åœ¨å¯¹è±¡å­˜å‚¨é‚£é‡Œæ–°å»ºä¸€ä¸ªå­˜å‚¨æ¡¶ç”¨äºå­˜æ”¾éŸ³é¢‘ï¼Œä¹Ÿå°±æ˜¯äº‘å­˜å‚¨çš„å®ç°ã€‚ éœ€è¦å®‰è£…ali-ossnpmåŒ…ï¼Œç”¨äºè¿æ¥é˜¿é‡Œäº‘å¯¹è±¡å­˜å‚¨ã€‚åœ¨åå°æ¥æ”¶åˆ°å‰ç«¯ä¸Šä¼ çš„ä¸´æ—¶æ–‡ä»¶åï¼Œå°±ä¼šå°†éŸ³é¢‘ä¸Šä¼ è‡³é˜¿é‡Œäº‘å¯¹è±¡å­˜å‚¨ä¸­ï¼ˆclient.putï¼‰ã€‚ æ’­æ”¾å½•éŸ³ç»†å¿ƒçš„å°ä¼™ä¼´å¯ä»¥æ³¨æ„åˆ°åœ¨ä½¿ç”¨Taro.uploadFileæ¥å£ä¸Šä¼ å½•éŸ³åï¼Œåœ¨successå›è°ƒä¸­è°ƒç”¨äº†playAudioå‡½æ•°ç”¨äºæ’­æ”¾éŸ³é¢‘ï¼Œæ¥ä¸‹æ¥è®²ä¸€ä¸‹æ’­æ”¾éŸ³é¢‘æ˜¯å¦‚ä½•å®ç°çš„ã€‚ é¦–å…ˆï¼Œä½¿ç”¨Taro.createInnerAudioContextè·å–audioçš„ä¸Šä¸‹æ–‡å¯¹è±¡ï¼š1const innerAudioText = Taro.createInnerAudioContext(); å’Œå½•éŸ³ä¸€æ ·ï¼Œåœ¨ç»„ä»¶æŒ‚è½½å®Œæˆæ—¶ï¼Œæ³¨å†Œç›‘å¬äº‹ä»¶ï¼š12345678910useEffect(() =&gt; &#123; innerAudioText.onPlay(() =&gt; &#123; console.log('å¼€å§‹æ’­æ”¾'); &#125;); innerAudioText.onError((e) =&gt; &#123; console.log('æ’­æ”¾å¼‚å¸¸'); console.log(e); &#125;); &#125;, []); åœ¨å½•éŸ³æ–‡ä»¶ä¸Šä¼ æˆåŠŸåï¼Œè°ƒç”¨playAudioæ–¹æ³•ç”¨äºæ’­æ”¾å½•éŸ³ï¼š1234const playAudio = (url) =&gt; &#123; innerAudioText.autoplay = true; innerAudioText.src = url;&#125;;åœ¨srcè¢«èµ‹äºˆå€¼çš„æ—¶å€™ï¼Œå½•éŸ³å°±ä¼šå¼€å§‹æ’­æ”¾ã€‚ æ€»ç»“ä»¥ä¸Šå°±æ˜¯æ•´ä¸ªå½•éŸ³åŠŸèƒ½å’Œå½•éŸ³æ’­æ”¾åŠŸèƒ½å®ç°çš„æ•´ä¸ªæµç¨‹ï¼Œå¦‚æœ‰ç–‘é—®æ¬¢è¿å¤§å®¶ä¸€èµ·äº¤æµã€‚","categories":[{"name":"å°ç¨‹åº","slug":"å°ç¨‹åº","permalink":"http://delaprada.com/categories/%E5%B0%8F%E7%A8%8B%E5%BA%8F/"}],"tags":[{"name":"å°ç¨‹åº","slug":"å°ç¨‹åº","permalink":"http://delaprada.com/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F/"}]},{"title":"äº‘æœåŠ¡å™¨éƒ¨ç½²node.js eggé¡¹ç›®","slug":"äº‘æœåŠ¡å™¨éƒ¨ç½²node-js-eggé¡¹ç›®","date":"2021-02-21T12:43:07.000Z","updated":"2021-03-13T03:22:12.000Z","comments":true,"path":"2021/02/21/äº‘æœåŠ¡å™¨éƒ¨ç½²node-js-eggé¡¹ç›®/","link":"","permalink":"http://delaprada.com/2021/02/21/%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2node-js-egg%E9%A1%B9%E7%9B%AE/","excerpt":"","text":"æœ€è¿‘åœ¨åšæ¯•ä¸šè®¾è®¡ï¼Œç”¨egg+mysql+sequelize+taroå†™ä¸€ä¸ªå°ç¨‹åºï¼Œå› ä¸ºæ²¡æœ‰ç”¨åˆ°å¾®ä¿¡çš„äº‘å¼€å‘ï¼Œæ˜¯è‡ªå·±æ­å»ºçš„åå°ï¼Œæ‰€ä»¥éœ€è¦å°†åå°é¡¹ç›®éƒ¨ç½²åˆ°äº‘æœåŠ¡å™¨ä¸Šã€‚æ•´ä¸ªè¿‡ç¨‹è¸©äº†ä¸å°‘å‘ï¼Œäºæ˜¯æƒ³å†™ä¸ªæµç¨‹ä»¥é˜²å¿˜è®°ã€‚ äº‘æœåŠ¡å™¨å‡†å¤‡è´­ä¹°äº‘æœåŠ¡å™¨å¯åœ¨è…¾è®¯äº‘è´­ä¹°è½»é‡åº”ç”¨æœåŠ¡å™¨ï¼Œå­¦ç”Ÿçš„è¯å¯ä»¥è´­ä¹°æ ¡å›­äº‘æœåŠ¡å™¨ï¼Œè§„æ ¼æ˜¯cpu1æ ¸ï¼Œå†…å­˜2GBï¼Œç³»ç»Ÿç›˜40GBï¼Œå¯¹äºæˆ‘çš„é¡¹ç›®æ¥è¯´åº”è¯¥å¤Ÿç”¨äº†ï¼šè…¾è®¯äº‘æ ¡å›­äº‘æœåŠ¡å™¨ æ³¨å†ŒåŸŸåå¾®ä¿¡å°ç¨‹åºå®˜æ–¹æ–‡æ¡£ä¸­è¡¨æ˜ï¼ŒæœåŠ¡å™¨åŸŸååªæ”¯æŒhttpsï¼Œä¸”ä¸èƒ½ä½¿ç”¨ipåœ°å€ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ³¨å†ŒåŸŸåã€‚ åŸŸåè´­ä¹°å®Œæˆåï¼Œéœ€è¦å®åè®¤è¯ï¼Œå®åè®¤è¯å®Œæˆåæ‰èƒ½è¿›è¡Œä¸‹ä¸€æ­¥è§£æã€‚ ä¸å’Œipé…å¥—ä½¿ç”¨çš„åŸŸåæ˜¯æ²¡æœ‰ä»»ä½•æ„ä¹‰çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å°†åŸŸåç»‘å®šåˆ°æˆ‘ä»¬éœ€è¦å¯¹å¤–æä¾›æœåŠ¡çš„æœåŠ¡å™¨ipä¸Šã€‚å› æ­¤æˆ‘ä»¬ç‚¹å‡»åŸŸåçš„è§£ææ“ä½œï¼Œæ·»åŠ è§£æåˆ°ä½ ä¹‹å‰è´­ä¹°çš„æœåŠ¡å™¨çš„ipä¸Šï¼š å¯ä»¥åˆ°è½»é‡äº‘æœåŠ¡å™¨æ§åˆ¶å°æŸ¥çœ‹ä¹‹å‰è´­ä¹°çš„äº‘æœåŠ¡å™¨çš„å…¬ç½‘ipï¼š ç”³è¯·SSLè¯ä¹¦ä¸Šé¢æåˆ°ï¼Œå¾®ä¿¡å°ç¨‹åºå®˜æ–¹è§„å®šåŸŸåå¿…é¡»æ˜¯httpsï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ç”³è¯·sslè¯ä¹¦ï¼Œè…¾è®¯äº‘å¯ä»¥å…è´¹ç”³è¯·sslè¯ä¹¦ï¼Œè¯ä¹¦ä¹Ÿè¦æ·»åŠ åˆ°åŸŸåè§£æè®°å½•ä¸­ï¼šè¯ä¹¦ç”³è¯·æˆåŠŸåå…ˆä¸‹è½½ä¸‹æ¥ï¼Œä»¥å¤‡åç»­ä½¿ç”¨ï¼šè¯ä¹¦ä¸‹è½½ä¸‹æ¥åä¼šæœ‰å¤šç§ï¼Œæˆ‘ä»¬åç»­ä¼šä½¿ç”¨åˆ°nginxçš„è¯ä¹¦ã€‚ ä»¥ä¸Šå°±å®Œæˆå¥½äº‘æœåŠ¡å™¨çš„å‡†å¤‡å·¥ä½œäº†ã€‚ äº‘æœåŠ¡å™¨ç¯å¢ƒéƒ¨ç½²æ ¹æ®é¡¹ç›®éœ€æ±‚ï¼Œæˆ‘ä»¬è¦åœ¨äº‘æœåŠ¡å™¨ä¸Šå®‰è£…nodeã€MySQLã€nginxã€‚ è¿æ¥è¿œç¨‹æœåŠ¡å™¨ è¿æ¥è¿œç¨‹æœåŠ¡å™¨çš„æ„ä¹‰åœ¨äºï¼Œæˆ‘ä»¬èƒ½å¤Ÿåœ¨æœ¬åœ°å¯¹è¿œç¨‹æœåŠ¡å™¨è¿›è¡Œæ“ä½œï¼Œæ¯”å¦‚æ–‡ä»¶ä¸Šä¼ ã€å®‰è£…åŒ…ã€‚è¿™é‡Œæˆ‘ä»¬éœ€è¦å®‰è£…ä¸¤ä¸ªåº”ç”¨ï¼šXShellå’ŒXftpï¼ŒXShellä¸€èˆ¬ç”¨äºå¯¹è¿œç¨‹æœåŠ¡å™¨è¿›è¡Œæ“ä½œï¼ŒXftpä¸€èˆ¬ç”¨äºæ–‡ä»¶ä¸Šä¼ ã€‚ XShellå’ŒXftpå®‰è£…é…ç½®å‚è€ƒåšå®¢ï¼šæ–°æ‰‹æ­å»ºäº‘æœåŠ¡å™¨è¯¦ç»†è¿‡ç¨‹ å®‰è£…å¥½ä»¥ä¸Šä¸¤ä¸ªåº”ç”¨åå°±å¯ä»¥å¼€å§‹ç¯å¢ƒéƒ¨ç½²äº†ã€‚ ç¯å¢ƒéƒ¨ç½²ä»¥ä¸‹æ­¥éª¤å‡åœ¨XShellä¸­æ‰§è¡Œã€‚ nodeå®‰è£…12345678910111ã€ä¸‹è½½nodeäºŒè¿›åˆ¶å®‰è£…åŒ… wget https://nodejs.org/dist/v10.13.0/node-v10.13.0-linux-x64.tar.xz2ã€è§£å‹ tar xvf node-v10.13.0-linux-x64.tar.xz3ã€åˆ›å»ºè½¯é“¾æ¥ï¼Œä½¿nodeå’Œnpmå…¨å±€æœ‰æ•ˆ ln -s /root/node-v10.13.0-linux-x64/bin/node /usr/local/bin/node ln -s /root/node-v10.13.0-linux-x64/bin/npm /usr/local/bin/npm4ã€æŸ¥çœ‹nodeå’Œnpmç‰ˆæœ¬ï¼Œå¦‚æœæ˜¾ç¤ºç‰ˆæœ¬å·ï¼Œè¯´æ˜å®‰è£…æˆåŠŸ node -v npm -v5ã€è½¯ä»¶é»˜è®¤å®‰è£…åœ¨/root/node-v10.13.0-linux-x64/ç›®å½•ä¸‹ æŒ‰ç…§è¿™ä¸ªæ­¥éª¤nodeå¯ä»¥æˆåŠŸï¼Œä½†npmä¼šå‡ºç°é—®é¢˜ï¼Œå› æ­¤åç»­æˆ‘æ”¹ç”¨nvmå®‰è£…nodeã€‚ å®‰è£…nvmï¼š 123curl -o- https://raw.githubusercontent.com/creationix/nvm/v0.33.9/install.sh | bashæˆ–è€…wget -qO- https://raw.githubusercontent.com/creationix/nvm/v0.33.9/install.sh | bash å®‰è£…nodeï¼Œæ³¨æ„ï¼šå¦‚æœä½ å·²ç»å®‰è£…äº†nodeï¼Œä¸ç”¨å¸è½½æ—§çš„ï¼Œç›´æ¥å®‰è£…å°±å¥½ï¼Œnvmä¼šæ›¿ä½ ç®¡ç†ç‰ˆæœ¬çš„ï¼š 1nvm install node æ­¤æ—¶å†è¾“å…¥node -vå’Œnpm -véƒ½æ˜¾ç¤ºå¯¹åº”ç‰ˆæœ¬ï¼Œè¡¨æ˜å®‰è£…æˆåŠŸã€‚ MySQLå®‰è£…å®‰è£…yum repoç”±äºCentOSçš„yumæºä¸­æ²¡æœ‰MySQLï¼Œéœ€è¦åˆ°MySQLçš„å®˜ç½‘ä¸‹è½½yum repoé…ç½®æ–‡ä»¶ã€‚æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š 1wget https://dev.mysql.com/get/mysql57-community-release-el7-9.noarch.rpm ç„¶åè¿›è¡Œrepoçš„å®‰è£…ï¼š 1rpm -ivh mysql57-community-release-el7-9.noarch.rpm æ‰§è¡Œå®Œæˆåä¼šåœ¨/etc/yum.repos.d/ç›®å½•ä¸‹ç”Ÿæˆä¸¤ä¸ªrepoæ–‡ä»¶mysql-community.repo mysql-community-source.repoã€‚ ä½¿ç”¨yumå‘½ä»¤å®ŒæˆMySQLå®‰è£…å¿…é¡»è¿›å…¥/etc/yum.repos.d/ç›®å½•åå†æ‰§è¡Œä»¥ä¸‹è„šæœ¬ã€‚ å®‰è£…å‘½ä»¤ï¼šyum install mysql-server å¯åŠ¨MySQLï¼šsystemctl start mysqld è·å–å®‰è£…æ—¶çš„ä¸´æ—¶å¯†ç ï¼ˆåœ¨ç¬¬ä¸€æ¬¡ç™»é™†æ—¶å°±æ˜¯ç”¨è¿™ä¸ªå¯†ç ï¼‰ï¼šgrep &#39;temporary password&#39; /var/log/mysqld.log ç™»é™†æ‰§è¡Œmysql -u root -pæŒ‡ä»¤ï¼Œç„¶åè¾“å…¥å¯†ç ï¼ˆåˆšåˆšè·å–çš„ä¸´æ—¶å¯†ç ï¼‰ã€‚ ç™»é™†æˆåŠŸåä¿®æ”¹å¯†ç ä¿®æ”¹å¯†ç æ—¶ï¼ŒMySQLä¼šè¿›è¡Œå¯†ç å¼ºåº¦æ ¡éªŒï¼Œä¸æ»¡è¶³æ ¡éªŒæ—¶ä¼šæŠ¥å¼‚å¸¸ï¼š 1ERROR 1819 (HY000): Your password does not satisfy the current policy requirements ä½†æˆ‘ä»¬é€šå¸¸æƒ³è®¾ç½®æ›´ä¸ºç®€å•çš„å¯†ç ï¼Œè¿™é‡Œéœ€è¦æ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š 123set global validate_password_policy=0; set global validate_password_length=4; ALTER USER 'root'@'localhost' IDENTIFIED BY '123456'; è¿™æ ·æˆ‘ä»¬å°±å°†MySQLçš„å¯†ç æ”¹ä¸ºç®€å•çš„123456äº†ã€‚ ä»¥ä¸Šå°±å®Œæˆå¥½MySQLçš„å®‰è£…ã€‚ æ•°æ®å¯¼å…¥å› ä¸ºä¹‹å‰æ˜¯åœ¨æœ¬åœ°è¿›è¡Œå‰åç«¯è”è°ƒï¼Œæ•°æ®éƒ½å­˜å‚¨åœ¨æœ¬åœ°çš„æ•°æ®åº“ä¸­ï¼Œæ‰€ä»¥éœ€è¦å°†æœ¬åœ°çš„æ•°æ®å¯¼å…¥äº‘æœåŠ¡å™¨çš„æ•°æ®åº“ä¸­ã€‚ step1ï¼šå°†æœ¬åœ°æ•°æ®åº“ä¿¡æ¯å¯¼å‡ºä¸º.sqlæ–‡ä»¶ã€‚cmdè¿›å…¥ç»ˆç«¯ï¼Œæ‰§è¡Œä»¥ä¸‹æŒ‡ä»¤ï¼š 1mysqldump -u root -p miniprogram &gt; C:\\Users\\alice\\miniprogram.sql æˆ‘çš„æ•°æ®åº“åç§°ä¸ºminiprogramï¼Œå¯¼å‡ºçš„.sqlæ–‡ä»¶çš„åç§°ä¹Ÿè¦å«miniprogramï¼Œå¯¼å‡ºåˆ°ä¸€ä¸ªä½ å¯ä»¥æ‰¾åˆ°çš„ä½ç½®ã€‚ step2ï¼šåœ¨äº‘æœåŠ¡å™¨ä¸­ä¹Ÿåˆ›å»ºä¸€ä¸ªåå­—ç›¸åŒçš„æ•°æ®åº“ã€‚åœ¨XShellä¸­è¾“å…¥mysql -u root -pè¾“å…¥å¯†ç ç™»å½•è¿›å»ã€‚æ–°å»ºä¸€ä¸ªå’Œæ–‡ä»¶ç›¸åŒåç§°çš„æ•°æ®åº“ï¼ˆè¾“å…¥sqlè¯­å¥æ—¶ä¸è¦æ¼äº†åˆ†å·ï¼‰ï¼š 1create database miniprogram; è¿›å…¥æ•°æ®åº“ï¼š 1use miniprogram; è®¾ç½®æ•°æ®åº“ç¼–ç ï¼š 1set names utf8; step3ï¼šå°†miniprogram.sqlæ–‡ä»¶é€šè¿‡Xftpä¸Šä¼ åˆ°äº‘æœåŠ¡å™¨ä¸Šã€‚æˆ‘æ˜¯ç°åœ¨rootæ–‡ä»¶å¤¹ä¸‹æ–°å»ºuseræ–‡ä»¶å¤¹ï¼Œå¹¶å°†.sqlæ–‡ä»¶ä¼ è¾“è¿‡å»ï¼š step4ï¼šç¬¬äºŒæ­¥å·²ç»ç™»å½•æ•°æ®åº“ï¼Œæ­¤å¤„åªéœ€æ‰§è¡Œï¼š 1source /root/user/miniprogram.sql; å³å¯å¯¼å…¥æˆåŠŸã€‚ å¯ä»¥åç»­è¿›å…¥æ•°æ®åº“æŸ¥çœ‹æ˜¯å¦æœ‰å¯¹åº”çš„è¡¨åˆ¤æ–­æ˜¯å¦å¯¼å…¥æˆåŠŸï¼ˆæŒ‡ä»¤ï¼šshow databases;ã€use miniprogram;ï¼‰ã€‚ nginxå®‰è£…æ‰§è¡Œå‘½ä»¤ï¼š 1yum -y install nginx å®‰è£…å®Œåè¾“å…¥nginx -vï¼Œè‹¥æ˜¾ç¤ºnginxç‰ˆæœ¬å·åˆ™è¡¨ç¤ºå®‰è£…æˆåŠŸã€‚ ä¸Šä¼ SSLè¯ä¹¦åœ¨æœåŠ¡å™¨æ–°å»ºç›®å½•: /data/release/nginxï¼ˆ/dataæ–‡ä»¶æœ¬èº«å­˜åœ¨ï¼Œåªéœ€åœ¨é‡Œé¢æ–°å»ºreleaseæ–‡ä»¶å¤¹å’Œnginxæ–‡ä»¶å¤¹å³å¯ï¼‰ ä½¿ç”¨xftpå°†è¯ä¹¦ä¸Šä¼ åˆ°è¯¥æ–‡ä»¶å¤¹ä¸‹ï¼š ä¸Šä¼ ååœ¨æœåŠ¡å™¨ä¸ŠæŸ¥è¯¢ï¼š ä¸Šä¼ å®Œè¯ä¹¦åå°±å¯ä»¥å¼€å§‹é…ç½®nginxã€‚è¿›å…¥æœåŠ¡å™¨çš„/etc/nginx/conf.dç›®å½•ï¼Œæ–°å»ºä¸€ä¸ªweapp.confæ–‡ä»¶ï¼Œå°†æ–‡ä»¶æ‹·è´åˆ°æœ¬åœ°ï¼Œæ‰“å¼€ç¼–è¾‘ï¼Œå†™å…¥å¦‚ä¸‹é…ç½®ï¼š 1234567891011121314151617181920212223242526272829303132333435upstream app_weapp &#123; server localhost:7001; // ä½ çš„é¡¹ç›®æœåŠ¡ç«¯å¯åŠ¨çš„åœ°å€ keepalive 8;&#125; server &#123; listen 80; server_name www.miniprogram.ltd; // ä½ çš„åŸŸå rewrite ^(.*)$ https://$server_name$1 permanent;&#125; server &#123; listen 443; server_name www.miniprogram.ltd; // ä½ çš„åŸŸå ssl on; ssl_certificate /data/release/nginx/1_miniprogram.ltd_bundle.crt; //ä½ çš„è¯ä¹¦ ssl_certificate_key /data/release/nginx/2_miniprogram.ltd.key; // ä½ çš„è¯ä¹¦ ssl_session_timeout 5m; ssl_protocols TLSv1 TLSv1.1 TLSv1.2; ssl_ciphers ECDHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA256:ECDHE-RSA-AES256-SHA:ECDHE-RSA-AES128-SHA:DHE-RSA-AES256-SHA:DHE-RSA-AES128-SHA; ssl_session_cache shared:SSL:50m; ssl_prefer_server_ciphers on; location / &#123; proxy_pass http://app_weapp; proxy_http_version 1.1; proxy_set_header Upgrade $http_upgrade; proxy_set_header Connection 'upgrade'; proxy_set_header Host $host; proxy_cache_bypass $http_upgrade; &#125;&#125; nginxé…ç½®çš„upstreamä¸»è¦æ˜¯å®ç°è´Ÿè½½å‡è¡¡çš„æ•ˆæœã€‚ç®€å•æ¥è¯´å°±æ˜¯ï¼šupstreamæŒ‰ç…§è½®è¯¢ï¼ˆé»˜è®¤ï¼‰æ–¹å¼è¿›è¡Œè´Ÿè½½ï¼Œæ¯ä¸ªè¯·æ±‚æŒ‰æ—¶é—´é¡ºåºé€ä¸€åˆ†é…åˆ°ä¸åŒçš„åç«¯æœåŠ¡å™¨ï¼Œå¦‚æœåç«¯æœåŠ¡å™¨downæ‰ï¼Œèƒ½è‡ªåŠ¨å‰”é™¤ã€‚æ‰€ä»¥å®é™…ä¸Šä½ å‘åŸŸåå‘èµ·è¯·æ±‚ï¼Œæ˜¯ä¼šè¢«è½¬å‘åˆ°äº‘æœåŠ¡å™¨çš„åç«¯æœåŠ¡å™¨ä¸Šçš„ã€‚è¯¦æƒ…å¯å‚è€ƒåšå®¢ï¼šnginxä½¿ç”¨upstreamå®ç°è´Ÿè½½å‡è¡¡ã€‚ ä¿®æ”¹å¥½åå°†è¯¥æ–‡ä»¶ä¸Šä¼ è‡³/etc/nginx/conf.dç›®å½•ä¸‹ï¼Œç„¶åå†XShellä¸­è¾“å…¥nginx -tï¼Œå¦‚æ˜¾ç¤ºä»¥ä¸‹ä¿¡æ¯ï¼Œåˆ™é…ç½®æˆåŠŸï¼š é…ç½®æˆåŠŸåï¼Œè¾“å…¥nginxå›è½¦ï¼Œå³å¯å¯åŠ¨nginxã€‚æ­¤æ—¶é€šè¿‡é…ç½®çš„åŸŸåè®¿é—®æœåŠ¡å™¨ï¼ˆhttp://www.miniprogram.ltdï¼‰ï¼Œä¼šæ˜¾ç¤ºNginxè¯¦æƒ…é¡µã€‚ å¦‚æœè®¿é—® http://ä½ çš„åŸŸå/weapp/a ä¼šè‡ªåŠ¨è·³è½¬åˆ° HTTPS ä¸Šï¼Œå¹¶æ˜¾ç¤º 502 Bad Gatewayï¼Œåˆ™è¡¨ç¤ºé…ç½®æˆåŠŸï¼š å¦‚æœä¸Šä¼ çš„weapp.confæ–‡ä»¶å‘ç”Ÿäº†ä¿®æ”¹ï¼Œéœ€è¦é‡å¯nginxï¼šnginx -s reloadã€‚ å¦‚æœå‡ºç°nginx: [emerg] bind() to [::]:80 failed (98: Address already in use)çš„æŠ¥é”™ï¼Œå¯ä»¥æ‰§è¡Œnetstat -ntplæŒ‡ä»¤æŸ¥çœ‹è¿›ç¨‹ï¼Œå°†å ç”¨80ç«¯å£çš„è¿›ç¨‹killæ‰ï¼Œæˆ–æ‰§è¡Œfuser -n tcp 80ç›´æ¥æŸ¥çœ‹å ç”¨80ç«¯å£çš„è¿›ç¨‹æœ‰å“ªäº›ï¼Œä¾æ¬¡killæ‰å³å¯ã€‚ è‡³æ­¤äº‘æœåŠ¡å™¨çš„ç¯å¢ƒå·²ç»å®Œå…¨æ­å»ºå¥½äº†ã€‚ å°†æœåŠ¡ç«¯é¡¹ç›®ä¸Šä¼ è‡³äº‘æœåŠ¡å™¨åœ¨æœåŠ¡å™¨ç«¯åˆ›å»ºç›®å½•/data/release/weappï¼ˆå’Œä¸Šé¢å­˜æ”¾nginxè¯ä¹¦åŒç›®å½•ï¼‰ï¼Œå°†æœåŠ¡ç«¯ä»£ç é€šè¿‡xftpä¼ è¾“åˆ°äº‘æœåŠ¡å™¨ä¸Šï¼ˆè®°å¾—ä¸è¦ä¼ node_modulesï¼‰ï¼š æ³¨æ„æœåŠ¡ç«¯æ•°æ®åº“é¡¹ç›®çš„é…ç½®éƒ¨åˆ†ï¼Œé¡¹ç›®ä¸­ç”¨åˆ°sequelizeæ„å»ºæ•°æ®åº“ï¼Œéœ€å°†é…ç½®çš„ç”¨æˆ·åå’Œå¯†ç æ”¹ä¸ºäº‘æœåŠ¡å™¨ç«¯MySQLçš„ç”¨æˆ·åå’Œå¯†ç ï¼š ä¸Šä¼ å®Œåï¼Œæ‰§è¡Œä»¥ä¸‹æŒ‡ä»¤å°†npmæºåˆ‡æ¢åˆ°æ·˜å®é•œåƒï¼š 1npm config set registry https://registry.npm.taobao.org å®‰è£…å…¨å±€ä¾èµ–ï¼š 1npm install --production å¯åŠ¨æœåŠ¡ç«¯ï¼š 1npm start æœåŠ¡ç«¯é¡¹ç›®å¯åŠ¨æˆåŠŸã€‚ äº‘æœåŠ¡å™¨é˜²ç«å¢™å¼€æ”¾7001ç«¯å£æ­¤æ­¥éª¤å¾ˆå…³é”®ï¼Œå¦åˆ™æ— æ³•è®¿é—®æœåŠ¡ç«¯æ¥å£ã€‚åœ¨è…¾è®¯äº‘è½»é‡äº‘æœåŠ¡å™¨é˜²ç«å¢™å¤„æ·»åŠ è§„åˆ™ï¼Œå¼€æ”¾7001ç«¯å£ï¼š å› ä¸ºç›®å‰åŸŸåè¿˜æœªå¤‡æ¡ˆæˆåŠŸï¼Œæ‰€ä»¥ä¸èƒ½é€šè¿‡åŸŸåè¿›è¡Œè®¿é—®ã€‚æ­¤æ—¶åªéœ€å¯åŠ¨mysqlå’ŒæœåŠ¡ç«¯é¡¹ç›®ï¼Œä¸éœ€è¦å¯åŠ¨nginxæ¥æµ‹è¯•æœåŠ¡ç«¯æ¥å£ï¼š åŸŸåå¤‡æ¡ˆå› ä¸ºå¾®ä¿¡å°ç¨‹åºå®˜æ–¹æ–‡æ¡£ä¸­è¡¨æ˜ï¼ŒæœåŠ¡å™¨åŸŸååªæ”¯æŒhttpsï¼Œä¸”ä¸èƒ½ä½¿ç”¨ipåœ°å€ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ³¨å†ŒåŸŸåçš„åŒæ—¶ï¼Œè¿˜éœ€è¦è¿›è¡ŒåŸŸåå¤‡æ¡ˆï¼Œè¿™æ ·æ‰èƒ½æ­£å¸¸è®¿é—®æœåŠ¡ç«¯çš„æ¥å£ã€‚åŸŸåå¤‡æ¡ˆæµç¨‹å¤§æ¦‚æ˜¯åå¤šå¤©å·¦å³ï¼Œåœ¨æ­¤æœŸé—´éœ€è¦å°†åŸŸåè§£ææš‚åœã€‚æˆ‘æ˜¯åœ¨è…¾è®¯äº‘ä¸Šè¿›è¡Œå¤‡æ¡ˆçš„ï¼Œè¿˜æŒºé¡ºåˆ©ã€‚ å¤‡æ¡ˆå®Œæˆåï¼Œè¿›å…¥äº‘æœåŠ¡å™¨ï¼Œå¯åŠ¨MySQLã€nginxã€é¡¹ç›®ï¼Œç„¶åå°±å¯ä»¥é¡ºåˆ©è®¿é—®äº†ï¼š æœ‰å‡ ç‚¹éœ€è¦æ³¨æ„ï¼š æ­¤æ—¶ä¸éœ€è¦åƒç”¨ipè®¿é—®åå°ä¸€æ ·è¾“å…¥ç«¯å£å·äº†ï¼ŒåŸŸåå‰æ˜¯httpæˆ–httpså‡å¯ï¼Œå› ä¸ºnginxä¼šå°†httpé‡å®šå‘ä¸ºhttps åç»­è¸©å‘éƒ¨åˆ†æ¥å£æ— æ³•è®¿é—®åœ¨è®¿é—®æ¥å£è¿‡ç¨‹ä¸­å‘ç°ï¼Œæœ‰äº›æ¥å£èƒ½å¤Ÿæ­£å¸¸è®¿é—®ï¼Œæœ‰äº›æ¥å£å´ä¸èƒ½ï¼Œå¯¼è‡´æˆ‘ä¸€åº¦æ€€ç–‘æ˜¯ä¸æ˜¯eggçš„é—®é¢˜ã€‚ åæ¥å‘ç°æ˜¯è¿œç¨‹æ•°æ®åº“çš„æ•°æ®æ²¡æœ‰æ›´æ–°ï¼å½“æˆ‘ä»¬åœ¨æœ¬åœ°å¼€å‘çš„æ—¶å€™ï¼Œé€šå¸¸æ˜¯è¿æ¥æœ¬åœ°çš„æ•°æ®åº“ï¼Œä½†æ˜¯æˆ‘ä»¬å‘åå°è¯·æ±‚æ•°æ®æ—¶ï¼Œåå°æ˜¯åœ¨äº‘æœåŠ¡å™¨ä¸Šçš„ï¼Œå®ƒè¯·æ±‚çš„æ˜¯äº‘æœåŠ¡å™¨ä¸Šçš„MySQLæ•°æ®åº“ã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦å†ä¸€æ¬¡å°†æœ¬åœ°æ•°æ®åº“å¯¼å‡ºæˆsqlæ–‡ä»¶ï¼Œå¯¼å…¥äº‘æœåŠ¡å™¨çš„æ•°æ®åº“ä¸­ã€‚ eggé¡¹ç›®æ›´æ–°åä¹Ÿè¦é‡æ–°ä¸Šä¼ è‡³äº‘æœåŠ¡å™¨ã€‚ debeaverè¿æ¥è¿œç¨‹æ•°æ®åº“æŠ¥é”™å¦‚æœæ¯æ¬¡æ•°æ®æœ‰å˜æ›´éƒ½è¦å°†æœ¬åœ°æ•°æ®åº“çš„sqlå¯¼å‡ºå†å¯¼å…¥è¿œç¨‹æ•°æ®åº“ï¼Œå°±ååˆ†éº»çƒ¦ï¼Œä½†ç›´æ¥åœ¨XShellä¸­æ“ä½œè¿œç¨‹æ•°æ®åº“ï¼Œåœ¨éå¯è§†åŒ–çš„ç•Œé¢è¾“å…¥å„ç§æ•°æ®åº“æ“ä½œæ‰§è¡Œä¹Ÿååˆ†ç¹çï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨debeaverè¿æ¥è¿œç¨‹æ•°æ®åº“ï¼ˆdebeaveræ—¢å¯ä»¥è¿æ¥æœ¬åœ°æ•°æ®åº“ä¹Ÿå¯ä»¥è¿æ¥è¿œç¨‹æ•°æ®åº“è¿›è¡Œæ“ä½œï¼‰ã€‚ ä½†æ˜¯æŒ‰ç…§æœ¬åœ°æ•°æ®åº“çš„é“¾æ¥æ–¹å¼æ¥è¿æ¥è¿œç¨‹æ•°æ®åº“æ—¶ï¼Œä¼šå‡ºç°ä»¥ä¸‹æŠ¥é”™ï¼š 1message from server: &quot;Host &#39;221.4.34.96&#39; is not allowed to connect to this MySQL server&quot; è¿™æ˜¯æƒé™é—®é¢˜å¯¼è‡´çš„ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è¿œç¨‹æ•°æ®åº“ä¸­ä¿®æ”¹å¯¹Host &#39;221.4.34.96&#39;çš„æƒé™æ¥è§£å†³ï¼š å°†å…¶ä¸­çš„123.123.123.123æ”¹ä¸ºä½ çš„debeaveripï¼š221.4.34.96ã€‚ åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­å¯èƒ½æ¶‰åŠå¯†ç ä¸ç¬¦åˆè¦æ±‚çš„é—®é¢˜ï¼Œå¯ä»¥ä¿®æ”¹å¯†ç å¼ºåº¦ï¼š 12&#x2F;&#x2F; æŸ¥çœ‹å½“å‰å®‰å…¨å˜é‡å€¼mysql&gt; SHOW VARIABLES LIKE &#39;validate_password%&#39;; 123&#x2F;&#x2F; è®¾ç½®set global validate_password_policy&#x3D;0;set global validate_password_length&#x3D;4; è¿™æ ·å°±èƒ½å¤Ÿå°†123456ä½œä¸ºä½ çš„å¯†ç ã€‚","categories":[{"name":"å°ç¨‹åº","slug":"å°ç¨‹åº","permalink":"http://delaprada.com/categories/%E5%B0%8F%E7%A8%8B%E5%BA%8F/"}],"tags":[{"name":"å°ç¨‹åº","slug":"å°ç¨‹åº","permalink":"http://delaprada.com/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F/"}]},{"title":"æ•°æ®åº“å­¦ä¹ åŠæ¢ç´¢ä¹‹æ—…","slug":"æ•°æ®åº“å­¦ä¹ åŠæ¢ç´¢ä¹‹æ—…","date":"2021-02-02T11:51:48.000Z","updated":"2021-02-03T06:42:02.000Z","comments":true,"path":"2021/02/02/æ•°æ®åº“å­¦ä¹ åŠæ¢ç´¢ä¹‹æ—…/","link":"","permalink":"http://delaprada.com/2021/02/02/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AD%A6%E4%B9%A0%E5%8F%8A%E6%8E%A2%E7%B4%A2%E4%B9%8B%E6%97%85/","excerpt":"","text":"å‰è¨€ä½œä¸ºä¸€åå¼€å‘äººå‘˜ï¼Œä¸å¯é¿å…ä¼šæ¥è§¦åˆ°æ•°æ®åº“ã€‚è™½ç„¶å¤§äºŒçš„æ—¶å€™æœ‰å­¦è¿‡æ•°æ®åº“è¿™é—¨è¯¾ï¼Œä½†ç»ˆç©¶æ˜¯â€œçº¸ä¸Šå¾—æ¥ç»ˆè§‰æµ…â€ï¼Œæ²¡æœ‰åœ¨å®é™…é¡¹ç›®ä¸­è¿ç”¨ï¼Œä¸€åˆ‡éƒ½åªæ˜¯â€œç©ºä¸­æ¥¼é˜â€ã€‚è¶è¿™æ¬¡åšæ¯•è®¾ï¼Œæœ‰æœºä¼šæ¯”è¾ƒç³»ç»Ÿåœ°æ¢³ç†æ•°æ®åº“ç›¸å…³çš„çŸ¥è¯†ï¼Œä¸ºè‡ªå·±çš„é¡¹ç›®è®¾è®¡æ•°æ®åº“ï¼Œä¹Ÿæ˜¯ä¸€æ¬¡æ”¶è·é¢‡ä¸°çš„ç»å†ã€‚ ä»€ä¹ˆæ˜¯æ•°æ®åº“ç³»ç»Ÿæ•°æ®åº“æ˜¯â€œæŒ‰ç…§æ•°æ®ç»“æ„æ¥ç»„ç»‡ã€å­˜å‚¨å’Œç®¡ç†æ•°æ®çš„ä»“åº“â€ã€‚æ˜¯ä¸€ä¸ªé•¿æœŸå­˜å‚¨åœ¨è®¡ç®—æœºå†…çš„ã€æœ‰ç»„ç»‡çš„ã€å¯å…±äº«çš„ã€ç»Ÿä¸€ç®¡ç†çš„ å¤§é‡æ•°æ®çš„é›†åˆã€‚ æ•°æ®åº“ç³»ç»Ÿçš„ä¸»è¦ç›®æ ‡ï¼Œæ˜¯ç»™ç”¨æˆ·æä¾›ä¸€ç§ä¾¿æ·é«˜æ•ˆçš„æ–¹å¼å»å­˜å‚¨å’Œè·å–ä¿¡æ¯ã€‚ å…³ç³»å‹æ•°æ®åº“å’Œéå…³ç³»å‹æ•°æ®åº“å…³ç³»å‹æ•°æ®åº“å’Œéå…³ç³»å‹æ•°æ®åº“åœ¨ä½¿ç”¨åœºæ™¯ä¸Šå·®åˆ«æ¯”è¾ƒå¤§ï¼Œæ‰€ä»¥å¹¶ä¸å­˜åœ¨å­°å¼ºå­°å¼±ï¼Œåªæœ‰ç»“åˆè‡ªèº«çš„ä¸šåŠ¡ç‰¹ç‚¹æ‰èƒ½å‘æŒ¥å‡ºè¿™ä¸¤ç±»æ•°æ®åº“çš„ä¼˜åŠ¿ã€‚ æ•°æ®å­˜å‚¨ç»“æ„ å…³ç³»å‹æ•°æ®åº“ä¸€èˆ¬æœ‰å›ºå®šçš„è¡¨ç»“æ„ï¼Œå¹¶ä¸”éœ€è¦é€šè¿‡DDLï¼ˆData Definition Languageï¼‰è¯­å¥æ¥ä¿®æ”¹è¡¨ç»“æ„ï¼Œä¸å®¹æ˜“è¿›è¡Œæ‰©å±•ï¼Œè€Œéå…³ç³»å‹æ•°æ®åº“çš„å­˜å‚¨æœºåˆ¶å°±æœ‰å¾ˆå¤šï¼Œæ¯”å¦‚åŸºäºæ–‡æ¡£ï¼ŒK-Vé”®å€¼å¯¹ï¼Œè¿˜æœ‰åŸºäºå›¾ç­‰ï¼Œå¯¹äºæ•°æ®çš„æ ¼å¼ååˆ†çµæ´»æ²¡æœ‰å›ºå®šçš„è¡¨ç»“æ„ï¼Œæ–¹ä¾¿æ‰©å±•ã€‚å› æ­¤ï¼Œå¦‚æœä¸šåŠ¡çš„æ•°æ®ç»“æ„å¹¶ä¸æ˜¯å›ºå®šçš„æˆ–è€…ç»å¸¸å˜åŠ¨æ¯”è¾ƒå¤§çš„ï¼Œé‚£ä¹ˆéå…³ç³»å‹æ•°æ®åº“æ˜¯ä¸ªå¥½çš„é€‰æ‹©ã€‚ å¯æ‰©å±•æ€§ ä¼ ç»Ÿçš„å…³ç³»å‹æ•°æ®åº“ç»™äººä¸€ç§æ¨ªå‘æ‰©å±•éš¾ï¼Œä¸å¥½å¯¹æ•°æ®è¿›è¡Œåˆ†ç‰‡ç­‰å°è±¡ï¼Œè€Œä¸€äº›éå…³ç³»å‹æ•°æ®åº“åˆ™åŸç”Ÿå°±æ”¯æŒæ•°æ®çš„æ°´å¹³æ‰©å±•ï¼ˆæ¯”å¦‚mongodbçš„shardingæœºåˆ¶ï¼‰ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œéå…³ç³»å‹æ•°æ®åº“ä¸æ˜¯æŒ‡æ²¡æœ‰å…³ç³»çš„æ•°æ®åº“ï¼Œéå…³ç³»å‹æ•°æ®åº“çš„è‹±æ–‡ä¸ºNot Only SQLï¼Œè¯‘ä¸ºä¸ä»…ä»…æ˜¯SQLæˆ–è®¸æ›´ä¸ºæ°å½“ã€‚NoSQLç›¸å¯¹SQLæ¥è¯´ï¼Œå…³è”æ€§ç›¸å¯¹æ›´è‡ªç”±ï¼Œé™åˆ¶æ›´å°‘ï¼Œé˜‰å‰²äº†SQLçš„ç‰¹æ€§ï¼Œæ‰€ä»¥å®ƒçš„æ€§èƒ½ä¼šæ›´å¥½ï¼Œé€Ÿåº¦ä¹Ÿæ›´å¿«ä¸€äº›ã€‚ä½†åœ¨ä¸€äº›å¯¹æ•°æ®å®‰å…¨ç¨³å®šè¦æ±‚æ›´é«˜çš„åœºæ™¯ä¸‹ï¼ŒSQLæ›´ä¸ºé€‚ç”¨ã€‚ å¯¹äºè¿™ä¸¤ç±»æ•°æ®åº“ï¼Œå¯¹æ–¹çš„ä¼˜åŠ¿å°±æ˜¯è‡ªå·±çš„å¼±åŠ¿ï¼Œåä¹‹äº¦ç„¶ã€‚ ä½†æ˜¯è¿‘å¹´æ¥è¿™ä¸¤ç§æ•°æ®åº“éƒ½åœ¨å‘ç€å¦å¤–ä¸€ä¸ªæ–¹å‘è¿›åŒ–ã€‚ä¾‹å¦‚ï¼šNOSQLæ•°æ®åº“æ…¢æ…¢å¼€å§‹å…·å¤‡SQLæ•°æ®åº“çš„ä¸€äº›å¤æ‚æŸ¥è¯¢åŠŸèƒ½çš„é›å½¢ï¼Œæ¯”å¦‚Couchbaseçš„indexä»¥åŠMONGOçš„å¤æ‚æŸ¥è¯¢ã€‚å¯¹äºäº‹åŠ¡çš„æ”¯æŒä¹Ÿå¯ä»¥ç”¨ä¸€äº›ç³»ç»Ÿçº§çš„åŸå­æ“ä½œæ¥å®ç°ä¾‹å¦‚ä¹è§‚é”ä¹‹ç±»çš„æ–¹æ³•æ¥æ›²çº¿æ•‘å›½ã€‚SQLæ•°æ®åº“ä¹Ÿå¼€å§‹æ…¢æ…¢è¿›åŒ–ï¼Œæ¯”å¦‚HandlerSockeræŠ€æœ¯çš„å®ç°ï¼Œå¯ä»¥åœ¨MYSQLä¸Šå®ç°å¯¹äºSQLå±‚çš„ç©¿é€ï¼Œç”¨NOSQLçš„æ–¹å¼è®¿é—®æ•°æ®åº“ï¼Œæ€§èƒ½å¯ä»¥ä¸Šå¯ä»¥è¾¾åˆ°ç”šè‡³è¶…è¶ŠNOSQLæ•°æ®åº“ã€‚å¯æ‰©å±•æ€§ä¸Šä¾‹å¦‚Percona Serverï¼Œå¯ä»¥å®ç°æ— ä¸­å¿ƒåŒ–çš„é›†ç¾¤ã€‚ SQLSQL Data Definition (DDL)æœ€é€šç”¨çš„åˆ›å»ºè¡¨çš„æŒ‡ä»¤ä¸ºï¼š 1234567891011create table r ( A1 D1, A2 D2, ..., An Dn, &lt;integrity-contraint1&gt; &lt;integrity-constraint2&gt; ... &lt;integrity-constraintn&gt; ) rï¼šè¡¨çš„åç§° Aiï¼šå±æ€§åç§° Diï¼šå±æ€§Aiçš„æ•°æ®ç±»å‹ ä¾‹å¦‚ï¼š 1234567create table instructor ( ID char(5), name varchar(20) not null, dept_name varchar(20), salary numberic(8, 2))insert into instructor values ('10211', 'Smith', 'Biology', 66000) åˆ›å»ºè¡¨æ—¶çš„integrity constraintsï¼š not null primary key (A1, â€¦, An) foreign key (Am, â€¦, An) references r åˆ é™¤æˆ–ä¿®æ”¹è¡¨ç»“æ„ï¼ˆdropï¼Œalterï¼‰ï¼š drop table r ï¼ˆåˆ é™¤è¡¨åŠå…¶å†…å®¹ï¼‰ delete from student ï¼ˆåˆ é™¤è¡¨ä¸­çš„æ‰€æœ‰å†…å®¹ï¼Œä½†ä¿ç•™è¡¨ï¼‰ alter table alter table r add A D ï¼ˆå¢åŠ ï¼ŒAä¸ºå±æ€§ï¼ŒDä¸ºå±æ€§åŸŸï¼‰ alter table r drop A ï¼ˆåˆ é™¤ï¼‰ SQLæŸ¥è¯¢è¯­å¥çš„åŸºæœ¬ç»“æ„SQL DMLï¼ˆData manipulation languageï¼‰ä¸ºæˆ‘ä»¬æä¾›æŸ¥è¯¢ã€æ’å…¥ã€åˆ é™¤ã€æ›´æ–°æ¡ç›®çš„èƒ½åŠ›ã€‚ ç»å…¸çš„æŸ¥è¯¢è¯­å¥æ ¼å¼123select A1, A2, ..., Anfrom r1, r2, ..., rmwhere P Aiï¼šä»£è¡¨å±æ€§ riï¼šä»£è¡¨å…³ç³» Pï¼šæ¡ä»¶è¯­å¥ åœ¨selectæ—¶åŠ ä¸Šdistinctè¡¨ç¤ºå»é‡é€‰æ‹©ï¼š 12select distinct dept_namefrom instructor selectè¯­å¥selectè¯­å¥åå¯æ¥ç®—æœ¯è¡¨è¾¾å¼ï¼š+ã€-ã€*ã€/ã€‚ 12select ID, name, salary/12from instructor renameé‡å‘½åæ“ä½œ1old-name as new-name ä¾‹å¦‚ï¼š 12select IDã€nameã€salary/12 as monthly_salaryfrom instructor å­—ç¬¦ä¸²æ“ä½œ percent(%)ï¼š%å¯ä»¥åŒ¹é…ä»»ä½•å­ä¸² underscore(_)ï¼š_å¯ä»¥åŒ¹é…ä»»ä½•å­—ç¬¦ ä»¥ä¸Šä¸¤ç§å­—ç¬¦ä¸²æ“ä½œå¯ä»¥åº”ç”¨äºæ•°æ®åº“è¡¨çš„æ¨¡ç³ŠæŸ¥è¯¢ä¸­ã€‚ ä¾‹å¦‚ï¼šå¯»æ‰¾æ‰€æœ‰å¯¼å¸ˆä¸­åå­—å¸¦æœ‰darçš„äºº 123select namefrom instructorwhere name like '%dar%' tupleçš„æ’åºé»˜è®¤æ˜¯å‡åºascï¼š 123select distinct namefrom instructororder by name å¦‚æœè¦é™åºéœ€æ˜¾å¼å£°æ˜ï¼š 1order by name desc å¯ä»¥æ ¹æ®å¤šä¸ªå±æ€§è¿›è¡Œæ’åºï¼š 1order by dept_name, name Set Operation Question: Find courses that ran in Fall 2009 or in Spring 2010 123(select course_id from section where sem='Fall' and year='2009')union(select course_id from section where sem='Spring' and year='2010') Find courses that ran in Fall 2009 and in Spring 2010 123(select course_id from section where sem='Fall' and year=2009)intersect(select course_id from section where sem='Spring' and year=2009) Find courses that ran in Fall 2009 but not in Spring 2010 123(select course_id from section where sem='Fall' and year=2009)except(select course_id from section where sem='Spring' and year=2009) ä»¥ä¸Šæ‰€æœ‰çš„Set Operationéƒ½æ˜¯è‡ªåŠ¨å»é‡çš„ã€‚ èšé›†å‡½æ•°Aggregate Functionsèšé›†å‡½æ•°æ˜¯å¯¹ä¸€ç»„æ•°æ®è¿›è¡Œè®¡ç®—ï¼Œå¹¶è¿”å›å•ä¸€ç»“æœçš„å‡½æ•°ã€‚é™¤äº†count(*)ä»¥å¤–ï¼Œèšé›†å‡½æ•°ä¼šå¿½ç•¥nullå€¼ã€‚èšé›†å‡½æ•°é€šå¸¸åœ¨selectè¯­å¥ä¸­ä¼šä½¿ç”¨group byä»å¥ã€‚ åªèƒ½åœ¨ä»¥ä¸‹æƒ…å†µä¸­å°†èšé›†å‡½æ•°ä½œä¸ºè¡¨è¾¾å¼ï¼š the select list of a SELECT statement (either a subquery or an outer query). a having clause å¸¸ç”¨çš„èšé›†å‡½æ•°ï¼š Count() Sum() Avg() Min() Max() Count()å’ŒSum()çš„åŒºåˆ«åœ¨äºï¼šCount()æ˜¯ç”¨äºè®¡ç®—å…ƒç»„æ•°é‡ï¼ŒSum()æ˜¯ç”¨äºè®¡ç®—å…ƒç»„çš„å†…å®¹æ€»å’Œã€‚ joinSQL joinè¯­å¥æ˜¯åŸºäºä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šè¡¨çš„å…±åŒå±æ€§æ¥åˆå¹¶è¡¨çš„æ•°æ®æˆ–è€…è¡Œã€‚ Join Types Join Conditions inner join natural left outer join on right outer join using (A1, A2, â€¦, An) full outer join Join Conditionsï¼šç”¨äºå®šä¹‰å“ªäº›å±æ€§åœ¨å¤šä¸ªå…³ç³»ä¸­æ˜¯è¦åŒ¹é…çš„ Join Typesï¼šç”¨äºå®šä¹‰å“ªä¸€ä¸ªå…³ç³»ä¸­çš„turpleåœ¨æ²¡æœ‰åŒ¹é…åˆ°ä»»ä½•å…¶ä»–å…³ç³»ä¸­çš„turpleæ—¶ä»ç„¶ä¿ç•™ natural joiné»˜è®¤æ˜¯inner joinï¼Œå®ƒä¹Ÿå¯ä»¥æ˜¯left outer joinæˆ–è€…right outer joinã€‚è¡¨è¾¾çš„æ—¶å€™ï¼Œä½¿ç”¨natural joinè¡¨ç¤ºinner joinå†…è¿æ¥ï¼Œnatural left outer joinæˆ–left outer joinè¡¨ç¤ºå·¦å¤–è¿æ¥ï¼Œnatural right outer joinæˆ–right outer joinè¡¨ç¤ºå³å¤–è¿æ¥ã€‚ ä¾‹å¦‚ï¼š courseè¡¨ï¼š course_id title dept_name credits BI0-301 Genetics Bioloty 4 CS-190 GameDesign Comp_Sci 4 CS-315 Robotics Comp_Sci 3 prereqè¡¨ï¼š course_id prereq_id BI0_301 BI0_101 CS_190 CS_101 course natural(inner) join prereqï¼š course_id title dept_name credits prereq_id BI0_301 Genetics Biology 4 BI0_101 CS_190 Game Design Comp_Sci 4 CS_101 è‡ªç„¶è¿æ¥æ˜¯åŸºäºä¸¤ä¸ªè¡¨ä¸­å…·æœ‰ç›¸åŒåç§°çš„å±æ€§æ¥è¿›è¡Œè¿æ¥ï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­å°±æ˜¯course_idã€‚ course (inner) join prereq using course_idï¼š course_id title dept_name credits prereq_id BI0_301 Genetics Biology 4 BI0_101 CS_190 Game Design Comp_Sci 4 CS_101 å› ä¸ºä¸¤ä¸ªè¡¨çš„å…±åŒå±æ€§ä¸ºcourse_idï¼Œæ‰€ä»¥ä»¥ä¸Šä¸¤ç§è¡¨è¾¾æ–¹å¼æ˜¯ç­‰ä»·çš„ã€‚ å·¦å¤–è¿æ¥å’Œå³å¤–è¿æ¥ï¼š å·¦å¤–è¿æ¥ï¼šä¿ç•™å·¦è¡¨çš„æ‰€æœ‰è¡Œï¼Œæ— æ³•åŒ¹é…çš„å±æ€§åˆ™è®¾ç½®ä¸ºnull å³å¤–è¿æ¥ï¼šä¿ç•™å³è¡¨çš„æ‰€æœ‰è¡Œï¼Œæ— æ³•åŒ¹é…çš„å±æ€§åˆ™è®¾ç½®ä¸ºnull Built-in Data Types in SQL date: dateâ€™2005-7-27â€™ time: timeâ€™09:00:30â€™ timestamp: dateåŠ ä¸Šæ—¶é—´ â€˜2005-7-27 09:00:30.75â€™ interval: subtracting a date/time/timestamp value from another gives an interval value indexç´¢å¼•ç´¢å¼•æ˜¯å­˜å‚¨çš„è¡¨ä¸­ä¸€ä¸ªç‰¹å®šåˆ—çš„å€¼ï¼ˆæ¯”å¦‚Employee_Nameï¼‰çš„æ•°æ®ç»“æ„ï¼ˆæœ€å¸¸è§çš„æ˜¯B-Treeï¼‰ã€‚ç´¢å¼•æ˜¯åœ¨è¡¨çš„åˆ—ä¸Šåˆ›å»ºçš„ã€‚æ‰€ä»¥è¦è®°ä½çš„ç‚¹æ˜¯ï¼Œç´¢å¼•åŒ…å«ä¸€ä¸ªè¡¨ä¸­åˆ—çš„å€¼ï¼Œå¹¶ä¸”è¿™äº›å€¼å­˜å‚¨åœ¨ä¸€ä¸ªæ•°æ®ç»“æ„ä¸­ã€‚ 12345Create table student( ID varchar(5))Create index studentID_index on student(ID) æˆ‘ä»¬ä¸ºä»€ä¹ˆéœ€è¦æ•°æ®åº“ç´¢å¼•ï¼Ÿ å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªæ•°æ®åº“è¡¨ Employeeï¼Œ è¿™ä¸ªè¡¨æœ‰ä¸‰ä¸ªå­—æ®µï¼ˆåˆ—ï¼‰åˆ†åˆ«æ˜¯ Employee_Nameã€Employee_Age å’ŒEmployee_Addressã€‚å‡è®¾è¡¨Employee æœ‰ä¸Šåƒè¡Œæ•°æ®ã€‚ æˆ‘ä»¬è¦ä»è¿™ä¸ªè¡¨ä¸­æŸ¥æ‰¾å‡ºæ‰€æœ‰åå­—æ˜¯â€˜Jesusâ€™çš„é›‡å‘˜ä¿¡æ¯ï¼Œä½¿ç”¨åˆ°ä¸‹é¢è¿™ä¸ªè¯­å¥ï¼š 123SELECT * FROM Employee WHERE Employee_Name = 'Jesus' å¦‚æœè¡¨ä¸­æ²¡æœ‰ç´¢å¼•ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ å¦‚æœæ²¡æœ‰ç´¢å¼•çš„è¯ï¼Œç›´æ¥åœ¨æ•°æ®åº“ä¸­è¿›è¡ŒæŸ¥è¯¢ï¼Œæ•°æ®åº“éœ€è¦æ‰«æEmployeeè¡¨çš„æ¯ä¸€è¡Œç¡®å®šé›‡å‘˜çš„åå­—ï¼ˆEmployee_Nameï¼‰æ˜¯å¦ä¸ºâ€™Jesusâ€™ã€‚ç”±äºæˆ‘ä»¬æƒ³è¦å¾—åˆ°æ¯ä¸ªåå­—ä¸ºJesusçš„é›‡å‘˜ä¿¡æ¯ï¼Œåœ¨æŸ¥è¯¢åˆ°ç¬¬ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„è¡Œåï¼Œä¸èƒ½åœæ­¢æŸ¥è¯¢ï¼Œå› ä¸ºå¯èƒ½è¿˜æœ‰å…¶ä»–ç¬¦åˆæ¡ä»¶çš„è¡Œã€‚æ‰€ä»¥ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ•°æ®åº“è¦ä¸€è¡Œä¸€è¡Œåœ°æŸ¥æ‰¾ç›´åˆ°æœ€åä¸€è¡Œã€‚è¿™å°±æ˜¯æ‰€è°“çš„å…¨è¡¨æ‰«æã€‚ æ•°æ®åº“ç´¢å¼•æ˜¯æ€æ ·æå‡æ€§èƒ½çš„ï¼Ÿ ä½¿ç”¨ç´¢å¼•çš„å…¨éƒ¨æ„ä¹‰å°±æ˜¯é€šè¿‡ç¼©å°ä¸€å¼ è¡¨ä¸­éœ€è¦æŸ¥è¯¢çš„è®°å½•/è¡Œçš„æ•°ç›®æ¥åŠ å¿«æœç´¢çš„é€Ÿåº¦ã€‚ ä»€ä¹ˆæ ·çš„æ•°æ®ç»“æ„å¯ä»¥ä½œä¸ºç´¢å¼•ï¼Ÿ B-Treeæ˜¯æœ€å¸¸ç”¨çš„ç”¨äºç´¢å¼•çš„æ•°æ®ç»“æ„ã€‚å› ä¸ºå®ƒä»¬æ—¶é—´å¤æ‚åº¦ä½ï¼ŒæŸ¥æ‰¾ã€åˆ é™¤ã€æ’å…¥æ“ä½œéƒ½å¯ä»¥åœ¨å¯¹æ•°æ—¶é—´å†…å®Œæˆã€‚å¦å¤–ä¸€ä¸ªé‡è¦åŸå› æ˜¯ï¼Œå­˜å‚¨åœ¨B-Treeä¸­çš„æ•°æ®æ˜¯æœ‰åºçš„ã€‚æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼ˆDBMSï¼‰é€šå¸¸å†³å®šç´¢å¼•åº”è¯¥ç”¨å“ªäº›æ•°æ®ç»“æ„ã€‚ä½†åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä½ åœ¨åˆ›å»ºç´¢å¼•æ—¶å¯ä»¥æŒ‡å®šç´¢å¼•è¦ç”¨çš„æ•°æ®ç»“æ„ã€‚ å“ˆå¸Œè¡¨ç´¢å¼•æ˜¯æ€æ ·å·¥ä½œçš„ï¼Ÿ åœ¨å¯»æ‰¾å€¼æ—¶ï¼Œå“ˆå¸Œè¡¨æ•ˆç‡æé«˜ã€‚æ‰€ä»¥ï¼Œå¦‚æœä½¿ç”¨å“ˆå¸Œç´¢å¼•ï¼Œå¯¹äºæ¯”è¾ƒå­—ç¬¦ä¸²æ˜¯å¦ç›¸ç­‰çš„æŸ¥è¯¢èƒ½å¤Ÿæå¿«åœ°æ£€ç´¢å‡ºå…¶å€¼ã€‚ æ¯”å¦‚åœ¨åˆšåˆšçš„æŸ¥è¯¢ï¼ˆSELECT * FROM Employee WHERE Employee_Name = â€˜Jesusâ€™ï¼‰å°±å¯ä»¥åˆ›å»ºåœ¨Employee_Nameåˆ—ä¸Šçš„å“ˆå¸Œç´¢å¼•ã€‚å“ˆå¸Œç´¢å¼•ä¸€èˆ¬çš„å·¥ä½œæ–¹å¼æ˜¯ï¼Œå°†åˆ—çš„å€¼ä½œä¸ºç´¢å¼•çš„é”®å€¼ï¼ˆkeyï¼‰ï¼Œå’Œé”®å€¼å¯¹åº”å®é™…çš„å€¼ï¼ˆvalueï¼‰æ˜¯æŒ‡å‘è¯¥è¡¨ï¼ˆEmployeeï¼‰ä¸­ç›¸åº”è¡Œçš„æŒ‡é’ˆã€‚ ä½†å“ˆå¸Œè¡¨æ˜¯æ— é¡ºåºçš„æ•°æ®ç»“æ„ï¼Œå¯¹äºå¾ˆå¤šç±»å‹çš„æŸ¥è¯¢è¯­å¥å“ˆå¸Œç´¢å¼•éƒ½æ— èƒ½ä¸ºåŠ›ï¼Œæ¯”å¦‚æŸ¥æ‰¾æ‰€æœ‰å°äº40å²çš„å‘˜å·¥ã€‚å“ˆå¸Œè¡¨åªé€‚åˆæŸ¥è¯¢é”®å€¼å¯¹ï¼Œä¹Ÿå°±æ˜¯è¯´æŸ¥è¯¢ç›¸ç­‰çš„æŸ¥è¯¢ã€‚ ç´¢å¼•æ˜¯æ€æ ·æå‡æ€§èƒ½çš„ï¼Ÿ ç´¢å¼•æ˜¯ç”¨æ¥å­˜å‚¨åˆ—å€¼çš„æ•°æ®ç»“æ„ã€‚å¦‚æœç´¢å¼•ä½¿ç”¨æœ€å¸¸ç”¨çš„æ•°æ®ç»“æ„B-Treeï¼Œé‚£ä¹ˆå…¶ä¸­çš„æ•°æ®æ˜¯æœ‰åºçš„ã€‚æœ‰åºçš„åˆ—å€¼å¯ä»¥æå¤§åœ°æå‡æ€§èƒ½ã€‚ å‡è®¾æˆ‘ä»¬åœ¨Employee_Nameè¿™ä¸€åˆ—ä¸Šåˆ›å»ºä¸€ä¸ªB-Treeç´¢å¼•ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬ç”¨ä¹‹å‰çš„SQLæŸ¥æ‰¾å§“åæ˜¯Jesusçš„é›‡å‘˜æ—¶ï¼Œä¸éœ€è¦å†æ‰«æå…¨è¡¨ã€‚è€Œæ˜¯ç”¨ç´¢å¼•æŸ¥æ‰¾åå­—ä¸ºJesusçš„é›‡å‘˜ï¼Œå› ä¸ºç´¢å¼•å·²ç»æ˜¯æŒ‰ç…§å­—æ¯é¡ºåºæ’åºã€‚ç´¢å¼•å·²ç»æ’åºæ„å‘³ç€æŸ¥è¯¢ä¸€ä¸ªåå­—ä¼šå¿«å¾ˆå¤šï¼Œå› ä¸ºåå­—ä¸­é¦–å­—æ¯ä¸ºJçš„å‘˜å·¥éƒ½æ˜¯æ’åˆ—åœ¨ä¸€èµ·çš„ã€‚å¦å¤–é‡è¦çš„ä¸€ç‚¹æ˜¯ï¼Œç´¢å¼•åŒæ—¶å­˜å‚¨äº†è¡¨ä¸­ç›¸åº”è¡Œçš„æŒ‡é’ˆä»¥è·å–å…¶ä»–åˆ—çš„æ•°æ®ã€‚ æ•°æ®åº“ç´¢å¼•é‡Œå­˜äº†ä»€ä¹ˆï¼Ÿ æ•°æ®åº“ç´¢å¼•æ˜¯åˆ›å»ºåœ¨è¡¨çš„æŸåˆ—ä¸Šçš„ï¼Œå¹¶å­˜å‚¨äº†è¿™ä¸€åˆ—çš„æ‰€æœ‰å€¼ï¼Œå¹¶ä¸”ï¼Œæ•°æ®åº“ç´¢å¼•ä¸å­˜å‚¨è¿™ä¸ªè¡¨ä¸­å…¶ä»–åˆ—çš„å€¼ã€‚å¦‚æœæˆ‘ä»¬åœ¨Employee_Nameåˆ—åˆ›å»ºç´¢å¼•ï¼Œé‚£ä¹ˆåˆ—Employee_Ageå’ŒEmployee_Addressä¸Šçš„å€¼å¹¶ä¸ä¼šå­˜å‚¨åœ¨è¿™ä¸ªç´¢å¼•å½“ä¸­ã€‚å¦‚æœæˆ‘ä»¬æŠŠå…¶ä»–æ‰€æœ‰å­—æ®µéƒ½å­˜å‚¨åœ¨è¿™ä¸ªç´¢å¼•ä¸­ï¼Œé‚£å°±ç›¸å½“äºæ‹·è´äº†ä¸€æ•´å¼ è¡¨ä½œä¸ºç´¢å¼•ï¼Œè¿™æ ·ä¼šå ç”¨å¤ªå¤§çš„ç©ºé—´è€Œä¸”ä¼šååˆ†ä½æ•ˆã€‚ ç´¢å¼•å­˜å‚¨äº†æŒ‡å‘è¡¨ä¸­æŸä¸€è¡Œçš„æŒ‡é’ˆ æ•°æ®åº“ç´¢å¼•é™¤äº†å­˜å‚¨è¡¨ä¸­æŸåˆ—çš„å€¼å¤–ï¼ŒåŒæ—¶è¿˜å­˜å‚¨äº†æŒ‡å‘è¡¨ä¸­ç›¸åº”è¡Œçš„æŒ‡é’ˆã€‚æŒ‡é’ˆæ˜¯æŒ‡ä¸€å—å†…å­˜åŒºåŸŸï¼Œè¯¥å†…å­˜åŒºåŸŸè®°å½•çš„æ˜¯å¯¹ç¡¬ç›˜ä¸Šè®°å½•çš„ç›¸åº”è¡Œçš„æ•°æ®çš„å¼•ç”¨ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œç´¢å¼•ä¸­çš„Employee_Nameè¿™åˆ—çš„æŸä¸ªå€¼ï¼ˆæˆ–è€…èŠ‚ç‚¹ï¼‰å¯ä»¥æè¿°ä¸ºï¼ˆJesus, 0x82829ï¼‰ï¼Œ0x82829å°±æ˜¯åŒ…å«Jesusé‚£è¡Œæ•°æ®åœ¨ç¡¬ç›˜ä¸Šçš„åœ°å€ã€‚å¦‚æœæ²¡æœ‰è¿™ä¸ªå¼•ç”¨ï¼Œä½ å°±åªèƒ½è®¿é—®åˆ°ä¸€ä¸ªå•ç‹¬çš„å€¼Jesusï¼Œè€Œè¿™æ ·æ²¡æœ‰æ„ä¹‰ã€‚ æ•°æ®åº“æ€ä¹ˆçŸ¥é“ä»€ä¹ˆæ—¶å€™ä½¿ç”¨ç´¢å¼•ï¼Ÿ å½“è¿™ä¸ªSQLï¼ˆSELECT * FROM Employee WHERE Employee_Name = Jesusï¼‰è¿è¡Œæ—¶ï¼Œæ•°æ®åº“ä¼šæ£€æŸ¥åœ¨æŸ¥è¯¢åˆ—ä¸Šæ˜¯å¦æœ‰ç´¢å¼•ã€‚å‡è®¾Employee_Nameåˆ—ä¸Šç¼ºå¤±åˆ›å»ºäº†ç´¢å¼•ï¼Œæ•°æ®åº“ä¼šæ¥ç€æ£€æŸ¥ä½¿ç”¨è¿™ä¸ªç´¢å¼•åšæŸ¥è¯¢æ˜¯å¦åˆç†ï¼Œå› ä¸ºæœ‰äº›åœºæ™¯ä¸‹ï¼Œä½¿ç”¨ç´¢å¼•æ¯”èµ·å…¨è¡¨æ‰«æä¼šæ›´åŠ ä½æ•ˆã€‚ ä½¿ç”¨æ•°æ®åº“ç´¢å¼•ä¼šæœ‰ä»€ä¹ˆä»£ä»·ï¼Ÿ ç´¢å¼•ä¼šå ç”¨ç©ºé—´ï¼Œè¡¨è¶Šå¤§ï¼Œç´¢å¼•å ç”¨çš„ç©ºé—´è¶Šå¤§ã€‚ æ€§èƒ½æŸå¤±ï¼ˆä¸»è¦æ˜¯å€¼æ›´æ–°æ“ä½œï¼‰ã€‚å½“ä½ åœ¨è¡¨ä¸­æ·»åŠ ã€åˆ é™¤æˆ–è€…æ›´æ–°è¡Œæ•°æ®æ—¶ï¼Œç´¢å¼•ä¸­ä¹Ÿä¼šæœ‰ç›¸åŒçš„æ“ä½œã€‚ åŸºæœ¬åŸåˆ™æ˜¯ï¼šå¦‚æœè¡¨ä¸­æŸåˆ—åœ¨æŸ¥è¯¢è¿‡ç¨‹ä¸­ä½¿ç”¨éå¸¸é¢‘ç¹ï¼Œé‚£å°±åœ¨è¯¥åˆ—ä¸Šåˆ›å»ºç´¢å¼•ã€‚ Large-Object TypesLarge objects (photos, videos, CAD files, etc.) are stored as a large objectï¼š Blobï¼šbinary large object Clob: character large object ä¾‹å¦‚ï¼š 12345Book_review clob(10KB)Image blob(10MB)Movie blob(2GB) When a query returns a large object, a pointer is returned rather than the large object itself. æ•°æ®åº“è®¾è®¡ä»¥åŠE-Ræ¨¡å‹ä¸€ä¸ªæ•°æ®åº“å¯ä»¥è¢«å»ºæ¨¡ä¸ºï¼š å®ä½“ï¼ˆentityï¼‰é›†åˆ å®ä½“ä¹‹é—´çš„å…³ç³»ï¼ˆrelationshipï¼‰ å®ä½“ä¸€ä¸ªå­˜åœ¨çš„å¯¹è±¡ï¼Œå¹¶èƒ½ä¸å…¶ä»–å¯¹è±¡åŒºåˆ«å¼€æ¥ã€‚ å…³ç³»å¤šä¸ªå®ä½“ä¹‹é—´çš„è”ç³»ã€‚å…³ç³»é›†çš„ç»´åº¦å¯ä»¥æ˜¯äºŒç»´ï¼Œä¹Ÿå¯ä»¥æ˜¯å¤šç»´ã€‚ä¸¤ä¸ªå®ä½“é›†ä¹‹é—´çš„å…³ç³»å°±æ˜¯äºŒç»´å…³ç³»ï¼Œå¤§å¤šæ•°æ•°æ®åº“ç³»ç»Ÿä¸­çš„å…³ç³»éƒ½æ˜¯äºŒç»´çš„ã€‚å¤šäºä¸¤ä¸ªå®ä½“é›†ä¹‹é—´çš„å…³ç³»å°±æ˜¯å¤šç»´å…³ç³»ã€‚ å¤šç»´å…³ç³»çš„ä¾‹å­ï¼š 12Student work on research projects under the guidance of an instructor.Relationship proj_guide is a ternary relationship relationship between instructor, student, and project. å±æ€§çš„åŸŸå’Œç±»å‹ å±æ€§çš„åŸŸï¼ˆdomainï¼‰ï¼šè¡¨ç¤ºçš„æ˜¯å±æ€§çš„å–å€¼èŒƒå›´ å±æ€§çš„ç±»å‹ï¼ˆtypesï¼‰ï¼š ç®€å•å’Œå¤åˆå±æ€§ï¼ˆsimple/compositeï¼‰ å•å€¼å±æ€§å’Œå¤šå€¼å±æ€§ï¼ˆsingle-values/multivaluedï¼‰ è¡ç”Ÿå±æ€§ï¼ˆDerivesï¼‰ æ˜ å°„åŸºæ•° one to one one to many many to one many to many Participation Constraint total participationï¼ˆå®Œå…¨å‚ä¸ï¼‰ï¼šä¸€ä¸ªå®ä½“é›†åœ¨ä¸€ä¸ªå…³ç³»ä¸­æ˜¯å®Œå…¨å‚ä¸çš„è¯ï¼Œè¯¥å®ä½“é›†ä¸­çš„æ¯ä¸ªå®ä½“éƒ½ä¼šå‚ä¸åˆ°è‡³å°‘ä¸€ä¸ªå…³ç³»ä¸­ã€‚ æ¯”å¦‚ï¼Œåœ¨å¤è¯—è¯å°ç¨‹åºä¸­ï¼Œç”¨æˆ·å’Œç”¨æˆ·çš„æœ—è¯µä½œå“ä¹‹é—´å­˜åœ¨ç€å…³ç³»ï¼Œé‚£æœ—è¯µä½œå“æ˜¯å®Œå…¨å‚ä¸åˆ°è¿™ä¸ªå…³ç³»ä¸­çš„ï¼Œä¸å­˜åœ¨å“ªä¸ªæœ—è¯µä½œå“æ²¡æœ‰å¯¹åº”çš„ç”¨æˆ·ã€‚åˆæ¯”å¦‚ï¼Œåœ¨å­¦ç”Ÿç®¡ç†ç³»ç»Ÿä¸­ï¼Œå¯¼å¸ˆå’Œå­¦ç”Ÿä¹‹é—´å­˜åœ¨ç€å…³ç³»ï¼Œä½†å¯¼å¸ˆå’Œå­¦ç”Ÿè¿™ä¸¤ä¸ªå®ä½“éƒ½ä¸æ˜¯å®Œå…¨å‚ä¸åˆ°è¯¥å…³ç³»ä¸­çš„ï¼Œå› ä¸ºæœ‰äº›å¯¼å¸ˆå¯èƒ½æ²¡æœ‰æ‹›æ”¶å­¦ç”Ÿï¼Œæœ‰äº›å­¦ç”Ÿä¹Ÿæ²¡æœ‰é€‰æ‹©å¯¼å¸ˆï¼Œè¿™ä¸ªå°±æ˜¯éƒ¨åˆ†å‚ä¸ï¼ˆpartial participationï¼‰ partial participationï¼šä¸€ä¸ªå®ä½“é›†ä¸­çš„æœ‰äº›å®ä½“æ²¡æœ‰å‚ä¸åˆ°å…³ç³»ä¸­ï¼Œåˆ™å®ä½“é›†çš„å‚ä¸åº¦å°±æ˜¯éƒ¨åˆ†å‚ä¸ã€‚ Keys super keyï¼šæ˜¯å±æ€§ç»„åˆçš„é›†åˆï¼Œè¯¥é›†åˆä¸­çš„æ¯ä¸ªå±æ€§ç»„åˆéƒ½èƒ½å¤Ÿå”¯ä¸€åœ°è¯†åˆ«è¡¨ä¸­çš„turple candidate keyï¼šæ˜¯super keyçš„æœ€å°å­é›†çš„é›†åˆ primary keyï¼š å…¶ä¸­ä¸€ä¸ªcandidate keyä¼šè¢«é€‰æ‹©ä¸ºprimary key å…³ç³»é›†çš„keyå…³ç³»é›†å¯ä»¥æ²¡æœ‰å±æ€§ï¼Œå¦‚æœå…³ç³»é›†æœ‰å±æ€§ï¼Œé‚£å„ä¸ªå®ä½“é›†çš„primary keyç»„åˆèµ·æ¥å¯ä»¥å½¢æˆå…³ç³»é›†çš„super keyã€‚ E-Rå›¾ çŸ©å½¢ä»£è¡¨å®ä½“é›† è±å½¢ä»£è¡¨å…³ç³»é›† å±æ€§åˆ—ä¸¾åœ¨çŸ©å½¢ä¸­ ç”¨ä¸‹åˆ’çº¿æ ‡è¯†å‡ºprimary key å¸¦æœ‰å¤åˆï¼Œå¤šå€¼ï¼Œè¡ç”Ÿå±æ€§çš„å®ä½“ï¼š å…³ç³»é›†æœ‰è‡ªèº«çš„å±æ€§ï¼š åŸºæ•°é™åˆ¶çš„è¡¨è¾¾å®ä½“é›†å’Œå…³ç³»é›†ä¹‹é—´ï¼Œç”¨â†’è¡¨ç¤ºâ€œoneâ€ï¼Œç”¨â€”è¡¨ç¤ºâ€œmanyâ€ã€‚ one to one relationshipï¼š instructorè‡³å¤šæœ‰ä¸€ä¸ªstudentï¼Œstudentè‡³å¤šæœ‰ä¸€ä¸ªinstructor one to many relationshipï¼š instructorå¯ä»¥æœ‰å¤šä¸ªstudentï¼ˆåŒ…æ‹¬0ï¼‰ï¼Œstudentè‡³å¤šæœ‰ä¸€ä¸ªinstructor many to one relationshipï¼š many to many relationshipï¼š total participationï¼š ä½¿ç”¨cardinality limitï¼š å±æ€§ç»§æ‰¿ top-down design process: specialization bottom-up design process: generalization overlappingï¼šå¯é‡å  disjointï¼šä¸å¯é‡å ï¼Œåªèƒ½æ˜¯ä¸¤è€…ä¹‹ä¸€ E-Ræ ‡è¯†æ€»ç»“ è®¾è®¡å…³é”®ç‚¹ å±æ€§é—´ä¸äº§ç”Ÿè”ç³»ï¼Œå½“å±æ€§ä¸å…¶ä»–å®ä½“æœ‰è”ç³»æ—¶ï¼Œè¯¥å±æ€§åº”ä½œä¸ºå®ä½“ å½“ä¸€ä¸ªå¯¹è±¡è¢«è¡¨è¾¾ä¸ºå®ä½“æ—¶ï¼Œåœ¨å…¶ä»–å®ä½“ä¸­ä¸èƒ½ä»¥å±æ€§å‡ºç°ï¼Œåªèƒ½ç”¨è”ç³»è¡¨è¾¾ MySQLå®è·µåœ¨å¤§è‡´äº†è§£äº†æ•°æ®åº“çš„åŸºç¡€çŸ¥è¯†åï¼Œæˆ‘ä¾¿å¼€å§‹è®¾è®¡ï¼Œæ­å»ºè‡ªå·±çš„æ•°æ®åº“ã€‚ é¦–å…ˆæ˜¯ç”»E-Rå›¾ï¼Œå¯¹æ•°æ®åº“è¿›è¡Œç®€å•å»ºæ¨¡ï¼š åœ¨å¤è¯—è¯å°ç¨‹åºä¸­ï¼Œæˆ‘å»ºç«‹äº†11ä¸ªå®ä½“é›†å’Œ5ä¸ªå…³ç³»é›†ï¼Œæœ‰äº›å®ä½“é›†ä¹‹é—´æ˜¯æœ‰ç»§æ‰¿å…³ç³»çš„ï¼Œæ¯”å¦‚compositionä¸poemsï¼Œpoetryï¼Œlunyuï¼Œshijingã€‚ åœ¨åˆ›å»ºè¡¨æ—¶ï¼Œé€‰æ‹©MySQLçš„é»˜è®¤å­˜å‚¨å¼•æ“InnoDBï¼š 1234567891011121314create table user ( openid varchar(100) not null comment openid, nickname varchar(100) default null comment 'æ˜µç§°', avatar_url varchar(1000) default null comment 'å¤´åƒåœ°å€', gender int(1) default 0 comment 'æ€§åˆ«', province varchar(30) default null comment 'çœä»½', city varchar(30) default null comment 'åŸå¸‚', country varchar(30) default null comment 'å›½å®¶', primary key openid)ENGINE=InnoDBDEFAULT CHARSET=utf8mb4COLLATE=utf8mb4_general_ciCOMMENT='å¤è¯—è¯å°ç¨‹åº'; auto_incrementå½“æˆ‘ä»¬åœ¨MySQLä¸­å»ºè¡¨æ—¶ï¼Œæœ‰äº›å±æ€§ç»å¸¸ä¼šæ·»åŠ auto_incrementè¿™ä¸ªå±æ€§å®šä¹‰ï¼Œå®ƒå¯ä»¥ç”¨äºä¸ºä¸€ä¸ªè¡¨ä¸­çš„è®°å½•è‡ªåŠ¨ç”ŸæˆIDã€‚auto_incrementæ˜¯ç”¨äºä¸»é”®è‡ªåŠ¨å¢é•¿çš„ï¼Œä»1å¼€å§‹å¢é•¿ï¼Œå½“ä½ æŠŠç¬¬ä¸€æ¡è®°å½•åˆ é™¤æ—¶ï¼Œå†æ’å…¥ç¬¬äºŒæ¡æ•°æ®ï¼Œä¸»é”®å€¼æ˜¯2ï¼Œä¸æ˜¯1ã€‚ åœ¨ä½¿ç”¨auto_incrementæ—¶ï¼Œåº”æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š auto_incrementæ•°æ®åˆ—å¿…é¡»æ˜¯ä¸»é”®æˆ–è€…æ˜¯ä¸»é”®çš„ä¸€éƒ¨åˆ†ï¼Œä¸”å¿…é¡»å…·å¤‡NOT NULLå±æ€§ å½“è¿›è¡Œå…¨è¡¨åˆ é™¤æ—¶ï¼ŒMySQL auto_incrementä¼šä»1é‡æ–°å¼€å§‹ç¼–å· InnoDBå­˜å‚¨å¼•æ“MySQL ä»ç¬¬ä¸€ä¸ªç‰ˆæœ¬å‘å¸ƒåˆ°ç°åœ¨å·²ç»æœ‰äº† 20 å¤šå¹´çš„å†å²ï¼Œåœ¨è¿™ä¹ˆå¤šå¹´çš„å‘å±•å’Œæ¼”å˜ä¸­ï¼Œæ•´ä¸ªåº”ç”¨çš„ä½“ç³»ç»“æ„å˜å¾—è¶Šæ¥è¶Šå¤æ‚ï¼š æœ€ä¸Šå±‚ï¼šç”¨äºè¿æ¥ã€çº¿ç¨‹å¤„ç†çš„éƒ¨åˆ†å¹¶ä¸æ˜¯ MySQL ã€å‘æ˜ã€çš„ï¼Œå¾ˆå¤šæœåŠ¡éƒ½æœ‰ç±»ä¼¼çš„ç»„æˆéƒ¨åˆ† ç¬¬äºŒå±‚ï¼šåŒ…å«äº†å¤§å¤šæ•° MySQL çš„æ ¸å¿ƒæœåŠ¡ï¼ŒåŒ…æ‹¬äº†å¯¹ SQL çš„è§£æã€åˆ†æã€ä¼˜åŒ–å’Œç¼“å­˜ç­‰åŠŸèƒ½ï¼Œå­˜å‚¨è¿‡ç¨‹ã€è§¦å‘å™¨å’Œè§†å›¾éƒ½æ˜¯åœ¨è¿™é‡Œå®ç°çš„ ç¬¬ä¸‰å±‚ï¼šMySQLä¸­çœŸæ­£è´Ÿè´£æ•°æ®çš„å­˜å‚¨å’Œæå–çš„å­˜å‚¨å¼•æ“ï¼Œä¾‹å¦‚ï¼šInnoDBã€MyISAM æ•°æ®çš„å­˜å‚¨åœ¨æ•´ä¸ªæ•°æ®åº“ä½“ç³»ç»“æ„ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸åŒçš„å­˜å‚¨å¼•æ“æ¥å­˜å‚¨æ•°æ®ï¼Œè€Œç»å¤§å¤šæ•°å­˜å‚¨å¼•æ“éƒ½ä»¥äºŒè¿›åˆ¶çš„å½¢å¼å­˜å‚¨æ•°æ®ã€‚ åœ¨ InnoDB å­˜å‚¨å¼•æ“ä¸­ï¼Œæ‰€æœ‰çš„æ•°æ®éƒ½è¢«é€»è¾‘åœ°å­˜æ”¾åœ¨è¡¨ç©ºé—´ä¸­ï¼Œè¡¨ç©ºé—´ï¼ˆtablespaceï¼‰æ˜¯å­˜å‚¨å¼•æ“ä¸­æœ€é«˜çš„å­˜å‚¨é€»è¾‘å•ä½ï¼Œåœ¨è¡¨ç©ºé—´çš„ä¸‹é¢åˆåŒ…æ‹¬æ®µï¼ˆsegmentï¼‰ã€åŒºï¼ˆextentï¼‰ã€é¡µï¼ˆpageï¼‰ï¼š åŒä¸€ä¸ªæ•°æ®åº“å®ä¾‹çš„æ‰€æœ‰è¡¨ç©ºé—´éƒ½æœ‰ç›¸åŒçš„é¡µå¤§å°ï¼›é»˜è®¤æƒ…å†µä¸‹ï¼Œè¡¨ç©ºé—´ä¸­çš„é¡µå¤§å°éƒ½ä¸º 16KBï¼Œå½“ç„¶ä¹Ÿå¯ä»¥é€šè¿‡æ”¹å˜ innodb_page_size é€‰é¡¹å¯¹é»˜è®¤å¤§å°è¿›è¡Œä¿®æ”¹ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ä¸åŒçš„é¡µå¤§å°æœ€ç»ˆä¹Ÿä¼šå¯¼è‡´åŒºå¤§å°çš„ä¸åŒï¼š ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œåœ¨ InnoDB å­˜å‚¨å¼•æ“ä¸­ï¼Œä¸€ä¸ªåŒºçš„å¤§å°æœ€å°ä¸º 1MBï¼Œé¡µçš„æ•°é‡æœ€å°‘ä¸º 64 ä¸ªã€‚ å¦‚ä½•å­˜å‚¨è®°å½•ä¸ç°æœ‰çš„å¤§å¤šæ•°å­˜å‚¨å¼•æ“ä¸€æ ·ï¼ŒInnoDB ä½¿ç”¨é¡µä½œä¸ºç£ç›˜ç®¡ç†çš„æœ€å°å•ä½ï¼›æ•°æ®åœ¨ InnoDB å­˜å‚¨å¼•æ“ä¸­éƒ½æ˜¯æŒ‰è¡Œå­˜å‚¨çš„ï¼Œæ¯ä¸ª 16KB å¤§å°çš„é¡µä¸­å¯ä»¥å­˜æ”¾ 2-200 è¡Œçš„è®°å½•ã€‚ è¡Œæº¢å‡ºæ•°æ®å½“ InnoDB ä½¿ç”¨ Compact æˆ–è€… Redundant æ ¼å¼å­˜å‚¨æé•¿çš„ VARCHAR æˆ–è€… BLOB è¿™ç±»å¤§å¯¹è±¡æ—¶ï¼Œæˆ‘ä»¬å¹¶ä¸ä¼šç›´æ¥å°†æ‰€æœ‰çš„å†…å®¹éƒ½å­˜æ”¾åœ¨æ•°æ®é¡µèŠ‚ç‚¹ä¸­ï¼Œè€Œæ˜¯å°†è¡Œæ•°æ®ä¸­çš„å‰ 768 ä¸ªå­—èŠ‚å­˜å‚¨åœ¨æ•°æ®é¡µä¸­ï¼Œåé¢ä¼šé€šè¿‡åç§»é‡æŒ‡å‘æº¢å‡ºé¡µã€‚ ä½†æ˜¯å½“æˆ‘ä»¬ä½¿ç”¨æ–°çš„è¡Œè®°å½•æ ¼å¼ Compressed æˆ–è€… Dynamic æ—¶éƒ½åªä¼šåœ¨è¡Œè®°å½•ä¸­ä¿å­˜ 20 ä¸ªå­—èŠ‚çš„æŒ‡é’ˆï¼Œå®é™…çš„æ•°æ®éƒ½ä¼šå­˜æ”¾åœ¨æº¢å‡ºé¡µé¢ä¸­ã€‚ æ•°æ®é¡µç»“æ„é¡µæ˜¯ InnoDB å­˜å‚¨å¼•æ“ç®¡ç†æ•°æ®çš„æœ€å°ç£ç›˜å•ä½ï¼Œè€Œ B-Tree èŠ‚ç‚¹å°±æ˜¯å®é™…å­˜æ”¾è¡¨ä¸­æ•°æ®çš„é¡µé¢ã€‚ é¦–å…ˆï¼Œä¸€ä¸ª InnoDB é¡µæœ‰ä»¥ä¸‹ä¸ƒä¸ªéƒ¨åˆ†ï¼š User Recordså°±æ˜¯æ•´ä¸ªé¡µé¢ä¸­çœŸæ­£ç”¨äºå­˜æ”¾è¡Œè®°å½•çš„éƒ¨åˆ†ï¼Œè€ŒFree Spaceå°±æ˜¯ç©ºä½™ç©ºé—´ã€‚ B+ æ ‘åœ¨æŸ¥æ‰¾å¯¹åº”çš„è®°å½•æ—¶ï¼Œå¹¶ä¸ä¼šç›´æ¥ä»æ ‘ä¸­æ‰¾å‡ºå¯¹åº”çš„è¡Œè®°å½•ï¼Œå®ƒåªèƒ½è·å–è®°å½•æ‰€åœ¨çš„é¡µï¼Œå°†æ•´ä¸ªé¡µåŠ è½½åˆ°å†…å­˜ä¸­ï¼Œå†é€šè¿‡ Page Directory ä¸­å­˜å‚¨çš„ç¨€ç–ç´¢å¼•å’Œ n_ownedã€next_record å±æ€§å–å‡ºå¯¹åº”çš„è®°å½•ï¼Œä¸è¿‡å› ä¸ºè¿™ä¸€æ“ä½œæ˜¯åœ¨å†…å­˜ä¸­è¿›è¡Œçš„ï¼Œæ‰€ä»¥é€šå¸¸ä¼šå¿½ç•¥è¿™éƒ¨åˆ†æŸ¥æ‰¾çš„è€—æ—¶ã€‚ ç´¢å¼•ç´¢å¼•åœ¨ä¸Šæ–‡ä¸­ä¹Ÿæåˆ°ï¼Œæ˜¯æ•°æ®åº“éå¸¸é‡è¦çš„æ¦‚å¿µï¼Œå®ƒæ˜¯å­˜å‚¨å¼•æ“èƒ½å¤Ÿå¿«é€Ÿå®šä½è®°å½•çš„ç§˜å¯†æ­¦å™¨ï¼Œæ˜¯å¯¹æŸ¥è¯¢æ€§èƒ½ä¼˜åŒ–æœ€æœ‰æ•ˆçš„æ‰‹æ®µã€‚ ç´¢å¼•çš„æ•°æ®ç»“æ„InnoDBå­˜å‚¨å¼•æ“åœ¨ç»å¤§å¤šæ•°æƒ…å†µä¸‹ä½¿ç”¨B+æ ‘å»ºç«‹ç´¢å¼•ï¼Œè¿™æ˜¯å…³ç³»å‹æ•°æ®åº“ä¸­æœ€ä¸ºå¸¸ç”¨å’Œæœ‰æ•ˆçš„ç´¢å¼•ã€‚ä½†æ˜¯ B+ æ ‘ç´¢å¼•å¹¶ä¸èƒ½æ‰¾åˆ°ä¸€ä¸ªç»™å®šé”®å¯¹åº”çš„å…·ä½“å€¼ï¼Œå®ƒåªèƒ½æ‰¾åˆ°æ•°æ®è¡Œå¯¹åº”çš„é¡µï¼Œç„¶åæ­£å¦‚ä¸Šä¸€èŠ‚æ‰€æåˆ°çš„ï¼Œæ•°æ®åº“æŠŠæ•´ä¸ªé¡µè¯»å…¥åˆ°å†…å­˜ä¸­ï¼Œå¹¶åœ¨å†…å­˜ä¸­æŸ¥æ‰¾å…·ä½“çš„æ•°æ®è¡Œã€‚ B+ æ ‘æ˜¯å¹³è¡¡æ ‘ï¼Œå®ƒæŸ¥æ‰¾ä»»æ„èŠ‚ç‚¹æ‰€è€—è´¹çš„æ—¶é—´éƒ½æ˜¯å®Œå…¨ç›¸åŒçš„ï¼Œæ¯”è¾ƒçš„æ¬¡æ•°å°±æ˜¯ B+ æ ‘çš„é«˜åº¦ã€‚ èšé›†ç´¢å¼•å’Œè¾…åŠ©ç´¢å¼•æ•°æ®åº“ä¸­çš„ B+ æ ‘ç´¢å¼•å¯ä»¥åˆ†ä¸ºèšé›†ç´¢å¼•ï¼ˆclustered indexï¼‰å’Œè¾…åŠ©ç´¢å¼•ï¼ˆsecondary indexï¼‰ï¼Œå®ƒä»¬ä¹‹é—´çš„æœ€å¤§åŒºåˆ«å°±æ˜¯ï¼Œèšé›†ç´¢å¼•ä¸­å­˜æ”¾ç€ä¸€æ¡è¡Œè®°å½•çš„å…¨éƒ¨ä¿¡æ¯ï¼Œè€Œè¾…åŠ©ç´¢å¼•ä¸­åªåŒ…å«ç´¢å¼•åˆ—å’Œä¸€ä¸ªç”¨äºæŸ¥æ‰¾å¯¹åº”è¡Œè®°å½•çš„ã€ä¹¦ç­¾ã€ã€‚ èšé›†ç´¢å¼•InnoDBå­˜å‚¨å¼•æ“ä¸­çš„è¡¨éƒ½æ˜¯ä½¿ç”¨ç´¢å¼•ç»„ç»‡çš„ï¼Œä¹Ÿå°±æ˜¯æŒ‰ç…§é”®çš„é¡ºåºå­˜æ”¾ã€‚èšé›†ç´¢å¼•å°±æ˜¯æŒ‰ç…§è¡¨ä¸­ä¸»é”®çš„é¡ºåºæ„å»ºä¸€é¢— B+ æ ‘ï¼Œå¹¶åœ¨å¶èŠ‚ç‚¹ä¸­å­˜æ”¾è¡¨ä¸­çš„è¡Œè®°å½•æ•°æ®ã€‚èšé›†ç´¢å¼•æ„æˆçš„B+æ ‘æ˜¯æ•°æ®å®é™…å­˜å‚¨çš„å½¢å¼ã€‚ 123456789CREATE TABLE users( id INT NOT NULL, first_name VARCHAR(20) NOT NULL, last_name VARCHAR(20) NOT NULL, age INT NOT NULL, PRIMARY KEY(id), KEY(last_name, first_name, age) KEY(first_name)); å¦‚æœä½¿ç”¨ä¸Šé¢çš„ SQL åœ¨æ•°æ®åº“ä¸­åˆ›å»ºä¸€å¼ è¡¨ï¼ŒB+ æ ‘å°±ä¼šä½¿ç”¨ id ä½œä¸ºç´¢å¼•çš„é”®ï¼Œå¹¶åœ¨å¶å­èŠ‚ç‚¹ä¸­å­˜å‚¨ä¸€æ¡è®°å½•ä¸­çš„æ‰€æœ‰ä¿¡æ¯ã€‚ èšé›†ç´¢å¼•ä¸è¡¨çš„ç‰©ç†å­˜å‚¨æ–¹å¼æœ‰ç€éå¸¸å¯†åˆ‡çš„å…³ç³»ï¼Œæ‰€æœ‰æ­£å¸¸çš„è¡¨åº”è¯¥æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªèšé›†ç´¢å¼•ï¼ˆç»å¤§å¤šæ•°æƒ…å†µä¸‹éƒ½æ˜¯ä¸»é”®ï¼‰ï¼Œè¡¨ä¸­çš„æ‰€æœ‰è¡Œè®°å½•æ•°æ®éƒ½æ˜¯æŒ‰ç…§èšé›†ç´¢å¼•çš„é¡ºåºå­˜æ”¾çš„ã€‚ è¾…åŠ©ç´¢å¼•è¾…åŠ©ç´¢å¼•ä¹Ÿæ˜¯é€šè¿‡ B+ æ ‘å®ç°çš„ï¼Œä½†æ˜¯å®ƒçš„å¶èŠ‚ç‚¹å¹¶ä¸åŒ…å«è¡Œè®°å½•çš„å…¨éƒ¨æ•°æ®ï¼Œä»…åŒ…å«ç´¢å¼•ä¸­çš„æ‰€æœ‰é”®å’Œä¸€ä¸ªç”¨äºæŸ¥æ‰¾å¯¹åº”è¡Œè®°å½•çš„ã€ä¹¦ç­¾ã€ï¼Œåœ¨ InnoDB ä¸­è¿™ä¸ªä¹¦ç­¾å°±æ˜¯å½“å‰è®°å½•çš„ä¸»é”®ã€‚ å¦‚æœåœ¨è¡¨ users ä¸­å­˜åœ¨ä¸€ä¸ªè¾…åŠ©ç´¢å¼• (first_name, age)ï¼Œé‚£ä¹ˆå®ƒæ„æˆçš„ B+ æ ‘å¤§è‡´å°±æ˜¯ä¸Šå›¾è¿™æ ·ï¼ŒæŒ‰ç…§ (first_name, age) çš„å­—æ¯é¡ºåºå¯¹è¡¨ä¸­çš„æ•°æ®è¿›è¡Œæ’åºï¼Œå½“æŸ¥æ‰¾åˆ°ä¸»é”®æ—¶ï¼Œå†é€šè¿‡èšé›†ç´¢å¼•è·å–åˆ°æ•´æ¡è¡Œè®°å½•ï¼š ä¸Šå›¾å±•ç¤ºäº†ä¸€ä¸ªä½¿ç”¨è¾…åŠ©ç´¢å¼•æŸ¥æ‰¾ä¸€æ¡è¡¨è®°å½•çš„è¿‡ç¨‹ï¼šé€šè¿‡è¾…åŠ©ç´¢å¼•æŸ¥æ‰¾åˆ°å¯¹åº”çš„ä¸»é”®ï¼Œæœ€ååœ¨èšé›†ç´¢å¼•ä¸­ä½¿ç”¨ä¸»é”®è·å–å¯¹åº”çš„è¡Œè®°å½•ï¼Œè¿™ä¹Ÿæ˜¯é€šå¸¸æƒ…å†µä¸‹è¡Œè®°å½•çš„æŸ¥æ‰¾æ–¹å¼ã€‚ Referenceã€æµ…å…¥æµ…å‡ºã€MySQL å’Œ InnoDB How do database indexes work? And, how do indexes help? Provide a tutorial on database indexes.","categories":[{"name":"æ•°æ®åº“","slug":"æ•°æ®åº“","permalink":"http://delaprada.com/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"}],"tags":[{"name":"æ•°æ®åº“","slug":"æ•°æ®åº“","permalink":"http://delaprada.com/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"}]},{"title":"å¾®ä¿¡å°ç¨‹åºç™»å½•é‰´æƒä¸è·å–ç”¨æˆ·ä¿¡æ¯","slug":"å¾®ä¿¡å°ç¨‹åºç™»å½•é‰´æƒä¸è·å–ç”¨æˆ·ä¿¡æ¯","date":"2021-01-26T00:29:21.000Z","updated":"2021-01-27T02:04:44.000Z","comments":true,"path":"2021/01/26/å¾®ä¿¡å°ç¨‹åºç™»å½•é‰´æƒä¸è·å–ç”¨æˆ·ä¿¡æ¯/","link":"","permalink":"http://delaprada.com/2021/01/26/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E7%99%BB%E5%BD%95%E9%89%B4%E6%9D%83%E4%B8%8E%E8%8E%B7%E5%8F%96%E7%94%A8%E6%88%B7%E4%BF%A1%E6%81%AF/","excerpt":"","text":"å‰è¨€åœ¨å°ç¨‹åºä¸­ï¼Œä¸äº‘å¼€å‘ç›¸æ¯”ï¼Œä¼ ç»Ÿçš„å‰åç«¯å¼€å‘åœ¨ç™»å½•é‰´æƒçš„å®ç°æ–¹é¢ç›¸å¯¹æ¥è¯´æ›´åŠ å¤æ‚ï¼Œä¸ä»…éœ€è¦å‰ç«¯å’Œåç«¯çš„äº¤äº’ï¼Œåç«¯è¿˜éœ€è¦ä¸å¾®ä¿¡æ¥å£æœåŠ¡è¿›è¡Œäº¤äº’ï¼Œä»¥å®Œæˆæ•´ä¸ªé‰´æƒæµç¨‹ï¼š æ•´ä¸ªæµç¨‹ç®€å•æ¥è¯´åˆ†ä¸ºä»¥ä¸‹7æ­¥ï¼š å‰ç«¯è°ƒç”¨wx.login()è·å–ä¸´æ—¶ç™»å½•å‡­è¯codeï¼Œå¹¶å›ä¼ åˆ°å¼€å‘è€…æœåŠ¡å™¨ã€‚ æœåŠ¡å™¨è°ƒç”¨auth.code2Sessionæ¢å–ç”¨æˆ·å”¯ä¸€æ ‡è¯†OpenIDå’Œä¼šè¯å¯†é’¥session_keyã€‚ æœåŠ¡å™¨ç«¯æ ¹æ®OpenIDæˆ–session_keyç”Ÿæˆè‡ªå®šä¹‰ç™»å½•æ€ï¼ˆå¯ä»¥ç†è§£ä¸ºæ˜¯tokenï¼‰ï¼Œå°†tokenå“åº”ç»™å‰ç«¯ã€‚ å‰ç«¯å°†tokenå­˜å…¥Storageä¸­ã€‚ å½“å‰ç«¯ä¹‹åå‘åç«¯å‘èµ·è¯·æ±‚æ—¶ï¼Œå°±ä¼šå¸¦ä¸Štokenã€‚ åå°é€šè¿‡tokenï¼ˆæˆ–è€…å…¶ä»–ç±»å‹å¯†é’¥ï¼‰ï¼Œè§£å¯†è·å–OpenIDï¼Œåˆ¤æ–­æ˜¯å“ªä¸ªç”¨æˆ·çš„è¡Œä¸ºï¼Œåšå‡ºå“åº”çš„é€»è¾‘å¤„ç†ï¼ˆæ¯”å¦‚æ“ä½œæ•°æ®åº“ç­‰ï¼‰ã€‚ åå°å“åº”æ•°æ®ç»™å‰ç«¯ã€‚ è¿™ä¸ªæ˜¯å°ç¨‹åºç™»å½•çš„æµç¨‹ï¼Œä½†æ˜¯å°ç¨‹åºç™»å½•å’Œå°ç¨‹åºè·å–ç”¨æˆ·ä¿¡æ¯å¹¶ä¸æ˜¯ä¸€å›äº‹ã€‚å°ç¨‹åºç™»å½•çš„APIæ˜¯wx.loginï¼Œå¯ä»¥è·å–ç”¨æˆ·çš„openIDï¼ŒopenIDæ˜¯ç”¨æˆ·çš„å”¯ä¸€æ ‡è¯†ï¼Œæ˜¯æ¯”è¾ƒéšç§çš„æ•°æ®ï¼Œä¸€èˆ¬ä¸ä¼šè¿”å›ç»™å‰ç«¯ã€‚å°ç¨‹åºè·å–ç”¨æˆ·ä¿¡æ¯çš„APIæ˜¯wx.getUserInfoï¼Œå®ƒå¯ä»¥è·å–ç”¨æˆ·çš„ä¸€äº›åŸºæœ¬ä¿¡æ¯ï¼Œæ¯”å¦‚nickNameã€avatarUrlç­‰ã€‚ä¸¤è€…ä¸è¦å¼„æ··ã€‚ å…¶å®å¾®ä¿¡ç™»å½•ä¸€å¼€å§‹å¹¶ä¸æ˜¯è¿™æ ·çš„ï¼Œä»¥å¾€å¾®ä¿¡å°ç¨‹åºåœ¨ç”¨æˆ·æ²¡æœ‰ä»»ä½•æ“ä½œçš„æƒ…å†µä¸‹å°±ä¼šç›´æ¥å¼¹å‡ºæˆæƒçš„ç™»å½•æ–¹å¼ï¼Œå¦‚æœç”¨æˆ·ç‚¹å‡»æ‹’ç»æˆæƒï¼Œåˆ™æ— æ³•ä½¿ç”¨å°ç¨‹åºã€‚æŒ‰ç…§å¾®ä¿¡å®˜æ–¹å¯¹è¿™ä¸ªåŠŸèƒ½æ›´æ–°çš„è§£é‡Šæ˜¯ï¼š å› æ­¤ï¼Œå¾®ä¿¡å¯¹å¼€å‘çš„å»ºè®®æ˜¯ï¼š å½“ç”¨æˆ·æ‰“å¼€å°ç¨‹åºæ—¶è®¿é—®ç¬¬ä¸€ä¸ªé¡µé¢æ—¶ï¼Œå…ˆé€šè¿‡wx.loginï¼Œè·å–ç”¨æˆ· openID ã€‚è¿™æ—¶æ— éœ€å¼¹æ¡†æˆæƒï¼Œå¼€å‘è€…æ‹¿åˆ° openID å¯ä»¥å»ºç«‹è‡ªèº«çš„å¸å·IDã€‚ åœ¨ç¬¬ä¸€æ­¥ä¸­ï¼Œæ‹¿åˆ° openID åï¼Œåˆ¤æ–­æ˜¯æ–°ç”¨æˆ·è¿˜æ˜¯è€ç”¨æˆ·ã€‚å¦‚æœæ˜¯è€ç”¨æˆ·ï¼Œå¯ä»¥ç›´æ¥ç™»å½•ï¼›å¦‚æœæ˜¯æ–°ç”¨æˆ·ï¼Œå¯å…ˆåœ¨å°ç¨‹åºé¦–é¡µå±•ç¤ºä½ çš„ä¿¡æ¯æœåŠ¡ï¼Œè®©ç”¨æˆ·å¯¹è¿™ä¸ªå°ç¨‹åºæœ‰å¤§æ¦‚çš„äº†è§£ï¼Œå†å¼•å¯¼ç”¨æˆ·è¿›è¡Œä¸‹ä¸€æ­¥çš„æ“ä½œã€‚ å½“éœ€è¦è·å–ç”¨æˆ·å¤´åƒæ˜µç§°çš„æ—¶å€™ï¼Œå¯¹ç”¨æˆ·å±•ç¤ºä¸€ä¸ªç™»å½•é¡µé¢ï¼Œè¿™ä¸ªé¡µé¢åªæœ‰ä¸€ä¸ªæœ€é‡è¦çš„æ“ä½œï¼Œå¼•å¯¼ç”¨æˆ·è¿›è¡Œç™»å½•ã€‚ å°ç¨‹åºç™»å½•åœ¨ä¸Šä¸€èŠ‚ä¸­æœ‰æåˆ°ï¼Œå°ç¨‹åºç™»å½•å¯ä»¥åˆ†ä¸º7ä¸ªæ­¥éª¤ï¼Œä¸‹é¢å°±è¯¦ç»†è®²ä¸€ä¸‹7ä¸ªæ­¥éª¤å…·ä½“æ˜¯å¦‚ä½•å®ç°ã€‚ step1: å‰ç«¯è°ƒç”¨wx.login()è·å–ä¸´æ—¶ç™»å½•å‡­è¯codeåœ¨é¡¹ç›®ä¸­ï¼Œæˆ‘ä½¿ç”¨äº†Taroæ¡†æ¶ï¼Œæ‰€ä»¥è°ƒç”¨çš„APIå¯¹åº”ä¸ºTaro.login()ï¼š 123456789101112131415161718192021222324252627Taro.login(&#123;&#125;) .then((res) =&gt; &#123; if (res.code) &#123; // å°†codeå‘é€åˆ°åå°ï¼Œä»¥è·å–token getToken(res.code) .then((res: any) =&gt; &#123; const &#123; token, userExist &#125; = res; // å°†tokenå­˜å‚¨åˆ°Storageä¸­ Taro.setStorageSync('token', token); // å¦‚æœæ˜¯è€ç”¨æˆ·ï¼Œè·å–ç”¨æˆ·ä¿¡æ¯ if(userExist) &#123; const &#123; userInfo &#125; = res; Taro.setStorageSync('userInfo', userInfo); &#125; &#125;) .catch((err) =&gt; &#123; console.error(err); &#125;); &#125; else &#123; console.log('ç™»å½•å¤±è´¥! ' + res.errMsg); &#125; &#125;) .catch((err) =&gt; &#123; console.error(err); &#125;); step2: æœåŠ¡ç«¯è°ƒç”¨auth.code2Sessionæ¢å–openidå’Œsession_keyæœåŠ¡ç«¯è°ƒç”¨å¤–éƒ¨æ¥å£éœ€è¦ä½¿ç”¨egg.jsä¸­çš„ä¸€ä¸ªapiï¼šthis.ctx.curlï¼Œå› ä¸ºæ˜¯å¼‚æ­¥è¯·æ±‚ï¼Œæ‰€ä»¥éœ€è¦åŠ ä¸Šawaitï¼š 123456789101112131415// app/controller/home.js// loginæ¥å£async login() &#123; const &#123; ctx &#125; = this; const &#123; code &#125; = ctx.request.body; // æœåŠ¡å™¨æ ¹æ®å®¢æˆ·ç«¯ä¼ æ¥çš„codeå‘å¾®ä¿¡æ¥å£æœåŠ¡è·å–session_keyå’Œopenid const res = await ctx.curl( `https://api.weixin.qq.com/sns/jscode2session? appid=wx6936c18b38186cf3&amp;secret=d11f77fb7d5a959b6ba46c30dbd4da95&amp;js_code=$&#123;code&#125;&amp;grant_type=authorization_code`, &#123; dataType: 'json', &#125; ); const &#123; openid &#125; = res.data; // è·å–åˆ°openid&#125; step3: æ ¹æ®openidç”Ÿæˆè‡ªå®šä¹‰ç™»å½•æ€tokenï¼Œå“åº”ç»™å‰ç«¯å› ä¸ºopenidæ˜¯ç”¨æˆ·çš„å”¯ä¸€æ ‡è¯†ï¼Œæ ¹æ®å®ƒç”Ÿæˆtokenï¼Œå“åº”ç»™å‰ç«¯åï¼Œå‰ç«¯æ¯æ¬¡å‘è¯·æ±‚å¸¦ä¸Štokenï¼Œåå°è§£å¯†è¯·æ±‚ä¸­çš„tokenï¼Œè·å–åˆ°openidï¼Œä¾¿èƒ½è¯†åˆ«è¿™æ˜¯å“ªä¸ªç”¨æˆ·çš„è¯·æ±‚è¡Œä¸ºã€‚ è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨jwtæ¥ç”Ÿæˆè‡ªå®šä¹‰ç™»å½•æ€tokenï¼Œä½¿ç”¨jwt-simpleåº“æ¥ç”Ÿæˆjwtï¼š 1234567891011121314151617const jwt = require('jwt-simple');const SECRET = 'zhuoran'; // è‡ªå®šä¹‰async login() &#123; ... const &#123; openid &#125; = res.data; // è·å–åˆ°openid // æ ¹æ®ç”¨æˆ·çš„openidç”Ÿæˆtoken const token = jwt.encode(openid, SECRET); // å°†tokenè¿”å› ctx.body = &#123; token: token, ... &#125;; ...&#125; step4: å‰ç«¯å°†tokenå­˜å…¥storage12// å°†tokenå­˜å‚¨åˆ°Storageä¸­Taro.setStorageSync('token', token); å¹¶åœ¨æ¯æ¬¡è¯·æ±‚æ—¶å¸¦ä¸Štokenï¼Œå°†tokenæ”¾åœ¨è¯·æ±‚å¤´çš„Authorizationå­—æ®µé‡Œé¢ï¼š 12345678910const option = &#123; url: BASE_URL + url, data: data, method: method, header: &#123; 'content-type': contentType, Authorization: Taro.getStorageSync('token'), &#125;,&#125;;Taro.request(option); è¿™æ ·å‰ç«¯ä¹‹åå‘åç«¯å‘èµ·è¯·æ±‚ï¼Œéƒ½ä¼šå¸¦ä¸Štokenã€‚ step5: åå°è§£å¯†tokenè·å–openidåœ¨åå°è§£å¯†tokenè·å–openidä¹‹åï¼Œä¾¿èƒ½çŸ¥é“è¿™æ˜¯å“ªä¸ªç”¨æˆ·çš„è¯·æ±‚ï¼Œæ‰§è¡Œå“åº”çš„æ“ä½œï¼š 12345678910111213141516171819async request() &#123; const &#123; ctx &#125; = this; // ä»è¯·æ±‚å¤´çš„authorizationå­—æ®µè·å–token const token = ctx.get('authorization'); // å¯¹tokenè¿›è¡Œè§£å¯†è·å–å…¶ä¸­çš„openid const openid = jwt.decode(token, SECRET); // æ ¹æ®openidæŸ¥æ‰¾ç”¨æˆ·ä¿¡æ¯ const res = await ctx.model.User.findAll(&#123; where: &#123; openid: openid, &#125;, &#125;); // ä¹‹åæ³¨æ„è¦å°†openidå±æ€§å»æ‰ï¼Œç§å¯†å±æ€§ä¸ä¼ å›ç»™å®¢æˆ·ç«¯ ctx.body = res;&#125; é¢å¤–éœ€è¦æ³¨æ„çš„ç‚¹ä¿å­˜ç”¨æˆ·ç™»å½•æ€ï¼Œä¸€ç›´ä»¥æ¥éƒ½æœ‰ä¸¤ç§è§£å†³æ–¹æ¡ˆï¼šå‰ç«¯ä¿å­˜å’Œåç«¯ä¿å­˜ã€‚ åç«¯ä¿å­˜ï¼šåœ¨åç«¯è®¾å®šå¹¶å­˜å‚¨å½“å‰tokençš„è¿‡æœŸæ—¶é—´ï¼Œå®šæœŸé€šçŸ¥å°ç¨‹åºå‰ç«¯é‡æ–°ç™»å½• å‰ç«¯ä¿å­˜ï¼šå› ä¸ºsession_keyå­˜åœ¨æ—¶æ•ˆæ€§ï¼ˆå› ä¸ºé€šè¿‡session_keyæˆ‘ä»¬å¯ä»¥æŸ¥çœ‹æ•æ„Ÿä¿¡æ¯ï¼Œæ‰€ä»¥å¿…å®šä¼šæœ‰ä¸€å®šçš„æ—¶æ•ˆæ€§ï¼‰ï¼Œè€Œå°ç¨‹åºå‰ç«¯å¯ä»¥é€šè¿‡wx.checkSession()æ¥æ£€æŸ¥session_keyæ˜¯å¦è¿‡æœŸã€‚æˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰ç™»å½•æ€ï¼Œå¹¶è€ƒè™‘ä»¥session_keyæœ‰æ•ˆæœŸä½œä¸ºè‡ªèº«ç™»å½•æ€æœ‰æ•ˆæœŸï¼ˆä¹Ÿå°±æ˜¯ä»¥session_keyçš„åˆ°æœŸæ—¶é—´ä½œä¸ºè‡ªå®šä¹‰ç™»å½•æ€çš„åˆ°æœŸæ—¶é—´ï¼Œä¸¤è€…å®é™…ä¸Šå¹¶æ²¡æœ‰å®è´¨è”ç³»ï¼‰ã€‚è¿™ä¸ªä¹Ÿæ˜¯å°ç¨‹åºæ–‡æ¡£ä¸­æ¨èçš„æ–¹æ³•ã€‚ å› æ­¤ï¼Œåœ¨é¡¹ç›®ä¸­tokenæ˜¯ä¼šè¿‡æœŸçš„ï¼Œä¸€æ®µæ—¶é—´æ²¡æœ‰ä½¿ç”¨å°±ä¼šå¯¼è‡´å®ƒè¿‡æœŸã€‚é‚£æ€ä¹ˆå»æ£€éªŒtokenæ˜¯å¦è¿‡æœŸï¼Œç„¶åå»æ›´æ–°å®ƒå‘¢ï¼Ÿ è¿™é‡Œå°±éœ€è¦ç”¨åˆ°å‰ç«¯æ‹¦æˆªå™¨å’Œåç«¯ä¸­é—´ä»¶ã€‚å‰ç«¯æ‹¦æˆªå™¨ç”¨æ¥åˆ¤æ–­tokenæ˜¯å¦è¿‡æœŸï¼Œåç«¯ä¸­é—´ä»¶ç”¨äºåˆ¤æ–­è¯·æ±‚æ˜¯å¦æºå¸¦tokenä»¥åŠtokenæ˜¯å¦æœ‰æ•ˆã€‚ å‰ç«¯æ‹¦æˆªå™¨è¿™é‡Œä¼šä½¿ç”¨åˆ°Taroæ‹¦æˆªå™¨APIï¼šTaro.addInterceptor(callback)ã€‚æ‹¦æˆªå™¨å…è®¸æˆ‘ä»¬åœ¨è¯·æ±‚å‘å‡ºå‰æˆ–å‘å‡ºååšä¸€äº›é¢å¤–æ“ä½œã€‚ ä¾‹å¦‚ï¼š 123456789101112131415const interceptor = function (chain) &#123; // æ‹¦æˆªè¯·æ±‚å‘å‡ºå‰åšä¸€äº›é¢å¤–æ“ä½œ const requestParams = chain.requestParams const &#123; method, data, url &#125; = requestParams console.log(`http $&#123;method || 'GET'&#125; --&gt; $&#123;url&#125; data: `, data) return chain.proceed(requestParams) .then(res =&gt; &#123; // æ‹¦æˆªè¯·æ±‚å‘å‡ºååšä¸€äº›é¢å¤–æ“ä½œ console.log(`http &lt;-- $&#123;url&#125; result:`, res) return res &#125;) &#125;Taro.addInterceptor(interceptor) æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥å°†checkSessionæ­¥éª¤å†™åœ¨å‰ç«¯æ‹¦æˆªå™¨é‡Œï¼Œåœ¨è¯·æ±‚æ¯æ¬¡å‘å‡ºä¹‹å‰åˆ¤æ–­session_keyæ˜¯å¦æœ‰è¿‡æœŸï¼Œå¦‚æœè¿‡æœŸäº†ï¼Œåˆ™é‡æ–°è°ƒç”¨loginæ–¹æ³•ï¼Œæ›´æ–°tokenï¼Œå¦‚æœæ²¡æœ‰è¿‡æœŸï¼Œåˆ™æ­£å¸¸å‘èµ·è¯·æ±‚ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283// loginæ–¹æ³•const login = () =&gt; &#123; Taro.login(&#123;&#125;) .then((res) =&gt; &#123; if (res.code) &#123; console.log('codeä¸º' + res.code); // å°†codeå’ŒuserInfoå‘é€åˆ°åå°ï¼Œä»¥è·å–token getToken(res.code) .then((token) =&gt; &#123; console.log('è·å–token'); console.log(token); // å°†tokenå­˜å‚¨åˆ°Storageä¸­ Taro.setStorageSync('token', token); &#125;) .catch((err) =&gt; &#123; console.error(err); &#125;); &#125; else &#123; console.log('ç™»å½•å¤±è´¥! ' + res.errMsg); &#125; &#125;) .catch((err) =&gt; &#123; console.error(err); &#125;);&#125;;// è‡ªå®šä¹‰æ‹¦æˆªå™¨const customInterceptor = (chain) =&gt; &#123; const requestParams = chain.requestParams; // è·å–token const loginFlag = Taro.getStorageSync('token'); // æ£€æŸ¥sessionæ˜¯å¦è¿‡æœŸ Taro.checkSession(&#123;&#125;) .then((res) =&gt; &#123; console.log(res); console.log('sessionæ²¡è¿‡æœŸï¼Œä¸ç”¨é‡æ–°ç™»å½•'); console.log('tokenä¸º' + loginFlag); &#125;) .catch((err) =&gt; &#123; console.log(err); console.log('sessionå·²è¿‡æœŸï¼Œè¦é‡æ–°ç™»å½•'); // é‡æ–°ç™»å½• login(); &#125;); return chain.proceed(requestParams).then((res) =&gt; &#123; // åªè¦è¯·æ±‚æˆåŠŸï¼Œä¸ç®¡è¿”å›ä»€ä¹ˆçŠ¶æ€ç ï¼Œéƒ½èµ°è¿™ä¸ªå›è°ƒ switch (res.statusCode) &#123; case HTTP_STATUS.NOT_FOUND: return Promise.reject('è¯·æ±‚èµ„æºä¸å­˜åœ¨'); case HTTP_STATUS.BAD_GATEWAY: return Promise.reject('æœåŠ¡ç«¯å‡ºç°äº†é—®é¢˜'); case HTTP_STATUS.FORBIDDEN: &#123; Taro.setStorageSync('Authorization', ''); // pageToLogin(); // TODO æ ¹æ®è‡ªèº«ä¸šåŠ¡ä¿®æ”¹ return Promise.reject('æ²¡æœ‰æƒé™è®¿é—®'); &#125; case HTTP_STATUS.AUTHENTICATE: &#123; Taro.setStorageSync('Authorization', ''); // pageToLogin(); return Promise.reject('éœ€è¦é‰´æƒ'); &#125; case HTTP_STATUS.SUCCESS: return res.data; &#125; &#125;);&#125;;// Taro æä¾›äº†ä¸¤ä¸ªå†…ç½®æ‹¦æˆªå™¨// logInterceptor - ç”¨äºæ‰“å°è¯·æ±‚çš„ç›¸å…³ä¿¡æ¯// timeoutInterceptor - åœ¨è¯·æ±‚è¶…æ—¶æ—¶æŠ›å‡ºé”™è¯¯ã€‚const interceptors = [ customInterceptor, Taro.interceptors.logInterceptor,];export default interceptors; åç«¯ä¸­é—´ä»¶æ­£å¦‚ä¹‹å‰æ‰€è¿°ï¼Œåç«¯ä¸­é—´ä»¶çš„ä½œç”¨æ˜¯ç”¨æˆ·åˆ¤æ–­è¯·æ±‚æ˜¯å¦æºå¸¦tokenä»¥åŠtokenæ˜¯å¦æœ‰æ•ˆçš„ã€‚æˆ‘ä»¬åœ¨egg Node.jsåç«¯é¡¹ç›®ä¸­å®šä¹‰æ ¡éªŒtokençš„ä¸­é—´ä»¶ï¼š 1234567891011121314151617181920212223242526272829// app/middleware/auth.jslet jwt = require('jwt-simple');const SECRET = 'zhuoran';module.exports = (options) =&gt; &#123; return async function auth(ctx, next) &#123; const token = ctx.get('authorization'); if (token) &#123; console.log('è¯·æ±‚å¸¦æœ‰token'); try &#123; const openid = jwt.decode(token, SECRET); await next(); &#125; catch (err) &#123; ctx.body = &#123; code: 401, msg: 'tokenæœ‰è¯¯', &#125;; &#125; &#125; else &#123; console.log('è¯·æ±‚æ²¡æœ‰å¸¦token'); ctx.body = &#123; code: 401, msg: 'æ‚¨æ²¡æœ‰ç™»å½•', &#125;; &#125; &#125;;&#125;; å› ä¸ºå°ç¨‹åºä¸­ï¼Œæœ‰äº›åŠŸèƒ½ä¸å¼ºåˆ¶è¦æ±‚ç”¨æˆ·ç™»å½•ä¹‹åæ‰èƒ½ä½¿ç”¨ï¼Œæ‰€ä»¥æœ‰äº›è¯·æ±‚æ“ä½œä¸éœ€è¦åå°æ ¡éªŒæ˜¯å¦æœ‰tokenï¼Œé‚£ä¹ˆè¿™ä¸ªauth.jsä¸­é—´ä»¶å°±ä¸èƒ½å¤Ÿå…¨å±€é…ç½®ï¼Œè€Œæ˜¯æ”¾åœ¨éœ€è¦æ ¡éªŒtokençš„è·¯ç”±ä¸‹ï¼š 123456789module.exports = (app) =&gt; &#123; const &#123; router, controller, middleware &#125; = app; const auth = middleware.auth(); router.get('/', controller.home.index); router.get('/request', auth, controller.home.request); // å°†middlewareæ”¾åœ¨ä¸­é—´ router.post('/login', controller.home.login); router.post('/userInfo', controller.home.userInfo);&#125;; ç™»å½•é‰´æƒåŠè·å¾—ç”¨æˆ·ä¿¡æ¯æµç¨‹æ¢³ç†ç™»å½•ï¼š è·å–ç”¨æˆ·ä¿¡æ¯ï¼š æ€»ç»“ç›¸å¯¹äºäº‘å¼€å‘æ¥è¯´ï¼Œä¼ ç»Ÿçš„å‰åç«¯å¼€å‘åœ¨ç™»å½•é‰´æƒæ–¹é¢å¤æ‚è®¸å¤šï¼Œæ¶‰åŠå¤šç«¯äº¤äº’ï¼Œä»¥ä¸Šæ€»ç»“ä¹Ÿæœ‰è®¸å¤šè¦æ”¹è¿›çš„åœ°æ–¹ã€‚æ€»è€Œè¨€ä¹‹ï¼Œå°†é€»è¾‘ç†é¡ºä¹‹åï¼Œå†™ä»£ç å°±æ¯”è¾ƒç®€å•äº†ã€‚ åœ¨ç™»å½•é‰´æƒè¿‡ç¨‹ä¸­æ¯”è¾ƒé‡è¦çš„ç‚¹ï¼š çŸ¥é“ä»€ä¹ˆæ˜¯ç”¨æˆ·çš„å”¯ä¸€æ ‡è¯†ï¼Œå¹¶æ ¹æ®å®ƒç”Ÿæˆtoken å¯¹tokenè¿›è¡Œæ ¡éªŒï¼Œåˆ¤æ–­å…¶æ˜¯å¦è¿‡æœŸï¼Œæ˜¯å¦å‡†ç¡® é€šè¿‡ç”»æµç¨‹å›¾ç­‰æ–¹å¼ç†æ¸…å„ä¸ªè¿‡ç¨‹çš„é€»è¾‘ å‚è€ƒä½¿ç”¨Nodejså®ç°jwtåŸç† æ‰‹æŠŠæ‰‹æ•™ä¼šä½ å°ç¨‹åºç™»å½•é‰´æƒ å°ç¨‹åºç™»å½•é‚£äº›äº‹ å°ç¨‹åºï¼šæˆæƒã€ç™»å½•ã€session_keyã€unionId å¾®ä¿¡å°ç¨‹åºwx.getUserInfoæˆæƒè·å–ç”¨æˆ·ä¿¡æ¯ï¼ˆå¤´åƒã€æ˜µç§°ï¼‰ å‰åç«¯åˆ†ç¦»é¡¹ç›®ï¼Œtokenè¿‡æœŸï¼Œé‡æ–°ç™»å½•å’Œåˆ·æ–°tokençš„é—®é¢˜ eggä¸­é—´ä»¶åŒ¹é…è·¯ç”± Taroå¾®ä¿¡å°ç¨‹åºç™»å½• Buttonç»„ä»¶onGetUserInfoæœªæ‰§è¡Œ","categories":[{"name":"å°ç¨‹åº","slug":"å°ç¨‹åº","permalink":"http://delaprada.com/categories/%E5%B0%8F%E7%A8%8B%E5%BA%8F/"}],"tags":[{"name":"å°ç¨‹åº","slug":"å°ç¨‹åº","permalink":"http://delaprada.com/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F/"}]},{"title":"egg.js+react SSRå®è·µ","slug":"egg-js-react-SSRå®è·µ","date":"2021-01-19T13:06:48.000Z","updated":"2021-03-18T02:20:20.000Z","comments":true,"path":"2021/01/19/egg-js-react-SSRå®è·µ/","link":"","permalink":"http://delaprada.com/2021/01/19/egg-js-react-SSR%E5%AE%9E%E8%B7%B5/","excerpt":"","text":"å‰è¨€æœ€è¿‘åœ¨åšæ¯•è®¾çš„è°ƒç ”ï¼Œæƒ³å­¦ä¸€ä¸‹å¦‚ä½•ç”¨nodeè¿›è¡Œåå°å¼€å‘ï¼Œé€‰æ‹©çš„åå°æ¡†æ¶æ˜¯é˜¿é‡Œçš„egg.jsï¼Œç»“åˆmysqlæ•°æ®åº“ã€DBeaveræ•°æ®åº“ç®¡ç†å·¥å…·å’ŒSequelizeå®ç°CRUDæ“ä½œã€‚ åŸºç¡€åŠŸèƒ½é¦–å…ˆä»‹ç»ä¸€ä¸‹eggåˆå§‹åŒ–ç”Ÿæˆçš„é¡¹ç›®å„ä¸ªéƒ¨åˆ†çš„åŠŸèƒ½ã€‚ ä¸€ä¸ªeggé¡¹ç›®ç›®å½•ç»„æˆå¤§è‡´å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637egg-projectâ”œâ”€â”€ package.jsonâ”œâ”€â”€ app.js (å¯é€‰)â”œâ”€â”€ agent.js (å¯é€‰)â”œâ”€â”€ app| â”œâ”€â”€ router.jsâ”‚ â”œâ”€â”€ controllerâ”‚ | â””â”€â”€ home.jsâ”‚ â”œâ”€â”€ service (å¯é€‰)â”‚ | â””â”€â”€ user.jsâ”‚ â”œâ”€â”€ middleware (å¯é€‰)â”‚ | â””â”€â”€ response_time.jsâ”‚ â”œâ”€â”€ schedule (å¯é€‰)â”‚ | â””â”€â”€ my_task.jsâ”‚ â”œâ”€â”€ public (å¯é€‰)â”‚ | â””â”€â”€ reset.cssâ”‚ â”œâ”€â”€ view (å¯é€‰)â”‚ | â””â”€â”€ home.tplâ”‚ â””â”€â”€ extend (å¯é€‰)â”‚ â”œâ”€â”€ helper.js (å¯é€‰)â”‚ â”œâ”€â”€ request.js (å¯é€‰)â”‚ â”œâ”€â”€ response.js (å¯é€‰)â”‚ â”œâ”€â”€ context.js (å¯é€‰)â”‚ â”œâ”€â”€ application.js (å¯é€‰)â”‚ â””â”€â”€ agent.js (å¯é€‰)â”œâ”€â”€ config| â”œâ”€â”€ plugin.js| â”œâ”€â”€ config.default.jsâ”‚ â”œâ”€â”€ config.prod.js| â”œâ”€â”€ config.test.js (å¯é€‰)| â”œâ”€â”€ config.local.js (å¯é€‰)| â””â”€â”€ config.unittest.js (å¯é€‰)â””â”€â”€ test â”œâ”€â”€ middleware | â””â”€â”€ response_time.test.js â””â”€â”€ controller â””â”€â”€ home.test.js app/router.jsç”¨äºé…ç½®URLè·¯ç”±è§„åˆ™ã€‚å³æè¿°è¯·æ±‚URLå’Œå…·ä½“æ‰¿æ‹…æ‰§è¡ŒåŠ¨ä½œçš„Controllerçš„å¯¹åº”å…³ç³»ã€‚ app/router.jsé‡Œé¢å®šä¹‰URLè·¯ç”±è§„åˆ™ï¼š 12345// app/router.jsmodule.exports = app =&gt; &#123; const &#123; router, controller &#125; = app; router.get('/user/:id', controller.user.info);&#125;; app/controllerç›®å½•ä¸‹é¢å®ç°Controllerï¼š 123456789// app/controller/user.jsclass UserController extends Controller &#123; async info() &#123; const &#123; ctx &#125; = this; ctx.body = &#123; name: `hello $&#123;ctx.params.id&#125;`, &#125;; &#125;&#125; å½“ç”¨æˆ·æ‰§è¡ŒGET /user/123ï¼Œuser.jsè¿™ä¸ªé‡Œé¢çš„infoæ–¹æ³•å°±ä¼šæ‰§è¡Œã€‚ ä¸€äº›è·¯ç”±å®šä¹‰æ–¹å¼ï¼š 123456789// app/router.jsmodule.exports = app =&gt; &#123; const &#123; router, controller &#125; = app; router.get('/home', controller.home); router.get('/user/:id', controller.user.page); router.post('/admin', isAdmin, controller.admin); router.post('/user', isLoginUser, hasAdminPermission, controller.user.create); router.post('/api/v1/comments', controller.v1.comments.create); // app/controller/v1/comments.js&#125;; RESTfulé£æ ¼çš„URLå®šä¹‰å¦‚æœæƒ³é€šè¿‡RESTfulçš„æ–¹å¼æ¥å®šä¹‰è·¯ç”±ï¼Œeggæä¾›äº†app.router.resources(&#39;routerName&#39;, &#39;pathMatch&#39;, controller)å¿«é€Ÿåœ¨ä¸€ä¸ªè·¯å¾„ä¸Šç”ŸæˆCRUDè·¯ç”±ç»“æ„ã€‚ 123456// app/router.jsmodule.exports = app =&gt; &#123; const &#123; router, controller &#125; = app; router.resources('posts', '/api/posts', controller.posts); router.resources('users', '/api/v1/users', controller.v1.users); // app/controller/v1/users.js&#125;; ä¸Šé¢ä»£ç å°±åœ¨ /posts è·¯å¾„ä¸Šéƒ¨ç½²äº†ä¸€ç»„ CRUD è·¯å¾„ç»“æ„ï¼Œå¯¹åº”çš„ Controller ä¸º app/controller/posts.js æ¥ä¸‹æ¥ï¼Œ ä½ åªéœ€è¦åœ¨ posts.js é‡Œé¢å®ç°å¯¹åº”çš„å‡½æ•°å°±å¯ä»¥äº†ã€‚ Method Path Route Name Controller.Action GET /posts posts app.controllers.posts.index GET /posts/new new_post app.controllers.posts.new GET /posts/:id post app.controllers.posts.show GET /posts/:id/edit edit_post app.controllers.posts.edit POST /posts posts app.controllers.posts.create PUT /posts/:id post app.controllers.posts.update DELETE /posts/:id post app.controllers.posts.destroy 1234567891011121314// app/controller/posts.jsexports.index = async () =&gt; &#123;&#125;;exports.new = async () =&gt; &#123;&#125;;exports.create = async () =&gt; &#123;&#125;;exports.show = async () =&gt; &#123;&#125;;exports.edit = async () =&gt; &#123;&#125;;exports.update = async () =&gt; &#123;&#125;;exports.destroy = async () =&gt; &#123;&#125;; å¦‚æœæˆ‘ä»¬ä¸éœ€è¦å…¶ä¸­çš„æŸå‡ ä¸ªæ–¹æ³•ï¼Œå¯ä»¥ä¸ç”¨åœ¨ posts.js é‡Œé¢å®ç°ï¼Œè¿™æ ·å¯¹åº” URL è·¯å¾„ä¹Ÿä¸ä¼šæ³¨å†Œåˆ° Routerã€‚ app/controller/**Controllerè´Ÿè´£è§£æç”¨æˆ·çš„è¾“å…¥ï¼Œå¤„ç†åè¿”å›ç›¸åº”çš„ç»“æœã€‚eggæ¨èControllerå±‚ä¸»è¦å¯¹ç”¨æˆ·çš„è¯·æ±‚å‚æ•°è¿›è¡Œå¤„ç†ï¼ˆæ ¡éªŒã€è½¬æ¢ï¼‰ï¼Œç„¶åè°ƒç”¨å¯¹åº”çš„serviceæ–¹æ³•å¤„ç†ä¸šåŠ¡ï¼Œå¾—åˆ°ä¸šåŠ¡ç»“æœåå°è£…å¹¶è¿”å›ã€‚ç®€å•æ¥è¯´ï¼ŒControlleræ˜¯æ¥å£ï¼Œè€Œå…·ä½“æ¶‰åŠåˆ°æ“ä½œè¡¨çš„äº‹æƒ…äº¤ç»™serviceæ¥åšã€‚ å¦‚ä½•ç¼–å†™Controlleræ‰€æœ‰çš„Controlleræ–‡ä»¶éƒ½å¿…é¡»æ”¾åœ¨app/controllerç›®å½•ä¸‹ï¼Œå¯ä»¥æ”¯æŒå¤šçº§ç›®å½•ï¼Œè®¿é—®çš„æ—¶å€™å¯ä»¥é€šè¿‡ç›®å½•åçº§è”è®¿é—®ã€‚ æ¨èä½¿ç”¨controllerç±»çš„æ–¹å¼ï¼š 12345678910111213141516171819202122// app/controller/post.jsconst Controller = require('egg').Controller;class PostController extends Controller &#123; async create() &#123; const &#123; ctx, service &#125; = this; const createRule = &#123; title: &#123; type: 'string' &#125;, content: &#123; type: 'string' &#125;, &#125;; // æ ¡éªŒå‚æ•° ctx.validate(createRule); // ç»„è£…å‚æ•° const author = ctx.session.userId; const req = Object.assign(ctx.request.body, &#123; author &#125;); // è°ƒç”¨ Service è¿›è¡Œä¸šåŠ¡å¤„ç† const res = await service.post.create(req); // è®¾ç½®å“åº”å†…å®¹å’Œå“åº”çŠ¶æ€ç  ctx.body = &#123; id: res.id &#125;; ctx.status = 201; &#125;&#125;module.exports = PostController; ä¸Šé¢çš„ä»£ç å®šä¹‰äº†ä¸€ä¸ªPostControllerçš„ç±»ï¼Œç±»é‡Œé¢çš„æ¯ä¸€ä¸ªæ–¹æ³•éƒ½å¯ä»¥ä½œä¸ºä¸€ä¸ªControlleråœ¨Routerä¸­å¼•ç”¨åˆ°ï¼Œæˆ‘ä»¬å¯ä»¥ä»app.controlleræ ¹æ®æ–‡ä»¶åå’Œæ–¹æ³•åå®šä½åˆ°å®ƒï¼š 12345// app/router.jsmodule.exports = app =&gt; &#123; const &#123; router, controller &#125; = app; router.post('createPost', '/api/posts', controller.post.create);&#125; Controller æ”¯æŒå¤šçº§ç›®å½•ï¼Œä¾‹å¦‚å¦‚æœæˆ‘ä»¬å°†ä¸Šé¢çš„ Controller ä»£ç æ”¾åˆ° app/controller/sub/post.js ä¸­ï¼Œåˆ™å¯ä»¥åœ¨ router ä¸­è¿™æ ·ä½¿ç”¨ï¼š 1234// app/router.jsmodule.exports = app =&gt; &#123; app.router.post('createPost', '/api/posts', app.controller.sub.post.create);&#125; é¡¹ç›®ä¸­çš„Controllerç±»ç»§æ‰¿äºegg.Controllerï¼Œä¼šæœ‰å‡ ä¸ªå±æ€§æŒ‚åœ¨thisä¸Šï¼š this.ctxï¼šå½“å‰è¯·æ±‚çš„ä¸Šä¸‹æ–‡Contextå¯¹è±¡çš„å®ä¾‹ï¼Œé€šè¿‡å®ƒæˆ‘ä»¬å¯ä»¥æ‹¿åˆ°æ¡†æ¶å°è£…å¥½çš„å¤„ç†å½“å‰è¯·æ±‚çš„å„ç§ä¾¿æ·å±æ€§å’Œæ–¹æ³•ã€‚ this.appï¼šå½“å‰åº”ç”¨Applicationå¯¹è±¡çš„å®ä¾‹ï¼Œé€šè¿‡å®ƒæˆ‘ä»¬å¯ä»¥æ‹¿åˆ°æ¡†æ¶æä¾›çš„å…¨å±€å¯¹è±¡å’Œæ–¹æ³•ã€‚ this.serviceï¼šåº”ç”¨å®šä¹‰çš„ Serviceï¼Œé€šè¿‡å®ƒæˆ‘ä»¬å¯ä»¥è®¿é—®åˆ°æŠ½è±¡å‡ºçš„ä¸šåŠ¡å±‚ï¼Œç­‰ä»·äº this.ctx.service ã€‚ this.configï¼šåº”ç”¨è¿è¡Œæ—¶çš„é…ç½®é¡¹ã€‚ this.loggerï¼šlogger å¯¹è±¡ã€‚ app/service/**ç”¨äºç¼–å†™ä¸šåŠ¡é€»è¾‘å±‚ï¼Œå¯é€‰ï¼Œå»ºè®®ä½¿ç”¨ã€‚Serviceå°±æ˜¯åœ¨å¤æ‚ä¸šåŠ¡åœºæ™¯ä¸‹ç”¨äºåšä¸šåŠ¡é€»è¾‘å°è£…çš„ä¸€ä¸ªæŠ½è±¡å±‚ï¼Œæä¾›è¿™ä¸ªæŠ½è±¡æœ‰ä»¥ä¸‹å‡ ä¸ªå¥½å¤„ï¼š ä¿æŒControllerä¸­çš„é€»è¾‘æ›´åŠ ç®€æ´ã€‚ ä¿æŒä¸šåŠ¡é€»è¾‘çš„ç‹¬ç«‹æ€§ï¼ŒæŠ½è±¡å‡ºæ¥çš„Serviceå¯ä»¥è¢«å¤šä¸ªControlleré‡å¤è°ƒç”¨ã€‚ ä¸‹é¢å°±é€šè¿‡ä¸€ä¸ªå®Œæ•´çš„ä¾‹å­ï¼Œçœ‹çœ‹æ€ä¹ˆä½¿ç”¨ Serviceã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748// app/router.jsmodule.exports = app =&gt; &#123; app.router.get('/user/:id', app.controller.user.info);&#125;;// app/controller/user.jsconst Controller = require('egg').Controller;class UserController extends Controller &#123; async info() &#123; const &#123; ctx &#125; = this; const userId = ctx.params.id; const userInfo = await ctx.service.user.find(userId); ctx.body = userInfo; &#125;&#125;module.exports = UserController;// app/service/user.jsconst Service = require('egg').Service;class UserService extends Service &#123; // é»˜è®¤ä¸éœ€è¦æä¾›æ„é€ å‡½æ•°ã€‚ // constructor(ctx) &#123; // super(ctx); å¦‚æœéœ€è¦åœ¨æ„é€ å‡½æ•°åšä¸€äº›å¤„ç†ï¼Œä¸€å®šè¦æœ‰è¿™å¥è¯ï¼Œæ‰èƒ½ä¿è¯åé¢ `this.ctx`çš„ä½¿ç”¨ã€‚ // // å°±å¯ä»¥ç›´æ¥é€šè¿‡ this.ctx è·å– ctx äº† // // è¿˜å¯ä»¥ç›´æ¥é€šè¿‡ this.app è·å– app äº† // &#125; async find(uid) &#123; // å‡å¦‚ æˆ‘ä»¬æ‹¿åˆ°ç”¨æˆ· id ä»æ•°æ®åº“è·å–ç”¨æˆ·è¯¦ç»†ä¿¡æ¯ const user = await this.ctx.db.query('select * from user where uid = ?', uid); // å‡å®šè¿™é‡Œè¿˜æœ‰ä¸€äº›å¤æ‚çš„è®¡ç®—ï¼Œç„¶åè¿”å›éœ€è¦çš„ä¿¡æ¯ã€‚ const picture = await this.getPicture(uid); return &#123; name: user.user_name, age: user.age, picture, &#125;; &#125; async getPicture(uid) &#123; const result = await this.ctx.curl(`http://photoserver/uid=$&#123;uid&#125;`, &#123; dataType: 'json' &#125;); return result.data; &#125;&#125;module.exports = UserService;// curl http://127.0.0.1:7001/user/1234 config/config.default.jsç”¨äºç¼–å†™é…ç½®æ–‡ä»¶ã€‚ ç¤ºä¾‹ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253const path = require('path');module.exports = (app) =&gt; &#123; /** * built-in config * @type &#123;Egg.EggAppConfig&#125; **/ const config = (exports = &#123;&#125;); // use for cookie sign key, should change to your own and keep security config.keys = app.name + '_1610862343048_2407'; // add your middleware config here config.middleware = []; // add your user config here const userConfig = &#123; // myAppName: 'egg', &#125;; config.static = &#123; prefix: '/public/', dir: path.join(app.baseDir, 'public'), &#125;; // é…ç½®å’Œssrç›¸å…³é¡¹ config.reactssr = &#123; layout: path.join(app.baseDir, 'app/view/layout.html'), &#125;; // é…ç½®sequelizeï¼Œä¸mysqlæ•°æ®æºè¿æ¥ config.sequelize = &#123; dialect: 'mysql', host: 'localhost', port: 3306, database: 'eggtest', username: 'root', password: '*****', &#125;; // ä¸è¿›è¡Œcsrfæ”»å‡»æ£€æµ‹ï¼Œä½¿ç”¨postmanæ—¶éœ€è¦é…ç½® config.security = &#123; csrf: &#123; enable: false, &#125;, &#125;; return &#123; ...config, ...userConfig, &#125;;&#125;; config/plugin.jsç”¨äºé…ç½®éœ€è¦åŠ è½½çš„æ’ä»¶ã€‚ 123456789101112// plugin.jsexports.static = true;exports.reactssr = &#123; enable: true, package: 'egg-view-react-ssr',&#125;;exports.sequelize = &#123; enable: true, package: 'egg-sequelize',&#125;; 12345678910// plugin.local.jsexports.webpack = &#123; enable: true, package: 'egg-webpack',&#125;;exports.webpackreact = &#123; enable: true, package: 'egg-webpack-react',&#125;; app/model/**ç”¨äºæ”¾ç½®é¢†åŸŸæ¨¡å‹ï¼Œå¯é€‰ï¼Œç”±é¢†åŸŸç±»ç›¸å…³æ’ä»¶çº¦å®šï¼Œå¦‚ egg-sequelizeã€‚ å…¶ä½™é…ç½®è§eggå®˜ç½‘ä»‹ç»ï¼šç›®å½•ç»“æ„ã€‚ ç®€å•çš„CRUDåŠŸèƒ½çš„å®ç°é€šè¿‡ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬ç®€å•åœ°å®ç°ä¸€ä¸ªå‰ç«¯é€šè¿‡äº‹ä»¶å‘åå°å‘èµ·è¯·æ±‚ï¼Œåå°è¿›è¡Œå¤„ç†ï¼Œæ“ä½œæ•°æ®åº“ï¼Œç„¶åå“åº”ç»“æœçš„è¿‡ç¨‹ã€‚ MySQLä¸‹è½½åœ¨ç¼–ç ä¹‹å‰ï¼Œé¦–å…ˆè¦åœ¨æœ¬æœºä¸Šå®‰è£…å¥½MySQLï¼Œä¸‹è½½åœ°å€ï¼šMySQLã€‚è¦ä¸‹è½½å¤§çš„MSIç‰ˆæœ¬ï¼Œä¸è¦ä¸‹è½½zipï¼Œä¸‹è½½zipä¸€ç›´æ²¡æˆåŠŸã€‚ ä¸‹è½½å¥½MySQLä¹‹åï¼Œé…ç½®ç¯å¢ƒå˜é‡ï¼Œä½¿å¾—ç›´æ¥åœ¨cmdçš„æ ¹ç›®å½•ä¸‹è¾“å…¥mysqlæŒ‡ä»¤å¯ä»¥è¢«è¯†åˆ«ï¼Œå¦åˆ™æ¯æ¬¡éƒ½å¾—è¿›å…¥MySQLå®‰è£…åŒ…çš„binæ–‡ä»¶å¤¹ä¸‹cmdã€‚ DBeaverä¸‹è½½ä¸‹è½½DBeaverå®¢æˆ·ç«¯ï¼Œå¯¹MySQLæ•°æ®åº“è¿›è¡Œç®¡ç†ã€‚ åœ¨DBeaverä¸­å¯ä»¥é€šè¿‡æŒ‡ä»¤åˆ›å»ºè¡¨ï¼ŒæŸ¥çœ‹è¡¨ç›®å‰çš„æƒ…å†µï¼š å…³äºDBeaverè¿æ¥MySQLæ•°æ®åº“å¯å‚è€ƒæ–‡ç« ï¼šDBeaverè¿æ¥MySQLã€‚ åœ¨è¿æ¥è¿‡ç¨‹ä¸­ä¼šé‡åˆ°è¿™æ ·çš„é”™è¯¯ï¼š 1DBeaverè¿æ¥mysqlå¤±è´¥ï¼šUnable to load authentication plugin &#39;caching_sha2_password&#39;. è¿™ä¸ªæ˜¯å› ä¸ºï¼Œmysql8ä¹‹å‰çš„ç‰ˆæœ¬ä½¿ç”¨çš„å¯†ç åŠ å¯†è§„åˆ™æ˜¯mysql_native_passwordï¼Œä½†æ˜¯åœ¨mysql8åˆ™æ˜¯caching_sha2_passwordï¼Œæ‰€ä»¥éœ€è¦ä¿®æ”¹å¯†ç åŠ å¯†è§„åˆ™ã€‚ æ‰€ä»¥æ¥ä¸‹æ¥è¦åšçš„äº‹æƒ…å°±æ˜¯ä¿®æ”¹MySQLä½¿ç”¨çš„å¯†ç åŠ å¯†è§„åˆ™ã€‚ æ‰“å¼€cmdå¯¹è¯æ¡†ï¼Œè¾“å…¥mysql -u root -påå›è½¦ï¼Œç„¶åä¼šæç¤ºè¾“å…¥å¯†ç ï¼Œè¾“å…¥å¯†ç åå°±ä¼šè¿›å…¥MySQLçš„æ“ä½œç®¡ç†ç•Œé¢ã€‚ ä½¿ç”¨ use mysqlæ‰“å¼€æ•°æ®åº“ å’Œ select user,host,plugin from user; æŸ¥çœ‹ç”¨æˆ·ï¼Œä¸»æœºï¼Œæ’ä»¶ã€‚ æ¥ä¸‹æ¥å¼€å§‹ä¿®æ”¹é»˜è®¤æ’ä»¶alter user &#39;root&#39; @&#39;localhost&#39; identified with mysql_native_password by &#39;root&#39;; byåé¢è¾“å…¥å¯†ç ï¼Œå¯ä»¥é€šè¿‡è¯¥è¯­å¥ä¿®æ”¹å¯†ç ï¼Œè‹¥ä¸éœ€è¦ä¿®æ”¹å¯†ç åˆ™è¾“å…¥åŸæ¥çš„å¯†ç ã€‚ å†æ¬¡è¾“å…¥ select user,host,plugin from user; æŸ¥çœ‹ç”¨æˆ·ï¼Œä¸»æœºï¼Œæ’ä»¶ã€‚ åˆ°è¿™é‡Œå°±å¯ä»¥æ­£å¸¸è¿æ¥MySQLäº†ã€‚ Sequelizeå®‰è£…åŠé…ç½®å®‰è£…å¹¶é…ç½®egg-sequelizeæ’ä»¶ï¼ˆå®ƒä¼šè¾…åŠ©æˆ‘ä»¬å°†å®šä¹‰å¥½çš„ Model å¯¹è±¡åŠ è½½åˆ° app å’Œ ctx ä¸Šï¼‰å’Œ mysql2æ¨¡å—ï¼š 1npm install --save egg-sequelize mysql2 åœ¨ config/plugin.js ä¸­å¼•å…¥ egg-sequelize æ’ä»¶ï¼š 1234exports.sequelize = &#123; enable: true, package: 'egg-sequelize',&#125;; åœ¨ config/config.default.js ä¸­ç¼–å†™ sequelize é…ç½®ï¼š 12345678config.sequelize = &#123; dialect: 'mysql', host: 'localhost', port: 3306, database: 'eggtest', // æ•°æ®åº“åç§° username: 'root', password: '******',&#125;; åˆå§‹åŒ–æ•°æ®åº“æˆ‘ä»¬å¯ä»¥åœ¨MySQLåº”ç”¨å†…æˆ–è€…é€šè¿‡mysqlæŒ‡ä»¤åœ¨æœ¬åœ°åˆ›å»ºä¸€ä¸ªæ•°æ®åº“eggtestï¼š 12// mysqlæŒ‡ä»¤mysql -u root -e 'CREATE DATABASE IF NOT EXISTS `eggtest`;' å› ä¸ºDBeaverè¿æ¥MySQLæ—¶éœ€è¦è¿æ¥å·²ç»å­˜åœ¨çš„æ•°æ®åº“ï¼Œæ‰€ä»¥è¦åœ¨MySQLä¸­äº‹å…ˆåˆ›å»ºä¸€ä¸ªæ•°æ®åº“ã€‚ ç„¶åå†DBeaverä¸­é€šè¿‡æŒ‡ä»¤åˆ›å»ºuserè¡¨ï¼š 12345678910CREATE TABLE eggTest.`user` (`id` int(11) NOT NULL AUTO_INCREMENT,`username` varchar(100) DEFAULT NULL COMMENT 'å§“å',`age` INT(11) DEFAULT 0 COMMENT 'å¹´é¾„', PRIMARY KEY (`id`))ENGINE=InnoDBDEFAULT CHARSET=utf8mb4COLLATE=utf8mb4_0900_ai_ciCOMMENT='eggTestç”¨æˆ·ä¿¡æ¯'; ç„¶åæˆ‘ä»¬å°±å¯ä»¥åœ¨MySQLå’ŒDBeaverä¸­éƒ½çœ‹åˆ°è¿™ä¸ªæ–°å»ºçš„è¡¨äº†ã€‚ å®ŒæˆCRUDåŠŸèƒ½é¡¹ç›®ç›®å½•ï¼š config/plugin.jsï¼š 1234exports.sequelize = &#123; enable: true, package: 'egg-sequelize',&#125;; config/default.jsï¼š 123456789// æ·»åŠ æ•°æ®åº“é…ç½®config.sequelize = &#123; dialect: 'mysql', host: 'localhost', port: 3306, database: 'eggtest', username: 'root', password: '*******',&#125;; model/user.jsï¼š 123456789101112131415161718192021module.exports = (app) =&gt; &#123; const &#123; STRING, INTEGER &#125; = app.Sequelize; const user = app.model.define( 'user', &#123; id: &#123; type: INTEGER(11), primaryKey: true, &#125;, username: STRING(100), age: INTEGER(11), &#125;, &#123; freezeTableName: true, tableName: 'user', timestamps: false, underscored: true, &#125; ); return user;&#125;; controller/users.jsï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071const controller = require('egg').Controller;const toInt = function (str) &#123; if (typeof str === 'number') return str; if (!str) return str; return parseInt(str, 10) || 0;&#125;;class UserController extends controller &#123; /** * æ¥å£æè¿° * ç”¨æˆ·ç™»å½• * è¯·æ±‚æ–¹å¼ï¼špost * å‚æ•°ï¼š&#123; * usernameï¼šstring * age: int * &#125; */ // å±•ç¤ºæ‰€æœ‰ç”¨æˆ· async index() &#123; const &#123; ctx &#125; = this; const query = &#123; limit: toInt(ctx.query.limit), offset: toInt(ctx.query.offset) &#125;; ctx.body = await ctx.model.User.findAll(query); &#125; // å±•ç¤ºç”¨æˆ· async show() &#123; const &#123; ctx &#125; = this; ctx.body = await ctx.model.User.findByPk(toInt(ctx.params.id)); &#125; // åˆ›å»ºç”¨æˆ· async create() &#123; console.log('åˆ›å»ºç”¨æˆ·'); const &#123; ctx &#125; = this; const &#123; username, age &#125; = ctx.request.body; const user = await ctx.model.User.create(&#123; username, age &#125;); ctx.status = 201; ctx.body = user; &#125; // æ›´æ–°ç”¨æˆ· async update() &#123; const &#123; ctx &#125; = this; const id = toInt(ctx.params.id); const user = await ctx.model.User.findByPk(id); if(!user) &#123; ctx.status = 404; return; &#125; const &#123; age &#125; = ctx.request.body; await user.update(&#123; age &#125;); ctx.body = user; &#125; // åˆ é™¤ç”¨æˆ· async destroy() &#123; const &#123; ctx &#125; = this; const id = toInt(ctx.params.id); const user = await ctx.model.User.findByPk(id); if(!user) &#123; ctx.status = 404; return; &#125; await user.destroy(); ctx.status = 200; &#125;&#125;module.exports = UserController; router.jsï¼š 1234567module.exports = app =&gt; &#123; const &#123; router, controller &#125; = app; router.get('/', controller.home.server); router.get('/client', controller.home.client); router.resources('users', '/users', controller.users);&#125;; ä½¿ç”¨postmanè¿›è¡Œæµ‹è¯•ä½¿ç”¨postmanè¿›è¡Œæµ‹è¯•æ—¶æ³¨æ„è¦æŠŠeggçš„csrfæ£€æµ‹å…³æ‰ï¼š 123456// config/config.default.jsconfig.security = &#123; csrf: &#123; enable: false, &#125;,&#125;; æŸ¥è¯¢æ‰€æœ‰ç”¨æˆ·ï¼š æ ¹æ®idæŸ¥æ‰¾ï¼š æ–°å¢ç”¨æˆ·ï¼ˆæ³¨æ„è¯·æ±‚ä½“æ ¼å¼é€‰æ‹©x-www-form-urlencodedï¼‰ï¼š æ›´æ–°ç”¨æˆ·ä¿¡æ¯ï¼š åˆ é™¤ç”¨æˆ·ï¼š å‚è€ƒï¼šegg+sequelize+mysqlå®ç°CRUDæ“ä½œ ä¸å‰ç«¯å¯¹æ¥é¦–å…ˆå®‰è£…axioså’Œqsï¼š 1cnpm install axios qs åœ¨webç›®å½•ä¸‹æ–°å»ºapiæ–‡ä»¶å¤¹ï¼Œåœ¨config.jsæ–‡ä»¶ä¸­æ·»åŠ axiosåŸºç¡€é…ç½®ï¼Œåœ¨request.jsä¸­æ·»åŠ è¯·æ±‚æ–¹æ³•ï¼š 123456789101112131415161718192021222324// api/config.jsimport axios from 'axios';export const baseUrl = '/';const axiosInstance = axios.create(&#123; baseUrl: baseUrl, headers: &#123; post: &#123; 'Content-Type': 'application/x-www-form-urlencoded', &#125; &#125;&#125;);axiosInstance.interceptors.response.use( res =&gt; res.data, err =&gt; &#123; console.log(err, 'ç½‘ç»œé”™è¯¯'); &#125;);export &#123; axiosInstance,&#125;; 12345678910111213141516171819202122232425262728293031323334// api/request.jsimport &#123; axiosInstance &#125; from './config';import qs from 'qs';export const getAllUserRequest = () =&gt; &#123; return axiosInstance.get('/users');&#125;;export const searchUserRequest = (id) =&gt; &#123; return axiosInstance.get(`/users/$&#123;id&#125;`);&#125;;export const createUserRequest = (&#123; username, age &#125;) =&gt; &#123; return axiosInstance.post( '/users', qs.stringify(&#123; username, age, &#125;) );&#125;;export const updateUserRequest = (id, age) =&gt; &#123; return axiosInstance.put( `/users/$&#123;id&#125;`, qs.stringify(&#123; age, &#125;) );&#125;;export const deleteUserRequest = (id) =&gt; &#123; return axiosInstance.delete(`/users/$&#123;id&#125;`);&#125;; åœ¨ç»„ä»¶ä¸­å¼•å…¥è¯·æ±‚æ–¹æ³•ï¼Œå¹¶æ”¾åœ¨å¯¹åº”çš„äº‹ä»¶å¤„ç†å‡½æ•°ä¸­ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788import React, &#123; useEffect &#125; from 'react';// $&#123;root&#125;/app/web/component/layout.jsx é€šè¿‡ webpack alias é…ç½® componentimport Layout from '@component/layout.jsx';import &#123; getAllUserRequest, searchUserRequest, createUserRequest, updateUserRequest, deleteUserRequest,&#125; from '../../api/request';function HomeIndex(props) &#123; useEffect(() =&gt; &#123; console.log('----componentDidMount-----'); &#125;, []); const showAllUser = () =&gt; &#123; getAllUserRequest() .then((res) =&gt; &#123; console.log(res); &#125;) .catch((err) =&gt; &#123; console.error(err); &#125;); &#125;; const searchUser = (id) =&gt; &#123; searchUserRequest(id) .then((res) =&gt; &#123; console.log(res); &#125;) .catch((err) =&gt; &#123; console.error(err); &#125;); &#125;; const createUser = () =&gt; &#123; createUserRequest(&#123; username: 'bella', age: 18, &#125;) .then((res) =&gt; &#123; console.log(res); &#125;) .catch((err) =&gt; &#123; console.error(err); &#125;); &#125;; const updateUser = (id, age) =&gt; &#123; updateUserRequest(id, age) .then((res) =&gt; &#123; console.log(res); &#125;) .catch((err) =&gt; &#123; console.error(err); &#125;); &#125;; const deleteUser = (id) =&gt; &#123; deleteUserRequest(id) .then((res) =&gt; &#123; console.log(res); &#125;) .catch((err) =&gt; &#123; console.error(err); &#125;); &#125;; return ( &lt;div&gt; &lt;Layout title=\"egg-react-ssr\" keywords=\"alice\" description=\"easy task\"&gt; &lt;div className=\"main\"&gt; &lt;div className=\"page-container page-component\"&gt;&#123;props.message&#125;&lt;/div&gt; &lt;/div&gt; &lt;button onClick=&#123;showAllUser&#125;&gt;å±•ç¤ºæ‰€æœ‰ç”¨æˆ·&lt;/button&gt; &lt;button onClick=&#123;() =&gt; searchUser(1)&#125;&gt;æ ¹æ®idæœç´¢ç”¨æˆ·&lt;/button&gt; &lt;button onClick=&#123;createUser&#125;&gt;åˆ›å»ºç”¨æˆ·&lt;/button&gt; &lt;button onClick=&#123;() =&gt; updateUser(1, 19)&#125;&gt;æ›´æ–°ç”¨æˆ·ä¿¡æ¯&lt;/button&gt; &lt;button onClick=&#123;() =&gt; deleteUser(1)&#125;&gt;åˆ é™¤ç”¨æˆ·&lt;/button&gt; &lt;/Layout&gt; &lt;/div&gt; );&#125;export default HomeIndex; åœ¨å‰ç«¯é¡µé¢è§¦å‘ç‚¹å‡»äº‹ä»¶æ—¶ï¼Œå¯ä»¥å¾—åˆ°ç›¸åº”çš„ç»“æœï¼š åœ¨è¿™é‡Œï¼Œå¦ä¸€ä¸ªå¾ˆå…³é”®çš„ç‚¹æ˜¯webpack.config.jsçš„é…ç½®ï¼š 123456789101112131415161718const path = require('path');const fs = require('fs');const rootPath = fs.realpathSync(process.cwd());const resolve = (relativePath) =&gt; path.resolve(rootPath, relativePath);const projectPath = resolve('app/web');module.exports = &#123; devtool: 'source-map', entry: &#123; index: 'app/web/page/home/index.jsx', // å¿…é¡»æ˜¯jsxï¼Œå¦åˆ™å®¢æˆ·ç«¯æ¸²æŸ“æœ‰é—®é¢˜ &#125;, resolve: &#123; alias: &#123; '@': projectPath, // å­é¡¹ç›®æ ¹ç›®å½• '@component': path.resolve(projectPath, 'component'), &#125;, &#125;,&#125;; entryçš„é…ç½®å¿…é¡»æ˜¯jsxç»“å°¾çš„æ–‡ä»¶ï¼Œjsç»“å°¾çš„æ–‡ä»¶ä¼šå¯¼è‡´å®¢æˆ·ç«¯æ¸²æŸ“æœ‰é—®é¢˜ï¼ŒæœåŠ¡ç«¯çš„console.logä¹Ÿæ— æ³•æ­£å¸¸å±•ç¤ºã€‚ è¯¦æƒ…è§eggå®˜ç½‘å¯¹webpackçš„entryé…ç½®è§£é‡Šï¼šWebpackã€‚ é¡¹ç›®ä»“åº“åœ°å€ï¼šegg-react-ssr-exampleã€‚ å‚è€ƒEgg React SSR/CSR å·¥ç¨‹åŒ– Egg.jså¼€å‘æŒ‡å— Egg.js+vue å®æˆ˜é¡¹ç›®","categories":[{"name":"Node.js","slug":"Node-js","permalink":"http://delaprada.com/categories/Node-js/"}],"tags":[{"name":"Node.js","slug":"Node-js","permalink":"http://delaprada.com/tags/Node-js/"}]},{"title":"Taroå¾®ä¿¡å°ç¨‹åºäº‘å¼€å‘å®è·µ","slug":"Taroå¾®ä¿¡å°ç¨‹åºäº‘å¼€å‘å®è·µ","date":"2021-01-16T06:32:08.000Z","updated":"2021-01-17T02:48:48.000Z","comments":true,"path":"2021/01/16/Taroå¾®ä¿¡å°ç¨‹åºäº‘å¼€å‘å®è·µ/","link":"","permalink":"http://delaprada.com/2021/01/16/Taro%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E4%BA%91%E5%BC%80%E5%8F%91%E5%AE%9E%E8%B7%B5/","excerpt":"","text":"å‰è¨€äº‘å¼€å‘ç®€è€Œè¨€ä¹‹å°±æ˜¯ï¼šå¼€å‘è€…æ— éœ€æ­å»ºæœåŠ¡å™¨ï¼Œå¯å…é‰´æƒç›´æ¥ä½¿ç”¨å¹³å°æä¾›çš„APIè¿›è¡Œä¸šåŠ¡å¼€å‘ã€‚ äº‘å¼€å‘æä¾›äº‘å‡½æ•°ï¼Œäº‘æ•°æ®åº“å’Œäº‘å­˜å‚¨ï¼ŒæœåŠ¡ç«¯çš„éƒ¨ç½²å’Œæ‰˜ç®¡éƒ½äº¤ç”±è…¾è®¯äº‘æ¥ç®¡ç†ï¼Œå¼€å‘è€…å°±æ— éœ€åœ¨è¿ç»´å’Œç®¡ç†ä¸ŠæŠ•å…¥è¿‡å¤šçš„ç²¾åŠ›ã€‚ å°ç¨‹åºä¼ ç»Ÿå¼€å‘æ¨¡å¼ï¼š å°ç¨‹åºäº‘å¼€å‘ï¼š äº‘å‡½æ•°ï¼šnode.js äº‘æ•°æ®åº“ï¼šMongoDB ä¼ ç»Ÿå¼€å‘ vs äº‘å¼€å‘ï¼š ï¼ˆserverlessæŒ‡çš„æ˜¯ï¼šæˆ‘ä»¬æ— éœ€è€ƒè™‘ç¡¬ä»¶ç­‰åŸºç¡€è®¾æ–½ï¼Œæ˜¯æ— æœåŠ¡çš„åº”ç”¨ï¼Œæˆ‘ä»¬ä¾èµ–çš„æ˜¯åƒè…¾è®¯äº‘è¿™æ ·çš„äº‘æœåŠ¡å•†æä¾›çš„æœåŠ¡ï¼‰ äº‘å¼€å‘æƒ³è¦åœ¨å°ç¨‹åºä¸­å®ç°äº‘å¼€å‘ï¼Œé¦–å…ˆåœ¨å¯¼å…¥é¡¹ç›®æ—¶è¦å¡«å…¥æ³¨å†Œçš„APPIDï¼Œå¿…é¡»å¡«å†™ï¼Œå¦åˆ™æ— æ³•ä½¿ç”¨äº‘å¼€å‘åŠŸèƒ½ã€‚ æ— è®ºæ˜¯ä½¿ç”¨å¾®ä¿¡åˆ›å»ºä¸€ä¸ªäº‘å¼€å‘é¡¹ç›®è¿˜æ˜¯ä½¿ç”¨taro cliåˆå§‹åŒ–ä¸€ä¸ªäº‘å¼€å‘é¡¹ç›®ï¼Œæ ¹ç›®å½•ä¸‹éƒ½ä¼šæœ‰ä¸€ä¸ªproject.config.jsonæ–‡ä»¶ï¼Œæ–‡ä»¶ä¸­çš„cloudbaseRootç”¨äºæŒ‡å®šå­˜æ”¾äº‘å‡½æ•°&amp;äº‘æ‰˜ç®¡çš„ç›®å½•ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œäº‘å¼€å‘èƒ½åŠ›ä»åŸºç¡€åº“2.2.4å¼€å§‹æ”¯æŒã€‚ äº‘å¼€å‘åœ¨é»˜è®¤é…é¢ä¸‹å¯ä»¥åˆ›å»ºä¸¤ä¸ªç¯å¢ƒï¼Œå„ä¸ªç¯å¢ƒç›¸äº’éš”ç¦»ï¼Œæ¯ä¸ªç¯å¢ƒéƒ½åŒ…å«ç‹¬ç«‹çš„æ•°æ®åº“å®ä¾‹ã€å­˜å‚¨ç©ºé—´ã€äº‘å‡½æ•°é…ç½®ç­‰èµ„æºï¼š å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œæˆ‘åˆ›å»ºäº†ä¸¤ä¸ªç¯å¢ƒï¼Œä¸€ä¸ªå«devï¼Œ ä¸€ä¸ªå«test-taroã€‚ åœ¨é¡¹ç›®ä¸­ï¼Œéœ€è¦ä¸ºé¡¹ç›®é…ç½®å¼€å‘çš„ç¯å¢ƒï¼Œå¦åˆ™é»˜è®¤éƒ½æ˜¯æŒ‡å®šç¬¬ä¸€ä¸ªåˆ›å»ºçš„ç¯å¢ƒã€‚ æ¯”å¦‚åœ¨taroäº‘å¼€å‘é¡¹ç›®ä¸­ï¼Œéœ€åœ¨app.jsä¸­é…ç½®é¡¹ç›®ç¯å¢ƒï¼š 1234567componentDidMount () &#123; if (process.env.TARO_ENV === 'weapp') &#123; Taro.cloud.init(&#123; env: 'test-taro-1gs4sohn82c1ff34' // ç¯å¢ƒid &#125;) &#125;&#125; å¾®ä¿¡åŸç”Ÿçš„äº‘å¼€å‘é¡¹ç›®ä¸­ï¼Œåˆ™åœ¨onLaunchæ–¹æ³•ä¸­é…ç½®ï¼š 12345678910111213141516onLaunch: function () &#123; if (!wx.cloud) &#123; console.error('è¯·ä½¿ç”¨ 2.2.3 æˆ–ä»¥ä¸Šçš„åŸºç¡€åº“ä»¥ä½¿ç”¨äº‘èƒ½åŠ›') &#125; else &#123; wx.cloud.init(&#123; // env å‚æ•°è¯´æ˜ï¼š // env å‚æ•°å†³å®šæ¥ä¸‹æ¥å°ç¨‹åºå‘èµ·çš„äº‘å¼€å‘è°ƒç”¨ï¼ˆwx.cloud.xxxï¼‰ä¼šé»˜è®¤è¯·æ±‚åˆ°å“ªä¸ªäº‘ç¯å¢ƒçš„èµ„æº // æ­¤å¤„è¯·å¡«å…¥ç¯å¢ƒ ID, ç¯å¢ƒ ID å¯æ‰“å¼€äº‘æ§åˆ¶å°æŸ¥çœ‹ // å¦‚ä¸å¡«åˆ™ä½¿ç”¨é»˜è®¤ç¯å¢ƒï¼ˆç¬¬ä¸€ä¸ªåˆ›å»ºçš„ç¯å¢ƒï¼‰ // env: 'my-env-id', traceUser: true, &#125;) &#125; this.globalData = &#123;&#125;&#125; äº‘å‡½æ•°å¤„å¯é€šè¿‡å³é”®åˆ‡æ¢äº‘å‡½æ•°çš„å½“å‰ç¯å¢ƒï¼š æ³¨æ„ï¼šåœ¨å°ç¨‹åºç«¯é…ç½®initæ—¶çš„envåªä¼šå†³å®šå°ç¨‹åºç«¯APIè°ƒç”¨çš„äº‘ç¯å¢ƒï¼Œå¹¶ä¸ä¼šå†³å®šäº‘å‡½æ•°ä¸­APIè°ƒç”¨çš„ç¯å¢ƒï¼Œäº‘å‡½æ•°ä¸­éœ€è¦é€šè¿‡wx-server-sdkçš„initæ–¹æ³•é‡æ–°è®¾ç½®ç¯å¢ƒï¼ˆæˆ–è€…ä½¿ç”¨ä¸Šé¢çš„æ–¹é¢ï¼‰ã€‚ 123wx.cloud.init(&#123; env: 'test-x1dzi'&#125;) äº‘æ•°æ®åº“äº‘æ•°æ®åº“æ˜¯ä¸€ä¸ªJSONæ•°æ®åº“ï¼Œæ•°æ®åº“ä¸­çš„æ¯æ¡è®°å½•éƒ½æ˜¯ä¸€ä¸ªJSONæ ¼å¼çš„å¯¹è±¡ã€‚ ä¸€ä¸ªæ•°æ®åº“å¯ä»¥æœ‰å¤šä¸ªé›†åˆï¼ˆç›¸å½“äºå…³ç³»å‹æ•°æ®åº“ä¸­çš„è¡¨ï¼‰ï¼Œé›†åˆå¯ä»¥çœ‹ä½œä¸€ä¸ªJSONæ•°ç»„ï¼Œæ•°ç»„ä¸­çš„æ¯ä¸ªå¯¹è±¡å°±æ˜¯ä¸€æ¡è®°å½•ï¼Œè®°å½•çš„æ ¼å¼æ˜¯JSONå¯¹è±¡ã€‚ é€šè¿‡åœ¨äº‘å¼€å‘ç•Œé¢ç‚¹å‡»+åˆ›å»ºæ–°çš„é›†åˆï¼š æ•°æ®åº“çš„APIåˆ†ä¸ºå°ç¨‹åºç«¯å’ŒæœåŠ¡ç«¯ä¸¤ä¸ªéƒ¨åˆ†ï¼š å°ç¨‹åºç«¯APIï¼šæ‹¥æœ‰ä¸¥æ ¼çš„è°ƒç”¨æƒé™æ§åˆ¶ï¼Œå¼€å‘è€…å¯åœ¨å°ç¨‹åºå†…ç›´æ¥è°ƒç”¨APIè¿›è¡Œéæ•æ„Ÿæ•°æ®çš„æ“ä½œã€‚ æœåŠ¡ç«¯ï¼šå¯¹äºæœ‰æ›´é«˜å®‰å…¨è¦æ±‚çš„æ•°æ®ï¼Œå¯åœ¨äº‘å‡½æ•°å†…é€šè¿‡æœåŠ¡ç«¯APIè¿›è¡Œæ“ä½œã€‚äº‘å‡½æ•°çš„ç¯å¢ƒæ˜¯ä¸å®¢æˆ·ç«¯å®Œå…¨éš”ç¦»çš„ï¼Œåœ¨äº‘å‡½æ•°ä¸Šå¯ä»¥ç§å¯†ä¸”å®‰å…¨åœ°æ“ä½œæ•°æ®åº“ã€‚ åœ¨å¾®ä¿¡åŸç”Ÿé¡¹ç›®ä¸­ï¼š 12345678910111213141516// å°ç¨‹åºç«¯æ“ä½œæ•°æ®åº“// äº‘æ•°æ®åº“const db = wx.cloud.database();// å‘useré›†åˆæ·»åŠ æ•°æ®db.collection('user').add(&#123; data: &#123; name: \"jerry\", age: \"22\" &#125; &#125;).then(res =&gt; &#123; console.log(res); &#125;).catch(err =&gt; &#123; console.log(err); &#125;) 1234567// æœåŠ¡ç«¯æ“ä½œæ•°æ®åº“const cloud = require('wx-server-sdk');const db = cloud.database();// ç„¶åå†è¿›è¡Œæ•°æ®åº“æ“ä½œ// ... taroé¡¹ç›®ä¸­ï¼š 1234567891011121314151617// å°ç¨‹åºç«¯æ“ä½œæ•°æ®åº“const db = Taro.cloud.database();// å‘useré›†åˆæ·»åŠ æ•°æ®db.collection('user') .add(&#123; data: &#123; name: 'alice', age: '26', &#125;, &#125;) .then(res =&gt; &#123; console.log(res); &#125;) .catch(err =&gt; &#123; console.error(err); &#125;); 12345678// åœ¨äº‘å‡½æ•°å†…// äº‘å‡½æ•°å…¥å£æ–‡ä»¶const cloud = require(\"wx-server-sdk\");const db = cloud.database();// ç„¶åå†è¿›è¡Œæ•°æ®åº“æ“ä½œ// ... äº‘å‡½æ•°äº‘å‡½æ•°æ˜¯ä¸€æ®µè¿è¡Œåœ¨äº‘ç«¯çš„ä»£ç ï¼Œç›¸å½“äºæœåŠ¡ç«¯çš„ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨äº‘å‡½æ•°ä¸­æ“ä½œæ•°æ®åº“ã€ç®¡ç†äº‘æ–‡ä»¶ã€è°ƒç”¨å…¶ä»–äº‘å‡½æ•°ç­‰æ“ä½œã€‚ äº‘å‡½æ•°å¿…é¡»è¦è¿›è¡Œéƒ¨ç½²æ‰èƒ½ç”Ÿæ•ˆï¼Œéƒ¨ç½²æ–¹å¼ï¼š å³é”®ç‚¹å‡»å‡½æ•°æ–‡ä»¶å¤¹ï¼Œé€‰æ‹©ä¸Šä¼ å¹¶éƒ¨ç½²ï¼ˆäº‘ç«¯å®‰è£…ä¾èµ–ï¼Œä¸ä¸Šä¼ node_modulesï¼‰ã€‚ å¦‚æœé‡åˆ°ä»¥ä¸‹é—®é¢˜ï¼š 1cloudTest.weapp.jsx:86 Error: errCode: -404011 cloud function execution error | errMsg: cloud.callFunction:fail requestID 7ac9328a-579d-11eb-9459-5254006d699d, cloud function service error code -504002, error message Error: errCode: -1 unknown error | err å°è¯•é‡æ–°ä¸Šä¼ å¹¶éƒ¨ç½²ï¼Œè¿‡ä¸€ä¼šä¾¿ç”Ÿæ•ˆäº†ã€‚ æ¯”å¦‚æˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªaddäº‘å‡½æ•°ï¼š 1234567891011121314// index.js æ˜¯å…¥å£æ–‡ä»¶ï¼Œäº‘å‡½æ•°è¢«è°ƒç”¨æ—¶ä¼šæ‰§è¡Œè¯¥æ–‡ä»¶å¯¼å‡ºçš„ main æ–¹æ³•// event åŒ…å«äº†è°ƒç”¨ç«¯ï¼ˆå°ç¨‹åºç«¯ï¼‰è°ƒç”¨è¯¥å‡½æ•°æ—¶ä¼ è¿‡æ¥çš„å‚æ•°ï¼ŒåŒæ—¶è¿˜åŒ…å«äº†å¯ä»¥é€šè¿‡ getWXContext æ–¹æ³•è·å–çš„ç”¨æˆ·ç™»å½•æ€ `openId` å’Œå°ç¨‹åº `appId` ä¿¡æ¯const cloud = require('wx-server-sdk')exports.main = async (event, context) =&gt; &#123; let &#123; userInfo, a, b&#125; = event let &#123; OPENID, APPID &#125; = cloud.getWXContext() // è¿™é‡Œè·å–åˆ°çš„ openId å’Œ appId æ˜¯å¯ä¿¡çš„ let sum = a + b return &#123; OPENID, APPID, sum &#125;&#125; åœ¨å¼€å‘è€…å·¥å…·ä¸­ä¸Šä¼ å¹¶éƒ¨ç½²äº‘å‡½æ•°åï¼Œæˆ‘ä»¬åœ¨å°ç¨‹åºä¸­å¯ä»¥ä½¿ç”¨callFunctionæ–¹æ³•è°ƒç”¨ï¼š 12345678910111213141516171819wx.cloud.callFunction(&#123; // éœ€è°ƒç”¨çš„äº‘å‡½æ•°å name: 'add', // ä¼ ç»™äº‘å‡½æ•°çš„å‚æ•° data: &#123; a: 12, b: 19, &#125;, // æˆåŠŸå›è°ƒ complete: console.log&#125;)// å½“ç„¶ promise æ–¹å¼ä¹Ÿæ˜¯æ”¯æŒçš„wx.cloud.callFunction(&#123; name: 'add', data: &#123; a: 12, b: 19 &#125;&#125;).then(console.log) æœ¬åœ°è°ƒè¯•äº‘å¼€å‘æä¾›äº†äº‘å‡½æ•°æœ¬åœ°è°ƒè¯•çš„åŠŸèƒ½ï¼Œå¼€å‘è€…å¯ä»¥åœ¨æœ¬åœ°å¯¹äº‘å‡½æ•°è¿›è¡Œæ–­ç‚¹è°ƒè¯•ã€‚ ä¸ä½¿ç”¨æœ¬åœ°è°ƒè¯•å’Œä½¿ç”¨æœ¬åœ°è°ƒè¯•åœ¨è°ƒè¯•æµç¨‹ä¸Šçš„åŒºåˆ«ï¼š ä¸ä½¿ç”¨æœ¬åœ°è°ƒè¯•ï¼šæœ¬åœ°ä¿®æ”¹ä»£ç  â€”&gt; ä¸Šä¼ éƒ¨ç½²äº‘å‡½æ•° â€”&gt; è°ƒç”¨ã€‚ ä½¿ç”¨æœ¬åœ°è°ƒè¯•ï¼šæœ¬åœ°ä¿®æ”¹ â€”&gt; è°ƒç”¨ã€‚æ— éœ€ä¸Šä¼ ç­‰å¾…çš„æ­¥éª¤ã€‚ å¦‚ä½•è¿›è¡Œæœ¬åœ°è°ƒè¯•ï¼Ÿ è¿›è¡Œæœ¬åœ°è°ƒè¯•çš„äº‘å‡½æ•°é¦–å…ˆè¦æ‰§è¡Œcloud.initæ­¥éª¤ï¼Œåœ¨å…¶ä¸­æŒ‡å®šäº‘å‡½æ•°çš„ç¯å¢ƒï¼š 123cloud.init(&#123; env: 'test-taro-1gs4sohn82c1ff34'&#125;); å¦‚æœäº‘å‡½æ•°ä¸­æœ‰ä½¿ç”¨åˆ°npmæ¨¡å—ï¼Œéœ€åœ¨äº‘å‡½æ•°æœ¬åœ°ç›®å½•å®‰è£…ç›¸åº”ä¾èµ–æ‰å¯æ­£å¸¸ä½¿ç”¨äº‘å‡½æ•°æœ¬åœ°è°ƒç”¨åŠŸèƒ½ã€‚æ‰€ä»¥å¦‚æœåœ¨å¼€å¯æœ¬åœ°è°ƒè¯•çš„è¿‡ç¨‹ä¸­ï¼Œæœ‰ç›¸å…³çš„è­¦å‘Šï¼Œåˆ™æ£€æŸ¥ä¸€ä¸‹æ˜¯å¦æœ‰å®‰è£…ä¾èµ–ã€‚ äº‘å‡½æ•°ä¸­ä¸€èˆ¬éƒ½ä¼šç”¨åˆ°wx-server-sdkè¿™ä¸ªnpmåŒ…ï¼Œæ‰€ä»¥åº”è¯¥éƒ½è¦åœ¨æœ¬åœ°è°ƒè¯•ä¹‹å‰å®‰è£…ä¾èµ–ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚ é¦–å…ˆé€‰ä¸­æƒ³è¦è¿›è¡Œæœ¬åœ°è°ƒè¯•çš„äº‘å‡½æ•°ï¼Œå³é”®é€‰æ‹©å¼€å¯äº‘å‡½æ•°æœ¬åœ°è°ƒè¯•ã€‚ sourceç›®å½•ä¸‹å¯ä»¥çœ‹åˆ°äº‘å‡½æ•°å¯¹åº”çš„æºä»£ç ï¼Œå¯ä»¥åœ¨ä»£ç é‡Œæ·»åŠ æ–­ç‚¹ã€‚ æ¯”å¦‚å½“å‰æˆ‘æµ‹è¯•çš„å‡½æ•°æ˜¯batchï¼Œå½“æˆ‘åœ¨å°ç¨‹åºé¡µé¢ç‚¹å‡»æ‰¹é‡åˆ é™¤æŒ‰é’®æ—¶ï¼Œè°ƒè¯•ä¾¿å¼€å¯ã€‚æˆ‘ä»¬å¯ä»¥æ§åˆ¶æ€ä¹ˆæ‰§è¡Œä¸‹ä¸€æ­¥æ¥çœ‹æ•´ä¸ªå‡½æ•°æ‰§è¡Œçš„è¿‡ç¨‹ã€‚ä¹Ÿå¯ä»¥åœ¨consoleé¡µçœ‹åˆ°ç›¸åº”çš„è¾“å‡ºç»“æœ äº‘ç«¯æµ‹è¯•é™¤äº†æœ¬åœ°è°ƒè¯•ä»¥å¤–ï¼Œè¿˜èƒ½å¤Ÿæ‰§è¡Œäº‘ç«¯æµ‹è¯•ï¼Œåœ¨äº‘å¼€å‘å¹³å°å¯¹äº‘å‡½æ•°è¿›è¡Œæµ‹è¯•ï¼š åœ¨å…¶ä¸­è¾“å…¥å‚æ•°ï¼Œè¿è¡Œæµ‹è¯•ï¼Œå¯ä»¥åœ¨å¼€å‘è€…å·¥å…·çš„è°ƒè¯•å™¨ä¸­çœ‹åˆ°æ‰§è¡Œç»“æœã€‚ äº‘å­˜å‚¨ç®€å•æ¥è¯´ï¼š äº‘å­˜å‚¨ï¼šæä¾›å­˜å‚¨èƒ½åŠ›ï¼Œæ›´å¤šé¢å¯¹çš„åœºæ™¯æ˜¯éç»“æ„åŒ–æ•°æ®ï¼Œå¦‚æ–‡ä»¶ã€å›¾ç‰‡ã€è§†é¢‘ç­‰ã€‚ äº‘æ•°æ®åº“ï¼šæä¾›åŸºç¡€çš„æ•°æ®åº“å’Œæ•°æ®å¯¹è±¡ç®¡ç†èƒ½åŠ›ï¼ŒåŒ…æ‹¬oracleã€mysqlã€sqlã€serverç­‰å…³ç³»å‹æ•°æ®åº“ï¼Œä¹Ÿå¯ä»¥åŒ…æ‹¬ç±»ä¼¼mongodbã€hbaseç­‰åŠç»“æ„åŒ–æ•°æ®åº“ã€‚ æ‰€ä»¥ï¼Œå¦‚æœæˆ‘ä»¬è¦ä¸Šä¼ ä¸€äº›å›¾ç‰‡çš„è¯ï¼Œæˆ‘ä»¬éœ€è¦å°†å…¶å­˜å‚¨åˆ°äº‘å­˜å‚¨ä¸­ï¼Œå¹¶åœ¨æ•°æ®åº“ä¸­è®°å½•å›¾ç‰‡åœ¨äº‘å­˜å‚¨ä¸­çš„è·¯å¾„ã€‚ä¹‹åæƒ³è¦å±•ç¤ºè¿™äº›å›¾ç‰‡æ—¶ï¼Œä¾¿å¯ä»¥ä»æ•°æ®åº“ä¸­æ‰¾åˆ°è®°å½•ï¼Œå°†å›¾ç‰‡å±•ç¤ºå‡ºæ¥ã€‚ äº‘å­˜å‚¨çš„APIåŒ…æ‹¬ï¼š uploadFile downloadFile deleteFile getTempFileURL æ€»ç»“å®è·µä»£ç ä»“åº“åœ°å€ï¼šwechat-miniprogram-cloud","categories":[{"name":"å°ç¨‹åº","slug":"å°ç¨‹åº","permalink":"http://delaprada.com/categories/%E5%B0%8F%E7%A8%8B%E5%BA%8F/"}],"tags":[{"name":"å°ç¨‹åº","slug":"å°ç¨‹åº","permalink":"http://delaprada.com/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F/"}]},{"title":"Taroå…¥é—¨åŠè¸©å‘ä¹‹æ—…","slug":"Taroå…¥é—¨åŠè¸©å‘ä¹‹æ—…","date":"2021-01-12T13:33:41.000Z","updated":"2021-01-13T10:51:24.000Z","comments":true,"path":"2021/01/12/Taroå…¥é—¨åŠè¸©å‘ä¹‹æ—…/","link":"","permalink":"http://delaprada.com/2021/01/12/Taro%E5%85%A5%E9%97%A8%E5%8F%8A%E8%B8%A9%E5%9D%91%E4%B9%8B%E6%97%85/","excerpt":"","text":"å‰è¨€å› æœ€è¿‘å¼€å§‹å‡†å¤‡æ¯•è®¾ï¼Œæˆ‘çš„æ¯•è®¾æ˜¯è¦åšä¸€ä¸ªå°ç¨‹åºï¼Œä¾¿å¼€å§‹äº†å­¦ä¹ å¦‚ä½•å¼€å‘å°ç¨‹åºä¹‹æ—…ã€‚ Taroæ˜¯ä¸€ä¸ªå¼€æ”¾å¼è·¨ç«¯è·¨æ¡†æ¶çš„è§£å†³æ–¹æ¡ˆï¼Œæ”¯æŒä½¿ç”¨React/Vue/Nervç­‰æ¡†æ¶æ¥å¼€å‘å¾®ä¿¡ã€äº¬ä¸œã€ç™¾åº¦ã€æ”¯ä»˜å®ã€å­—èŠ‚è·³åŠ¨ã€QQå°ç¨‹åº / H5ç­‰åº”ç”¨ã€‚ æ‰€ä»¥ï¼Œä½¿ç”¨Taroçš„è¯ï¼Œåªéœ€ç¼–å†™ä¸€å¥—ä»£ç å°±èƒ½å¤Ÿæ‹¥æœ‰é€‚é…åˆ°å¤šç«¯çš„èƒ½åŠ›ã€‚Taroç›®å‰åœ¨githubä¸Š æœ‰27.9kä¸ªstarï¼Œè¿™ä¹Ÿæ˜¯æˆ‘é€‰æ‹©å­¦ä¹ å®ƒçš„ä¸€ä¸ªåŸå› ã€‚ï¼ˆè™½ç„¶æ•´ä¸ªåšä¸‹æ¥ä¹‹åå‘ç°å®ƒçš„æ•™ç¨‹å‘å®åœ¨æ˜¯å¤šâ€¦â€¦ï¼‰ é‚£å°±å¼€å§‹å§ã€‚ å®˜æ–¹æ–‡æ¡£ï¼šTaroå®˜æ–¹æ–‡æ¡£ å…¥é—¨å› ä¸ºæœ‰ä¸€å®šå‰ç«¯å¼€å‘ç»éªŒï¼Œæ‰€ä»¥æˆ‘ç›´æ¥ä»æ¸è¿›å¼å…¥é—¨æ•™ç¨‹ç€æ‰‹ï¼Œé€šè¿‡å®æ“ä¸€æ­¥æ­¥ä¸Šæ‰‹ã€‚ æ¸è¿›å¼å…¥é—¨æ•™ç¨‹ æ¸è¿›å¼å…¥é—¨æ•™ç¨‹æºç  æ¸è¿›å¼å…¥é—¨æ•™ç¨‹æ˜¯ä½¿ç”¨Taroå¼€å‘ä¸€ä¸ªç®€å•çš„V2EXè®ºå›å®¢æˆ·ç«¯ï¼Œæ•´ä¸ªæ•™ç¨‹åˆ†ä¸º4ä¸ªéƒ¨åˆ†ï¼š ç¯å¢ƒå‡†å¤‡ åŸºç¡€æ•™ç¨‹ é¡¹ç›®è¿›é˜¶ä¸ä¼˜åŒ– å¤šç«¯å¼€å‘ è¿™é‡Œå°±å±•å¼€ä¸€äº›æ•™ç¨‹ä¸­æ²¡æœ‰æåˆ°çš„ç‚¹å’Œæ€»ç»“å…¶ä¸­æ¯”è¾ƒå…³é”®çš„ç‚¹ã€‚ ç¯å¢ƒå‡†å¤‡ä½¿ç”¨Taroå¼€å‘éœ€è¦å®‰è£…ï¼š Taro CLI Node.js Taro CLIå®‰è£…æŒ‡ä»¤ï¼š 1npm i -g @tarojs&#x2F;cli å®‰è£…å®Œæ¯•ååœ¨ç»ˆç«¯è¾“å…¥taroï¼Œå¦‚æœå‡ºç°ç±»ä¼¼å†…å®¹è¯´æ˜å®‰è£…æˆåŠŸï¼š 123456789101112131415161718ğŸ‘½ Taro v3.0.0-beta.6Usage: taro &lt;command&gt; [options]Options: -V, --version output the version number -h, --help output usage informationCommands: init [projectName] Init a project with default templete config &lt;cmd&gt; Taro config create Create page for project build Build a project with options update Update packages of taro convert Convert weapp to taro info Diagnostics Taro env info doctor Diagnose taro project help [cmd] display help for [cmd] åŸºç¡€æ•™ç¨‹ç»„ä»¶åœ¨å°ç¨‹åºä¸­ï¼Œç»„ä»¶åˆ†ä¸ºé¡µé¢ç»„ä»¶å’ŒåŸºç¡€ç»„ä»¶ã€‚é¡µé¢ç»„ä»¶å°±æ˜¯é‚£äº›å¯ä»¥é€šè¿‡è·¯ç”±è·³è½¬åˆ°æŒ‡å®šé¡µé¢çš„ç»„ä»¶ï¼Œå…·æœ‰ç”Ÿå‘½å‘¨æœŸï¼ŒåŸºç¡€ç»„ä»¶å°±æ˜¯ä¸€äº›æ™®é€šç»„ä»¶ï¼Œä¸æ„æˆé¡µé¢ï¼Œæ˜¯é¡µé¢æˆ–è€…ç»„ä»¶çš„ä¸€éƒ¨åˆ†ã€‚ é¡µé¢ç»„ä»¶é¡µé¢ç»„ä»¶ä¸€èˆ¬åœ¨pagesæ–‡ä»¶å¤¹ä¸‹å®šä¹‰ï¼š ä»¥thread_detailç»„ä»¶ä¸¾ä¾‹ï¼Œè¯¥æ–‡ä»¶å¤¹ä¸‹æœ‰ä¸‰ä¸ªæ–‡ä»¶ï¼š index.cssï¼šæ ·å¼æ–‡ä»¶ thread_detail.tsxï¼šç»„ä»¶ thread_detail.config.tsï¼šé¡µé¢ç»„ä»¶é…ç½®æ–‡ä»¶ é…ç½®æ–‡ä»¶ä¸»è¦æ˜¯é…ç½®ä¸€äº›åŸºç¡€æ ·å¼å’Œæ–‡å­—ï¼Œé¡µé¢é…ç½®ï¼Œæ¯”å¦‚ï¼š 1234backgroundTextStyle: &#39;light&#39;,navigationBarBackgroundColor: &#39;#fff&#39;,navigationBarTitleText: &#39;WeChat&#39;,navigationBarTextStyle: &#39;black&#39; åœ¨thread_detail.config.tsä¸­æ˜¯è¿™æ ·ï¼š 123export default &#123; navigationBarTitleText: &#39;è¯é¢˜&#39;&#125; è¿™ä¸ªé…ç½®æ–‡ä»¶æ˜¯å¿…é¡»è¦å†™çš„ï¼Œå¦åˆ™åœ¨é¡¹ç›®æ‰“åŒ…ç¼–è¯‘å°±ä¼šæŠ¥å¦‚ä¸‹é”™è¯¯ï¼š 1Module not found: Canâ€˜t resolve â€˜.&#x2F;pages&#x2F;xxx&#x2F;xxx.configâ€˜ in â€˜xxxxâ€˜ è¿™é‡Œè¦æ³¨æ„ä¸€ä¸‹ã€‚ ç±»ç»„ä»¶ï¼š 12345678910111213141516171819202122232425262728293031import React, &#123; Component &#125; from 'react'import &#123; View &#125; from '@tarojs/components'class Index extends Component &#123; // å¯ä»¥ä½¿ç”¨æ‰€æœ‰çš„ React ç»„ä»¶æ–¹æ³• componentDidMount () &#123;&#125; // onLoad onLoad () &#123;&#125; // onReady onReady () &#123;&#125; // å¯¹åº” onShow componentDidShow () &#123;&#125; // å¯¹åº” onHide componentDidHide () &#123;&#125; // å¯¹åº” onPullDownRefreshï¼Œé™¤äº† componentDidShow/componentDidHide ä¹‹å¤–ï¼Œ // æ‰€æœ‰é¡µé¢ç”Ÿå‘½å‘¨æœŸå‡½æ•°åéƒ½ä¸å°ç¨‹åºç›¸å¯¹åº” onPullDownRefresh () &#123;&#125; render () &#123; return ( &lt;View className='index' /&gt; ) &#125;&#125;export default Index å‡½æ•°ç»„ä»¶ï¼š 1234567891011121314151617181920212223242526272829303132import React, &#123; useEffect &#125; from 'react'import &#123; View &#125; from '@tarojs/components'import &#123; useReady, useDidShow, useDidHide, usePullDownRefresh&#125; from '@tarojs/taro'function Index () &#123; // å¯ä»¥ä½¿ç”¨æ‰€æœ‰çš„ React Hooks useEffect(() =&gt; &#123;&#125;) // å¯¹åº” onReady useReady(() =&gt; &#123;&#125;) // å¯¹åº” onShow useDidShow(() =&gt; &#123;&#125;) // å¯¹åº” onHide useDidHide(() =&gt; &#123;&#125;) // Taro å¯¹æ‰€æœ‰å°ç¨‹åºé¡µé¢ç”Ÿå‘½å‘¨æœŸéƒ½å®ç°äº†å¯¹åº”çš„è‡ªå®šä¹‰ React Hooks è¿›è¡Œæ”¯æŒ // è¯¦æƒ…å¯æŸ¥é˜…ï¼šã€Taro æ–‡æ¡£ã€‘-&gt; ã€è¿›é˜¶æŒ‡å—ã€‘-&gt;ã€Hooksã€‘ usePullDownRefresh(() =&gt; &#123;&#125;) return ( &lt;View className='index' /&gt; )&#125;export default Index åŸºç¡€ç»„ä»¶åŸºç¡€ç»„ä»¶ä¸€èˆ¬åœ¨componentsæ–‡ä»¶å¤¹ä¸‹å®šä¹‰ï¼š è¿™é‡Œå°±ä¸éœ€è¦ä¸ºæ¯ä¸ªç»„ä»¶è®¾ç½®é…ç½®æ–‡ä»¶ã€‚ å…¥å£é…ç½®app.config.tså°±æ˜¯å…¥å£é…ç½®æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å…¶ä¸­é…ç½®é¡µé¢è·¯å¾„åˆ—è¡¨ã€å…¨å±€çš„é»˜è®¤çª—å£è¡¨ç°ç­‰å±æ€§ã€‚Taroçš„é…ç½®è§„èŒƒæ˜¯åŸºäºå¾®ä¿¡å°ç¨‹åºçš„å…¨å±€é…ç½®è¿›è¡Œè§„å®šçš„ï¼šå¾®ä¿¡å°ç¨‹åºå…¨å±€é…ç½®ã€‚ åœ¨V2EXé¡¹ç›®ä¸­ï¼Œå…¨å±€é…ç½®ä¸ºï¼š 1234567891011121314151617181920212223242526272829303132333435363738// app.config.tsexport default &#123; pages: [ 'pages/index/index', 'pages/nodes/nodes', 'pages/hot/hot', 'pages/node_detail/node_detail', 'pages/thread_detail/thread_detail', ], tabBar: &#123; list: [&#123; 'iconPath': 'resource/latest.png', 'selectedIconPath': 'resource/lastest_on.png', pagePath: 'pages/index/index', text: 'æœ€æ–°' &#125;, &#123; 'iconPath': 'resource/hotest.png', 'selectedIconPath': 'resource/hotest_on.png', pagePath: 'pages/hot/hot', text: 'çƒ­é—¨' &#125;, &#123; 'iconPath': 'resource/node.png', 'selectedIconPath': 'resource/node_on.png', pagePath: 'pages/nodes/nodes', text: 'èŠ‚ç‚¹' &#125;], 'color': '#000', 'selectedColor': '#56abe4', 'backgroundColor': '#fff', 'borderStyle': 'white' &#125;, window: &#123; backgroundTextStyle: 'light', navigationBarBackgroundColor: '#fff', navigationBarTitleText: 'WeChat', navigationBarTextStyle: 'black' &#125;&#125; è·¯ç”±è·¯ç”±è·³è½¬åœ¨Taroä¸­ï¼Œå¯ä»¥ä½¿ç”¨Taroçš„navigateToæ–¹æ³•è¿›è¡Œè·¯ç”±è·³è½¬ï¼š 1Taro.navigateTo(&#123; url: '/pages/thread_detail/thread_detail' &#125;) è¿™ä¸ªç”¨æ³•ç±»ä¼¼Reactä¸­çš„props.history.push(&#39;/xxx&#39;)ã€‚ è·¯ç”±å‚æ•°åœ¨é¡µé¢ç»„ä»¶ä¸­ï¼Œå¯ä»¥é€šè¿‡ getCurrentInstance().router æˆ–è€…Current.router?.paramsè·å–å½“å‰é¡µé¢çš„è·¯ç”±å‚æ•°ï¼š 1234import Taro, &#123; Current &#125; from '@tarojs/taro';// åœ¨ç»„ä»¶å†…const &#123; full_name &#125; = Current.router?.params; ç”Ÿå‘½å‘¨æœŸReactç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•å’Œå°ç¨‹åºçš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•åœ¨Taroä¸­å‡æ”¯æŒï¼Œä½†éœ€è¦æ³¨æ„å®ƒä»¬çš„è§¦å‘æ—¶æœºå’Œé¡ºåºã€‚è§å®˜æ–¹æ–‡æ¡£ï¼šç”Ÿå‘½å‘¨æœŸè§¦å‘æœºåˆ¶ã€‚ å†…ç½®ç»„ä»¶Taroä¸­ä½¿ç”¨å°ç¨‹åºè§„èŒƒçš„å†…ç½®ç»„ä»¶è¿›è¡Œå¼€å‘ï¼Œå¦‚&lt;View /&gt;ã€&lt;Text /&gt;ã€&lt;Button /&gt;ç­‰ï¼Œè¿™äº›æ˜¯è·¨å¹³å°ç»„ä»¶ã€‚ åœ¨Reactä¸­ä½¿ç”¨è¿™äº›å†…ç½®ç»„ä»¶å‰ï¼Œå¿…é¡»ä»@tarojs/componentsè¿›è¡Œå¼•å…¥ï¼Œç»„ä»¶çš„propséµä»å¤§é©¼å³°å¼å‘½åè§„èŒƒï¼š 12// å°ç¨‹åºå†™æ³•&lt;view hover-class='test' /&gt; 1234// Taroå†™æ³•import &#123; View &#125; from '@tarojs/components'&lt;View hoverClass='test' /&gt; äº‹ä»¶åœ¨ Taro ä¸­äº‹ä»¶éµä»å°é©¼å³°å¼ï¼ˆcamelCaseï¼‰å‘½åè§„èŒƒï¼Œæ‰€æœ‰å†…ç½®äº‹ä»¶åä»¥ on å¼€å¤´ã€‚ åœ¨äº‹ä»¶å›è°ƒå‡½æ•°ä¸­ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯äº‹ä»¶æœ¬èº«ï¼Œå›è°ƒä¸­è°ƒç”¨ stopPropagation å¯ä»¥é˜»æ­¢å†’æ³¡ã€‚ 1234567891011function Comp () &#123; function clickHandler (e) &#123; e.stopPropagation() // é˜»æ­¢å†’æ³¡ &#125; function scrollHandler () &#123;&#125; // åªæœ‰å°ç¨‹åºçš„ bindtap å¯¹åº” Taro çš„ onClick // å…¶ä½™å°ç¨‹åºäº‹ä»¶åæŠŠ bind æ¢æˆ on å³æ˜¯ Taro äº‹ä»¶åï¼ˆæ”¯ä»˜å®å°ç¨‹åºé™¤å¤–ï¼Œå®ƒçš„äº‹ä»¶å°±æ˜¯ä»¥ on å¼€å¤´ï¼‰ return &lt;ScrollView onClick=&#123;clickHandler&#125; onScroll=&#123;scrollHandler&#125; /&gt;&#125; é¡¹ç›®è¿›é˜¶ä¸ä¼˜åŒ–é¡¹ç›®åœ¨å¼€å‘å®Œæ¯•ä¹‹åï¼Œæˆ‘ä»¬æƒ³è¦çœ‹é¡¹ç›®çš„æ•ˆæœæ˜¯æ€ä¹ˆæ ·çš„ï¼Œè¦æ€ä¹ˆåšå‘¢ï¼Ÿå½“æ—¶æˆ‘å¾ˆç–‘æƒ‘ï¼Œäºæ˜¯æ‰¾äº†Taroå®˜æ–¹çš„ä¸€ä¸ª5åˆ†é’Ÿä¸Šæ‰‹å°ç¨‹åºçš„è§†é¢‘æ¥çœ‹ï¼Œä¾¿æ‰¾åˆ°äº†ç­”æ¡ˆã€‚ é¦–å…ˆï¼Œå…ˆæ‰“åŒ…ç¼–è¯‘ã€‚ä½¿ç”¨Taro CLIç”Ÿæˆçš„é¡¹ç›®ï¼Œåœ¨package.jsonä¸­å·²ç»é…ç½®å¥½äº†å„ç§å°ç¨‹åºçš„æ‰“åŒ…ç¼–è¯‘æŒ‡ä»¤ï¼š æ¯”å¦‚ï¼Œæˆ‘æƒ³æ‰“åŒ…å¾®ä¿¡å°ç¨‹åºï¼Œåˆ™åœ¨ç»ˆç«¯è¾“å…¥ï¼š 1npm run dev:weapp è°ƒè¯•çš„è¯å°±æ‰§è¡Œnpm run devï¼Œæ‰“åŒ…æ„å»ºåˆ°ç”Ÿäº§ç¯å¢ƒåˆ™æ‰§è¡Œnpm run buildã€‚ å¦‚æœæƒ³è¦å¤šç«¯ç¼–è¯‘ï¼Œåœ¨configæ–‡ä»¶å¤¹ä¸‹çš„index.jsé‡Œä¿®æ”¹outputRootå±æ€§ï¼š 1outputRoot: `dist/$&#123;process.env.TARO_ENV&#125;` è¿™æ ·çš„è¯ï¼Œå„ä¸ªç«¯æ‰“åŒ…å¥½çš„æ–‡ä»¶å°±å¯ä»¥åŒæ—¶å­˜æ”¾åœ¨distæ–‡ä»¶å¤¹å†…ï¼Œæ¯”å¦‚å¾®ä¿¡å°ç¨‹åºçš„è·¯å¾„æ˜¯dist/weappï¼Œh5çš„è·¯å¾„æ˜¯dist/h5ã€‚ ç„¶åï¼Œæ‰“å¼€å¾®ä¿¡å¼€å‘è€…å·¥å…·ï¼Œå¯¼å…¥æ‰“åŒ…ç¼–è¯‘å¥½çš„é¡¹ç›®ï¼Œå°±æœ‰æ•ˆæœå•¦ï¼š ä½†æ­¤æ—¶ï¼Œæˆ‘çš„é¡¹ç›®é‡åˆ°äº†ä¸€ä¸ªbugï¼Œåœ¨å¾®ä¿¡å¼€å‘è€…å·¥å…·ä¸­æŠ¥é”™äº†ï¼š å½“æ—¶æ²¡æœ‰ä»”ç»†çœ‹æŠ¥é”™ä¿¡æ¯ï¼Œå…¶å®ç¬¬äºŒè¡ŒThread.renderä¸­ç‚¹å‡»è¿›å»æœ‰æç¤ºæŠ¥é”™ä½ç½®ã€‚å¿ƒæƒ³ï¼šè¿™æ²¡æ³•è°ƒè¯•ã€‚ã€‚ã€‚ä¹Ÿæ²¡åŠæ³•console.logã€‚ï¼ˆå®é™…ä¸Šæ˜¯å¯ä»¥çš„ï¼‰ã€‚ äºæ˜¯ä¾¿æƒ³ï¼Œé‚£æ˜¯ä¸æ˜¯å¯ä»¥æ‰“åŒ…æˆh5ï¼Œåœ¨æµè§ˆå™¨é‡Œè°ƒè¯•ï¼Œè¿™æ ·ä¸å°±å’Œå¹³æ—¶çš„å‰ç«¯å¼€å‘ä¸€æ ·äº†ä¹ˆï¼äºæ˜¯ä¾¿è½¬å‘äº†å¦ä¸€ä¸ªæ–¹å‘ã€‚ä½†æ˜¯åœ¨æµè§ˆå™¨ç«¯ï¼Œä¼šæœ‰è·¨åŸŸé—®é¢˜ï¼Œlocalhostå‘https://www.v2ex.com/api/å‘èµ·è¯·æ±‚æ˜¯è¿åäº†æµè§ˆå™¨çš„åŒæºç­–ç•¥ã€‚å°ç¨‹åºå¼€å‘å·¥å…·å¹¶æ²¡æœ‰åŒæºç­–ç•¥çš„é™åˆ¶ï¼Œäºæ˜¯ä¸ä¼šæœ‰è¿™ä¸ªé—®é¢˜ã€‚ Taro h5 è·¨åŸŸé—®é¢˜è§£å†³é¦–å…ˆï¼Œè¦åœ¨config/dev.jsä¸­æ·»åŠ h5é…ç½®ï¼š 12345678910111213h5: &#123; devServer: &#123; proxy: &#123; '/api/': &#123; target: \"https://www.v2ex.com\", changeOrigin: true // pathRewrite: &#123; // '^/api/': '/' // &#125;, &#125; &#125; &#125;&#125; å…¶ä¸­çš„é…ç½®å°±æ˜¯webpackçš„devServerçš„é…ç½®ï¼Œè¯¦æƒ…å¯å‚è€ƒåšå®¢ï¼šdevServerä¹‹proxyè·¨åŸŸ ç¬¬äºŒæ­¥ï¼Œä¿®æ”¹api.tsé‡Œçš„HOSTï¼š 1234const HOST_URI = 'https://www.v2ex.com/api/'// ä¿®æ”¹ä¸ºconst HOST_URI = '/api/' ä¸ºä»€ä¹ˆè¦è¿™ä¹ˆæ”¹å‘¢ï¼Ÿå› ä¸ºåœ¨proxyä¸­ï¼Œæˆ‘ä»¬ä¼šæ£€æŸ¥è¯·æ±‚çš„å¼€å¤´æ˜¯å¦ä¸º/api/ï¼Œå¦‚æœæ˜¯ä»¥httpå¼€å¤´ï¼Œåˆ™æ£€æŸ¥ä¸åŒ¹é…ï¼Œä¸èµ°ä»£ç†ï¼Œè·¨åŸŸå¤±æ•ˆã€‚æ‰€ä»¥å»æ‰å‰é¢çš„httpéƒ¨åˆ†ï¼Œç›¸å½“äºé‡åˆ°/api/æ‰åšä»£ç†ï¼Œåˆ™ä¼šæŠŠé»˜è®¤åŸŸåhttp://localhost:xxxxæ”¹æˆtargetï¼Œä¹Ÿå°±æ˜¯https://www.v2ex.comåœ°å€ã€‚ä¸è¿‡åœ¨æµè§ˆå™¨F12ä¸‹ï¼ŒNetwork-&gt;Headersä¸­çœ‹åˆ°çš„è¿˜æ˜¯http://localhost:xxxx/api/xxxï¼Œä½†æ˜¯çœŸæ­£çš„è¯·æ±‚åœ°å€ä¸ºï¼šhttps://www.v2ex.com/api/xxxã€‚ éœ€è¦æ·»åŠ pathRewriteå±æ€§çš„åœºæ™¯æ˜¯ï¼šç›¸å½“äºé‡è§/api/æ‰åšä»£ç†ï¼Œä½†çœŸå®çš„è¯·æ±‚ä¸­æ²¡æœ‰/api/ï¼Œæ‰€ä»¥åœ¨pathRewriteä¸­æŠŠ/api/å»æ‰, è¿™æ ·æ—¢æœ‰äº†æ ‡è¯†, åˆèƒ½åœ¨è¯·æ±‚æ¥å£ä¸­æŠŠ/api/å»æ‰ã€‚ è¿è¡Œnpm run dev:h5ï¼Œå¯ä»¥åœ¨æµè§ˆå™¨ç«¯æŸ¥çœ‹åˆ°æ•ˆæœï¼š æœ€åé—®é¢˜æ˜¯ç”±äºå°†ç”Ÿå‘½å‘¨æœŸå‡½æ•°componentWillMountå†™æˆcomponentWillUnmountå¯¼è‡´çš„ï¼Œæ‰¾äº†å¥½ä¹…ï¼Œä»¥è‡³äºæƒ³é”¤æ­»è‡ªå·±ã€‚ ä¸è¿‡Reactå·²ç»ä¸å»ºè®®ä½¿ç”¨componentWillMountè¿™ä¸ªç”Ÿå‘½å‘¨æœŸå‡½æ•°äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬åº”è¯¥å°†æ•°æ®è·å–æ”¾åœ¨componentDidMountä¸­ï¼š 12345async componentDidMount() &#123; this.setState(&#123; thread: this.props.thread &#125;)&#125; æ¸²æŸ“æ—¶åŠ ä¸€å±‚åˆ¤æ–­ï¼š 12345678910111213// ç»„ä»¶å†…// åœ¨åŠ è½½åˆ°threadçš„æ•°æ®åå†æ¸²æŸ“ï¼Œé˜²æ­¢å‡ºç°property of undefinedçš„æŠ¥é”™const attrLen = Object.keys(thread).length;&#123;attrLen ? &lt;Thread node=&#123;thread.node&#125; title=&#123;thread.title&#125; last_modified=&#123;thread.last_modified&#125; replies=&#123;thread.replies&#125; tid=&#123;thread.id&#125; member=&#123;thread.member&#125; not_navi=&#123;true&#125;/&gt; : null&#125; å…¶å®å¾®ä¿¡å¼€å‘è€…å·¥å…·ä¹Ÿæœ‰å®Œå–„çš„è°ƒè¯•å™¨ï¼Œèƒ½å¤Ÿçœ‹åˆ°console.logç­‰çš„ç»“æœï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥åœ¨vscodeä¸­ä¿®æ”¹ä»£ç ï¼Œctrl sä¹‹åï¼Œå°±èƒ½å¤Ÿåœ¨å¾®ä¿¡å¼€å‘è€…å·¥å…·ä¸­çœ‹åˆ°ç›¸åº”çš„æ¸²æŸ“ç»“æœï¼Œä¹Ÿå¯ä»¥é€šè¿‡çœ‹consoleæ¥è°ƒè¯•ã€‚ä¸è¿‡å¾®ä¿¡å¼€å‘è€…å·¥å…·ä¼¼ä¹ä¸èƒ½å¤Ÿä½¿ç”¨Reduxçš„è°ƒè¯•å·¥å…·ï¼Œè¿™ä¸ªä¹‹åå†ç ”ç©¶ç ”ç©¶ã€‚ åç»­ç”¨hookså¯¹è¿™ä¸ªdemoè¿›è¡Œé‡æ„ï¼Œä»£ç ä»“åº“ï¼štaro-mini-programã€‚ å­¦ä¹ èµ„æ–™Taroå­¦ä¹ ä¼˜ç§€èµ„æºï¼šawesome-taro","categories":[{"name":"å°ç¨‹åº","slug":"å°ç¨‹åº","permalink":"http://delaprada.com/categories/%E5%B0%8F%E7%A8%8B%E5%BA%8F/"}],"tags":[{"name":"å°ç¨‹åº","slug":"å°ç¨‹åº","permalink":"http://delaprada.com/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F/"}]},{"title":"Reduxæºç è§£æ","slug":"Reduxæºç è§£æ","date":"2021-01-09T08:39:54.000Z","updated":"2021-01-09T08:44:54.000Z","comments":true,"path":"2021/01/09/Reduxæºç è§£æ/","link":"","permalink":"http://delaprada.com/2021/01/09/Redux%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/","excerpt":"","text":"Reduxæºç è§£æåœ¨ä½¿ç”¨Reduxçš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šè§‰å¾—å¾ˆæ–¹ä¾¿ï¼Œå› ä¸ºå¾ˆå¤šäº‹æƒ…Reduxä¼šå¸®æˆ‘ä»¬å®Œæˆï¼Œåœ¨å†…éƒ¨è¿ä½œï¼Œä¸éœ€è¦æˆ‘ä»¬æ‰‹åŠ¨å»åšï¼Œæ¯”å¦‚æˆ‘ä»¬è°ƒç”¨dispatchæ–¹æ³•çš„æ—¶å€™ï¼ŒReduxè‡ªåŠ¨å°±ä¼šå¸®æˆ‘ä»¬æ‰§è¡Œreduceæ–¹æ³•ï¼Œæ›´æ–°stateã€‚æ‰€ä»¥æœ¬æ–‡å°±æ¥æ‹†è§£ä¸€äº›Reduxåœ¨èƒŒåä¸ºæˆ‘ä»¬åšçš„äº‹æƒ…ï¼Œä¸»è¦åˆ†ä¸ºä»¥ä¸‹å‡ éƒ¨åˆ†ï¼š createStoreå‘ç”Ÿäº†ä»€ä¹ˆ? dispatchæ‰§è¡Œååœ¨å†…éƒ¨æ€ä¹ˆè¿è¡Œçš„ï¼Ÿ composeå‡½æ•°åšäº†ä»€ä¹ˆäº‹æƒ…ï¼Ÿ combineReducersæ˜¯å¦‚ä½•åˆå¹¶ä¸åŒçš„reducerçš„ï¼Ÿ applyMiddlewareæ˜¯å¦‚ä½•ç»„ç»‡ä¸­é—´ä»¶çš„ï¼Ÿ createStorecreateStoreæ˜¯è¦è§ä¸€ä¸ªstoreä»“åº“ï¼Œæ˜¯reduxçš„æ ¸å¿ƒæ‰€åœ¨ï¼Œå®ƒæœ€åè¦è¿”å›å››ä¸ªéå¸¸é‡è¦çš„å±æ€§ï¼Œåˆ†åˆ«æ˜¯ï¼š getState subscribe dispatch replaceReducer 123456789export default function createStore (reducer, preloadedState, enhancer) &#123;//...return &#123; getState,// è·å–åˆ° state subscribe,// é‡‡ç”¨å‘å¸ƒè®¢é˜…æ¨¡å¼ï¼Œè¿™ä¸ªæ–¹æ³•è¿›è¡Œè§‚å¯Ÿè€…çš„è®¢é˜… dispatch,// æ´¾å‘ action replaceReducer// ç”¨æ–°çš„ reducer æ›¿æ¢ç°åœ¨çš„ &#125;&#125; é¦–å…ˆç¬¬ä¸€æ­¥æ˜¯æ£€æŸ¥å‚æ•°ï¼Œä¸€å…±å¯ä»¥æ¥å—3ä¸ªå‚æ•°ï¼Œåˆ†åˆ«æ˜¯reducerï¼ˆæ”¹å˜storeçš„çº¯å‡½æ•°ï¼‰ï¼ŒpreloadedStateï¼ˆåˆå§‹çŠ¶æ€ï¼‰ï¼Œenhancerï¼ˆä¸­é—´ä»¶ç›¸å…³ï¼‰ã€‚ 12345678910111213141516export default function createStore (reducer, preloadedState, enhancer) &#123; //reducer å¿…é¡»æ˜¯å‡½æ•° // å½“å‰ reducer let currentReducer = reducer //state æ•°æ®ï¼Œredux çš„æ ¹æœ¬ let currentState = preloadedState // è®¢é˜…è€…é›†åˆ let currentListeners = [] // è™½ç„¶ä¸èµ·çœ¼ï¼Œä½†æ˜¯æ˜¯ä¸€ä¸ªå…³é”®çš„è®¾è®¡ let nextListeners = currentListeners // æ˜¯å¦æ­£åœ¨æœ‰ dispatch åœ¨è¿è¡Œ let isDispatching = false //... //return ä»£ç &#125; createStoreçš„getStateæ–¹æ³•ï¼š 12345function getState () &#123; // å¦‚æœæœ‰ dispatch æ­£åœ¨æ‰§è¡Œåˆ™æŠ¥é”™ if (isDispatching) throw new Error (\"xxxx å…·ä½“ä¿¡æ¯çœç•¥\") return currentState&#125; createStoreçš„subscribeæ–¹æ³•ï¼š ä¸ºäº†é¿å…å‘ç”Ÿé—®é¢˜ï¼Œæˆ‘ä»¬ä¼šç¼“å­˜æœ€å¼€å§‹çš„æ•°ç»„currentListenersï¼Œåœ¨è°ƒç”¨è®¢é˜…è€…çš„æ—¶å€™ï¼Œä¸€åˆ‡å…³äºcurrentListenersçš„æ”¹å˜éƒ½ä¸å…è®¸ï¼Œä½†æ˜¯å¯ä»¥æ‹·è´ä¸€ä»½åŒæ ·çš„æ•°ç»„ï¼Œè®©å®ƒæ¥æ‰¿æ‹…è®¢é˜…è€…å¯¹æ•°ç»„çš„æ”¹å˜ï¼Œè¿™ä¸ªæ•°ç»„å°±æ˜¯nextListenersã€‚ 123456789101112131415161718192021222324252627282930function ensureCanMutateNextListeners () &#123; // å¦‚æœ next å’Œ current æ•°ç»„æ˜¯ä¸€ä¸ªå¼•ç”¨ï¼Œé‚£è¿™ç§æƒ…å†µæ˜¯å±é™©çš„ï¼ŒåŸå› ä¸Šé¢å·²ç»è°ˆåˆ°ï¼Œæˆ‘ä»¬éœ€è¦ next å’Œ current ä¿æŒå„è‡ªç‹¬ç«‹ if (nextListeners === currentListeners) &#123; nextListeners = currentListeners.slice () &#125;&#125;function subscribe (listener) &#123; if (typeof listener !== 'function') &#123; throw new Error ('Expected the listener to be a function.') &#125; // å¦‚æœæ­£åœ¨æœ‰ dispatch æ‰§è¡Œåˆ™æŠ¥é”™ if (isDispatching) &#123; throw new Error (\"xxx\") &#125; let isSubscribed = true ensureCanMutateNextListeners () nextListeners.push (listener) // è¿”å›çš„æ˜¯ä¸€ä¸ªé€€è®¢çš„æ–¹æ³•ï¼Œå°†ç‰¹å®šçš„ listener ä»è®¢é˜…è€…é›†åˆä¸­åˆ é™¤ return function unsubscribe () &#123; // å·²ç»é€€è®¢äº†å°±ä¸ç®¡äº† if (!isSubscribed) return; if (isDispatching) throw new Error (\"xxx å…·ä½“ä¿¡æ¯çœç•¥\") isSubscribed = false ensureCanMutateNextListeners () const index = nextListeners.indexOf (listener) nextListeners.splice (index, 1) &#125;&#125; subscribeæ–¹æ³•ç”¨äºæ·»åŠ è®¢é˜…è€…Listenerï¼Œè¿”å›çš„å‡½æ•°unsubscirbeæ–¹æ³•ç”¨äºé€€è®¢æŸä¸ªè®¢é˜…è€…ã€‚ æ¯æ¬¡è°ƒç”¨è¿™ä¸ªsubscribeå‡½æ•°æ—¶ï¼Œéƒ½ä¼šäº§ç”Ÿä¸€ä¸ªé—­åŒ…ï¼Œé‡Œé¢å­˜å‚¨ç€isSubscribedçš„å€¼ï¼Œè°ƒç”¨næ¬¡å°±ä¼šäº§ç”Ÿnä¸ªè¿™æ ·çš„é—­åŒ…ï¼Œç”¨æ¥å­˜å‚¨nä¸ªä¸åŒçš„è®¢é˜…æƒ…å†µã€‚ createStoreçš„dispatchå‡½æ•°ï¼š 12345678910111213141516171819202122232425function dispatch (action) &#123;//action å¿…é¡»æ˜¯ä¸€ä¸ªå¯¹è±¡//action.type ä¸èƒ½ä¸º undefinedif (isDispatching) &#123; throw new Error ('Reducers may not dispatch actions.')&#125;try &#123; isDispatching = true // çœ‹åˆ°æ²¡æœ‰ï¼Ÿæ‰§è¡Œ reducer åè¿”å›çš„çŠ¶æ€ç›´æ¥æˆä¸º currentState äº† currentState = currentReducer (currentState, action) &#125; finally &#123; isDispatching = false &#125;// å°†nextListenersèµ‹å€¼ç»™currentListenersconst listeners = (currentListeners = nextListeners)for (let i = 0; i &lt; listeners.length; i++) &#123; // storeå‘ç”Ÿå˜åŒ–åˆ™è°ƒç”¨æ¯ä¸ªè®¢é˜…è€… const listener = listeners [i] listener ()&#125;return action&#125; createStoreçš„replaceReducerå‡½æ•°ï¼š 12345678910function replaceReducer (nextReducer) &#123; if (typeof nextReducer !&#x3D;&#x3D; &#39;function&#39;) &#123; throw new Error (&#39;Expected the nextReducer to be a function.&#39;) &#125; currentReducer &#x3D; nextReducer &#x2F;&#x2F; æ­¤æ—¶æ— æ³•åŒ¹é…ä»»ä½•çš„ actionï¼Œä½†æ˜¯è¿”å›çš„çŠ¶æ€å¯ä»¥å°† currentState ç»™æ›´æ–° &#x2F;&#x2F; ä¹Ÿå°±æ˜¯æ›´æ–°å½“å‰çš„ stateï¼Œå› ä¸º reducer æ›´æ–°äº†ï¼Œè€çš„ state è¯¥æ¢äº†ï¼ dispatch (&#123; type: ActionTypes.REPLACE &#125;)&#125; combineReduceråœ¨ä¹‹å‰çš„ReduxåŠå…¶ä¸­é—´ä»¶è§£ææ–‡ç« ä¸­ä¹Ÿæœ‰æåˆ°ï¼ŒcombineReducersæ–¹æ³•çš„ä½œç”¨å°†æ‰€æœ‰å­reduceråˆå¹¶ä¸ºä¸€ä¸ªå¤§reducerï¼Œæ ¹æ®actionçš„ä¸åŒè¿”å›æ–°çš„stateï¼š 1234567891011121314const reducer = combineReducers(&#123; a: doSomethingWithA, b: processB, c: c&#125;)// ç­‰åŒäºfunction reducer(state = &#123;&#125;, action) &#123;return &#123; a: doSomethingWithA(state.a, action), b: processB(state.b, action), c: c(state.c, action) &#125;&#125; å…¶æºç å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031323334export default function combineReducers (reducers) &#123; // ä»¥é¡¹ç›®ä¸­çš„ä¾‹å­æ¥è®²ï¼ŒreducerKeys å°±æ˜¯ ['recommend', 'singers'] const reducerKeys = Object.keys (reducers) //finalReducers æ˜¯ reducers è¿‡æ»¤åçš„ç»“æœ // ç¡®ä¿ finalReducers é‡Œé¢æ¯ä¸€ä¸ªé”®å¯¹åº”çš„å€¼éƒ½æ˜¯å‡½æ•° const finalReducers = &#123;&#125; for (let i = 0; i &lt; reducerKeys.length; i++) &#123; const key = reducerKeys [i] if (typeof reducers [key] === 'function') &#123; finalReducers [key] = reducers [key] &#125; &#125; const finalReducerKeys = Object.keys (finalReducers) // æœ€åä¾ç„¶è¿”å›ä¸€ä¸ªçº¯å‡½æ•° return function combination (state = &#123;&#125;, action) &#123; // è¿™ä¸ªæ ‡å¿—ä½è®°å½•åˆå§‹çš„ state æ˜¯å¦å’Œç»è¿‡ reducer åæ˜¯ä¸€ä¸ªå¼•ç”¨ï¼Œå¦‚æœä¸æ˜¯åˆ™ state è¢«æ”¹å˜äº† let hasChanged = false const nextState = &#123;&#125; for (let i = 0; i &lt; finalReducerKeys.length; i++) &#123; const key = finalReducerKeys [i] const reducer = finalReducers [key] // åŸæ¥çš„çŠ¶æ€æ ‘ä¸­ key å¯¹åº”çš„å€¼ const previousStateForKey = state [key] // è°ƒç”¨ reducer å‡½æ•°ï¼Œè·å¾—è¯¥ key å€¼å¯¹åº”çš„æ–°çŠ¶æ€ const nextStateForKey = reducer (previousStateForKey, action) nextState [key] = nextStateForKey hasChanged = hasChanged || nextStateForKey !== previousStateForKey &#125; // è¿™ä¸ªå¾ˆç®€å•ç†è§£å§ï¼Ÿå¦‚æœæ²¡æ”¹å˜ç›´æ¥æŠŠåŸå§‹çš„ state è¿”å›å³å¯ return hasChanged ? nextState : state &#125;&#125; composeå‡½æ•°composeæ˜¯ä¸€ä¸ªå·¥å…·ï¼Œå……åˆ†ä½“ç°é«˜é˜¶å‡½æ•°çš„æŠ€å·§ã€‚æºç å¦‚ä¸‹ï¼š 12345678910export default function compose (...funcs) &#123;if (funcs.length === 0) &#123; return arg =&gt; arg&#125;if (funcs.length === 1) &#123; return funcs [0]&#125; return funcs.reduce ((a, b) =&gt; (...args) =&gt; a (b (...args)))&#125; æ¯”å¦‚ï¼š 12345const f0 = (x) =&gt; &#123; console.log (x) &#125;const f1 = () =&gt; &#123; console.log (1) &#125;const f2 = () =&gt; &#123; console.log (2) &#125;let fArr = [f2, f1, f0];console.log (compose (...fArr)(100)) // æ‰§è¡Œ f2 (f1 (f0 (100))) è¾“å‡º 100 1 2 composeå‡½æ•°ä¸€èˆ¬ç”¨äºç»„åˆæ‰€æœ‰çš„enhancerï¼Œä½œä¸ºç¬¬ä¸‰ä¸ªå‚æ•°ä¼ å…¥createStoreæ–¹æ³•ã€‚createStoreæ–¹æ³•çš„ç»“æ„å¦‚ä¸‹ï¼š 1createStore(reducer, [preloadedState], [enhancer]) ç¬¬ä¸‰ä¸ªå¯é€‰å‚æ•°enhanceræŒ‡çš„æ˜¯store enhancerï¼Œä¹Ÿå°±æ˜¯storeçš„å¢å¼ºå™¨ï¼Œç”¨äºå¢å¼ºstoreçš„åŠŸèƒ½ã€‚ä¸€ä¸ªstore enhancerï¼Œå®é™…ä¸Šæ˜¯ä¸€ä¸ªé«˜é˜¶å‡½æ•°ï¼ˆcomposeä¹Ÿæ˜¯ä¸€ä¸ªé«˜é˜¶å‡½æ•°ï¼‰ï¼Œå®ƒçš„å‚æ•°æ˜¯åˆ›å»ºstoreçš„å‡½æ•°ï¼ˆstore creatorï¼‰ï¼Œè¿”å›å€¼æ˜¯ä¸€ä¸ªå¯ä»¥åˆ›å»ºåŠŸèƒ½æ›´å¼ºå¤§çš„storeçš„å‡½æ•°ï¼ˆenhanced store creatorï¼‰ï¼Œè¿™å’ŒReactä¸­çš„é«˜é˜¶ç»„ä»¶çš„æ¦‚å¿µå¾ˆç›¸ä¼¼ã€‚ store enhancerå‡½æ•°çš„ç»“æ„ä¸€èˆ¬å¦‚ä¸‹ï¼š 123456function enhancerCreator() &#123; return createStore =&gt; (...args) =&gt; &#123; // do something based on old store // return a new enhanced store &#125;&#125; éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒenhancerCreatoræ˜¯ç”¨äºåˆ›å»ºstore enhancerçš„å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼ŒenhancerCreatorçš„è°ƒç”¨ç»“æœæ‰æ˜¯ä¸€ä¸ªstore enhancerã€‚(â€¦args)å‚æ•°ä»£è¡¨ç©¿ä»¶storeæ‰€éœ€è¦çš„å‚æ•°ï¼Œä¹Ÿå°±æ˜¯createStoreæ¥æ”¶çš„å‚æ•°ï¼Œå®é™…ä¸Šå°±æ˜¯(reducer, [preloadedState], [enhancer])ã€‚ å¯ä»¥è¿™ä¹ˆç†è§£ï¼Œå› ä¸ºè¦åˆ›å»ºä¸€ä¸ªåŠŸèƒ½æ›´åŠ å¼ºå¤§çš„storeï¼Œæ‰€ä»¥éœ€è¦ä¼ å…¥åˆ›å»ºstoreæ‰€éœ€è¦çš„å‚æ•°ã€‚ æ¯”å¦‚ï¼Œç°åœ¨æˆ‘ä»¬æƒ³åˆ›å»ºä¸€ä¸ªstore enhancerï¼Œç”¨äºè¾“å‡ºå‘é€çš„actionçš„ä¿¡æ¯å’Œstateçš„å˜åŒ–ï¼š 123456789101112131415// autoLogger.js// store enhancerexport default function autoLogger() &#123; return createStore =&gt; (reducer, initialState, enhancer) =&gt; &#123; const store = createStore(reducer, initialState, enhancer) function dispatch(action) &#123; console.log(`dispatch an action: $&#123;JSON.stringify(action)&#125;`); const res = store.dispatch(action); const newState = store.getState(); console.log(`current state: $&#123;JSON.stringify(newState)&#125;`); return res; &#125; return &#123;...store, dispatch&#125; &#125;&#125; autoLoggerå£°æ˜äº†ä¸€ä¸ªæ–°çš„dispatchæ–¹æ³•ï¼Œåœ¨åŸæœ¬çš„store.dispatchæ–¹æ³•åŸºç¡€ä¸Šæ·»åŠ äº†ä¸¤ä¸ªè¾“å‡ºæ—¥å¿—ï¼Œç„¶åè¿”å›ä¸€ä¸ªæ–°çš„storeï¼ˆ{â€¦store, dispatch}ï¼‰ã€‚å½“æˆ‘ä»¬è°ƒç”¨dispatchæ–¹æ³•æ—¶ï¼Œå®é™…æ˜¯è°ƒç”¨äº†autoLoggeræ–¹æ³•ä¸­æ–°å£°æ˜çš„dispatchï¼Œå› ä¸ºä¸Šé¢å¯¹è±¡æœ€åä¸€ä¸ªdispatchè¦†ç›–äº†storeä¸­çš„dispatchã€‚ å…¶ä¸­createStoreçš„éƒ¨åˆ†æºç å¦‚ä¸‹ï¼š 12345678910111213141516export default function createStore (reducer, preloadedState, enhancer) &#123; // ç¬¬äºŒä¸ªå‚æ•°ä¸ºå‡½æ•°ï¼Œä½†æ˜¯ç¬¬ä¸‰ä¸ªå‚æ•°æ²¡ä¼  if (typeof preloadedState === 'function' &amp;&amp; typeof enhancer === 'undefined') &#123; enhancer = preloadedState// å°†ç¬¬äºŒä¸ªå‚æ•°å½“åš enhancer preloadedState = undefined &#125; // ç¡®ä¿ enhancer ä¸ºå‡½æ•° if (typeof enhancer !== 'undefined') &#123; if (typeof enhancer !== 'function') &#123; throw new Error ('Expected the enhancer to be a function.') &#125; return enhancer (createStore)(reducer, preloadedState) &#125; //...&#125; å¦‚ä½•ä½¿ç”¨è¿™ä¸ªstore enhancerï¼Ÿ 123456789// configureStore.jsimport &#123; createStore, applyMiddleware &#125; from 'redux';import rootReducer from 'path/to/reducers';import autLogger from 'path/to/autoLogger';const store = createStore( reducerï¼Œ autoLogger()); applyMiddlewareapplyMiddlewareæœ¬èº«å°±æ˜¯ä¸€ä¸ªstore enhancerï¼Œç»“æ„å’Œä¸Šé¢çš„autoLoggerå¾ˆåƒï¼ŒapplyMiddlewareçš„æºç å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526export default function applyMiddleware (...middlewares) &#123; return createStore =&gt; (...args) =&gt; &#123; const store = createStore (...args) let dispatch = () =&gt; &#123; throw new Error ( 'Dispatching while constructing your middleware is not allowed. ' + 'Other middleware would not be applied to this dispatch.' ) &#125; //middlewareAPI å…¶å®å°±æ˜¯æ‹¿åˆ° store çš„ä¿¡æ¯ const middlewareAPI = &#123; getState: store.getState, dispatch: (...args) =&gt; dispatch (...args) &#125; // å‚è€ƒä¸Šé¢çš„ thunkï¼Œå…¶å®å°±æ˜¯ä¼ å…¥ store å‚æ•°ï¼Œå‰©ä¸‹çš„éƒ¨åˆ†ä¸º next =&gt; action =&gt; &#123; ... &#125;; // ä¼ å…¥è¿™ä¸ªå‚æ•°æ˜¯å¿…é¡»çš„ï¼Œå› ä¸ºéœ€è¦æ‹¿åˆ° store çš„ç›¸å…³å±æ€§ï¼Œå¦‚ thunk æ‹¿äº† getState // è¿™é‡Œçš„æ„æ€å°±æ˜¯æ¯ä¸ªä¸­é—´ä»¶éƒ½èƒ½æ‹¿åˆ° store çš„æ•°æ® const chain = middlewares.map (middleware =&gt; middleware (middlewareAPI)) dispatch = compose (...chain)(store.dispatch) return &#123; ...store, dispatch &#125; &#125;&#125; æ¯”å¦‚æˆ‘ä»¬åœ¨è°ƒç”¨applyMiddleware(thunk, logger)ï¼Œèµ°åˆ°composeé€»è¾‘çš„æ—¶å€™ï¼Œç›¸å½“äºè°ƒç”¨thunk(logger(store.dispatch))ã€‚ æ— è®ºæ˜¯applyMiddlewareä¸­ä½¿ç”¨composeç»„åˆæ‰€æœ‰ä¸­é—´ä»¶è¿˜æ˜¯ä½¿ç”¨composeæ¥ç»„åˆæ‰€æœ‰çš„enhancerï¼Œåœ¨ç»è¿‡composeç»„åˆä¹‹åï¼Œæ‰€æœ‰çš„middlewareæˆ–store enhanceréƒ½ä¼šå½¢æˆä¸€ä¸ªæ´‹è‘±æ¨¡å‹ã€‚composeä¸­çš„ç¬¬ä¸€ä¸ªenhancerï¼ˆæˆ–middlewareï¼‰å¤„äºæ´‹è‘±æ¨¡å‹çš„æœ€å¤–å±‚ï¼Œæœ€åä¸€ä¸ªenhancerå¤„äºæ´‹è‘±æ¨¡å‹çš„æœ€é‡Œå±‚ï¼Œç»è¿‡å±‚å±‚è°ƒç”¨å½¢æˆä¸€ä¸ªæ›´å¼ºå¤§çš„storeï¼š applyMiddleware(â€¦middlewares)å°†middlewareé™åˆ¶ä¸ºåªå¯ä»¥å¢å¼ºstore dispatchçš„åŠŸèƒ½ï¼Œä½†è¿™åªæ˜¯å®ƒè‡ªèº«çš„è§„èŒƒé™åˆ¶ï¼Œå¯¹äºå…¶ä»–store enhancerï¼Œä½ å¯ä»¥å¢å¼ºstoreä¸­åŒ…å«çš„ä»»æ„æ–¹æ³•çš„åŠŸèƒ½ï¼Œå¦‚dispatchã€subscribeã€getStateã€replaceReducerç­‰ã€‚æ¯•ç«Ÿï¼Œstoreåªæ˜¯ä¸€ä¸ªåŒ…å«ä¸€äº›å‡½æ•°çš„æ™®é€šJavaScriptå¯¹è±¡ï¼Œå¯ä»¥å¾ˆå®¹æ˜“çš„å¤åˆ¶å…¶ä¸­çš„æ–¹æ³•ï¼Œå¹¶å¢åŠ æ–°çš„åŠŸèƒ½ã€‚ å‚è€ƒReduxåŠä¸­é—´ä»¶åŸç†è§£æ æµ…æReduxçš„store enhancer","categories":[{"name":"React","slug":"React","permalink":"http://delaprada.com/categories/React/"}],"tags":[{"name":"React","slug":"React","permalink":"http://delaprada.com/tags/React/"}]},{"title":"React-ReduxåŠä¸­é—´ä»¶è§£æ","slug":"React-ReduxåŠä¸­é—´ä»¶è§£æ","date":"2021-01-07T07:55:48.000Z","updated":"2021-01-07T10:17:20.000Z","comments":true,"path":"2021/01/07/React-ReduxåŠä¸­é—´ä»¶è§£æ/","link":"","permalink":"http://delaprada.com/2021/01/07/React-Redux%E5%8F%8A%E4%B8%AD%E9%97%B4%E4%BB%B6%E8%A7%A3%E6%9E%90/","excerpt":"","text":"ä¸ºä»€ä¹ˆéœ€è¦ReduxReactçŸ¥è¯†DOMçš„ä¸€ä¸ªæŠ½è±¡å±‚ï¼Œå¹¶ä¸æ˜¯Webåº”ç”¨çš„å®Œæ•´è§£å†³æ–¹æ¡ˆã€‚æœ‰ä¸¤ä¸ªæ–¹é¢å®ƒæ²¡æœ‰æ¶‰åŠï¼š ä»£ç ç»“æ„ ç»„ä»¶ä¹‹é—´çš„é€šä¿¡ å¯¹äºå¤§å‹çš„å¤æ‚åº”ç”¨æ¥è¯´ï¼Œè¿™ä¸¤æ–¹é¢æ˜¯å¾ˆå…³é”®çš„ï¼Œå› æ­¤åªæœ‰Reactæ²¡æœ‰åŠæ³•å†™å¤§å‹åº”ç”¨ã€‚ ä½†Reduxå¹¶ä¸æ˜¯éç”¨ä¸å¯ã€‚å¦‚æœä½ çš„UIå±‚éå¸¸ç®€å•ï¼Œæ²¡æœ‰å¾ˆå¤šäº’åŠ¨ï¼ŒReduxå°±æ˜¯ä¸å¿…è¦çš„ï¼Œç”¨äº†åè€Œä¼šå¢åŠ å¤æ‚æ€§ã€‚ ä»¥ä¸‹è¿™äº›æƒ…å†µéƒ½ä¸éœ€è¦ä½¿ç”¨Reduxï¼š ç”¨æˆ·çš„ä½¿ç”¨æ–¹å¼éå¸¸ç®€å• ç”¨æˆ·ä¹‹é—´æ²¡æœ‰åä½œ ä¸éœ€è¦ä¸æœåŠ¡å™¨å¤§é‡äº¤äº’ï¼Œä¹Ÿæ²¡æœ‰ä½¿ç”¨WebSocket è§†å›¾å±‚ï¼ˆviewï¼‰åªä»å•ä¸€æ¥æºè·å–æ•°æ® Reduxé€‚ç”¨çš„åœºæ™¯æ˜¯ï¼šå¤šäº¤äº’ã€å¤šæ•°æ®æº ç”¨æˆ·çš„ä½¿ç”¨æ–¹å¼å¤æ‚ ä¸åŒèº«ä»½çš„ç”¨æˆ·æœ‰ä¸åŒçš„ä½¿ç”¨æ–¹å¼ï¼ˆæ¯”å¦‚æ™®é€šç”¨æˆ·å’Œç®¡ç†å‘˜ï¼‰ å¤šä¸ªç”¨æˆ·ä¹‹é—´å¯ä»¥åä½œ ä¸æœåŠ¡å™¨å¤§é‡äº¤äº’ï¼Œæˆ–è€…ä½¿ç”¨äº†WebSocket Viewè¦ä»å¤šä¸ªæ¥æºè·å–æ•°æ® ä»ç»„ä»¶çš„è§’åº¦çœ‹ï¼Œå¦‚æœä½ çš„åº”ç”¨æœ‰ä»¥ä¸‹åœºæ™¯ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨Reduxï¼š æŸä¸ªç»„ä»¶çš„çŠ¶æ€ï¼Œéœ€è¦å…±äº« æŸä¸ªçŠ¶æ€éœ€è¦åœ¨ä»»ä½•åœ°æ–¹éƒ½å¯ä»¥æ‹¿åˆ° ä¸€ä¸ªç»„ä»¶éœ€è¦æ”¹å˜å…¨å±€çŠ¶æ€ ä¸€ä¸ªç»„ä»¶éœ€è¦æ”¹å˜å¦ä¸€ä¸ªç»„ä»¶çš„çŠ¶æ€ Reduxçš„è®¾è®¡æ€æƒ³ Webåº”ç”¨æ˜¯ä¸€ä¸ªçŠ¶æ€æœºï¼Œè§†å›¾å’ŒçŠ¶æ€æ˜¯ä¸€ä¸€å¯¹åº”çš„ã€‚ æ‰€æœ‰çš„çŠ¶æ€ï¼Œéƒ½ä¿å­˜åœ¨ä¸€ä¸ªå¯¹è±¡ï¼ˆStoreï¼‰é‡Œã€‚ åŸºæœ¬æ¦‚å¿µStoreStoreæ˜¯ä¿å­˜æ•°æ®çš„åœ°æ–¹ï¼Œå¯çœ‹ä½œä¸€ä¸ªå®¹å™¨ã€‚æ•´ä¸ªåº”ç”¨åªèƒ½æœ‰ä¸€ä¸ªstoreï¼Œä¸€èˆ¬ç”¨createStoreè¿™ä¸ªæ–¹æ³•æ¥ç”ŸæˆStoreã€‚ 123import &#123; createStore &#125; from 'redux';const store = createStore(reducer, preloadedState, enhancer); storeä¸‰ä¸ªå‚æ•°çš„å«ä¹‰ï¼š reducerï¼šæ”¹å˜storeæ•°æ®çš„çº¯å‡½æ•° preloadedStateï¼šåˆå§‹çŠ¶æ€ enhancerï¼šä¸­é—´ä»¶ç›¸å…³ StateStoreå¯¹è±¡åŒ…å«æ‰€æœ‰æ•°æ®ã€‚å¦‚æœæƒ³å¾—åˆ°æŸä¸ªæ—¶é—´èŠ‚ç‚¹çš„æ•°æ®ï¼Œå°±è¦å¯¹Storeç”Ÿæˆå¿«ç…§ã€‚è¿™ç§æ—¶é—´èŠ‚ç‚¹çš„æ•°æ®é›†åˆï¼Œå°±å«åšStateã€‚ å½“å‰æ—¶åˆ»çš„Stateï¼Œå¯ä»¥é€šè¿‡store.getState()æ‹¿åˆ°ï¼š 1const state = store.getState(); ä¸€ä¸ªStateå¯¹åº”ä¸€ä¸ªViewã€‚åªè¦Stateç›¸åŒï¼ŒViewå°±ç›¸åŒã€‚ ActionStateå˜åŒ– =&gt;(å¯¼è‡´) Viewå˜åŒ–ã€‚ä½†æ˜¯ï¼Œç”¨æˆ·æ¥è§¦ä¸åˆ°Stateï¼Œåªèƒ½æ¥è§¦åˆ°Viewã€‚æ‰€ä»¥Stateçš„å˜åŒ–ä¹Ÿæ˜¯ç”±Viewå¯¼è‡´çš„ã€‚Actionå°±æ˜¯ç”¨æˆ·é€šè¿‡Viewå‘å‡ºçš„é€šçŸ¥ï¼Œè¡¨ç¤ºStateåº”è¯¥è¦å‘ç”Ÿå˜åŒ–äº†ã€‚ Actionæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå…¶ä¸­typeå±æ€§æ˜¯å¿…é¡»çš„ï¼š 1234const action =&#123; type: 'ADD_TODO', // Actionçš„åç§° payload: 'Learn Redux' // æºå¸¦çš„å­—ç¬¦ä¸²ä¿¡æ¯&#125;; payloadå±æ€§åå¯ä»¥æ˜¯ä»»æ„å…¶ä»–åç§°ï¼Œæ¯”å¦‚dataç­‰ã€‚ä¹‹åreducerå°±æ ¹æ®action.å±æ€§åæ¥è·å–æ•°æ®ï¼Œæ¯”å¦‚action.payloadï¼Œaction.dataã€‚ Action CreatorViewè¦å‘é€å¤šå°‘ç§æ¶ˆæ¯ï¼Œå°±ä¼šæœ‰å¤šå°‘ç§Actionã€‚å¦‚æœéƒ½æ‰‹å†™ï¼Œä¼šå¾ˆéº»çƒ¦ã€‚å¯ä»¥å®šä¹‰ä¸€ä¸ªå‡½æ•°æ¥ç”ŸæˆActionï¼Œè¿™ä¸ªå‡½æ•°å°±å«Action Creatorã€‚ 12345678910const ADD_TODO = 'æ·»åŠ  TODO';functionaddTodo(text)&#123; return &#123; type: ADD_TODO, text &#125;&#125;const action = addTodo('Learn Redux'); addTodoå‡½æ•°å°±æ˜¯ä¸€ä¸ªAction Creatorã€‚ store.dispatch()store.dispatch()æ˜¯Viewå‘å‡ºActionçš„å”¯ä¸€æ–¹æ³•ã€‚ store.dispatchå¯æ¥å—ä¸€ä¸ªActionå¯¹è±¡ä½œä¸ºå‚æ•°ï¼Œå°†å®ƒå‘é€å‡ºå»ï¼š 1234store.dispatch(&#123; type:'ADD_TODO', payload:'Learn Redux'&#125;); ä¹Ÿå¯ä»¥ç»“åˆAction Creatorï¼ˆè°ƒç”¨å‡½æ•°è¿”å›ä¸€ä¸ªActionå¯¹è±¡ï¼‰ï¼š 1store.dispatch(addTodo('Learn Redux')); ReducerStoreæ”¶åˆ°Actionä»¥åï¼Œå¿…é¡»ç»™å‡ºä¸€ä¸ªæ–°çš„Stateï¼Œè¿™æ ·Viewæ‰ä¼šå‘ç”Ÿå˜åŒ–ã€‚è¿™ç§Stateçš„è®¡ç®—è¿‡ç¨‹å°±å«åšReducerã€‚ Reduceræ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒæ¥å—å½“å‰Stateå’ŒActionä½œä¸ºå‚æ•°ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„Stateã€‚æ•´ä¸ªåº”ç”¨çš„åˆå§‹çŠ¶æ€ï¼Œå¯ä»¥ä½œä¸ºStateçš„é»˜è®¤å€¼ï¼š 123456789101112131415const defaultState = 0;const reducer = (state = defaultState, action) =&gt; &#123;switch (action.type) &#123;case 'ADD':return state + action.payload;default: return state; &#125;&#125;;const state = reducer(1, &#123;type: 'ADD',payload: 2&#125;); reducerå‡½æ•°æ”¶åˆ°åä¸ºADDçš„Actionä»¥åï¼Œå°±è¿”å›ä¸€ä¸ªæ–°çš„Stateï¼Œä½œä¸ºåŠ æ³•çš„è®¡ç®—ç»“æœã€‚ å®é™…åº”ç”¨ä¸­ï¼ŒReducerå‡½æ•°ä¸ç”¨åƒä¸Šé¢è¿™æ ·æ‰‹åŠ¨è°ƒç”¨ï¼Œstore.dispatchæ–¹æ³•ä¼šè§¦å‘Reducerçš„è‡ªåŠ¨æ‰§è¡Œã€‚ä¸ºæ­¤ï¼ŒStoreéœ€è¦çŸ¥é“Reducerå‡½æ•°ï¼Œåšæ³•å°±æ˜¯åœ¨ç”Ÿæˆstoreçš„æ—¶å€™ï¼Œå°†Reducerä¼ å…¥createStoreã€‚ä»¥åæ¯å½“store.dispatchå‘é€è¿‡æ¥ä¸€ä¸ªæ–°çš„Actionï¼Œå°±ä¼šè‡ªåŠ¨è°ƒç”¨Reducerï¼Œå¾—åˆ°æ–°çš„Stateã€‚ ä¸ºä»€ä¹ˆè¿™ä¸ªå‡½æ•°è¦å«Reducerï¼Ÿå› ä¸ºå®ƒå¯ä»¥ä½œä¸ºæ•°ç»„çš„reduceæ–¹æ³•çš„å‚æ•°ï¼š 123456789101112131415161718export default (state = defaultState, action) =&gt; &#123; switch(action.type) &#123; case actionTypes.CHANGE_CURRENT_ALBUM: return state.set('currentAlbum', action.data); case actionTypes.CHANGE_ENTER_LOADING: return state.set('enterLoading', action.data); default: return state; &#125;&#125;;const actions = [ &#123; type: 'ADD', payload: 0 &#125;, &#123; type: 'ADD', payload: 1 &#125;, &#123; type: 'ADD', payload: 2 &#125;];const total = actions.reduce(reducer, 0); // 3 jsæ•°ç»„api reduceæ–¹æ³•è§£æï¼š JSä¸­ reduce() çš„ç”¨æ³• reduce mdnå®˜æ–¹æ–‡æ¡£ ä¸€äº›éœ€è¦ç†Ÿè®°çš„ç‚¹ï¼š reduceçš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºreducerå‡½æ•°ï¼Œå¯ä¼ å…¥4ä¸ªå‚æ•°ï¼Œåˆ†åˆ«æ˜¯prevã€curã€indexã€arrï¼Œæ ¹æ®è‹±æ–‡å¤§è‡´èƒ½çŒœå‡ºå®ƒçš„æ„æ€ã€‚prevè¡¨ç¤ºä¸Šä¸€æ¬¡è°ƒç”¨çš„è¿”å›å€¼æˆ–è€…åˆå§‹å€¼ï¼Œcurè¡¨ç¤ºå½“å‰æ­£åœ¨å¤„ç†çš„æ•°ç»„å…ƒç´ ï¼Œindexè¡¨ç¤ºå½“å‰æ­£åœ¨å¤„ç†çš„æ•°ç»„å…ƒç´ çš„ç´¢å¼•ï¼ˆè‹¥æä¾›initå€¼ï¼Œåˆ™ç´¢å¼•ä¸º0ï¼Œå¦åˆ™ç´¢å¼•ä¸º1ï¼Œå› ä¸ºinitå€¼ä¸ç®—ä½œæ•°ç»„å…ƒç´ ï¼‰ï¼Œarrè¡¨ç¤ºåŸæ•°ç»„ reduceçš„ç¬¬äºŒä¸ªå‚æ•°ä¸ºåˆå§‹å€¼ 123arr.reduce(function(prev,cur,index,arr)&#123;...&#125;, init); å› ä¸ºreduxä¸­çš„reducerå‡½æ•°ä¸reduceæ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°reducerå‡½æ•°çš„ç»“æ„å’Œç”¨é€”ç±»ä¼¼ï¼Œæ‰€ä»¥ç§°ä¹‹ä¸ºreducerï¼ˆæŠŠstateçœ‹ä½œprevï¼Œactionçœ‹ä½œcurï¼Œè¿”å›çš„ä¹Ÿæ˜¯ä¸€ä¸ªæ–°çš„çŠ¶æ€ï¼Œä¸‹ä¸€æ¬¡dispatch actionçš„æ—¶å€™ï¼Œä¼šæ ¹æ®ä¸Šä¸€æ¬¡çš„çŠ¶æ€æ¥æ›´æ–°æˆ–è€…è¯´ç´¯åŠ ï¼‰ã€‚ çº¯å‡½æ•°Reducerå‡½æ•°æœ€é‡è¦çš„ç‰¹å¾æ˜¯ï¼šå®ƒæ˜¯ä¸€ä¸ªçº¯å‡½æ•°ï¼Œå³åªè¦æ˜¯åŒæ ·çš„è¾“å…¥ï¼Œå¿…å®šå¾—åˆ°åŒæ ·çš„è¾“å‡ºã€‚ å¹¶ä¸”å®ƒéœ€è¦éµå®ˆä»¥ä¸‹ä¸€äº›çº¦æŸï¼š ä¸å¾—æ”¹å†™å‚æ•° ä¸èƒ½è°ƒç”¨ç³»ç»ŸI/Oçš„API ä¸èƒ½è°ƒç”¨Date.now()æˆ–è€…Math.random()ç­‰ä¸çº¯çš„æ–¹æ³•ï¼Œå› ä¸ºæ¯æ¬¡ä¼šå¾—åˆ°ä¸ä¸€æ ·çš„ç»“æœ å› æ­¤ï¼ŒReducerå‡½æ•°é‡Œé¢ä¸èƒ½æ”¹å˜Stateï¼Œå¿…é¡»è¿”å›ä¸€ä¸ªå…¨æ–°çš„å¯¹è±¡ï¼š 1234567891011// State æ˜¯ä¸€ä¸ªå¯¹è±¡function reducer(state, action) &#123;return Object.assign(&#123;&#125;, state, &#123; thingToChange &#125;);// æˆ–è€…return &#123; ...state, ...newState &#125;;&#125;// State æ˜¯ä¸€ä¸ªæ•°ç»„function reducer(state, action) &#123;return [...state, newItem];&#125; store.subscribe()Storeå…è®¸ä½¿ç”¨store.subscribeæ–¹æ³•è®¾ç½®ç›‘å¬å‡½æ•°ï¼Œä¸€æ—¦Stateå‘ç”Ÿå˜åŒ–ï¼Œå°±è‡ªåŠ¨æ‰§è¡Œè¿™ä¸ªå‡½æ•°ã€‚ 1store.subscribe(listener); store.subscribeæ–¹æ³•è¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œè°ƒç”¨è¿™ä¸ªå‡½æ•°å°±å¯ä»¥è§£é™¤ç›‘å¬ã€‚ 1234let unsubscribe = store.subscribe(()=&gt; console.log(store.getState()));unsubscribe(); Storeçš„å®ç°Storeæä¾›äº†ä¸‰ä¸ªæ–¹æ³•ï¼š store.getState() store.dispatch() store.subscribe() ä¸‹é¢æ˜¯createStoreæ–¹æ³•çš„ä¸€ä¸ªç®€å•å®ç°ï¼š 12345678910111213141516171819202122const createStore = (reducer) =&gt; &#123;let state;let listeners = []; const getState = () =&gt; state; // getStateæ–¹æ³• const dispatch = (action) =&gt; &#123; // dispatchæ–¹æ³• state = reducer(state, action);\b listeners.forEach(listener =&gt; listener()); &#125;; const subscribe = (listener) =&gt; &#123; // subscribeæ–¹æ³• listeners.push(listener); return () =&gt; &#123; listeners = listeners.filter(l =&gt; l !== listener); &#125; &#125;; dispatch(&#123;&#125;); return &#123; getState, dispatch, subscribe &#125;;&#125;; Reducerçš„æ‹†åˆ†Reducerå‡½æ•°å¦‚æœä¸è¿›è¡Œæ‹†åˆ†çš„è¯ï¼Œä¼šå˜å¾—ååˆ†åºå¤§ã€‚Reduceréœ€è¦æ ¹æ®æ‰€æœ‰ç»„ä»¶çš„actionè¿›è¡Œå¤„ç†ï¼Œä»£ç çš„å¯è¯»æ€§ä¹Ÿä¼šå˜å¾—å¾ˆç³Ÿç³•ã€‚ Reduxæä¾›äº†ä¸€ä¸ªcombineReducersæ–¹æ³•ï¼Œç”¨äºReducerçš„æ‹†åˆ†ã€‚ä½ åªè¦å®šä¹‰å„ä¸ªå­Reducerå‡½æ•°ï¼Œç„¶åç”¨è¿™ä¸ªæ–¹æ³•ï¼Œå°†å®ƒä»¬åˆæˆä¸€ä¸ªå¤§çš„Reducerã€‚ 12345678910import &#123; combineReducers &#125; from 'redux';import &#123; reducer as chatLogReducer &#125; from '../application/ChatLog/store/index';import &#123; reducer as statusMessageReducer &#125; from '../application/StatusMessage/store/index';import &#123; reducer as userNameReducer &#125; from '../application/userName/store/index';const chatReducer = combineReducers(&#123; chatLog: chatLogReducer, statusMessage: statusMessageReducer, userName: userNameReducer,&#125;)ï¼› combineReducersæ–¹æ³•çš„ç”¨æ³•ï¼š 12345678910const reducer = combineReducers(&#123; stateå±æ€§å: å¯¹åº”çš„Reducer,&#125;)// ç­‰åŒäºconst reducer = (state = &#123;&#125;, action) =&gt; &#123; return &#123; stateå±æ€§å: è°ƒç”¨å¯¹åº”çš„Reducer, &#125;&#125; è¿”å›çš„æ˜¯åˆå¹¶åçš„reducerï¼Œä¹‹åç›´æ¥å°†è¿™ä¸ªåˆå¹¶åçš„reducerä½œä¸ºå‚æ•°ä¼ å…¥createStoreæ–¹æ³•ä¸­ã€‚ ä¾‹å¦‚ï¼ˆæ³¨æ„å…¶ä¸­çš„åŒºåˆ«ï¼ŒåŸç”Ÿå®ç°ä¸­æ˜¯è¦è°ƒç”¨å‡½æ•°ï¼Œè¿”å›å¯¹è±¡ï¼‰ï¼š 1234567891011121314const reducer = combineReducers(&#123; a: doSomethingWithA, b: processB, c: c&#125;)// ç­‰åŒäºfunction reducer(state = &#123;&#125;, action) &#123;return &#123; a: doSomethingWithA(state.a, action), b: processB(state.b, action), c: c(state.c, action) &#125;&#125; å·¥ä½œæµç¨‹ ï¼ˆæ³¨æ„Action Creatorsåˆ°Reducersä¹‹é—´æ˜¯è™šçº¿ï¼Œå› ä¸ºæ˜¯Storeè‡ªåŠ¨è°ƒç”¨reduceræ¥æ”¹å˜stateï¼Œæ‰€ä»¥æ˜¯è™šçº¿ï¼Œè¿™é‡Œçš„ç”»æ³•ä½“ç°äº†è¿™ä¸€æ€è·¯ã€‚ï¼‰ é¦–å…ˆï¼Œç”¨æˆ·å‘å‡ºActionã€‚ 1store.dispatch(action); Storeè‡ªåŠ¨è°ƒç”¨Reducerï¼Œå¹¶ä¼ å…¥ä¸¤ä¸ªå‚æ•°ï¼šå½“å‰Stateå’Œæ”¶åˆ°çš„Actionã€‚Reducerä¼šè¿”å›æ–°çš„Stateã€‚ Stateä¸€æ—¦æœ‰å˜åŒ–ï¼ŒStoreå°±ä¼šè°ƒç”¨ç›‘å¬å‡½æ•° 12// è®¾ç½®ç›‘å¬å‡½æ•°store.subscribe(listener); Reduxä¸­é—´ä»¶ä¸å¼‚æ­¥æ“ä½œæˆ‘ä»¬å·²ç»äº†è§£åˆ°Reduxçš„åŸºæœ¬åšæ³•ï¼šç”¨æˆ·å‘å‡ºActionï¼ŒReducerå‡½æ•°ç®—å‡ºæ–°çš„Stateï¼ŒViewé‡æ–°æ¸²æŸ“ã€‚ ä½†å¦‚æœæ¶‰åŠåˆ°å¼‚æ­¥æ“ä½œï¼Œåˆ™éœ€è¦ç”¨åˆ°æ–°çš„å·¥å…·ï¼šä¸­é—´ä»¶ã€‚ åŒæ­¥ä¸å¼‚æ­¥çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼ŸActionå‘å‡ºä»¥åï¼ŒReducerç«‹å³ç®—å‡ºStateï¼Œè¿™å«åŒæ­¥ã€‚Actionå‘å‡ºåï¼Œè¿‡ä¸€æ®µæ—¶é—´å†æ‰§è¡ŒReducerï¼Œè¿™å°±æ˜¯å¼‚æ­¥ã€‚ ä¸­é—´ä»¶çš„æ¦‚å¿µä¸­é—´ä»¶å…¶å®å°±æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå¯¹store.dispatchæ–¹æ³•è¿›è¡Œäº†æ”¹é€ ï¼Œåœ¨å‘å‡ºActionå’Œæ‰§è¡ŒReducerè¿™ä¸¤æ­¥ä¹‹é—´ï¼Œæ·»åŠ äº†å…¶ä»–åŠŸèƒ½ã€‚ æ¯”å¦‚æˆ‘ä»¬è¦æ·»åŠ æ—¥å¿—åŠŸèƒ½ï¼ŒæŠŠActionå’ŒStateæ‰“å°å‡ºæ¥ï¼Œå¯ä»¥å¯¹store.dispatchè¿›è¡Œæ”¹é€ ï¼š 123456let next = store.dispatch;store.dispatch = function dispatchAndLog(action) &#123; console.log('dispatching', action); next(action); console.log('next state', store.getState());&#125; ä»¥ä¸Šå°±æ˜¯ä¸­é—´ä»¶çš„é›å½¢ã€‚ ä¸ºä»€ä¹ˆä¸åœ¨å…¶ä»–ç¯èŠ‚æ·»åŠ è¿™ç§åŠŸèƒ½ï¼Ÿ Reducerï¼šçº¯å‡½æ•°ï¼Œåªæ‰¿æ‹…è®¡ç®—Stateçš„åŠŸèƒ½ï¼Œä¸é€‚åˆæ‰¿æ‹…å…¶ä»–åŠŸèƒ½ï¼Œå› ä¸ºçº¯å‡½æ•°ä¸èƒ½è¿›è¡Œè¯»å†™æ“ä½œã€‚ Viewï¼šä¸Stateä¸€ä¸€å¯¹åº”ï¼Œå¯çœ‹ä½œæ˜¯Stateçš„è§†è§‰å±‚ï¼Œä¹Ÿä¸é€‚åˆæ‰¿æ‹…å…¶ä»–åŠŸèƒ½ã€‚ Actionï¼šå­˜æ”¾æ•°æ®çš„å¯¹è±¡ï¼Œå³æ¶ˆæ¯çš„è½½ä½“ï¼Œåªèƒ½è¢«åˆ«äººæ“ä½œï¼Œè‡ªå·±ä¸èƒ½è¿›è¡Œä»»ä½•æ“ä½œã€‚ ä¸­é—´ä»¶çš„ç”¨æ³•å¸¸ç”¨çš„ä¸­é—´ä»¶éƒ½æœ‰ç°æˆçš„ï¼Œåªè¦å¼•ç”¨åˆ«äººå†™å¥½çš„æ¨¡å—å³å¯ã€‚æ¯”å¦‚ä¸Šé¢çš„æ—¥å¿—ä¸­é—´ä»¶ï¼Œå°±æœ‰ç°æˆçš„redux-loggeræ¨¡å—ã€‚ 12345678import &#123; applyMiddleware, createStore &#125; from 'redux';import createLogger from 'redux-logger';const logger = createLogger(); // ç”Ÿæˆæ—¥å¿—ä¸­é—´ä»¶loggerconst store = createStore( reducer, applyMiddleware(logger)); ä¸¤ç‚¹éœ€è¦æ³¨æ„ï¼š createStoreæ–¹æ³•å¯æ¥å—æ•´ä¸ªåº”ç”¨çš„åˆå§‹çŠ¶æ€ä½œä¸ºå‚æ•°ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹applyMiddlewareå°±æ˜¯ç¬¬ä¸‰ä¸ªå‚æ•°ï¼š 12345const store = createStore( reducer, initial_state, applyMiddleware(logger)); ä¸­é—´ä»¶çš„æ¬¡åºæœ‰è®²ç©¶ 1234const store = createStore( reducer, applyMiddleware(thunk, promise, logger)); applyMiddlewares()applyMiddlewaresæ˜¯Reduxçš„åŸç”Ÿæ–¹æ³•ï¼Œä½œç”¨æ˜¯å°†æ‰€æœ‰ä¸­é—´ä»¶ç»„æˆä¸€ä¸ªæ•°ç»„ï¼Œä¾æ¬¡æ‰§è¡Œã€‚å…¶æºç ä¸ºï¼š 1234567891011121314151617export default function applyMiddleware(...middlewares) &#123;return (createStore) =&gt; (reducer, preloadedState, enhancer) =&gt; &#123; var store = createStore(reducer, preloadedState, enhancer); var dispatch = store.dispatch; var chain = []; var middlewareAPI = &#123; getState: store.getState, dispatch: (action) =&gt; dispatch(action) &#125;; chain = middlewares.map(middleware =&gt; middleware(middlewareAPI)); dispatch = compose(...chain)(store.dispatch); return &#123;...store, dispatch&#125; &#125;&#125; å¯ä»¥çœ‹åˆ°å…¶ä¸­çš„middlewareAPIï¼Œé‡Œé¢æœ‰getStateå’Œdispatchæ–¹æ³•ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆå¼‚æ­¥çš„action creatorè¿”å›çš„å‡½æ•°çš„å‚æ•°å°±æ˜¯dispatchå’ŒgetStateã€‚ å¼‚æ­¥æ“ä½œçš„åŸºæœ¬æ€è·¯åŒæ­¥æ“ä½œåªè¦å‘å‡ºä¸€ç§Actionå³å¯ï¼Œå¼‚æ­¥æ“ä½œçš„å·®åˆ«æ˜¯å®ƒè¦å‘å‡ºä¸‰ç§Actionï¼ˆå¯èƒ½ä½†ä¸æ˜¯å¿…é¡»ï¼‰ï¼š æ“ä½œå‘èµ·æ—¶çš„Action æ“ä½œæˆåŠŸæ—¶çš„Action æ“ä½œå¤±è´¥æ—¶çš„Action æ‰€ä»¥æ•´ä¸ªå¼‚æ­¥æ€è·¯å°±æ˜¯ï¼š æ“ä½œå¼€å§‹æ—¶ï¼Œdispatchä¸€ä¸ªactionï¼Œè§¦å‘Stateæ›´æ–°ä¸ºâ€œæ­£åœ¨æ“ä½œâ€çŠ¶æ€ï¼ŒViewé‡æ–°æ¸²æŸ“ æ“ä½œç»“æŸæ—¶ï¼Œå†é€å‡ºä¸€ä¸ªactionï¼Œè§¦å‘Stateæ›´æ–°ä¸ºâ€œæ“ä½œç»“æŸâ€çŠ¶æ€ï¼ŒViewå†ä¸€æ¬¡é‡æ–°æ¸²æŸ“ ç»“åˆå®é™…å¼€å‘ï¼Œæ¯”å¦‚ç»„ä»¶ä¸­æœ‰ä¸ªLoadingç»„ä»¶ï¼Œä¸€èˆ¬æ˜¯åœ¨å¼€å§‹æ¸²æŸ“é¡µé¢æ—¶å±•ç¤ºè¿™ä¸ªLoadingç»„ä»¶ï¼Œåœ¨æ•°æ®åŠ è½½å®Œæˆä¹‹åï¼ŒLoadingç»„ä»¶æ¶ˆå¤±ã€‚ æ‰€ä»¥åœ¨å¼€å§‹æ¸²æŸ“é¡µé¢æ—¶ï¼Œå…ˆdispatchä¸€ä¸ªactionï¼Œå°†ä¸å±•ç¤ºLoadingç»„ä»¶ç›¸å…³çš„æ•°æ®ï¼ˆæ¯”å¦‚showï¼‰è®¾ä¸ºtrueï¼Œåœ¨å¼‚æ­¥æ•°æ®è·å–å®Œæˆåï¼Œå†dispatchä¸€ä¸ªactionï¼Œå°†showè®¾ç½®ä¸ºfalseã€‚ redux-thunkä¸­é—´ä»¶å®ç°å¼‚æ­¥æ“ä½œç»“æŸåç³»ç»Ÿè‡ªåŠ¨é€å‡ºç¬¬äºŒä¸ªActionçš„å…³é”®ï¼Œåœ¨Action Creatorä¹‹ä¸­ã€‚ æ¥çœ‹ä¸€ä¸ªè·å–ä¸“è¾‘åˆ—è¡¨çš„å¼‚æ­¥è¯·æ±‚æ“ä½œï¼š 1234567891011121314151617export const getAlbumList = (id) =&gt; &#123; return (dispatch, getState) =&gt; &#123; getAlbumDetailRequest(id).then(res =&gt; &#123; let data = res.playlist; // æ“ä½œç»“æŸ dispatch(changeCurrentAlbum(data)); dispatch(changeEnterLoading(false)); &#125;).catch(() =&gt; &#123; console.log(\"è·å–albumæ•°æ®å¤±è´¥ï¼\"); &#125;); &#125;&#125;// ä½¿ç”¨æ–¹æ³•// æ“ä½œå¼€å§‹dispatch(changeEnterLoading(true));dispatch(getAlbumList(id)); ä¸Šé¢çš„ä»£ç ï¼Œæœ‰å‡ ä¸ªåœ°æ–¹éœ€è¦æ³¨æ„ï¼š getAlbumListæ˜¯ä¸€ä¸ªAction Creatorï¼Œè¿”å›ä¸€ä¸ªå‡½æ•°ï¼ˆå’Œæ™®é€šçš„Action Creatorä¸åŒï¼Œæ™®é€šçš„Action Creatorè¿”å›ä¸€ä¸ªå¯¹è±¡ï¼‰ã€‚ getAlbumListå‡½æ•°æ‰€è¿”å›çš„å‡½æ•°çš„å‚æ•°æ˜¯dispatchå’ŒgetStateè¿™ä¸¤ä¸ªReduxæ–¹æ³•ï¼Œè€Œæ™®é€šçš„Action Creatorçš„å‚æ•°æ˜¯Actionçš„å†…å®¹ã€‚ å› ä¸ºæ­£å¸¸æƒ…å†µä¸‹ï¼Œstore.dispatchæ–¹æ³•çš„å‚æ•°åªèƒ½æ˜¯å¯¹è±¡ï¼Œä¸èƒ½æ˜¯å‡½æ•°ï¼Œæ‰€ä»¥å°±è¦ä½¿ç”¨redux-thunkï¼ˆæ˜¯å› ä¸ºéœ€è¦æ»¡è¶³è¿™æ ·çš„Action Creatorï¼Œä»¥å†…å®¹ä½œä¸ºå‚æ•°ï¼Œå’Œæ™®é€šçš„Action Creatorä¸€æ ·ï¼Œä½†æ˜¯è¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œä»¥dispatchå’ŒgetStateä½œä¸ºå‚æ•°ï¼Œè¿™æ ·åœ¨å¼‚æ­¥è¯·æ±‚å®Œæˆä¹‹åæ‰èƒ½å†dispatch actionï¼Œæ›´æ–°Stateï¼Œè¡¨ç¤ºæ“ä½œç»“æŸï¼Œæ‰€ä»¥æ‰æœ‰redux-thunkï¼‰ã€‚ 123456789import &#123; createStore, applyMiddleware &#125; from 'redux';import thunk from 'redux-thunk';import reducer from './reducers';// Note: this API requires redux@&gt;=3.1.0const store = createStore( reducer, applyMiddleware(thunk)); ä¸Šé¢ä»£ç ä½¿ç”¨redux-thunkä¸­é—´ä»¶ï¼Œæ”¹é€ store.dispatchï¼Œä½¿å¾—åè€…å¯ä»¥æ¥å—å‡½æ•°ä½œä¸ºå‚æ•°ã€‚ å› æ­¤ï¼Œå¼‚æ­¥æ“ä½œçš„ç¬¬ä¸€ç§è§£å†³æ–¹æ¡ˆå°±æ˜¯ï¼š å†™å‡ºä¸€ä¸ªè¿”å›å‡½æ•°çš„Action Creator ä½¿ç”¨redux-thunkä¸­é—´ä»¶æ”¹é€ store.dispatch React-Reduxçš„ç”¨æ³•UIç»„ä»¶React-Reduxå°†æ‰€æœ‰ç»„ä»¶åˆ†æˆä¸¤å¤§ç±»ï¼šUIç»„ä»¶å’Œå®¹å™¨ç»„ä»¶ã€‚ UIç»„ä»¶æœ‰ä»¥ä¸‹å‡ ä¸ªç‰¹å¾ï¼š åªè´Ÿè´£UIçš„å‘ˆç°ï¼Œä¸å¸¦æœ‰ä»»ä½•ä¸šåŠ¡é€»è¾‘ æ²¡æœ‰çŠ¶æ€ï¼ˆå³ä¸ä½¿ç”¨this.stateè¿™ä¸ªå˜é‡ï¼‰ æ‰€æœ‰æ•°æ®éƒ½ç”±å‚æ•°ï¼ˆthis.propsï¼‰æä¾› ä¸ä½¿ç”¨ä»»ä½•Reduxçš„API ä¾‹å¦‚ï¼š 1const Title = value =&gt;&lt;h1&gt;&#123;value&#125;&lt;/h1&gt;; å› ä¸ºä¸å«æœ‰çŠ¶æ€ï¼ŒUIç»„ä»¶åˆç§°ä¸ºâ€œçº¯ç»„ä»¶â€ï¼Œå³å®ƒåƒçº¯å‡½æ•°ä¸€æ ·ï¼Œçº¯ç²¹ç”±å‚æ•°å†³å®šå®ƒçš„å€¼ã€‚ å®¹å™¨ç»„ä»¶å®¹å™¨ç»„ä»¶çš„ç‰¹å¾åˆ™ç›¸åï¼š è´Ÿè´£ç®¡ç†æ•°æ®å’Œä¸šåŠ¡é€»è¾‘ï¼Œä¸è´Ÿè´£UIçš„å‘ˆç° å¸¦æœ‰å†…éƒ¨çŠ¶æ€ ä½¿ç”¨Reduxçš„API ä¹Ÿå°±æ˜¯ï¼šUIç»„ä»¶è´Ÿè´£UIçš„å‘ˆç°ï¼Œå®¹å™¨ç»„ä»¶è´Ÿè´£ç®¡ç†æ•°æ®å’Œé€»è¾‘ã€‚ å¦‚æœ ä¸€ä¸ªç»„ä»¶æ—¢æœ‰UIåˆæœ‰ä¸šåŠ¡é€»è¾‘æ€ä¹ˆåŠï¼Ÿåœ¨è¿™ç§æƒ…å†µä¸‹éœ€è¦å°†å®ƒè¿›è¡Œæ‹†åˆ†ï¼Œå¤–é¢æ˜¯ä¸€ä¸ªå®¹å™¨ç»„ä»¶ï¼Œé‡Œé¢åŒ…å«ä¸€ä¸ªUIç»„ä»¶ã€‚å‰è€…è´Ÿè´£ä¸å¤–éƒ¨çš„é€šä¿¡ï¼Œå°†æ•°æ®ä¼ ç»™åè€…ï¼Œç”±åè€…æ¸²æŸ“å‡ºè§†å›¾ã€‚ React-Reduxè§„å®šï¼Œæ‰€æœ‰çš„UIç»„ä»¶éƒ½ç”±ç”¨æˆ·æä¾›ï¼Œå®¹å™¨ç»„ä»¶åˆ™æ˜¯React-Reduxè‡ªåŠ¨ç”Ÿæˆï¼ˆé€šè¿‡connectï¼‰ã€‚ connectReact-Reduxæä¾›connectæ–¹æ³•ï¼Œç”¨äºä»UIç»„ä»¶ç”Ÿæˆå®¹å™¨ç»„ä»¶ã€‚ å®¹å™¨ç»„ä»¶éœ€è¦æœ‰ä¸šåŠ¡é€»è¾‘æ‰æ˜¯æœ‰æ„ä¹‰çš„ï¼Œæ‰€ä»¥ä¸ºäº†å®šä¹‰ä¸šåŠ¡é€»è¾‘ï¼Œéœ€è¦ç»™å‡ºä¸‹é¢ä¸¤æ–¹é¢çš„ä¿¡æ¯ï¼š è¾“å…¥é€»è¾‘ï¼ˆmapStateToPropsï¼‰ï¼šå¤–éƒ¨çš„æ•°æ®ï¼ˆå³stateå¯¹è±¡ï¼‰å¦‚ä½•è½¬æ¢ä¸ºUIç»„ä»¶çš„å‚æ•°ã€‚ è¾“å‡ºé€»è¾‘ï¼ˆmapDispatchToPropsï¼‰ï¼šç”¨æˆ·å‘å‡ºçš„åŠ¨ä½œå¦‚ä½•å˜ä¸ºActionå¯¹è±¡ï¼Œä»UIç»„ä»¶ä¼ å‡ºå»ã€‚ connectæ–¹æ³•çš„å®Œæ•´APIä¸ºï¼š 1234567import &#123; connect &#125; from 'react-redux'// TodoListä¸ºUIç»„ä»¶const VisibleTodoList = connect(mapStateToProps,mapDispatchToProps)(TodoList) mapStateToProps()mapStateToPropsæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæ¥å—stateä½œä¸ºå‚æ•°ï¼Œè¿”å›ä¸€ä¸ªå¯¹è±¡ï¼š 12345const mapStateToProps = (state) =&gt; (&#123; currentAlbum: state.getIn([\"album\", \"currentAlbum\"]), enterLoading: state.getIn([\"album\", \"enterLoading\"]), songsCount: state.getIn([\"player\", \"playList\"]).size,&#125;); mapStateToPropsä¼šè®¢é˜…Storeï¼Œæ¯å½“stateæ›´æ–°çš„æ—¶å€™ï¼Œå°±ä¼šè‡ªåŠ¨æ‰§è¡Œï¼Œé‡æ–°è®¡ç®—UIç»„ä»¶çš„å‚æ•°ï¼Œä»è€Œè§¦å‘UIç»„ä»¶çš„é‡æ–°æ¸²æŸ“ã€‚ mapDispatchToProps()mapDispatchToPropsæ˜¯connectå‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°ï¼Œç”¨æ¥å»ºç«‹UIç»„ä»¶çš„å‚æ•°ï¼ˆpropsï¼‰åˆ°store.dispatchæ–¹æ³•çš„æ˜ å°„ã€‚å®ƒå®šä¹‰äº†å“ªäº›ç”¨æˆ·çš„æ“ä½œåº”è¯¥å½“åšActionï¼Œä¼ ç»™Storeã€‚ 12345678const mapDispatchToProps = (dispatch) =&gt; &#123; return &#123; getAlbumDataDispatch(id) &#123; dispatch(changeEnterLoading(true)); dispatch(getAlbumList(id)); &#125;, &#125;;&#125;; ç»„ä»¶å†…éƒ¨å°±å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼è·å–æ•°æ®å’Œæ–¹æ³•ï¼š 123456const &#123; currentAlbum, enterLoading, songsCount, &#125; = props;const &#123; getAlbumDataDispatch &#125; = props; exportç»„ä»¶çš„æ—¶å€™éœ€è¦ç”¨connectåŒ…è£¹ï¼š 1export default connect(mapStateToProps, mapDispatchToProps)(React.memo(Album)); Providerç»„ä»¶connectæ–¹æ³•ç”Ÿæˆç»„ä»¶ä»¥åï¼Œéœ€è¦è®©å®¹å™¨ç»„ä»¶æ‹¿åˆ°stateå¯¹è±¡ï¼ˆæ¯”å¦‚mapStateToPropsçš„å‚æ•°stateï¼‰ï¼Œæ‰èƒ½ç”ŸæˆUIç»„ä»¶çš„å‚æ•°ã€‚ React-Reduxæä¾›Providerç»„ä»¶ï¼Œå¯ä»¥è®©å®¹å™¨ç»„ä»¶æ‹¿åˆ°stateã€‚ 123456789101112131415161718192021// App.jsimport React from 'react';import &#123; Provider &#125; from 'react-redux';import &#123; renderRoutes &#125; from 'react-router-config';import routes from './routes/index.js';import &#123; HashRouter &#125; from 'react-router-dom';import store from './store/index';function App() &#123; return ( &lt;Provider store=&#123;store&#125;&gt; &lt;HashRouter&gt; &lt;div className=\"App\"&gt; &#123;renderRoutes(routes)&#125; &lt;/div&gt; &lt;/HashRouter&gt; &lt;/Provider&gt; );&#125;export default App; 123456789101112// store/index.jsimport &#123; createStore, compose, applyMiddleware &#125; from 'redux';import thunk from 'redux-thunk';import reducer from './reducer';const composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;const store = createStore(reducer, composeEnhancers(// ç”¨äºå¼‚æ­¥æ“ä½œï¼Œä½¿å¾—dispatchèƒ½å¤Ÿæ¥å—å‡½æ•°ä½œä¸ºå‚æ•°ï¼Œè‡ªåŠ¨å‘å‡ºç¬¬äºŒä¸ªactionapplyMiddleware(thunk)));export default store; Provideråœ¨æ ¹ç»„ä»¶å¤–åŒ…äº†ä¸€å±‚ï¼Œè¿™æ ·ä¸€æ¥ï¼ŒAppçš„æ‰€æœ‰å­ç»„ä»¶å°±é»˜è®¤éƒ½èƒ½æ‹¿åˆ°stateã€‚ å®ƒçš„åŸç†æ˜¯Reactç»„ä»¶çš„contextå±æ€§ï¼Œå¯ä»¥çœ‹contextç¬”è®°ã€‚","categories":[{"name":"React","slug":"React","permalink":"http://delaprada.com/categories/React/"}],"tags":[{"name":"React","slug":"React","permalink":"http://delaprada.com/tags/React/"}]},{"title":"pm2å®‰è£…ä¸ä½¿ç”¨","slug":"pm2å®‰è£…ä¸ä½¿ç”¨","date":"2021-01-03T02:14:37.000Z","updated":"2021-01-03T02:46:16.000Z","comments":true,"path":"2021/01/03/pm2å®‰è£…ä¸ä½¿ç”¨/","link":"","permalink":"http://delaprada.com/2021/01/03/pm2%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/","excerpt":"","text":"æˆ‘ä»¬åœ¨å¯åŠ¨ä¸€ä¸ªserver.jsæ—¶ä¸€èˆ¬ä¼šä½¿ç”¨æŒ‡ä»¤ï¼š 1node server.js ä½†æ˜¯åœ¨ç»ˆç«¯å…³é—­ä¹‹åï¼ŒæœåŠ¡å°±ä¼šåœæ­¢äº†ã€‚æ‰€ä»¥æ­¤æ—¶å¯ä»¥åˆ©ç”¨PM2ç®¡ç†å·¥å…·ï¼Œå®‰è£…åæ‰§è¡Œæ‰§è¡Œï¼š 1pm2 start ./server.js æ­¤æ—¶å…³é—­ç»ˆç«¯æœåŠ¡ä¹Ÿä¸ä¼šåœæ­¢ã€‚ä¸‹é¢å°±ä»‹ç»ä¸€ä¸‹è¿™ä¸ªå·¥å…·ã€‚ ä»€ä¹ˆæ˜¯PM2PM2æ˜¯nodeè¿›ç¨‹ç®¡ç†å·¥å…·ï¼Œå¯ä»¥åˆ©ç”¨å®ƒæ¥ç®€åŒ–å¾ˆå¤šnodeåº”ç”¨ç®¡ç†çš„ç¹çä»»åŠ¡ï¼Œä¾‹å¦‚æ€§èƒ½ç›‘æ§ã€è‡ªåŠ¨é‡å¯ã€è´Ÿè½½å‡è¡¡ç­‰ï¼Œè€Œä¸”ä½¿ç”¨èµ·æ¥éå¸¸ç®€å•ã€‚ å®‰è£…123npm install pm2@latest -goryarn global add pm2 å¯åŠ¨ä¸€ä¸ªapp1pm2 start app.js åŒæ—¶ä¹Ÿå¯ä»¥è½»æ¾åœ°å¯åŠ¨å…¶ä»–åº”ç”¨ï¼š 123pm2 start bashscript.shpm2 start python-app.py --watchpm2 start binary-file -- --port 1520 ä¸€äº›å¯ä»¥ä¼ å…¥cliçš„å‚æ•°ï¼š 1234567891011121314151617181920212223242526272829# Specify an app name--name &lt;app_name&gt;# Watch and Restart app when files change--watch# Set memory threshold for app reload--max-memory-restart &lt;200MB&gt;# Specify log file--log &lt;log_path&gt;# Pass extra arguments to the script-- arg1 arg2 arg3# Delay between automatic restarts--restart-delay &lt;delay in ms&gt;# Prefix logs with time--time# Do not auto restart app--no-autorestart# Specify cron for forced restart--cron &lt;cron_pattern&gt;# Attach to application log--no-daemon ç®¡ç†è¿›ç¨‹é‡å¯ï¼š 1pm2 restart app_name 0ç§’åœæœºé‡è½½è¿›ç¨‹ï¼š 1pm2 reload app_name åœæ­¢è¿›ç¨‹ï¼š 1pm2 stop app_name åˆ é™¤è¿›ç¨‹ï¼š 1pm2 stop app_name é™¤äº†app_nameä»¥å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä¼ å…¥ï¼š allï¼šå¯¹æ‰€æœ‰è¿›ç¨‹æ‰§è¡Œè¯¥æ“ä½œ idï¼šå¯¹idå¯¹åº”çš„è¿›ç¨‹æ‰§è¡Œè¯¥æ“ä½œ æŸ¥çœ‹è¿›ç¨‹çŠ¶æ€ï¼š 1pm2 list ç¯å¢ƒé…ç½®å£°æ˜PM2å¯ä»¥è®©ä½¿ç”¨è€…ç®¡ç†å·¥ä½œæµã€‚å®ƒå¯ä»¥è®©ä½ é€šè¿‡ä¸€ä¸ªè¿›ç¨‹æ–‡ä»¶æ¥è°ƒæ•´ä½ çš„è¡Œä¸ºã€é€‰æ‹©ã€ç¯å¢ƒå˜é‡ã€æ¯ä¸ªåº”ç”¨çš„æ—¥å¿—æ–‡ä»¶ã€‚å¯¹äºå¾®æœåŠ¡åº”ç”¨æ¥è¯´æ˜¯æœ€æœ‰ç”¨çš„ã€‚ é…ç½®æ–‡ä»¶æ”¯æŒjsã€JSONã€YAMLæ ¼å¼ã€‚ ç”Ÿæˆé…ç½®æ–‡ä»¶ç”Ÿæˆä¸€ä¸ªè¿›ç¨‹æ–‡ä»¶æ¨¡æ¿ï¼š 1pm2 ecosystem æ‰§è¡ŒæŒ‡ä»¤åä¼šç”Ÿæˆä¸€ä¸ªæ¨¡æ¿ecosystem.config.jsï¼š 123456789101112module.exports = &#123; apps : [&#123; name: \"app\", script: \"./app.js\", env: &#123; NODE_ENV: \"development\", &#125;, env_production: &#123; NODE_ENV: \"production\", &#125; &#125;]&#125; å½“ä½ ç¼–è¾‘å®Œè¿™ä¸ªæ–‡ä»¶ä¹‹åå¯ä»¥é€šè¿‡clié‡æ–°æ‰§è¡Œè¯¥æ–‡ä»¶ï¼š 1pm2 [start|restart|stop|delete] ecosystem.config.js åœ¨å®é™…é¡¹ç›®å¼€å‘ä¸­ï¼Œæˆ‘ä»¬çš„åº”ç”¨ç»å¸¸éœ€è¦åœ¨å¤šä¸ªç¯å¢ƒä¸‹éƒ¨ç½²ï¼Œæ¯”å¦‚å¼€å‘ç¯å¢ƒã€æµ‹è¯•ç¯å¢ƒã€ç”Ÿäº§ç¯å¢ƒç­‰ã€‚åœ¨ä¸åŒç¯å¢ƒä¸‹ï¼Œæœ‰æ—¶å€™é…ç½®é¡¹ä¼šæœ‰å·®å¼‚ï¼Œæ¯”å¦‚é“¾æ¥çš„æ•°æ®åº“åœ°å€ä¸åŒç­‰ã€‚ å¯¹äºè¿™ç§åœºæ™¯ï¼Œpm2ä¹Ÿæ˜¯å¯ä»¥å¾ˆå¥½æ”¯æŒçš„ã€‚é¦–å…ˆé€šè¿‡åœ¨é…ç½®æ–‡ä»¶ä¸­é€šè¿‡env_xxæ¥å£°æ˜ä¸åŒç¯å¢ƒçš„é…ç½®ï¼Œç„¶ååœ¨å¯åŠ¨åº”ç”¨æ—¶ï¼Œé€šè¿‡--envå‚æ•°æŒ‡å®šè¿è¡Œçš„ç¯å¢ƒã€‚ åœ¨é…ç½®æ–‡ä»¶ä¸­ï¼Œé€šè¿‡envé€‰é¡¹å£°æ˜å¤šä¸ªç¯å¢ƒé…ç½®ï¼š envä¸ºé»˜è®¤çš„ç¯å¢ƒé…ç½®ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰ï¼Œenv_devã€env_teståˆ™åˆ†åˆ«æ˜¯å¼€å‘ç¯å¢ƒå’Œæµ‹è¯•ç¯å¢ƒã€‚å¯ä»¥çœ‹åˆ°ï¼Œä¸åŒç¯å¢ƒä¸‹çš„NODE_ENVã€REMOTE_ADDRå­—æ®µçš„å€¼æ˜¯ä¸åŒçš„ã€‚ åœ¨åº”ç”¨ä¸­ï¼Œå¯ä»¥é€šè¿‡process.env.REMOTE_ADDRç­‰æ¥è¯»å–é…ç½®ä¸­ç”Ÿå‘½çš„å˜é‡ã€‚ 1234567891011121314\"env\": &#123; \"NODE_ENV\": \"production\", \"REMOTE_ADDR\": \"http://www.example.com/\" &#125;, \"env_dev\": &#123; \"NODE_ENV\": \"development\", \"REMOTE_ADDR\": \"http://wdev.example.com/\" &#125;, \"env_test\": &#123; \"NODE_ENV\": \"test\", \"REMOTE_ADDR\": \"http://wtest.example.com/\" &#125; å¯åŠ¨æ—¶æŒ‡æ˜ç¯å¢ƒå‡è®¾é€šè¿‡ä¸‹é¢å¯åŠ¨è„šæœ¬ï¼ˆå¼€å‘ç¯å¢ƒï¼‰ï¼Œé‚£ä¹ˆï¼Œæ­¤æ—¶process.env.REMOTE_ADDRçš„å€¼å°±æ˜¯ç›¸åº”çš„ http://wdev.example.com/ ï¼Œå¯ä»¥è‡ªå·±è¯•éªŒä¸‹ã€‚ 1pm2 start app.js --env dev è´Ÿè½½å‡è¡¡å‘½ä»¤å¦‚ä¸‹ï¼Œè¡¨ç¤ºå¼€å¯ä¸‰ä¸ªè¿›ç¨‹ã€‚å¦‚æœä¼ å‚ä¸º-i maxï¼Œåˆ™ä¼šæ ¹æ®æœºå™¨å½“å‰æ ¸æ•°è‡ªåŠ¨å¼€å¯å°½å¯èƒ½å¤šçš„è¿›ç¨‹ã€‚ 12pm2 start app.js -i 3pm2 start app.js -i max æ—¥å¿—æŸ¥çœ‹é™¤äº†å¯ä»¥æ‰“å¼€æ—¥å¿—æ–‡ä»¶æŸ¥çœ‹æ—¥å¿—å¤–ï¼Œè¿˜å¯ä»¥é€šè¿‡pm2 logsæ¥æŸ¥çœ‹å®æ—¶æ—¥å¿—ã€‚è¿™ç‚¹å¯¹äºçº¿ä¸Šé—®é¢˜æ’æŸ¥éå¸¸é‡è¦ã€‚ æ¯”å¦‚æŸä¸ªnodeæœåŠ¡çªç„¶å¼‚å¸¸é‡å¯äº†ï¼Œé‚£ä¹ˆå¯ä»¥é€šè¿‡pm2æä¾›çš„æ—¥å¿—å·¥å…·æ¥æŸ¥çœ‹å®æ—¶æ—¥å¿—ï¼Œçœ‹æ˜¯ä¸æ˜¯è„šæœ¬å‡ºé”™ä¹‹ç±»å¯¼è‡´çš„å¼‚å¸¸é‡å¯ã€‚ 1pm2 logs","categories":[{"name":"Node.js","slug":"Node-js","permalink":"http://delaprada.com/categories/Node-js/"}],"tags":[{"name":"Node.js","slug":"Node-js","permalink":"http://delaprada.com/tags/Node-js/"}]},{"title":"useRef vs useState: æˆ‘ä»¬æ˜¯å¦éœ€è¦é‡æ¸²æŸ“","slug":"useRef-vs-useState-æˆ‘ä»¬æ˜¯å¦éœ€è¦é‡æ¸²æŸ“","date":"2020-12-28T01:40:47.000Z","updated":"2020-12-28T02:48:34.000Z","comments":true,"path":"2020/12/28/useRef-vs-useState-æˆ‘ä»¬æ˜¯å¦éœ€è¦é‡æ¸²æŸ“/","link":"","permalink":"http://delaprada.com/2020/12/28/useRef-vs-useState-%E6%88%91%E4%BB%AC%E6%98%AF%E5%90%A6%E9%9C%80%E8%A6%81%E9%87%8D%E6%B8%B2%E6%9F%93/","excerpt":"","text":"TL;DRï¼ˆToo Long, Donâ€™t Readï¼‰ useStateä¼šå¯¼è‡´re-renderï¼›useRefä¸ä¼š useStateå’ŒuseRefåœ¨é‡æ¸²æŸ“åéƒ½ä¼šè®°ä½å®ƒä»¬ä¹‹å‰çš„å€¼ å¼€å§‹å­¦ä¹ Reactå¹¶ä¸éš¾ï¼Œéš¾ç‚¹åœ¨äºç†è§£Reactçš„ç”Ÿå‘½å‘¨æœŸä»¥åŠre-renderã€‚åœ¨hookè¿™äº›æ–°çš„apiå‡ºç°ä¹‹åï¼Œæˆ‘ä»¬è„‘æµ·ä¸­ä¼šäº§ç”Ÿæ›´å¤šå…³äºReactçš„re-renderï¼ˆå³è™šæ‹ŸDOMæ˜¯åœ¨ä»€ä¹ˆæ—¶å€™æ€ä¹ˆæ ·è¿›è¡Œåè°ƒreconciliationçš„ï¼‰çš„é—®é¢˜ã€‚ Reconciliationï¼ˆåè°ƒï¼‰æ˜¯æŒ‡ä»…åœ¨DOMæ ‘çš„diffå‘ç”Ÿå˜åŒ–æ—¶è¿›è¡Œé‡æ¸²æŸ“ã€‚ æˆ‘ä»¬ä¸ºä»€ä¹ˆéœ€è¦çŸ¥é“ä»€ä¹ˆæ—¶å€™è¿›è¡Œé‡æ¸²æŸ“ï¼š re-renderæ˜¯åŸºäºæœ€æ–°çš„å˜åŒ–ï¼ˆlatest changesï¼‰æ¥æ›´æ–°UIå±‚ re-renderå¯¼è‡´DOMæ ‘åè°ƒæ˜¯å½±å“æ€§èƒ½ï¼ˆperformance factorï¼‰çš„ä¸€å¤§å› ç´  ä»€ä¹ˆå¯¼è‡´re-renderReactçš„re-renderç»™æˆ‘ä»¬å±•ç¤ºäº†ï¼Œæˆ‘ä»¬é€šè¿‡äº‹ä»¶ï¼ˆeventsï¼‰ã€è¯·æ±‚ï¼ˆrequestsï¼‰ã€å®šæ—¶å™¨ï¼ˆtimersï¼‰ç­‰æ–¹å¼å¯¹æ•°æ®å±‚åšå‡ºçš„æ”¹å˜ã€‚ä½†å®ƒä»¬å¹¶ä¸æ˜¯çœŸæ­£çš„è§¦å‘è€…ï¼ˆtriggersï¼‰â€”â€”stateçš„æ”¹å˜æ‰æ˜¯çœŸæ­£çš„è§¦å‘è€…ï¼ˆè§¦å‘re-renderï¼‰ã€‚è¿™ä¸ªæ˜¯åˆç†çš„ï¼Œå› ä¸ºäº‹ä»¶ã€è¯·æ±‚æœ€ç»ˆéƒ½æ˜¯é€šè¿‡æ›´æ–°stateæ¥è§¦å‘re-renderã€‚ å½“ç»„ä»¶æ˜¯åµŒå¥—ç€çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¾¿å¾ˆéš¾å‡†ç¡®åˆ¤æ–­stateæ”¹å˜æ˜¯æ€ä¹ˆè§¦å‘UIå±‚çš„å˜åŒ–çš„ã€‚è¿™ä¹Ÿæ˜¯ç»å¸¸å›°æƒ‘æ–°æ‰‹çš„ç‚¹ã€‚ 123456789101112function App() &#123; const [value, setValue] = React.useState(\"\"); const handleInputChange = e =&gt; &#123; setValue(e.target.value); &#125;; return ( &lt;div className=\"App\"&gt; &lt;Input value=&#123;value&#125; onChange=&#123;handleInputChange&#125; /&gt; &lt;Button&gt;Button&lt;/Button&gt; &lt;/div&gt; );&#125; åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼ŒAppç»„ä»¶ç”±ä¸¤ä¸ªå­ç»„ä»¶Inputå’ŒButtonï¼Œä½ è§‰å¾—å½“ç”¨æˆ·åœ¨inputä¸­è¾“å…¥å†…å®¹æ—¶DOMæ ‘çš„å“ªä¸€éƒ¨åˆ†ä¼šå‘ç”Ÿé‡æ¸²æŸ“å‘¢ï¼Ÿ 123const Input = (&#123; value, onChange &#125;) =&gt; ( &lt;input value=&#123;value&#125; onChange=&#123;onChange&#125; /&gt;); è§£é‡Šä¸€ä¸‹åµŒå¥—ç»„ä»¶åµŒå¥—ç»„ä»¶æ˜¯æœ€å›°æ‰°æ–°æ‰‹ä»¬çš„ç‚¹äº†ã€‚ä»–ä»¬æ€»æ˜¯ä¼šæƒ³ç€propsä¹Ÿä¼šè§¦å‘re-renderï¼Œæˆ‘æ—¶å¸¸ä¼šå¬åˆ°ï¼šâ€œä½†Inputæ²¡æœ‰stateï¼Œå®ƒåªæœ‰propsã€‚ä½†å®ƒre-renderäº†ï¼Œä¸ºä»€ä¹ˆï¼Ÿâ€ ä¸ºäº†è¯æ˜InputçœŸçš„re-renderï¼Œæˆ‘ä»¬é€šè¿‡React&#39;s dev toolæ¥æ£€æµ‹ã€‚ç‚¹å‡»settings/gear iconï¼Œç‚¹å‡»Highlight Updateé”®ã€‚ å½“æˆ‘ä»¬åœ¨inputä¸­è¾“å…¥å†…å®¹æ—¶ï¼Œä¼šå‘ç°Appã€Inputã€Buttonéƒ½æç¤ºåœ¨re-renderï¼Œè¿™ç§re-renderçš„è§¦å‘åªæ˜¯å› ä¸ºæ”¹å˜äº†å…¶ä¸­ä¸€ä¸ªå­ç»„ä»¶Inputçš„å†…å®¹ã€‚è¿™ç§æ›´æ–°å‡†ç¡®æ¥è¯´å¹¶ä¸æ˜¯inputå†…å®¹å˜åŒ–æ‰€å¯¼è‡´çš„ï¼Œè€Œæ˜¯å› ä¸ºAppç»„ä»¶ä¸­çš„state valueå‘ç”Ÿå˜åŒ–å¯¼è‡´çš„ã€‚ å› æ­¤æˆ‘ä»¬å¯ä»¥å¾—å‡ºç»“è®ºï¼šåªè¦Appçš„stateå‘ç”Ÿå˜åŒ–ï¼Œæ¯ä¸ªAppçš„å­ç»„ä»¶éƒ½ä¼šre-renderã€‚ä¹Ÿæœ‰ä¾‹å¤–ï¼Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨PureComponentæˆ–è€…shouldComponentUpdateæ˜¾å¼åœ°è¡¨æ˜Inputå’ŒButtonä¸ä¼šre-renderï¼Œåˆ™å­ç»„ä»¶Inputå’ŒButtonä¸ä¼šre-renderã€‚ é™¤äº†ä½¿ç”¨PureComponentå’ŒshouldComponentUpdateä»¥å¤–ï¼Œæœ‰ä¸¤ç§åŠæ³•èƒ½å¤Ÿæ§åˆ¶re-renderã€‚ç¬¬ä¸€ç§åŠæ³•æ˜¯å°†stateé€»è¾‘ä»AppæŒªåˆ°Inputå­ç»„ä»¶ä¸­ã€‚ 1234567const Input = () =&gt; &#123; const [value, setValue] = React.useState(\"\"); const handleInputChange = e =&gt; &#123; setValue(e.target.value); &#125;; return &lt;input value=&#123;value&#125; onChange=&#123;handleInputChange&#125; /&gt;;&#125;; è¿™ä¹ˆåšçš„è¯ï¼ŒAppå°±ä¸ä¼šæ›´æ–°ï¼Œå› ä¸ºstateæŒªåˆ°äº†å­ç»„ä»¶Inputä¸­ã€‚Appä¸ä¼šæ›´æ–°ä¹Ÿæ„å‘³ç€Buttonä¹Ÿä¸ä¼šæ›´æ–°ã€‚ è¿™é‡Œå…³é”®çš„ä¸€ç‚¹æ˜¯â€”â€”å°½ç®¡åè°ƒï¼ˆreconciliationï¼‰èƒ½å¤Ÿä½¿å¾—Reactå˜å¾—æ›´å¿«ï¼Œåœ¨ä¸€äº›å¤æ‚çš„DOMåœºæ™¯ä¸‹ä¹Ÿä¼šå¯¼è‡´æ€§èƒ½ç“¶é¢ˆã€‚æ‰€ä»¥ï¼Œä¸è¦ç›²ç›®åœ°ä¼˜åŒ–ï¼ˆdo not blindly optimizeï¼‰ã€‚ åœ¨ä¸re-renderçš„æƒ…å†µä¸‹ä¿å­˜æ•°æ®åœ¨æ•°æ®å‘ç”Ÿå˜åŒ–å’ŒUIæ›´æ–°æ—¶ï¼Œstateä¼šä¿å­˜ç€æ•°æ®ã€‚åœ¨æœ‰äº›æƒ…å†µä¸‹ï¼ŒUIçš„æ›´æ–°æ˜¯æ²¡æœ‰ä»€ä¹ˆå¿…è¦çš„ã€‚ éå—æ§ç»„ä»¶é¿å…åœ¨stateä¸­ä¿å­˜æ•°æ®ï¼Œå®ƒä»¬ä¼šé€‰æ‹©åœ¨refsä¸­ä¿å­˜æ•°æ®ã€‚ä¸‹é¢çš„ä¾‹å­ä½¿ç”¨refæ¥å¤„ç†è¡¨æ ¼åœºæ™¯ï¼š 12345678910111213141516function App() &#123; const [value, setValue] = React.useState(\"\"); const valueRef = React.useRef(); const handleClick = e =&gt; &#123; setValue(valueRef.current.value); &#125;; return ( &lt;div className=\"App\"&gt; &lt;h4&gt;Value: &#123;value&#125;&lt;/h4&gt; &lt;input ref=&#123;valueRef&#125; /&gt; &lt;Button onClick=&#123;handleClick&#125;&gt;Button&lt;/Button&gt; &lt;/div&gt; );&#125; å› ä¸ºæˆ‘ä»¬æ²¡æœ‰åœ¨inputä¸­ä½¿ç”¨stateæ¥å­˜å‚¨å…¶valueï¼Œæ‰€ä»¥å½“æˆ‘ä»¬å¡«å†™è¡¨æ ¼çš„æ—¶å€™æ˜¯æ²¡æœ‰re-renderã€‚åªæœ‰å½“æˆ‘ä»¬ç‚¹å‡»buttonæ—¶ï¼Œæ‰å°†refä¸­çš„current.valueèµ‹å€¼ç»™stateä¸­çš„valueã€‚ æ‰€ä»¥refä¸åªå¯ä»¥ç”¨äºè®¿é—®DOMèŠ‚ç‚¹ï¼Œè¿˜å¯ä»¥ç”¨æ¥å­˜å‚¨æ•°æ®ã€‚ å—æ§ç»„ä»¶æ˜¯éå—æ§ç»„ä»¶çš„åä¹‰è¯ï¼Œå®ƒä»¬æ˜¯ä½¿ç”¨stateä½œä¸ºæ•°æ®å­˜å‚¨çš„ç»„ä»¶ã€‚å—æ§ç»„ä»¶å¹¶ä¸å·®ï¼ˆbadï¼‰ï¼Œå®é™…ä¸Šï¼Œå®ƒä»¬æ˜¯æœ€ä¸ºæ¨èçš„ã€‚ å‚è€ƒï¼š https://www.codebeast.dev/usestate-vs-useref-re-render-or-not/","categories":[{"name":"React","slug":"React","permalink":"http://delaprada.com/categories/React/"}],"tags":[{"name":"React","slug":"React","permalink":"http://delaprada.com/tags/React/"}]},{"title":"strokeå­¦ä¹ ä¹‹stroke-dasharrayå’Œstroke-dashoffset","slug":"strokeå­¦ä¹ ä¹‹stroke-dasharrayå’Œstroke-dashoffset","date":"2020-12-26T01:01:00.000Z","updated":"2020-12-26T06:36:20.000Z","comments":true,"path":"2020/12/26/strokeå­¦ä¹ ä¹‹stroke-dasharrayå’Œstroke-dashoffset/","link":"","permalink":"http://delaprada.com/2020/12/26/stroke%E5%AD%A6%E4%B9%A0%E4%B9%8Bstroke-dasharray%E5%92%8Cstroke-dashoffset/","excerpt":"","text":"ä»Šå¤©åœ¨åšéŸ³ä¹APPçš„è¿›åº¦æ¡åŠŸèƒ½çš„æ—¶å€™ï¼Œä½¿ç”¨åˆ°äº†svgçš„stroke-dasharrayå’Œstoke-dashoffsetä¸¤ä¸ªä¹‹å‰æ²¡æœ‰ç”¨åˆ°è¿‡çš„å±æ€§ï¼Œå€Ÿæ­¤æœºä¼šæ€»ç»“ä¸€ä¸‹ã€‚ æ¦‚å¿µè§£æ strokeï¼šç”»çŸ­çº¿äºï¼Œåœ¨â€¦ä¸Šåˆ’çº¿ stroke-dasharrayï¼šç”¨äºåˆ›å»ºè™šçº¿ã€‚ä¹‹æ‰€ä»¥æ˜¯arrayæ˜¯å› ä¸ºå…¶å€¼å…¶å®æ˜¯æ•°ç»„ 123stroke-dasharray &#x3D; &#39;10&#39; stroke-dasharray &#x3D; &#39;10, 5&#39; stroke-dasharray &#x3D; &#39;20, 10, 5&#39; stroke-dasharrayä¸ºä¸€ä¸ªå‚æ•°æ—¶ï¼š å…¶å®æ˜¯è¡¨ç¤ºè™šçº¿é•¿åº¦å’Œæ¯æ®µè™šçº¿ä¹‹é—´çš„é—´è·ã€‚å¦‚ï¼šstroke-dasharray = &#39;10&#39; è¡¨ç¤ºï¼šè™šçº¿é•¿10ï¼Œé—´è·10ï¼Œç„¶åé‡å¤ è™šçº¿é•¿10ï¼Œé—´è·10ã€‚ ä¸¤ä¸ªå‚æ•°æˆ–è€…å¤šä¸ªå‚æ•°æ—¶ï¼šä¸€ä¸ªè¡¨ç¤ºé•¿åº¦ï¼Œä¸€ä¸ªè¡¨ç¤ºé—´è·ã€‚å¦‚ï¼šstroke-dasharray = &#39;10, 5&#39;è¡¨ç¤ºï¼šè™šçº¿é•¿10ï¼Œé—´è·5ï¼Œç„¶åé‡å¤ è™šçº¿é•¿10ï¼Œé—´è·5ã€‚å¦‚ï¼šstroke-dasharray = &#39;20, 10, 5&#39;è¡¨ç¤ºï¼šè™šçº¿é•¿20ï¼Œé—´è·10ï¼Œè™šçº¿é•¿5ï¼Œæ¥ç€æ˜¯é—´è·20ï¼Œè™šçº¿10ï¼Œé—´è·5ï¼Œä¹‹åå¼€å§‹å¦‚æ­¤å¾ªç¯ã€‚ stroke-dashoffsetï¼šoffsetæ˜¯åç§»çš„æ„æ€ï¼Œå› æ­¤è¿™ä¸ªå±æ€§æ˜¯ç›¸å¯¹äºèµ·å§‹ç‚¹çš„åç§»ã€‚åç§»xå€¼ä¸ºæ­£æ•°æ—¶ï¼Œè¡¨ç¤ºå‘å·¦ç§»åŠ¨äº†xä¸ªé•¿åº¦å•ä½ï¼Œåç§»xå€¼ä¸ºè´Ÿæ•°æ—¶ï¼Œè¡¨ç¤ºå‘å³ç§»åŠ¨äº†xä¸ªé•¿åº¦å•ä½ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸ç®¡åç§»çš„æ–¹å‘æ˜¯å“ªä¸€è¾¹ï¼Œdasharrayæ˜¯å¾ªç¯çš„ï¼Œä¹Ÿå°±æ˜¯ï¼šè™šçº¿-é—´éš”-è™šçº¿-é—´éš”ã€‚dashoffsetå±æ€§éœ€è¦æ­é…dasharrayå±æ€§æ‰èƒ½çœ‹å¾—å‡ºæ•ˆæœï¼Œå› ä¸ºä¸æ˜¯è™šçº¿çš„è¯æ˜¯æ— æ³•çœ‹å‡ºåç§»çš„ã€‚ å®ä¾‹ä¸¾ä¸€ä¸‹MDNçš„ä¾‹å­ï¼Œå›¾ä¸­çš„çº¢çº¿æ®µè¡¨ç¤ºåç§»çš„è·ç¦»ï¼š ä¸Šå›¾æ•ˆæœåˆ†åˆ«æ˜¯ï¼š æ²¡æœ‰è™šçº¿ stroke-dasharray=&quot;3 1&quot; ï¼Œè™šçº¿æ²¡æœ‰è®¾ç½®åç§»ï¼Œä¹Ÿå°±æ˜¯stroke-dashoffsetå€¼ä¸º0 stroke-dashoffset=&quot;3&quot;ï¼Œåç§»æ­£æ•°ï¼Œè™šçº¿æ•´ä½“å·¦ç§»äº†3ä¸ªå•ä½ï¼Œå›¾ä¸­3åé¢çš„çº¢çº¿æ®µï¼Œå°±æ˜¯èµ·å§‹çº¿æ®µï¼Œçº¿æ®µä¹‹åæ˜¯1ä¸ªå•ä½çš„é—´éš”ï¼Œæˆ‘ä»¬å¯è§åŒºåŸŸä»è¿™ä¸ªé—´éš”å¼€å§‹ï¼Œç„¶åå¾ªç¯ 3-1,3-1çš„è™šçº¿-é—´éš”-è™šçº¿-é—´éš” stroke-dashoffset=&quot;-3&quot;ï¼Œåç§»è´Ÿæ•°ï¼Œè™šçº¿æ•´ä½“å³ç§»åŠ¨äº†3ä¸ªå•ä½ï¼Œç”±äºdasharrayæ˜¯å¾ªç¯çš„ï¼Œå‰é¢åç§»çš„ä½ç½®ä¼šæœ‰dasharrayå¡«å……ä¸Š stroke-dashoffset=&quot;1&quot;ï¼Œåç§»æ­£æ•°ï¼Œè™šçº¿æ•´ä½“å·¦ç§»äº†1ä¸ªå•ä½ï¼Œæœ€ç»ˆå‘ˆç°å‡ºæ¥çš„æ•ˆæœè·Ÿçº¿æ®µ4 ä¸€æ · ï¼ˆçº¢è‰²éƒ¨åˆ†æ˜¯æˆ‘ä»¬çœ‹ä¸è§çš„éƒ¨åˆ†ï¼Œæ˜¯å¯è§†åŒºåŸŸæˆ–è€…åç§»å¯¼è‡´çš„ï¼‰ è¿›åº¦æ¡æ•ˆæœçº¿æ€§è¿›åº¦æ¡å®ç°è¿™æ ·ä¸€ä¸ªåŠ¨ç”»ï¼šçº¿æ®µä»æ— åˆ°æœ‰ï¼Œç”±çŸ­å˜é•¿ å®ç°æ€è·¯æ˜¯ï¼š è®¾ç½®stroke-dasharrayè™šçº¿é•¿åº¦ç­‰äºå½“å‰svgçš„å®½åº¦ï¼Œé—´éš”å¤§äºæˆ–è€…ç­‰äºsvgå®½åº¦ 123&lt;svg &gt; &lt;line id=\"line\" x1=\"30\" y1=\"30\" x2=\"300\" y2=\"30\" stroke-width=\"20\" stroke=\"red\" stroke-dasharray=\"300,320\"/&gt; &lt;/svg&gt; è¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥åœ¨å¯è§†åŒºåŸŸå†…çœ‹åˆ°ä¸€æ¡çº¢è‰²çš„å®çº¿ï¼ˆå› ä¸ºé—´éš”ä¸åœ¨å¯è§†åŒºåŸŸå†…ï¼‰ï¼š è®¾ç½®strokeå·¦ç§»300ï¼ˆå³stroke-dashoffset: 300ï¼‰ï¼Œè¿™æ ·å°±åˆšå¥½éšè—äº†è™šçº¿ï¼Œå¯è§†åŒºåŸŸçœ‹åˆ°çš„æ˜¯320çš„é—´éš”ï¼ˆå…¶å®åº”è¯¥æ˜¯270çš„é—´éš”ï¼Œå› ä¸ºå¯è§†åŒºåŸŸåªæœ‰270ï¼‰ï¼š å½“é¼ æ ‡ç§»å…¥çš„æ—¶å€™ï¼Œä½¿offsetç”±300å˜ä¸º0ï¼Œå°±å®ç°å›¾ä¸­çš„æ•ˆæœäº†ï¼š 123456svg:hover #line&#123; stroke-dashoffset: 0;&#125;#line&#123; transition: all 2s;&#125; åœ†å½¢è¿›åº¦æ¡å®ç°æ€è·¯å’Œä¸Šé¢æ˜¯ç±»ä¼¼çš„ï¼Œè®¾ç½®stroke-dasharrayè™šçº¿é•¿åº¦ç­‰äºå½“å‰åœ†çš„å‘¨é•¿ï¼Œé—´éš”å¤§äºæˆ–ç­‰äºåœ†çš„å‘¨é•¿ã€‚ å®ç°æ€è·¯ï¼š å…ˆç”»ä¸€ä¸ªåœ† 123&lt;svg width=\"200\" height=\"200\" viewBox=\"0 0 200 200\"&gt; &lt;circle id=\"circle\" cx=\"100\" cy=\"80\" r=\"50\" fill=\"gray\" stroke-width=\"5\" stroke=\"green\" /&gt; &lt;/svg&gt; è®¾ç½®stroke-dasharrayå’Œstroke-dashoffset 12345#circle&#123; transition: all 2s; stroke-dasharray:314,314; // å‘¨é•¿ä¸º2Ï€r stroke-dashoffset:314; // ç›¸å½“äºå·¦ç§»äº†314ï¼Œè™šçº¿éƒ¨åˆ†åˆ™ä¸åœ¨å¯è§†åŒºåŸŸå†…&#125; hoveræ—¶ï¼Œè®¾ç½®stroke-dashoffsetä¸º0ï¼Œå°†è™šçº¿éƒ¨åˆ†åˆå±•ç¤ºåˆ°å¯è§†åŒºåŸŸå†…ï¼Œæ³¨æ„åœ†çš„strokeèµ·å§‹ä½ç½®ä¸ºå³ä¾§ä¸­é—´ 123svg:hover #circle&#123; stroke-dashoffset:0; &#125; å› æ­¤ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è®©åœ†ä»ä¸Šæ–¹ä¸­ç‚¹å¼€å§‹ï¼Œéœ€è¦å°†åœ†é€†æ—¶é’ˆæ—‹è½¬90åº¦ï¼ˆrotate(-90deg)ï¼‰: 1234&amp;.progress-bar &#123; transform: scale (0.9) rotate (-90deg); stroke: $&#123;style [\"theme-color\"]&#125;; &#125; é€‚ç”¨åœºæ™¯ç”¨svgçš„stroke-dasharrayå’Œstroke-dashoffsetå®ç°è¿›åº¦æ¡æ•ˆæœé€‚ç”¨äºï¼šä¸ä¼šäººä¸ºæ‹–åŠ¨è¿›åº¦æ¡çš„åœºæ™¯ï¼Œæ¯”å¦‚é€šè¿‡propsä¼ å…¥ç™¾åˆ†æ¯”æ§åˆ¶dashoffsetçš„ä½ç½®ã€‚ å› ä¸ºåœ¨äººä¸ºæ‹–åŠ¨è¿›åº¦æ¡çš„åœºæ™¯ä¸‹ï¼Œä¸€èˆ¬éœ€è¦æœ‰æ‹–åŠ¨æŒ‰é’®ï¼Œéœ€è¦ä¸ºæ‹–åŠ¨æŒ‰é’®ç»‘å®šç”¨æˆ·çš„touchStartï¼ŒtouchMoveï¼ŒtouchEndäº‹ä»¶ï¼Œè¿™äº›åœ¨svgä¸Šæ˜¯ä¸å¯è¡Œçš„ã€‚ åœ¨äººä¸ºæ‹–åŠ¨è¿›åº¦æ¡çš„åœºæ™¯ä¸‹ï¼Œåªèƒ½ä¹–ä¹–ç”¨divå»ç”»è¿›åº¦æ¡ï¼Œä¾‹å¦‚ï¼š 12345678910111213141516&lt;ProgressBarWrapper&gt; &lt;div className=\"bar-inner\" ref=&#123;progressBar&#125; onClick=&#123;progressClick&#125; &gt; &lt;div className=\"progress\" ref=&#123;progress&#125;&gt;&lt;/div&gt; &lt;div className=\"progress-btn-wrapper\" ref=&#123;progressBtn&#125; onTouchStart=&#123;progressTouchStart&#125; onTouchMove=&#123;progressTouchMove&#125; onTouchEnd=&#123;progressTouchEnd&#125; &gt; &lt;div className=\"progress-btn\"&gt;&lt;/div&gt; &lt;/div&gt; &lt;/div&gt;&lt;/ProgressBarWrapper&gt; ProgressBarWrapperä¸ºæ•´ä¸ªè¿›åº¦æ¡çš„å®¹å™¨ï¼Œbar-inneræ˜¯è¿›åº¦æ¡çš„èƒŒæ™¯ï¼ˆ100%ï¼‰ï¼Œprogressæ˜¯å½“å‰è¿›åº¦ï¼ˆå¯å˜ï¼‰ï¼Œprogress-btn-wrapperæ˜¯æ‹–åŠ¨æŒ‰é’®å®¹å™¨ï¼Œprogress-btnæ˜¯æ‹–åŠ¨æŒ‰é’®ã€‚ å¯ä»¥çœ‹åˆ°æ­¤æ—¶è¿›åº¦æ¡æœ‰æ‹–åŠ¨äº‹ä»¶ï¼ˆtouchï¼‰å’Œç‚¹å‡»äº‹ä»¶ï¼ˆclickï¼‰ï¼Œè¿™ä¸¤ä¸ªäº‹ä»¶çš„å¤„ç†æ˜¯ä¸åŒçš„ã€‚ touchäº‹ä»¶å¤„ç†å‡½æ•°ï¼š 1234567891011121314151617181920212223242526272829303132const _offset = (offsetWidth) =&gt; &#123; // è®¾ç½®è¿›åº¦æ¡é•¿åº¦ä¸ºoffsetWidthï¼ŒæŒ‰é’®çš„xåç§»é‡ä¸ºoffsetWidth progress.current.style.width = `$&#123;offsetWidth&#125;px`; progressBtn.current.style.transform = `translate3d($ &#123;offsetWidth&#125;px, 0, 0)`;&#125;;// è®°å½•å¼€å§‹ä½ç½®å’Œå½“å‰è¿›åº¦æ¡å®½åº¦const progressTouchStart = (e) =&gt; &#123; const startTouch = &#123;&#125;; // è¡¨ç¤ºæ»‘åŠ¨åŠ¨ä½œå¼€å§‹ startTouch.initiated = true; startTouch.startX = e.touches[0].pageX; startTouch.left = progress.current.clientWidth; setTouch(startTouch); // touchæ˜¯ä¸€ä¸ªstateçŠ¶æ€ &#125;;const progressTouchMove = (e) =&gt; &#123; if(!touch.initiated) &#123; return; &#125; // deltaXè®°å½•ç§»åŠ¨è·ç¦» const deltaX = e.touches[0].pageX - touch.startX; // è¿›åº¦æ¡å‡€å®½åº¦ = è¿›åº¦æ¡å®½åº¦ - æŒ‰é’®å®½åº¦ const barWidth = progressBar.current.clientWidth - progressBtnWidth; // æ§åˆ¶offsetWidthå¤§å°ä½¿å¾—è¿›åº¦æ¡é•¿åº¦å’ŒæŒ‰é’®ä½ç½®åœ¨æœ€å°ï¼ˆ0ï¼‰å’Œæœ€å¤§ï¼ˆbarWidthï¼‰èŒƒå›´ä¹‹å†… const offsetWidth = Math.min(Math.max(0, touch.left + deltaX), barWidth); _offset(offsetWidth)ï¼›&#125;; clickç‚¹å‡»äº‹ä»¶ï¼š 1234567// ç‚¹å‡»äº‹ä»¶ï¼ˆä¸å‰é¢çš„æ‹–åŠ¨äº‹ä»¶æ•ˆæœä¸åŒï¼‰const progressClick = (e) =&gt; &#123; // è¿›åº¦æ¡å½“å‰é•¿åº¦ï¼ŒgetBoundingClientRectå¯è·å–DOMå…ƒç´ åˆ°æµè§ˆå™¨å¯è§†èŒƒå›´çš„è·ç¦» const rect = progressBar.current.getBoundingClientRect(); const offsetWidth = e.pageX - rect.left; _offset(offsetWidth);&#125; æ•ˆæœï¼š","categories":[],"tags":[]},{"title":"React hooks: useRef, useImperativeHandle","slug":"React-hooks-useRef-useImperativeHandle","date":"2020-12-14T03:07:00.000Z","updated":"2020-12-19T02:19:00.000Z","comments":true,"path":"2020/12/14/React-hooks-useRef-useImperativeHandle/","link":"","permalink":"http://delaprada.com/2020/12/14/React-hooks-useRef-useImperativeHandle/","excerpt":"","text":"RefsRefsæä¾›äº†ä¸€ç§æ–¹å¼ï¼Œå…è®¸æˆ‘ä»¬è®¿é—®DOMèŠ‚ç‚¹æˆ–åœ¨renderæ–¹æ³•ä¸­åˆ›å»ºçš„Reactå…ƒç´ ã€‚ åœ¨å…¸å‹çš„Reactæ•°æ®æµä¸­ï¼Œpropsæ˜¯çˆ¶ç»„ä»¶ä¸å­ç»„ä»¶äº¤äº’çš„å”¯ä¸€æ–¹å¼ã€‚è¦ä¿®æ”¹ä¸€ä¸ªå­ç»„ä»¶ï¼Œä½ éœ€è¦ä½¿ç”¨æ–°çš„propsæ¥é‡æ–°æ¸²æŸ“å®ƒã€‚ ä½†æ˜¯åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä½ éœ€è¦åœ¨å…¸å‹æ•°æ®æµä¹‹å¤–å¼ºåˆ¶ä¿®æ”¹å­ç»„ä»¶ã€‚è¢«ä¿®æ”¹çš„å­ç»„ä»¶å¯èƒ½æ˜¯ä¸€ä¸ªReactå®ä¾‹ï¼Œä¹Ÿå¯èƒ½æ˜¯ä¸€ä¸ªDOMå…ƒç´ ã€‚ ä½•æ—¶ä½¿ç”¨Refs ç®¡ç†ç„¦ç‚¹ï¼ˆå—æ§ç»„ä»¶ï¼‰ï¼Œæ–‡æœ¬é€‰æ‹©æˆ–åª’ä½“æ’­æ”¾ è§¦å‘å¼ºåˆ¶åŠ¨ç”» é›†æˆç¬¬ä¸‰æ–¹DOMåº“ refå€¼æ ¹æ®èŠ‚ç‚¹çš„ç±»å‹è€Œæœ‰æ‰€ä¸åŒ å½“refå±æ€§ç”¨äºHTMLå…ƒç´ æ—¶ï¼ŒReact.createRef()åˆ›å»ºçš„refæ¥æ”¶åº•å±‚DOMå…ƒç´ ä½œä¸ºå…¶currentå±æ€§ï¼ˆæ¯”å¦‚divï¼‰ã€‚ å½“refå±æ€§ç”¨äºè‡ªå®šä¹‰classç»„ä»¶æ—¶ï¼Œrefå¯¹è±¡æ¥æ”¶ç»„ä»¶çš„æŒ‚è½½å®ä¾‹ä½œä¸ºå…¶currentå±æ€§ã€‚ ä¸èƒ½åœ¨å‡½æ•°ç»„ä»¶ä¸Šä½¿ç”¨refå±æ€§ï¼Œå› ä¸ºå®ƒä»¬æ²¡æœ‰å®ä¾‹ã€‚å¦‚æœæƒ³è¦åœ¨å‡½æ•°ç»„ä»¶ä¸­ä½¿ç”¨refï¼Œå¯ä»¥ä½¿ç”¨forwardRefï¼ˆå¯ä¸useImperativeHandleç»“åˆä½¿ç”¨ï¼‰ã€‚ä¸ç®¡æ€æ ·ï¼Œä½ å¯ä»¥åœ¨å‡½æ•°ç»„ä»¶å†…éƒ¨ä½¿ç”¨refå±æ€§ï¼Œåªè¦å®ƒæŒ‡å‘ä¸€ä¸ªDOMå…ƒç´ æˆ–classç»„ä»¶ã€‚ useRefuseRefæœ€ä¸ºä¼ ç»Ÿçš„ç”¨æ³•å°±æ˜¯å­˜å‚¨ä¸€ä¸ªDOMèŠ‚ç‚¹çš„å¼•ç”¨ã€‚å½“è¿™ä¸ªDOMèŠ‚ç‚¹æ›´æ–°æ—¶ï¼Œè¿™ä¸ªå¼•ç”¨ä¹Ÿä¼šæ›´æ–°ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡currentå±æ€§æ¥è®¿é—®DOMèŠ‚ç‚¹ã€‚ 1234567891011const App = () =&gt; &#123; const domRef = useRef() useEffect(() =&gt; &#123; doSomething(domRef.current) // access the DOM node here &#125;, []); return ( &lt;div ref=&#123;domRef&#125;&gt; &lt;Components /&gt; &lt;/div&gt; );&#125; è¿˜æœ‰ä¸€ç§å¸¸ç”¨çš„ç”¨æ³•æ˜¯åœ¨çˆ¶å­ç»„ä»¶ä¸­ä½¿ç”¨ï¼Œé€šè¿‡ç»“åˆuseRefå’ŒforwardRefæ–¹æ³•ï¼Œçˆ¶ç»„ä»¶èƒ½å¤Ÿè®¿é—®å­ç»„ä»¶å†…éƒ¨çš„DOMèŠ‚ç‚¹ã€‚ Refså…è®¸æŸäº›ç»„ä»¶æ¥æ”¶refï¼Œå¹¶å‘ä¸‹ä¼ é€’ç»™å­ç»„ä»¶ã€‚æ¯”å¦‚åœ¨ä¸‹é¢è¿™ä¸ªå®ä¾‹ä¸­ï¼ŒFancyButtonä½¿ç”¨React.forwardRefæ¥ä¼ é€’ç»™å®ƒçš„refï¼Œç„¶åè½¬å‘åˆ°å®ƒæ¸²æŸ“çš„DOM buttonï¼Œæ­¤æ—¶åœ¨çˆ¶ç»„ä»¶ä¸­å°±å¯ä»¥ä½¿ç”¨ref.currentæ¥è®¿é—®buttonçš„DOMèŠ‚ç‚¹ï¼š 12345678910111213141516const FancyButton = React.forwardRef((props, ref) =&gt; ( &lt;button ref=&#123;ref&#125; className=\"FancyButton\"&gt; &#123;props.children&#125; &lt;/button&gt;));const Parent = () =&gt; &#123; // ä½ å¯ä»¥ç›´æ¥è·å– DOM button çš„ ref const ref = React.createRef(); return ( &lt;FancyButton ref=&#123;ref&#125;&gt; Click me! &lt;/FancyButton&gt; );&#125; ä¸Šè¿°ä»£ç çš„é€æ­¥è§£é‡Šï¼š é€šè¿‡è°ƒç”¨React.createRefåˆ›å»ºäº†ä¸€ä¸ªReact refå¹¶å°†å…¶èµ‹å€¼ç»™refå˜é‡ é€šè¿‡åˆ¶å®šrefä¸ºJSXå±æ€§ï¼Œå°†å…¶å‘ä¸‹ä¼ é€’ç»™&lt;FancyButton ref={ref}&gt; Reactä¼ é€’refç»™forwardRefå†…å‡½æ•°(props, ref) =&gt; ...ï¼Œä½œä¸ºå…¶ç¬¬äºŒä¸ªå‚æ•° å‘ä¸‹è½¬å‘è¯¥refå‚æ•°åˆ°&lt;button ref={ref}&gt;ï¼Œå°†å…¶æŒ‡å®šä¸ºJSXå±æ€§ å½“refæŒ‚è½½å®Œæ¯•ï¼Œref.currentå°†æŒ‡å‘&lt;button&gt;DOMèŠ‚ç‚¹ æ³¨æ„ï¼š ç¬¬äºŒä¸ªå‚æ•°refåªåœ¨ä½¿ç”¨React.forwardRefå®šä¹‰ç»„ä»¶æ—¶å­˜åœ¨ã€‚å¸¸è§„å‡½æ•°å’Œclassç»„ä»¶ä¸æ¥æ”¶refå‚æ•°ï¼Œä¸”propsä¸­ä¹Ÿä¸å­˜åœ¨refã€‚æ‰€ä»¥ç”¨forwardRefå®šä¹‰ç»„ä»¶æ˜¯ä¸€ä¸ªæ¯”è¾ƒç‰¹æ®Šçš„ç”¨æ³•ã€‚ å¦‚æœæƒ³è¦åœ¨é«˜é˜¶ç»„ä»¶ä¸­ä½¿ç”¨refï¼Œéœ€è¦å¤šä¸€æ­¥é€ä¼ ï¼Œè§å®˜ç½‘ä¾‹å­ useImperativeHandleuseImperativeHandleæ–¹æ³•å¯ä»¥è®©æˆ‘ä»¬é€šè¿‡refå°†ä¸€äº›å˜é‡å’Œå‡½æ•°ä»å­ç»„ä»¶ä¼ é€’ç»™çˆ¶ç»„ä»¶ã€‚çˆ¶ç»„ä»¶å¯ä»¥é€‰æ‹©ä½¿ç”¨å®ƒæˆ–è€…å°†è¿™ä¸ªrefåˆä¼ é€’ç»™å¦ä¸€ä¸ªå­ç»„ä»¶ã€‚ æˆ‘ä»¬éƒ½çŸ¥é“ï¼ŒReactæ˜¯å•å‘æ•°æ®æµçš„ï¼Œæ•°æ®æ˜¯ä»çˆ¶ç»„ä»¶é€šè¿‡propsä¼ é€’åˆ°å­ç»„ä»¶çš„ï¼Œæ‰€ä»¥useImperativeHandleå’ŒforwardRefç›¸ç»“åˆå®ç°ä¿¡æ¯ä»å­ç»„ä»¶ä¼ é€’ç»™çˆ¶ç»„ä»¶ï¼Œè¿™æ˜¯ä¸€ä¸ªæ¯”è¾ƒæ–°é¢–çš„ç”¨æ³•ã€‚ 12345678910111213141516171819202122232425262728293031import &#123; useState, useRef, forwardRef, useImperativeHandle &#125; from \"react\";const ChildOne = forwardRef((props, ref) =&gt; &#123; const [ count, setCount ] = useState(0); useImperativeHandle(ref, () =&gt; (&#123; count, &#125;)); const updateCount = () =&gt; &#123; setCount((c) =&gt; c + 1); console.log(count + 1); &#125;; return &lt;button onClick=&#123;updateCount&#125;&gt;Increment&lt;/button&gt;;&#125;);const ChildTwo = forwardRef((props, ref) =&gt; &#123; const checkCount = () =&gt; console.log(\"-&gt;\", ref.current.count); return &lt;button onClick=&#123;checkCount&#125;&gt;Count&lt;/button&gt;;&#125;);const Parent = () =&gt; &#123; const ref = useRef(); return ( &lt;div&gt; &lt;ChildOne ref=&#123;ref&#125; /&gt; &lt;ChildTwo ref=&#123;ref&#125; /&gt; &lt;/div&gt; )&#125; åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬åœ¨Parentä¸­åˆå§‹åŒ–refï¼Œç„¶åä¼ é€’ç»™ä¸¤ä¸ªå­ç»„ä»¶ã€‚ å­ç»„ä»¶1æœ‰è‡ªå·±çš„stateï¼Œä½¿ç”¨useState hookæ¥æ§åˆ¶ï¼ŒåŒæ—¶å®ƒæœ‰ä¸€ä¸ªupdateCountæ–¹æ³•æ¥å¢åŠ countæ•°é‡ã€‚ å­ç»„ä»¶1é€šè¿‡useImperativeHandleè¿™ä¸ªhookè®©çˆ¶ç»„ä»¶èƒ½å¤Ÿè®¿é—®countï¼ŒuseImperativeHandleæ–¹æ³•ä»¥refä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ï¼Œä»¥ä¸€ä¸ªåŒ¿åå‡½æ•°ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ï¼Œè¿™ä¸ªåŒ¿åå‡½æ•°è¿”å›ä¸€ä¸ªåŒ…å«countå˜é‡çš„å¯¹è±¡ã€‚ ç°åœ¨çˆ¶ç»„ä»¶èƒ½å¤Ÿè®¿é—®countï¼Œå¹¶ä¼ é€’ç»™å­ç»„ä»¶2ã€‚å½“ç‚¹å‡»å­ç»„ä»¶2æ—¶ï¼Œè¾“å‡ºref.current.countã€‚ è¿™æ˜¯ä¸€ä¸ªä¿¡æ¯æµä»å­ç»„ä»¶ä¼ é€’åˆ°çˆ¶ç»„ä»¶ï¼Œå†ä»çˆ¶ç»„ä»¶ä¼ é€’ç»™å­ç»„ä»¶çš„ä¾‹å­ã€‚ä¸æ­¤åŒæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥æ³¨æ„åˆ°ï¼Œå› ä¸ºæˆ‘ä»¬ä½¿ç”¨äº†useRefï¼Œæ‰€ä»¥çˆ¶ç»„ä»¶æ˜¯æ²¡æœ‰å‘ç”Ÿä»»ä½•çš„é‡æ–°æ¸²æŸ“ï¼ˆre-renderï¼‰ã€‚ å¯¹useRefå’ŒuseImperativeHandleç®€å•å®è·µçš„ä»£ç åœ°å€ï¼šhttps://github.com/delaprada/Refs-practice å‚è€ƒï¼š https://react.docschina.org/docs/forwarding-refs.html https://medium.com/@binyamin/react-hooks-useref-useimperativehandle-uselayouteffect-ede6f40f393e","categories":[{"name":"React","slug":"React","permalink":"http://delaprada.com/categories/React/"}],"tags":[{"name":"React","slug":"React","permalink":"http://delaprada.com/tags/React/"}]},{"title":"httpçŸ¥è¯†æ±‡æ€»","slug":"httpçŸ¥è¯†æ±‡æ€»","date":"2020-12-07T11:45:35.000Z","updated":"2020-12-08T02:26:54.000Z","comments":true,"path":"2020/12/07/httpçŸ¥è¯†æ±‡æ€»/","link":"","permalink":"http://delaprada.com/2020/12/07/http%E7%9F%A5%E8%AF%86%E6%B1%87%E6%80%BB/","excerpt":"","text":"httpåè®® httpåè®®æ˜¯Webçš„åº”ç”¨å±‚åè®®ï¼Œå®šä¹‰äº†Webå®¢æˆ·ç«¯å‘æœåŠ¡å™¨è¯·æ±‚é¡µé¢çš„æ–¹å¼ï¼›ä»¥åŠæœåŠ¡å™¨å‘å®¢æˆ·ç«¯ä¼ é€Webé¡µé¢çš„æ–¹å¼ã€‚ å®ƒä½¿ç”¨tcpä½œä¸ºå®ƒçš„è¿è¾“å±‚åè®®ã€‚ æ— çŠ¶æ€åè®®ï¼Œå› ä¸ºhttpæœåŠ¡å™¨ä¸ä¿å­˜å…³äºå®¢æˆ·çš„ä»»ä½•ä¿¡æ¯ã€‚ ä¸å®‰å…¨ï¼Œä¸ä¼šå¯¹ä¼ è¾“çš„æ•°æ®è¿›è¡ŒåŠ å¯†ã€‚ Qï¼šhttpåè®®ä¸ºæ— çŠ¶æ€åè®®ï¼Œå¦‚ä½•è®°ä½ç”¨æˆ·çš„çŠ¶æ€ï¼Ÿ Aï¼šæ— çŠ¶æ€åè®®çš„å¥½å¤„æ˜¯å¿«é€Ÿï¼Œä½†æ˜¯æœ‰æ—¶æˆ‘æƒ³è¦è®°ä½ç”¨æˆ·çš„çŠ¶æ€ï¼ˆæ¯”å¦‚ï¼šç™»å½•çŠ¶æ€ï¼‰ã€‚æ­¤æ—¶æˆ‘ä»¬å¯ä»¥ä½¿ç”¨cookieæˆ–è€…sessionè®°å½•ç”¨æˆ·çš„æµè§ˆçŠ¶æ€ä¿¡æ¯ï¼Œç”¨æˆ·èº«ä»½ä¿¡æ¯ã€‚ httpè¯·æ±‚/å“åº”æŠ¥æ–‡è¯·æ±‚æŠ¥æ–‡ ç”±4ä¸ªéƒ¨åˆ†ç»„æˆï¼šè¯·æ±‚è¡Œã€è¯·æ±‚å¤´ã€ç©ºè¡Œã€è¯·æ±‚ä½“ è¯·æ±‚è¡Œç”±3ä¸ªå­—æ®µç»„æˆï¼šè¯·æ±‚æ–¹æ³•ã€URLå­—æ®µã€HTTPåè®®ç‰ˆæœ¬å­—æ®µ è¯·æ±‚æ–¹æ³•æœ‰ï¼šGETã€HEADã€POSTã€PUTã€DELETE ç©ºè¡Œï¼šå‘Šè¯‰æœåŠ¡å™¨è¯·æ±‚å¤´éƒ¨åˆ°æ­¤ä¸ºæ­¢ è¯·æ±‚ä½“ï¼šå¦‚æœè¯·æ±‚æ–¹æ³•æ˜¯GETï¼Œåˆ™ä¸ºç©ºï¼›å¦‚æœè¯·æ±‚æ–¹æ³•æ˜¯POSTï¼Œæ­¤å¤„æ”¾ç½®è¦æäº¤çš„æ•°æ® ä¸Šé¢æ˜¯POSTæ–¹æ³•ï¼Œå®ƒçš„è¯·æ±‚è¡ŒURLæ®µä¸­ä¸€èˆ¬æ˜¯æ²¡æœ‰å‚æ•°çš„ï¼Œå‚æ•°æ”¾åœ¨äº†æŠ¥æ–‡ä½“ä¸­ã€‚è€ŒGETæ–¹æ³•çš„å‚æ•°ç›´æ¥ç½®äºè¯·æ±‚è¡ŒURLä¸­ï¼ŒæŠ¥æ–‡ä½“åˆ™ä¸ºç©ºã€‚ å“åº”æŠ¥æ–‡ ç”±3ä¸ªéƒ¨åˆ†ç»„æˆï¼šå“åº”è¡Œã€å“åº”å¤´ã€å“åº”ä½“ å“åº”è¡Œï¼šç”±åè®®ç‰ˆæœ¬ã€çŠ¶æ€ç ã€çŠ¶æ€æè¿°æ„æˆ httpçŠ¶æ€ç 1XX é€šçŸ¥ 2XX æˆåŠŸ 3XX é‡å®šå‘ 4XX å®¢æˆ·ç«¯é”™è¯¯ 5XX æœåŠ¡ç«¯é”™è¯¯ 100ï¼ˆâ€continueâ€ï¼‰è¯¥çŠ¶æ€ç è¯´æ˜æœåŠ¡å™¨æ”¶åˆ°äº†è¯·æ±‚çš„åˆå§‹éƒ¨åˆ†ï¼Œå¹¶ä¸”è¯·å®¢æˆ·ç«¯ç»§ç»­å‘é€ã€‚ ä¾‹å¦‚ï¼šå®¢æˆ·ç«¯æœ‰ä¸€ä¸ªè¾ƒå¤§çš„æ–‡ä»¶éœ€è¦ä¸Šä¼ å¹¶ä¿å­˜ï¼Œä½†æ˜¯å®¢æˆ·ç«¯ä¸çŸ¥é“æœåŠ¡å™¨æ˜¯å¦æ„¿æ„æ¥å—è¿™ä¸ªæ–‡ä»¶ï¼Œæ‰€ä»¥å¸Œæœ›åœ¨æ¶ˆè€—ç½‘ç»œèµ„æºè¿›è¡Œä¼ è¾“ä¹‹å‰ï¼Œå…ˆè¯¢é—®ä¸€ä¸‹æœåŠ¡å™¨çš„æ„æ„¿ã€‚ å®é™…æ“ä½œä¸ºå®¢æˆ·ç«¯å‘é€ä¸€æ¡ç‰¹æ®Šçš„è¯·æ±‚æŠ¥æ–‡ï¼ŒæŠ¥æ–‡çš„å¤´éƒ¨åº”åŒ…å«ï¼š 1Expect: 100-continue å¦‚æœæœåŠ¡å™¨æ„¿æ„æ¥å—ï¼Œå°±ä¼šè¿”å›100 continueçŠ¶æ€ç ã€‚ 200ï¼ˆâ€OKâ€ï¼‰ä¸€åˆ‡æ­£å¸¸ 204 ï¼ˆæ— å†…å®¹ï¼‰æœåŠ¡å™¨æˆåŠŸå¤„ç†äº†è¯·æ±‚ï¼Œä½†æ²¡æœ‰è¿”å›ä»»ä½•å†…å®¹ã€‚ å¯¹äºä¸€äº›æäº¤åˆ°æœåŠ¡å™¨å¤„ç†çš„æ•°æ®ï¼Œåªéœ€è¦è¿”å›æ˜¯å¦æˆåŠŸçš„æƒ…å†µä¸‹ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨çŠ¶æ€ç 204æ¥ä½œä¸ºè¿”å›ä¿¡æ¯ï¼Œä»è€Œçœæ‰å¤šä½™çš„æ•°æ®ä¼ è¾“ã€‚ 206ï¼ˆéƒ¨åˆ†å†…å®¹ï¼‰è¿™ç§å“åº”æ˜¯åœ¨å®¢æˆ·ç«¯è¡¨æ˜è‡ªå·±åªéœ€è¦ç›®æ ‡urlä¸Šçš„éƒ¨åˆ†èµ„æºçš„æ—¶å€™è¿”å›çš„ï¼Œè¿™ç§æƒ…å†µç»å¸¸å‘ç”Ÿåœ¨å®¢æˆ·ç«¯ç»§ç»­è¯·æ±‚ä¸€ä¸ªæœªå®Œæˆçš„ä¸‹è½½æ—¶ä½¿ç”¨ã€‚ 301ï¼ˆMove Permanentlyï¼‰æ°¸ä¹…æ€§è½¬ç§»ã€‚å°†è·³è½¬åˆ°æ–°çš„urlåœ°å€ï¼ŒåŸæœ¬è¯·æ±‚çš„èµ„æºå·²ç»ä¸å¯ä»¥å†è®¿é—®äº†ã€‚ 302ï¼ˆMove Temporarilyï¼‰æš‚æ—¶æ€§è½¬ç§»ã€‚å°†è·³è½¬åˆ°æ–°çš„urlåœ°å€ï¼ŒåŸæœ¬è¯·æ±‚çš„èµ„æºä»ç„¶å¯ä»¥è¢«è®¿é—®ã€‚ 304ï¼ˆâ€Not Modifiedâ€ï¼‰å’Œæµè§ˆå™¨ç¼“å­˜ç›¸å…³ã€‚è¡¨æ˜æœåŠ¡å™¨ç«¯èµ„æºæœªå‘ç”Ÿæ”¹å˜ï¼Œå¯ä»¥ç»§ç»­ä½¿ç”¨æµè§ˆå™¨ç¼“å­˜ä¸­çš„èµ„æºã€‚è¯·æ±‚çš„æ—¶å€™ä¸€èˆ¬ç»“åˆlast-modified/if-modified-sinceå’ŒEtag/if-none-matchä½¿ç”¨ã€‚ 400ï¼ˆâ€Bad Requestâ€ï¼‰è¯·æ±‚ä¸èƒ½è¢«æœåŠ¡å™¨ç†è§£ã€‚ 401ï¼ˆâ€unauthorizedâ€ï¼‰è¯·æ±‚æ²¡æœ‰httpè®¤è¯çš„è®¤è¯ä¿¡æ¯ã€‚ 403ï¼ˆâ€Forbiddenâ€ï¼‰è¯·æ±‚è¢«æœåŠ¡å™¨æ‹’ç»ã€‚ 404ï¼ˆâ€Not Foundâ€ï¼‰è¯·æ±‚çš„èµ„æºä¸åœ¨æœåŠ¡å™¨ç«¯ã€‚ 500ï¼ˆâ€Internet Server Errorâ€ï¼‰æœåŠ¡å™¨æ–¹é¢çš„é—®é¢˜ã€‚ 502ï¼ˆâ€Bad Gatewayâ€ï¼‰ä½œä¸ºç½‘å…³æˆ–è€…ä»£ç†çš„æœåŠ¡å™¨å‘ä¸Šæ¸¸æœåŠ¡å™¨å‘èµ·è¯·æ±‚æ—¶ï¼Œä»ä¸Šæ¸¸æœåŠ¡å™¨æ¥æ”¶åˆ°æ— æ•ˆå“åº”ã€‚ 504ï¼ˆâ€Gateway Timeoutâ€ï¼‰ä½œä¸ºç½‘å…³æˆ–è€…ä»£ç†çš„æœåŠ¡å™¨å‘ä¸Šæ¸¸æœåŠ¡å™¨å‘èµ·è¯·æ±‚æ—¶ï¼Œæœªèƒ½åŠæ—¶ä»ä¸Šæ¸¸æœåŠ¡å™¨æ¥æ”¶åˆ°å“åº”ã€‚ 301å’Œ302çš„åŒºåˆ«å…±åŒç‚¹ï¼š301å’Œ302çŠ¶æ€ç éƒ½è¡¨ç¤ºé‡å®šå‘ï¼Œä¹Ÿå°±æ˜¯è¯´æµè§ˆå™¨åœ¨æ‹¿åˆ°æœåŠ¡å™¨è¿”å›çš„è¿™ä¸ªçŠ¶æ€ç ä¹‹åä¼šè‡ªåŠ¨è·³è½¬åˆ°ä¸€ä¸ªæ–°çš„urlåœ°å€ã€‚ åŒºåˆ«ï¼š301è¡¨ç¤ºæ—§åœ°å€å·²ç»è¢«æ°¸ä¹…åœ°ç§»é™¤äº†ï¼Œè¿™ä¸ªèµ„æºä¸å¯ä»¥è®¿é—®äº†ã€‚ â€‹ 302è¡¨ç¤ºæ—§åœ°å€çš„èµ„æºè¿˜åœ¨ï¼Œå¯ä»¥è®¿é—®ï¼Œè¿™ä¸ªé‡å®šå‘åªæ˜¯ä¸´æ—¶åœ°ä»æ—§åœ°å€è½¬åˆ°æ–°åœ°å€ã€‚ 302 303 307çš„åŒºåˆ«302å½“å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘å‡ºPOSTè¯·æ±‚åï¼Œæ”¶åˆ°æœåŠ¡å™¨çš„302çŠ¶æ€ç ï¼Œé‚£ä¹ˆæ˜¯ä¸èƒ½è‡ªåŠ¨å‘æ–°çš„URLå‘é€è¯·æ±‚ï¼Œå¿…é¡»è·Ÿç”¨æˆ·ç¡®è®¤æ˜¯å¦è¯¥é‡å‘ï¼Œå› ä¸ºç¬¬äºŒæ¬¡POSTè¯·æ±‚æ—¶ï¼Œç¯å¢ƒå¯èƒ½å·²ç»å‘ç”Ÿå˜åŒ–ï¼ˆPOSTæ–¹æ³•ä¸æ˜¯å¹‚ç­‰çš„ï¼ŒPOSTæ“ä½œä¼šä¸ç¬¦åˆç”¨æˆ·é¢„æœŸï¼‰ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼šå¦‚æœå®¢æˆ·ç«¯å‘å‡ºéGET, HEADè¯·æ±‚å(æ¯”å¦‚POSTè¯·æ±‚)ï¼Œæ”¶åˆ°302çŠ¶æ€ç ï¼Œæ˜¯ä¸èƒ½å¤Ÿè‡ªåŠ¨åœ°å‘æ–°çš„URLå‘é€é‡å¤è¯·æ±‚ï¼Œé™¤éå¾—åˆ°ç”¨æˆ·çš„ç¡®è®¤ã€‚ 303ä¼šç›´æ¥å°†ä¸Šè¿°çš„POSTè¯·æ±‚é‡å®šå‘ä¸ºGETè¯·æ±‚ 307ä¸ä¼šå°†POSTè½¬ä¸ºGETï¼Œè€Œæ˜¯ä¼šè¯¢é—®ç”¨æˆ·æ˜¯å¦åº”è¯¥åœ¨æ–°çš„URLä¸Šå‘èµ·POSTè¯·æ±‚ httpæ–¹æ³• è¯·æ±‚æ–¹æ³• æè¿° 1 GET è¯·æ±‚æŒ‡å®šçš„é¡µé¢ä¿¡æ¯ï¼Œå¹¶è¿”å›å®ä½“ä¸»ä½“ã€‚ 2 HEAD ç±»ä¼¼äº GET è¯·æ±‚ï¼Œåªä¸è¿‡è¿”å›çš„å“åº”ä¸­æ²¡æœ‰å…·ä½“çš„å†…å®¹ï¼Œç”¨äºè·å–æŠ¥å¤´ 3 POST å‘æŒ‡å®šèµ„æºæäº¤æ•°æ®è¿›è¡Œå¤„ç†è¯·æ±‚ï¼ˆä¾‹å¦‚æäº¤è¡¨å•æˆ–è€…ä¸Šä¼ æ–‡ä»¶ï¼‰ã€‚æ•°æ®è¢«åŒ…å«åœ¨è¯·æ±‚ä½“ä¸­ã€‚POST è¯·æ±‚å¯èƒ½ä¼šå¯¼è‡´æ–°çš„èµ„æºçš„å»ºç«‹å’Œ/æˆ–å·²æœ‰èµ„æºçš„ä¿®æ”¹ã€‚ 4 PUT ä»å®¢æˆ·ç«¯å‘æœåŠ¡å™¨ä¼ é€çš„æ•°æ®å–ä»£æŒ‡å®šçš„æ–‡æ¡£çš„å†…å®¹ã€‚ 5 DELETE è¯·æ±‚æœåŠ¡å™¨åˆ é™¤æŒ‡å®šçš„é¡µé¢ã€‚ 6 CONNECT HTTP/1.1 åè®®ä¸­é¢„ç•™ç»™èƒ½å¤Ÿå°†è¿æ¥æ”¹ä¸ºç®¡é“æ–¹å¼çš„ä»£ç†æœåŠ¡å™¨ã€‚ 7 OPTIONS å…è®¸å®¢æˆ·ç«¯æŸ¥çœ‹æœåŠ¡å™¨çš„æ€§èƒ½ã€‚OPTIONSæ–¹æ³•è¯·æ±‚webæœåŠ¡å™¨å‘ŠçŸ¥å…¶æ”¯æŒçš„å„ç§åŠŸèƒ½ã€‚å¯ä»¥è¯¢é—®æœåŠ¡å™¨é€šå¸¸æ”¯æŒå“ªäº›æ–¹æ³• 8 patch å¯¹å·²çŸ¥èµ„æºè¿›è¡Œå±€éƒ¨æ›´æ–° å¦‚ä½•ç†è§£patchå±€éƒ¨æ›´æ–°èµ„æºå‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªUserInfoï¼Œé‡Œé¢æœ‰userIdï¼Œ userNameï¼Œ userGenderç­‰10ä¸ªå­—æ®µã€‚å¯ä½ çš„ç¼–è¾‘åŠŸèƒ½å› ä¸ºéœ€æ±‚ï¼Œåœ¨æŸä¸ªç‰¹åˆ«çš„é¡µé¢é‡Œåªèƒ½ä¿®æ”¹userNameï¼Œè¿™æ—¶å€™çš„æ›´æ–°æ€ä¹ˆåšï¼Ÿ äººä»¬é€šå¸¸(ä¸ºå¾’çœäº‹)æŠŠä¸€ä¸ªåŒ…å«äº†ä¿®æ”¹åuserNameçš„å®Œæ•´userInfoå¯¹è±¡ä¼ ç»™åç«¯ï¼Œåšå®Œæ•´æ›´æ–°ã€‚ä½†ä»”ç»†æƒ³æƒ³ï¼Œè¿™ç§åšæ³•æ„Ÿè§‰æœ‰ç‚¹äºŒï¼Œè€Œä¸”çœŸå¿ƒæµªè´¹å¸¦å®½(çº¯æŠ€æœ¯ä¸Šè®²ï¼Œä½ ä¸å…³å¿ƒå¸¦å®½é‚£æ˜¯ä½ åœŸè±ª)ã€‚ äºæ˜¯patchè¯ç”Ÿï¼Œåªä¼ ä¸€ä¸ªuserNameåˆ°æŒ‡å®šèµ„æºå»ï¼Œè¡¨ç¤ºè¯¥è¯·æ±‚æ˜¯ä¸€ä¸ªå±€éƒ¨æ›´æ–°ï¼Œåç«¯ä»…æ›´æ–°æ¥æ”¶åˆ°çš„å­—æ®µã€‚ è€Œputè™½ç„¶ä¹Ÿæ˜¯æ›´æ–°èµ„æºï¼Œä½†è¦æ±‚å‰ç«¯æä¾›çš„ä¸€å®šæ˜¯ä¸€ä¸ªå®Œæ•´çš„èµ„æºå¯¹è±¡ï¼Œç†è®ºä¸Šè¯´ï¼Œå¦‚æœä½ ç”¨äº†putï¼Œä½†å´æ²¡æœ‰æä¾›å®Œæ•´çš„UserInfoï¼Œé‚£ä¹ˆç¼ºäº†çš„é‚£äº›å­—æ®µåº”è¯¥è¢«æ¸…ç©ºã€‚ å‚è€ƒï¼šhttps://segmentfault.com/q/1010000005685904/ httpç¼ºé™· é€šä¿¡ä½¿ç”¨æ˜æ–‡ï¼ˆä¸åŠ å¯†ï¼‰ï¼Œå†…å®¹å¯èƒ½è¢«çªƒå¬ ä¸éªŒè¯é€šä¿¡æ–¹çš„èº«ä»½ï¼Œå› æ­¤æœ‰å¯èƒ½é­é‡ä¼ªè£… æ— æ³•è¯æ˜æŠ¥æ–‡çš„å®Œæ•´æ€§ï¼Œæ‰€ä»¥æœ‰å¯èƒ½å·²é­ç¯¡æ”¹ é€šä¿¡ä½¿ç”¨æ˜æ–‡å¯èƒ½ä¼šè¢«çªƒå¬ å¦‚æœè¦é—®ä¸ºä»€ä¹ˆé€šä¿¡æ—¶ä¸åŠ å¯†æ˜¯ä¸€ä¸ªç¼ºç‚¹ï¼Œè¿™æ˜¯å› ä¸ºï¼ŒæŒ‰TCP/IP åè®®æ—çš„å·¥ä½œæœºåˆ¶ï¼Œé€šä¿¡å†…å®¹åœ¨æ‰€æœ‰çš„é€šä¿¡çº¿è·¯ä¸Šéƒ½æœ‰å¯èƒ½é­åˆ°çª¥è§†ã€‚ ä¸éªŒè¯é€šä¿¡æ–¹çš„èº«ä»½ï¼Œå¯èƒ½é­é‡ä¼ªè£… åœ¨httpåè®®é€šä¿¡æ—¶ï¼Œç”±äºä¸å­˜åœ¨ç¡®è®¤é€šä¿¡æ–¹çš„å¤„ç†æ­¥éª¤ï¼Œä»»ä½•äººéƒ½å¯ä»¥å‘èµ·è¯·æ±‚ã€‚å¦å¤–ï¼ŒæœåŠ¡å™¨åªè¦æ¥æ”¶åˆ°è¯·æ±‚ï¼Œä¸ç®¡å¯¹æ–¹æ˜¯è°éƒ½ä¼šè¿”å›ä¸€ä¸ªå“åº”ã€‚ æ‘˜è‡ªï¼šhttps://blog.csdn.net/wangxp423/article/details/80033225 https httpåè®®ä¼ è¾“çš„æ•°æ®éƒ½æ˜¯æœªåŠ å¯†çš„ï¼Œä¹Ÿå°±æ˜¯æ˜æ–‡çš„ï¼Œå› æ­¤ä½¿ç”¨httpåè®®ä¼ è¾“éšç§ä¿¡æ¯éå¸¸ä¸å®‰å…¨ã€‚ä¸ºäº†ä¿è¯è¿™äº›éšç§æ•°æ®èƒ½åŠ å¯†ä¼ è¾“ï¼Œè®¾è®¡äº†SSLï¼ˆSecure Sockets Layerï¼‰/ TLSï¼ˆTransport Layer Securityï¼‰åè®®ç”¨äºå¯¹httpåè®®ä¼ è¾“çš„æ•°æ®è¿›è¡ŒåŠ å¯†ï¼Œä»è€Œè¯ç”Ÿäº†httpsã€‚ å› æ­¤ï¼Œhttpså¾ˆå®‰å…¨ã€‚æ­¤å¤–ï¼ŒhttpsåŒæ—¶ä¹Ÿä¸€å®šç¨‹åº¦ä¸Šä¿æŠ¤äº†æœåŠ¡ç«¯ï¼Œä½¿ç”¨æ¶æ„æ”»å‡»å’Œä¼ªè£…æ•°æ®çš„æˆæœ¬å¤§å¤§æé«˜ã€‚ SSL/TLSæ¡æ‰‹è¿‡ç¨‹ Client Hello æ¡æ‰‹ç¬¬ä¸€æ­¥æ˜¯å®¢æˆ·ç«¯å‘æœåŠ¡ç«¯å‘é€Client Helloæ¶ˆæ¯ã€‚è¿™ä¸ªæ¶ˆæ¯é‡ŒåŒ…å«äº†ä¸€ä¸ªå®¢æˆ·ç«¯ç”Ÿæˆçš„éšæœºæ•°Random1ï¼Œå®¢æˆ·ç«¯æ”¯æŒçš„åŠ å¯†å¥—ä»¶ï¼ˆSupport Ciphersï¼‰å’ŒSSL Versionç­‰ä¿¡æ¯ã€‚ Server Hello ç¬¬äºŒæ­¥æ˜¯æœåŠ¡ç«¯æƒ³å®¢æˆ·ç«¯å‘é€Server Helloæ¶ˆæ¯ã€‚æ­¤æ—¶ä¼šç”Ÿæˆä¸€ä»½éšæœºæ•°Random2ï¼ŒåŒæ—¶è¿™ä¸ªæ¶ˆæ¯ä¼šä»Client Helloä¼ æ¥çš„Support Ciphersé‡Œç¡®å®šä¸€ä»½åŠ å¯†å¥—ä»¶ï¼Œè¿™ä¸ªå¥—ä»¶å†³å®šäº†åç»­åŠ å¯†å’Œç”Ÿæˆæ‘˜è¦æ—¶å…·ä½“ä½¿ç”¨å“ªäº›ç®—æ³•ã€‚ æ³¨æ„ï¼šè‡³æ­¤å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯éƒ½æ‹¥æœ‰äº†ä¸¤ä¸ªéšæœºæ•°ï¼ˆRandom1+Random2ï¼‰ï¼Œè¿™ä¸¤ä¸ªéšæœºæ•°ä¼šåœ¨åç»­ç”Ÿæˆå¯¹ç§°ç§˜é’¥æ—¶ç”¨åˆ°ã€‚ Certificate è¿™ä¸€æ­¥æ˜¯æœåŠ¡ç«¯å°†è‡ªå·±çš„è¯ä¹¦ä¸‹å‘ç»™å®¢æˆ·ç«¯ï¼Œè®©å®¢æˆ·ç«¯éªŒè¯è‡ªå·±çš„èº«ä»½ï¼Œå®¢æˆ·ç«¯éªŒè¯é€šè¿‡åå–å‡ºè¯ä¹¦ä¸­çš„å…¬é’¥ã€‚ Server Hello Done Server Hello Doneé€šçŸ¥å®¢æˆ·ç«¯Server Helloè¿‡ç¨‹ç»“æŸã€‚ Certificate Verify å®¢æˆ·ç«¯æ”¶åˆ°æœåŠ¡ç«¯ä¼ æ¥çš„è¯ä¹¦åï¼Œå…ˆä»CAéªŒè¯è¯¥è¯ä¹¦çš„åˆæ³•æ€§ï¼ŒéªŒè¯é€šè¿‡åå–å‡ºè¯ä¹¦ä¸­çš„æœåŠ¡ç«¯å…¬é’¥ï¼Œå†ç”Ÿæˆéšæœºæ•°Random3ï¼Œå†ç”¨æœåŠ¡ç«¯å…¬é’¥éå¯¹ç§°åŠ å¯†Random3ç”ŸæˆPreMaster Keyã€‚ httpsçš„æœåŠ¡ç«¯å¿…é¡»æ‹¥æœ‰ä¸€ä¸ªCAè®¤è¯åˆæ³•æˆæƒçš„è¯ä¹¦ï¼Œæ²¡æœ‰è¿™ä¸ªè¯ä¹¦ï¼Œå®¢æˆ·ç«¯åœ¨è®¿é—®è¯¥æœåŠ¡å™¨æ—¶ä¼šæé†’ç”¨æˆ·è¿™ä¸ªç½‘ç«™æ˜¯ä¸å—ä¿¡ä»»çš„ Client Key Exchange ä¸Šä¸€æ­¥ä¸­å®¢æˆ·ç«¯æ ¹æ®æœåŠ¡å™¨ä¼ æ¥çš„å…¬é’¥ç”Ÿæˆäº†PreMaster Keyï¼ŒClient Key Exchangeå°±æ˜¯å°†è¿™ä¸ªPreMaster Keyä¼ ç»™æœåŠ¡ç«¯ï¼ŒæœåŠ¡ç«¯å†ç”¨è‡ªå·±çš„ç§é’¥è§£å‡ºè¿™ä¸ªPreMaster Keyå¾—åˆ°å®¢æˆ·ç«¯ç”Ÿæˆçš„Random3ã€‚ è‡³æ­¤ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯éƒ½æ‹¥æœ‰Random1+Random2+Random3ï¼Œé‚£ä¹ˆä¸¤è¾¹å†æ ¹æ®åŒæ ·çš„ç®—æ³•å°±å¯ä»¥ç”Ÿæˆä¸€ä»½ç§˜é’¥ï¼Œæ¡æ‰‹ç»“æŸåçš„åº”ç”¨å±‚æ•°æ®éƒ½æ˜¯ä½¿ç”¨è¿™ä¸ªç§˜é’¥è¿›è¡Œå¯¹ç§°åŠ å¯†ã€‚ ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ä¸‰ä¸ªéšæœºæ•°ï¼Ÿ è¿™æ˜¯å› ä¸ºSSL/TLSæ¡æ‰‹è¿‡ç¨‹çš„æ•°æ®éƒ½æ˜¯æ˜æ–‡ä¼ è¾“çš„ï¼Œå¹¶ä¸”å¤šä¸ªéšæœºæ•°ç§å­æ¥ç”Ÿæˆç§˜é’¥ä¸å®¹æ˜“è¢«æš´åŠ›ç ´è§£ã€‚ æœ€é‡è¦ç†è§£å‰å…­æ­¥ Change Cipher Specï¼ˆClientï¼‰ è¿™ä¸€æ­¥å®¢æˆ·ç«¯é€šçŸ¥æœåŠ¡ç«¯åé¢å†å‘é€çš„æ¶ˆæ¯éƒ½ä¼šä½¿ç”¨å‰é¢åå•†å‡ºæ¥çš„ç§˜é’¥åŠ å¯†äº†ï¼Œè¿™æ˜¯ä¸€æ¡äº‹ä»¶æ¶ˆæ¯ã€‚ Encrypted Handshake Message(Client) è¿™ä¸€æ­¥å¯¹åº”çš„æ˜¯Client Finishæ¶ˆæ¯ï¼Œå®¢æˆ·ç«¯å°†å‰é¢çš„æ¡æ‰‹æ¶ˆæ¯ç”Ÿæˆæ‘˜è¦å†ç”¨åå•†å¥½çš„ç§˜é’¥åŠ å¯†ï¼Œè¿™æ˜¯å®¢æˆ·ç«¯å‘é€çš„ç¬¬ä¸€æ¡åŠ å¯†æ¶ˆæ¯ã€‚æœåŠ¡ç«¯æ¥æ”¶åä¼šç”¨ç§é’¥è§£å¯†ï¼Œèƒ½è§£å‡ºæ¥åˆ™è¯´æ˜å‰é¢çš„åå•†å‡ºæ¥çš„ç§˜é’¥æ˜¯ä¸€è‡´çš„ã€‚ Change Cipher Spec(Server) è¿™ä¸€æ­¥æ˜¯æœåŠ¡ç«¯é€šçŸ¥å®¢æˆ·ç«¯åé¢å†å‘é€çš„æ¶ˆæ¯éƒ½ä¼šä½¿ç”¨åŠ å¯†ï¼Œä¹Ÿæ˜¯ä¸€æ¡äº‹ä»¶æ¶ˆæ¯ã€‚ Encrypted Handshake Message(Server) è¿™ä¸€æ­¥å¯¹åº”çš„æ˜¯Server Finishæ¶ˆæ¯ï¼ŒæœåŠ¡ç«¯ä¹Ÿä¼šå°†æ¡æ‰‹è¿‡ç¨‹çš„æ¶ˆæ¯ç”Ÿæˆæ‘˜è¦å†ç”¨ç§˜é’¥åŠ å¯†ï¼Œè¿™æ˜¯æœåŠ¡ç«¯å‘å‡ºçš„ç¬¬ä¸€æ¡åŠ å¯†æ¶ˆæ¯ã€‚å®¢æˆ·ç«¯æ¥æ”¶åä¼šç”¨ç§˜é’¥è§£å¯†ï¼Œèƒ½è§£å‡ºæ¥è¯´æ˜åå•†çš„ç§˜é’¥æ˜¯ä¸€è‡´çš„ã€‚ Application Data åˆ°è¿™é‡Œï¼ŒåŒæ–¹å·²å®‰å…¨åå•†å‡ºåŒä¸€ä»½ç§˜é’¥ï¼Œæ‰€æœ‰çš„åº”ç”¨å±‚æ•°æ®éƒ½ä¼šç”¨è¿™ä¸ªç§˜é’¥åŠ å¯†åå†é€šè¿‡TCPè¿›è¡Œå¯é ä¼ è¾“ã€‚ å‚è€ƒï¼šhttp://www.ruanyifeng.com/blog/2014/02/ssl_tls.html https://juejin.im/post/584b76d3a22b9d0058d5036f http1.0/1.1/2.0çš„åŒºåˆ«http1.0 httpåè®®è€çš„æ ‡å‡†æ˜¯http1.0ã€‚ä¸ºäº†æé«˜ç³»ç»Ÿçš„æ•ˆç‡ï¼Œhttp1.0è§„å®šæµè§ˆå™¨ä¸æœåŠ¡å™¨åªä¿æŒçŸ­æš‚çš„è¿æ¥ï¼Œæµè§ˆå™¨çš„æ¯æ¬¡è¯·æ±‚éƒ½éœ€è¦ä¸æœåŠ¡å™¨å»ºç«‹ä¸€ä¸ªtcpè¿æ¥ï¼ŒæœåŠ¡å™¨å®Œæˆè¯·æ±‚å¤„ç†åç«‹å³æ–­å¼€tcpè¿æ¥ï¼ŒæœåŠ¡å™¨ä¸è·Ÿè¸ªæ¯ä¸ªå®¢æˆ·ä¹Ÿä¸è®°å½•è¿‡å»çš„è¯·æ±‚ã€‚è¿æ¥æ— æ³•å¤ç”¨ã€‚ å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯æ¯æ¬¡å»ºç«‹å’Œå…³é—­è¿æ¥æ˜¯ä¸€ä¸ªç›¸å¯¹æ¯”è¾ƒè´¹æ—¶çš„è¿‡ç¨‹ï¼Œå¹¶ä¸”ä¼šä¸¥é‡å½±å“å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨çš„æ€§èƒ½ã€‚ http1.1 ä¸ºäº†å…‹æœhttp1.0çš„è¿™ä¸ªç¼ºé™·ï¼Œhttp1.1æ”¯æŒæŒä¹…è¿æ¥ï¼Œåœ¨ä¸€ä¸ªtcpè¿æ¥ä¸Šå¯ä»¥ä¼ é€å¤šä¸ªhttpè¯·æ±‚å’Œå“åº”ï¼Œå‡å°‘äº†å»ºç«‹å’Œå…³é—­è¿æ¥çš„æ¶ˆè€—å’Œå»¶è¿Ÿã€‚ åŒæ—¶ï¼Œhttp1.1è¿˜å…è®¸å®¢æˆ·ç«¯ä¸ç”¨ç­‰å¾…ä¸Šä¸€æ¬¡è¯·æ±‚ç»“æœè¿”å›ï¼Œå°±å¯ä»¥å‘å‡ºä¸‹ä¸€æ¬¡è¯·æ±‚ï¼Œä½†æœåŠ¡å™¨ç«¯å¿…é¡»æŒ‰ç…§æ¥æ”¶åˆ°å®¢æˆ·ç«¯è¯·æ±‚çš„å…ˆåé¡ºåºä¾æ¬¡å›é€å“åº”ç»“æœï¼Œä»¥ä¿è¯å®¢æˆ·ç«¯èƒ½å¤ŸåŒºåˆ†æ¯æ¬¡è¯·æ±‚çš„å†…å®¹ã€‚ http1.1è¿˜å…‹æœäº†http1.0çš„æ€§èƒ½é—®é¢˜ã€‚http1.1é€šè¿‡å¢åŠ æ›´å¤šçš„è¯·æ±‚å¤´å’Œå“åº”å¤´æ¥æ”¹è¿›å’Œæ‰©å……http1.0çš„åŠŸèƒ½ã€‚ http1.xçš„ç¼ºé™· Head-Of-Line Blockingï¼šä¸€æ—¦é˜Ÿé¦–çš„è¯·æ±‚å¤„ç†å¤ªæ…¢ï¼Œå°±ä¼šé˜»å¡åé¢è¯·æ±‚çš„å¤„ç†ã€‚ åœ¨HTTP/1.xä¸­ï¼Œç”±äºæœåŠ¡å™¨å¿…é¡»æŒ‰æ¥å—è¯·æ±‚çš„é¡ºåºå‘é€å“åº”çš„è§„åˆ™é™åˆ¶ï¼Œå‡è®¾æµè§ˆå™¨åœ¨ä¸€ä¸ªï¼ˆtcpï¼‰è¿æ¥ä¸Šå‘é€äº†ä¸¤ä¸ªè¯·æ±‚ï¼Œé‚£ä¹ˆæœåŠ¡å™¨å¿…é¡»ç­‰ç¬¬ä¸€ä¸ªè¯·æ±‚å“åº”å®Œæ¯•æ‰èƒ½å‘é€ç¬¬äºŒä¸ªè¯·æ±‚çš„å“åº”ã€‚ è¿æ¥æ— æ³•å¤ç”¨ï¼šè¿æ¥æ— æ³•å¤ç”¨ä¼šå¯¼è‡´æ¯æ¬¡è¯·æ±‚éƒ½ä¼šç»å†ä¸‰æ¬¡æ¡æ‰‹å’Œæ…¢å¯åŠ¨ã€‚ HTTP1.1è™½ç„¶åŠ å…¥äº†keep-aliveå¯ä»¥å¤ç”¨ä¸€éƒ¨åˆ†è¿æ¥ï¼Œä½†åœ¨ä¸€äº›æƒ…å†µä¸‹ä»ç„¶éœ€è¦å»ºç«‹å¤šä¸ªè¿æ¥æ¥é¿å…ä»»åŠ¡é˜»å¡é—®é¢˜ï¼ˆHead-Of-Line Blockingï¼‰ï¼Œæ¯”å¦‚é€šè¿‡å¹¶å‘è¿æ¥å’ŒåŸŸååˆ†ç‰‡å¢åŠ ä»»åŠ¡é˜Ÿåˆ—ï¼Œè¿™æ ·å°±ä¸è‡³äºä¸€ä¸ªé˜Ÿä¼çš„ä»»åŠ¡é˜»å¡å…¶ä»–æ‰€æœ‰ä»»åŠ¡ã€‚å› ä¸ºæ­¤æ—¶éœ€è¦å»ºç«‹å¤šä¸ªè¿æ¥ï¼Œæ‰€ä»¥ä¸€å®šç¨‹åº¦ä¸Šä¼šæ¶ˆè€—èµ„æºï¼Œç»™æœåŠ¡å™¨æ€§èƒ½å¸¦æ¥æ€§èƒ½å‹åŠ›ã€‚ åè®®å¼€é”€å¤§ï¼šHTTP/1.xä¸­headerå†…å®¹è¿‡å¤§ï¼ˆæ¯æ¬¡è¯·æ±‚headeråŸºæœ¬ä¸æ€ä¹ˆå˜åŒ–ï¼‰ï¼Œå¢åŠ äº†ä¼ è¾“çš„æˆæœ¬ã€‚ å®‰å…¨å› ç´ ï¼šHTTP/1.xä¸­ä¼ è¾“çš„å†…å®¹éƒ½æ˜¯æ˜æ–‡ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯åŒæ–¹æ— æ³•éªŒè¯èº«ä»½ã€‚ http2.0http2.0æ¯”ä¹‹å‰çš„åè®®åœ¨æ€§èƒ½ä¸Šæœ‰å¾ˆå¤§çš„æå‡ï¼š å¤šè·¯å¤ç”¨ï¼šå…è®¸åœ¨ä¸€ä¸ªè¿æ¥ä¸Šå‘é€å¤šä¸ªè¯·æ±‚ï¼Œå“åº”å¤šä¸ªè¯·æ±‚ã€‚ æ¯ä¸ªè¯·æ±‚å’Œå®ƒæ‰€å¯¹åº”çš„å“åº”ä¼šåœ¨ä¸€ä¸ªstreamä¸­ ä¸€ä¸ªè¿æ¥ä¸­å¯ä»¥æœ‰å¤šä¸ªstream æ¯ä¸ªstreamé«˜åº¦ç‹¬ç«‹ï¼Œé˜»å¡çš„streamä¸ä¼šå½±å“å…¶ä»–streamçš„å¤„ç†ï¼Œæ‰€ä»¥å¯ä»¥é¿å…Head-Of-Line Blockingã€‚ äºŒè¿›åˆ¶åˆ†å¸§ï¼šç”¨äºŒè¿›åˆ¶çš„æ ¼å¼å»å®šä¹‰æŠ¥æ–‡ã€‚ http1.1çš„è§£ææ˜¯åŸºäºæ–‡æœ¬çš„ï¼ŒåŸºæœ¬æ–‡æœ¬åè®®çš„æ ¼å¼å­˜åœ¨å¤©ç„¶çš„ç¼ºé™·ã€‚å› ä¸ºæ–‡æœ¬çš„è¡¨ç°å½¢å¼æœ‰å¤šæ ·æ€§ï¼Œè¦åšåˆ°å¥å£®æ€§è€ƒè™‘çš„åœºæ™¯å¿…ç„¶å¾ˆå¤šã€‚ http2.0å’Œhttp1.1æŠ¥æ–‡æ ¼å¼åŒºåˆ«ï¼š é¦–éƒ¨å‹ç¼© å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œç¬¬2ä¸ªè¯·æ±‚çš„Headeråªæœ‰:pathä¸ä¸€æ ·ï¼Œå› æ­¤å‹ç¼©ç©ºé—´éå¸¸å¯è§‚ã€‚ Headerså‹ç¼©çš„ç®—æ³•HPACKæœ¬èº«ä¼¼ä¹å¾ˆå¤æ‚(å…¶å®ä¹Ÿä¸éš¾)ï¼Œä½†æ˜¯ç®—æ³•æ€æƒ³å…¶å®éå¸¸ç®€å•çš„ï¼Œå‡è®¾æˆ‘ä»¬åœ¨æµè§ˆå™¨å‘èµ·100ä¸ªè¯·æ±‚ï¼Œå®ƒä»¬çš„user-agentæ˜¯ä¸ä¼šå˜çš„ï¼Œé‚£æˆ‘ä»¬ä¸ºä»€ä¹ˆéœ€è¦é‡å¤ä¼ è¾“è¿™ä¸ªé•¿é•¿çš„å­—ç¬¦ä¸²å‘¢ï¼Ÿç”¨dictionaryè®°å½•ä¸€æ¬¡ä¸å°±è¡Œäº†ï¼ æœåŠ¡ç«¯æ¨é€ï¼šæœåŠ¡ç«¯å¯ä»¥ä¸»åŠ¨æ¨é€ä¸€äº›å®¢æˆ·ç«¯ä¹‹åå¯èƒ½ä¼šè¯·æ±‚çš„èµ„æºã€‚ å¦‚ä½•å‡çº§åˆ°http2.0 å‚è€ƒFunDebugæ–‡ç« ï¼šhttps://blog.fundebug.com/2019/10/28/speedup-fundebug-by-using-http2/ æˆ‘ä»¬ä½¿ç”¨äº†Nginxä½œä¸ºå‰ç«¯é¡µé¢ä¸åç«¯æ¥å£çš„åå‘ä»£ç†æœåŠ¡å™¨(Reverse Proxy)ï¼Œåªéœ€è¦ä¿®æ”¹ä¸€ä¸‹Nginxé…ç½®æ–‡ä»¶å°±å¯ä»¥å‡çº§HTTP/2äº†ï¼Œéå¸¸ç®€å•ã€‚ æ³¨æ„ï¼Œåœ¨ Nginx ä¸Š å¼€å¯ HTTP/2 éœ€è¦ Nginx 1.9.5 ä»¥ä¸Šç‰ˆæœ¬ï¼ˆåŒ…æ‹¬1.9.5ï¼‰ï¼Œå¹¶ä¸”éœ€è¦ OpenSSL 1.0.2 ä»¥ä¸Šç‰ˆæœ¬(åŒ…æ‹¬1.0.2)ã€‚ä½¿ç”¨nginx -Vå‘½ä»¤å¯ä»¥æŸ¥çœ‹Nginxçš„ç‰ˆæœ¬ä¿¡æ¯ï¼š 123456nginx -Vnginx version: nginx&#x2F;1.12.1built by gcc 6.3.0 20170516 (Debian 6.3.0-18)built with OpenSSL 1.1.0f 25 May 2017TLS SNI support enabledconfigure arguments: --prefix&#x3D;&#x2F;etc&#x2F;nginx --sbin3-path&#x3D;&#x2F;usr&#x2F;sbin&#x2F;nginx --modules-path&#x3D;&#x2F;usr&#x2F;lib&#x2F;nginx&#x2F;modules --conf-path&#x3D;&#x2F;etc&#x2F;nginx&#x2F;nginx.conf --error-log-path&#x3D;&#x2F;var&#x2F;log&#x2F;nginx&#x2F;error.log --http-log-path&#x3D;&#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.log --pid-path&#x3D;&#x2F;var&#x2F;run&#x2F;nginx.pid --lock-path&#x3D;&#x2F;var&#x2F;run&#x2F;nginx.lock --http-client-body-temp-path&#x3D;&#x2F;var&#x2F;cache&#x2F;nginx&#x2F;client_temp --http-proxy-temp-path&#x3D;&#x2F;var&#x2F;cache&#x2F;nginx&#x2F;proxy_temp --http-fastcgi-temp-path&#x3D;&#x2F;var&#x2F;cache&#x2F;nginx&#x2F;fastcgi_temp --http-uwsgi-temp-path&#x3D;&#x2F;var&#x2F;cache&#x2F;nginx&#x2F;uwsgi_temp --http-scgi-temp-path&#x3D;&#x2F;var&#x2F;cache&#x2F;nginx&#x2F;scgi_temp --user&#x3D;nginx --group&#x3D;nginx --with-compat --with-file-aio --with-threads --with-http_addition_module --with-http_auth_request_module --with-http_dav_module --with-http_flv_module --with-http_gunzip_module --with-http_gzip_static_module --with-http_mp4_module --with-http_random_index_module --with-http_realip_module --with-http_secure_link_module --with-http_slice_module --with-http_ssl_module --with-http_stub_status_module --with-http_sub_module --with-http_v2_module --with-mail --with-mail_ssl_module --with-stream --with-stream_realip_module --with-stream_ssl_module --with-stream_ssl_preread_module --with-cc-opt&#x3D;&#39;-g -O2 -fdebug-prefix-map&#x3D;&#x2F;data&#x2F;builder&#x2F;debuild&#x2F;nginx-1.12.1&#x2F;debian&#x2F;debuild-base&#x2F;nginx-1.12.1&#x3D;. -specs&#x3D;&#x2F;usr&#x2F;share&#x2F;dpkg&#x2F;no-pie-compile.specs -fstack-protector-strong -Wformat -Werror&#x3D;format-security -Wp,-D_FORTIFY_SOURCE&#x3D;2 -fPIC&#39; --with-ld-opt&#x3D;&#39;-specs&#x3D;&#x2F;usr&#x2F;share&#x2F;dpkg&#x2F;no-pie-link.specs -Wl,-z,relro -Wl,-z,now -Wl,--as-needed -pie&#39; å¯çŸ¥ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„Nginxç‰ˆæœ¬ä¸º1.12.1ï¼ŒOpenSSLç‰ˆæœ¬ä¸º1.1.0fï¼Œç¬¦åˆè¦æ±‚ã€‚ è¿˜æœ‰ä¸€ç‚¹ï¼Œè™½ç„¶HTTP/2æ ‡å‡†å¹¶æ²¡æœ‰è¦æ±‚åŠ å¯†ï¼Œä½†æ˜¯æ‰€æœ‰æµè§ˆå™¨éƒ½è¦æ±‚HTTP/2å¿…é¡»åŠ å¯†ï¼Œè¿™æ ·çš„è¯ï¼Œåªæœ‰HTTPSæ‰èƒ½å‡çº§HTTP/2ã€‚ å¦‚æœä½ è¿˜æ²¡ç”¨è¿‡HTTPSçš„è¯ï¼Œä¸å¦¨çœ‹çœ‹æˆ‘çš„åšå®¢ï¼šæ•™ä½ å¿«é€Ÿæ’¸ä¸€ä¸ªå…è´¹HTTPSè¯ä¹¦ï¼Œå…¶å®ä¹Ÿå¾ˆç®€å•ã€‚ ä¸€åˆ‡å‰ææ²¡é—®é¢˜çš„è¯(Nginx&gt;=1.9.5ï¼ŒOpenSSL&gt;=1.0.2ï¼ŒHTTPS)ï¼Œåªéœ€è¦ä¿®æ”¹1è¡Œé…ç½®ï¼Œåœ¨listenæŒ‡ä»¤åé¢æ·»åŠ http2ï¼š 12345server&#123; listen 443 ssl http2; server_name www.fundebug.com;&#125; é‡å¯Nginxï¼Œå‡çº§HTTP/2å°±æˆåŠŸäº†ï¼Œå¯ä»¥ä½¿ç”¨curlå‘½ä»¤æ£€æŸ¥ï¼š 12345678910111213curl -sI https:&#x2F;&#x2F;www.fundebug.comHTTP&#x2F;2 200server: nginx&#x2F;1.12.1date: Mon, 07 Oct 2019 00:12:53 GMTcontent-type: text&#x2F;html; charset&#x3D;UTF-8content-length: 4892x-powered-by: Expressaccept-ranges: bytescache-control: public, max-age&#x3D;0last-modified: Sun, 06 Oct 2019 23:07:25 GMTetag: W&#x2F;&quot;131c-16da353dbc8&quot;vary: Accept-Encodingstrict-transport-security: max-age&#x3D;15768001 curlæŒ‡ä»¤ï¼šç”¨æ¥è¯·æ±‚webæœåŠ¡å™¨ã€‚å®ƒçš„åå­—å°±æ˜¯å®¢æˆ·ç«¯ï¼ˆclientï¼‰çš„URLå·¥å…·çš„æ„æ€ã€‚ å‚è€ƒï¼šhttps://www.ruanyifeng.com/blog/2019/09/curl-reference.html å¦‚ä½•æŸ¥çœ‹å½“å‰ç½‘ç«™ä½¿ç”¨å“ªç§åè®®æ‰“å¼€chromeçš„devToolï¼ˆf12ï¼‰ï¼Œé€‰æ‹©networké¡¹ï¼š å¦‚æœæ²¡æœ‰çš„è¯åœ¨Statusä¸€æ ï¼Œç‚¹å‡»å³é”®ï¼Œé€‰æ‹©protocolé¡¹å³å¯ï¼š","categories":[{"name":"è®¡ç®—æœºç½‘ç»œ","slug":"è®¡ç®—æœºç½‘ç»œ","permalink":"http://delaprada.com/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/"}],"tags":[{"name":"è®¡ç®—æœºç½‘ç»œ","slug":"è®¡ç®—æœºç½‘ç»œ","permalink":"http://delaprada.com/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/"}]},{"title":"ä»€ä¹ˆæ˜¯è·¨åŸŸä»¥åŠè·¨åŸŸè§£å†³æ–¹æ¡ˆ","slug":"ä»€ä¹ˆæ˜¯è·¨åŸŸä»¥åŠè·¨åŸŸè§£å†³æ–¹æ¡ˆ","date":"2020-12-06T08:30:16.000Z","updated":"2020-12-19T15:06:18.000Z","comments":true,"path":"2020/12/06/ä»€ä¹ˆæ˜¯è·¨åŸŸä»¥åŠè·¨åŸŸè§£å†³æ–¹æ¡ˆ/","link":"","permalink":"http://delaprada.com/2020/12/06/%E4%BB%80%E4%B9%88%E6%98%AF%E8%B7%A8%E5%9F%9F%E4%BB%A5%E5%8F%8A%E8%B7%A8%E5%9F%9F%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/","excerpt":"","text":"åœ¨ä»‹ç»è·¨åŸŸå‰ï¼Œå…ˆä»‹ç»æµè§ˆå™¨çš„ä¸€ä¸ªé‡è¦çš„å®‰å…¨ç­–ç•¥â€”â€”åŒæºç­–ç•¥ã€‚ åœ¨æ–‡ä¸­ï¼Œweb ç«¯åœ°å€ä¸º localhost:8000 æœåŠ¡ç«¯åœ°å€ä¸º localhost:8080 åŒæºç­–ç•¥ åŒæºç­–ç•¥æ˜¯æµè§ˆå™¨çš„ä¸€ä¸ªå®‰å…¨åŠŸèƒ½ï¼Œå®ƒæ˜¯æµè§ˆå™¨æœ€æ ¸å¿ƒä¹Ÿæœ€åŸºæœ¬çš„å®‰å…¨åŠŸèƒ½ï¼Œå¦‚æœç¼ºå°‘åŒæºç­–ç•¥ï¼Œæµè§ˆå™¨å¾ˆå®¹æ˜“å—åˆ°XSSå’ŒCSFRç­‰æ”»å‡»ã€‚ åŒæºæŒ‡çš„æ˜¯ï¼šåè®®ï¼ŒåŸŸåï¼Œç«¯å£å·éƒ½ç›¸åŒ åŒæºç­–ç•¥è§„å®šï¼šä¸åŒæºçš„å®¢æˆ·ç«¯è„šæœ¬ï¼ˆåœ¨æ²¡æœ‰æ˜ç¡®æˆæƒçš„æƒ…å†µä¸‹ï¼‰ä¸èƒ½è¯»å†™å¯¹æ–¹çš„èµ„æº è·¨åŸŸä»€ä¹ˆæ˜¯è·¨åŸŸè·¨åŸŸæ˜¯æŒ‡ä¸€ä¸ªæºä¸‹çš„æ–‡æ¡£æˆ–è„šæœ¬è¯•å›¾å»è¯·æ±‚å¦ä¸€ä¸ªæºä¸‹çš„èµ„æºã€‚ å¸¸è§çš„è·¨åŸŸåœºæ™¯ï¼š 1234567891011121314151617181920URL è¯´æ˜ æ˜¯å¦å…è®¸é€šä¿¡http:&#x2F;&#x2F;www.domain.com&#x2F;a.jshttp:&#x2F;&#x2F;www.domain.com&#x2F;b.js åŒä¸€åŸŸåï¼Œä¸åŒæ–‡ä»¶æˆ–è·¯å¾„ å…è®¸http:&#x2F;&#x2F;www.domain.com&#x2F;lab&#x2F;c.jshttp:&#x2F;&#x2F;www.domain.com:8000&#x2F;a.jshttp:&#x2F;&#x2F;www.domain.com&#x2F;b.js åŒä¸€åŸŸåï¼Œä¸åŒç«¯å£ ä¸å…è®¸ http:&#x2F;&#x2F;www.domain.com&#x2F;a.jshttps:&#x2F;&#x2F;www.domain.com&#x2F;b.js åŒä¸€åŸŸåï¼Œä¸åŒåè®® ä¸å…è®¸ http:&#x2F;&#x2F;www.domain.com&#x2F;a.jshttp:&#x2F;&#x2F;192.168.4.12&#x2F;b.js åŸŸåå’ŒåŸŸåå¯¹åº”ç›¸åŒip ä¸å…è®¸ http:&#x2F;&#x2F;www.domain.com&#x2F;a.jshttp:&#x2F;&#x2F;x.domain.com&#x2F;b.js ä¸»åŸŸç›¸åŒï¼Œå­åŸŸä¸åŒ ä¸å…è®¸http:&#x2F;&#x2F;domain.com&#x2F;c.js http:&#x2F;&#x2F;www.domain1.com&#x2F;a.jshttp:&#x2F;&#x2F;www.domain2.com&#x2F;b.js ä¸åŒåŸŸå ä¸å…è®¸ ä¸ºä»€ä¹ˆä¼šå‡ºç°è·¨åŸŸå½’ç»“äºå‰åç«¯åˆ†ç¦»è¿™ç§æ¶æ„è®¾è®¡å’Œå¼€å‘æ¨¡å¼ã€‚å‰ç«¯å¼€å‘äººå‘˜åªéœ€è´Ÿè´£å°†é¡µé¢è®¾è®¡åšå¥½ï¼Œåç«¯å¼€å‘äººå‘˜åªéœ€å°†åç«¯é€»è¾‘å†™å¥½ï¼Œè¿™æ ·é™ä½äº†å‰ç«¯å’Œåç«¯ç¨‹åºå‘˜çš„é—¨æ§›ï¼Œä¹Ÿæå‡äº†å¼€å‘æ•ˆç‡ã€‚é‚£åœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œå‰åç«¯éœ€è¦è¿›è¡Œè”è°ƒï¼Œæ‰èƒ½å¯¹å„ç§åŠŸèƒ½è¿›è¡Œæµ‹è¯•ã€‚ä½†åœ¨å‰åç«¯åˆ†ç¦»çš„æ¨¡å¼ä¸‹ï¼Œå‰åç«¯çš„åŸŸåæ˜¯ä¸ä¸€è‡´çš„ï¼Œæ­¤æ—¶æµè§ˆå™¨å‘æœåŠ¡å™¨å‘èµ·è¯·æ±‚çš„æ—¶å€™å°±ä¼šå‘ç”Ÿè·¨åŸŸçš„é—®é¢˜ã€‚ ä¸ºä»€ä¹ˆéœ€è¦è·¨åŸŸé™åˆ¶ä¸åŒæºçš„è¯·æ±‚æ¯”å¦‚ç”¨æˆ·ç™»å½•aç½‘ç«™ï¼ŒåŒæ—¶æ–°å¼€tabæ‰“å¼€äº†bç½‘ç«™ï¼Œå¦‚æœä¸é™åˆ¶åŒæºï¼Œbå¯ä»¥åƒaç½‘ç«™å‘èµ·ä»»ä½•è¯·æ±‚ï¼Œä¼šè®©ä¸æ³•åˆ†å­æœ‰æœºå¯è¶ã€‚ é™åˆ¶domæ“ä½œå¦‚æœç°åœ¨æœ‰ä¸€ä¸ªå’Œç™¾åº¦å¾ˆç±»ä¼¼çš„ç½‘ç«™å«ï¼šwww.baidu1.comã€‚æˆ‘ä»¬å…ˆç™»å½•ä¸€ä¸‹ç™¾åº¦ï¼Œç„¶åè®¿é—®è¿™ä¸ªwww.baidu1.comã€‚å¦‚æœå¯ä»¥è¿›è¡Œdomæ“ä½œï¼ˆä¾‹å¦‚ï¼šdocument.cookieï¼‰çš„è¯ï¼Œå¤§å®¶çš„ä¿¡æ¯åœ¨è¿™äº›é’“é±¼ç½‘ç«™ä¸Šä¼šè¢«è½»æ¾è·å–ã€‚ è·¨åŸŸè§£å†³æ–¹æ¡ˆ CORSè·¨åŸŸèµ„æºå…±äº«ï¼ˆCORSï¼‰æ˜¯ä¸€ç§æœºåˆ¶ï¼Œå®ƒä½¿ç”¨é¢å¤–çš„HTTPå¤´æ¥å‘Šè¯‰æµè§ˆå™¨ï¼Œè®©è¿è¡Œåœ¨ä¸€ä¸ªoriginï¼ˆdomainï¼‰ä¸Šçš„webåº”ç”¨è¢«å‡†è®¸è®¿é—®æ¥è‡ªä¸åŒæºæœåŠ¡å™¨ä¸Šçš„æŒ‡å®šçš„èµ„æºã€‚å½“è¿™ä¸ªwebåº”ç”¨å‘ä¸€ä¸ªä¸ä¹‹ä¸åŒåŸŸã€åè®®æˆ–ç«¯å£å·çš„æœåŠ¡å™¨è¯·æ±‚èµ„æºçš„æ—¶å€™ï¼Œå°±ä¼šå‘èµ·ä¸€ä¸ªè·¨åŸŸè¯·æ±‚ã€‚ CORSä¸­çš„è¯·æ±‚åˆ†ä¸ºä¸¤ç§ï¼šç®€å•è¯·æ±‚å’Œéç®€å•è¯·æ±‚ã€‚ ç®€å•è¯·æ±‚ï¼Œä¾‹å¦‚è¯·æ±‚æ–¹æ³•ä¸ºHEADï¼ŒGETï¼ŒPOSTï¼›éç®€å•è¯·æ±‚ï¼Œä¾‹å¦‚ï¼šPUTï¼ŒDELETEã€‚ æµè§ˆå™¨å¯¹è¿™ä¸¤ç§è¯·æ±‚çš„å¤„ç†æ˜¯ä¸ä¸€æ ·çš„ã€‚ ç®€å•è¯·æ±‚ å¦‚æœæµè§ˆå™¨å‘ç°è¿™æ¬¡è·¨åŸŸè¯·æ±‚æ˜¯ç®€å•è¯·æ±‚ï¼Œå°±è‡ªåŠ¨åœ¨å¤´ä¿¡æ¯ä¸­æ·»åŠ ä¸€ä¸ªOriginå­—æ®µã€‚Originå­—æ®µç”¨æ¥è¯´æ˜ï¼Œæœ¬æ¬¡è¯·æ±‚æ¥è‡ªå“ªä¸ªæºã€‚æœåŠ¡å™¨ä¼šæ ¹æ®è¿™ä¸ªå€¼å†³å®šæ˜¯å¦åŒæ„è¿™æ¬¡è¯·æ±‚ã€‚ å¦‚æœæœåŠ¡å™¨åŒæ„è¿™æ¬¡è¯·æ±‚çš„è¯ï¼Œå°±ä¼šåœ¨å“åº”æŠ¥æ–‡åŠ å…¥å¤´å­—æ®µAccess-Control-Allow-Originã€‚å®ƒçš„å€¼è¦ä¹ˆæ˜¯è¯·æ±‚æ—¶Originå­—æ®µçš„å€¼ï¼Œè¦ä¹ˆæ˜¯ä¸€ä¸ª*ï¼Œè¡¨ç¤ºæ¥æ”¶ä»»æ„åŸŸåçš„è¯·æ±‚ã€‚ éç®€å•è¯·æ±‚ é¢„æ£€è¯·æ±‚ï¼šæµè§ˆå™¨å¦‚æœå‘ç°æ­¤æ¬¡è¯·æ±‚æ˜¯ä¸€ä¸ªéç®€å•è¯·æ±‚çš„è¯ï¼Œå°±è‡ªåŠ¨å‘å‡ºä¸€ä¸ªé¢„æ£€è¯·æ±‚ã€‚é¢„æ£€è¯·æ±‚ç”¨çš„è¯·æ±‚æ–¹æ³•æ˜¯OPTIONSï¼Œè¡¨ç¤ºè¿™ä¸ªè¯·æ±‚æ˜¯ç”¨æ¥è¯¢é—®æœåŠ¡å™¨ï¼Œå½“å‰ç½‘é¡µæ‰€åœ¨åŸŸåæ˜¯å¦åœ¨æœåŠ¡å™¨çš„è®¸å¯åå•ä¹‹ä¸­ï¼Œä»¥åŠå¯ä»¥ä½¿ç”¨å“ªäº›HTTPå¤´å­—æ®µã€‚åœ¨è¿™ä¸ªæŠ¥æ–‡ä¸­è¿˜ä¼šå¸¦æœ‰Access-Control-Request-Methodå­—æ®µï¼Œè¡¨ç¤ºCORSè¯·æ±‚ä¸­ä½¿ç”¨çš„httpæ–¹æ³•æ˜¯ä»€ä¹ˆï¼Œæ¯”å¦‚PUTï¼›è¿˜æœ‰Access-Control-Request-Headersï¼ŒæŒ‡å®šæµè§ˆå™¨CORSè¯·æ±‚ä¼šé¢å¤–å‘é€çš„å¤´ä¿¡æ¯å­—æ®µã€‚ é¢„æ£€è¯·æ±‚çš„å›åº”ï¼šæœåŠ¡å™¨åœ¨æ”¶åˆ°é¢„æ£€è¯·æ±‚ä¹‹åï¼Œæ£€æŸ¥äº†Originã€Access-Control-Request-Methodå’ŒAccess-Control-Request-Headerså­—æ®µä»¥åï¼Œç¡®è®¤å…è®¸è·¨åŸŸè¯·æ±‚ï¼Œå°±å¯ä»¥åšå‡ºå›åº”ã€‚å›åº”çš„å…³é”®å­—æ®µä¹Ÿæ˜¯Access-Control-Allow-Originã€‚ æƒ³è¦æºå¸¦cookieéœ€è¦æ»¡è¶³3ä¸ªæ¡ä»¶ï¼š å®¢æˆ·ç«¯è®¾ç½®withCredentialså±æ€§ä¸ºtrueï¼Œä¾‹å¦‚åœ¨axiosä¸­çš„è®¾ç½®æ–¹å¼ä¸ºï¼šaxios.defaults.withCredentials = true æœåŠ¡å™¨ç«¯æ·»åŠ Access-Control-Allow-Credentials: true æœåŠ¡å™¨ç«¯é…ç½®çš„Access-Control-Allow-Originä¸ºé* Nodeçš„è·¨åŸŸè§£å†³ä¾‹å­åŸç”Ÿæ–¹å¼1234567891011121314app.use(async (ctx, next) =&gt; &#123; ctx.set(\"Access-Control-Allow-Origin\", ctx.headers.origin); ctx.set(\"Access-Control-Allow-Credentials\", true); ctx.set(\"Access-Control-Request-Method\", \"PUT,POST,GET,DELETE,OPTIONS\"); ctx.set( \"Access-Control-Allow-Headers\", \"Origin, X-Requested-With, Content-Type, Accept, cc\" ); if (ctx.method === \"OPTIONS\") &#123; ctx.status = 204; return; &#125; await next();&#125;); ç¬¬ä¸‰æ–¹ä¸­é—´ä»¶123const cors = require(\"koa-cors\");app.use(cors()); Nodeæ­£å‘ä»£ç†ä»£ç†çš„æ€è·¯ä¸ºï¼Œåˆ©ç”¨æœåŠ¡ç«¯è¯·æ±‚ä¸ä¼šè·¨åŸŸçš„ç‰¹æ€§ï¼Œè®©æ¥å£å’Œå½“å‰ç«™ç‚¹ï¼ˆä»£ç†æœåŠ¡å™¨ï¼‰åŒåŸŸã€‚ ä»£ç†å‰ï¼š ä»£ç†åï¼š cliå·¥å…·ä¸­çš„ä»£ç†Webpackï¼ˆ4.xï¼‰åœ¨webpackä¸­å¯ä»¥é…ç½®proxyæ¥å¿«é€Ÿè·å¾—æ¥å£ä»£ç†çš„èƒ½åŠ›ã€‚ 1234567891011121314151617181920212223242526const path = require(\"path\");const HtmlWebpackPlugin = require(\"html-webpack-plugin\");module.exports = &#123; entry: &#123; index: \"./index.js\" &#125;, output: &#123; filename: \"bundle.js\", path: path.resolve(__dirname, \"dist\") &#125;, devServer: &#123; port: 8000, proxy: &#123; \"/api\": &#123; target: \"http://localhost:8080\" &#125; &#125; &#125;, plugins: [ new HtmlWebpackPlugin(&#123; filename: \"index.html\", template: \"webpack.html\" &#125;) ]&#125;; ä¿®æ”¹å‰ç«¯æ¥å£è¯·æ±‚æ–¹å¼ï¼Œæ”¹ä¸ºä¸å¸¦åŸŸåã€‚ï¼ˆå› ä¸ºç°åœ¨æ˜¯åŒåŸŸè¯·æ±‚äº†ï¼‰ï¼š 1234567891011121314&lt;button id=\"getlist\"&gt;è·å–åˆ—è¡¨&lt;/button&gt;&lt;button id=\"login\"&gt;ç™»å½•&lt;/button&gt;&lt;script src=\"https://cdn.bootcss.com/axios/0.19.2/axios.min.js\"&gt;&lt;/script&gt;&lt;script&gt; axios.defaults.withCredentials = true; getlist.onclick = () =&gt; &#123; axios.get(\"/api/corslist\").then(res =&gt; &#123; console.log(res.data); &#125;); &#125;; login.onclick = () =&gt; &#123; axios.post(\"/api/login\"); &#125;;&lt;/script&gt; å› ä¸ºå‰ç«¯ç°åœ¨æ˜¯å‘webpackçš„devServerå‘èµ·è¯·æ±‚ï¼Œæ‰€ä»¥ä¸éœ€è¦å¸¦åŸŸå(ä¹Ÿå°±æ˜¯http://localhost:8080)ï¼ŒdevServerä¼šè‡ªåŠ¨è½¬å‘ç»™ç›®æ ‡æœåŠ¡å™¨åœ°å€http://localhost:8080ã€‚ Vue-cli 2.x123456789// config/index.js...proxyTable: &#123; '/api': &#123; target: 'http://localhost:8080', &#125;&#125;,... Vue-cli 3.x12345678910111213// vue.config.js å¦‚æœæ²¡æœ‰å°±æ–°å»ºmodule.exports = &#123; devServer: &#123; port: 8000, proxy: &#123; \"/api\": &#123; target: \"http://localhost:8080\" &#125; &#125; &#125;&#125;;... Parcelï¼ˆ2.xï¼‰123456// .proxyrc&#123; \"/api\": &#123; \"target\": \"http://localhost:8080\" &#125;&#125; ä»¥ä¸Šé…ç½®æ–¹å¼è™½å¤šï¼Œä½†éƒ½æ˜¯æœ‰ç€å…±åŒçš„åº•å±‚åŒ…http-proxy-middlewareã€‚é‡Œé¢éœ€è¦ç”¨åˆ°çš„å„ç§websocketï¼Œrewriteç­‰åŠŸèƒ½ï¼Œç›´æ¥çœ‹è¿™ä¸ªåº“çš„é…ç½®å³å¯ã€‚æœç´¢æŠ€å·§å°±æ˜¯ï¼Œæƒ³è¦é‚£ä¸ªæ¡†æ¶ç›´æ¥google xxx proxyå³å¯ï¼Œå®˜ç½‘æœ‰é…ç½®ç­”æ¡ˆã€‚ Nginxåå‘ä»£ç†Nginxåˆ™æ˜¯é€šè¿‡åå‘ä»£ç†çš„æ–¹å¼ï¼Œè¿™é‡Œéœ€è¦è‡ªå®šä¹‰ä¸€ä¸ªåŸŸåã€‚è¿™é‡Œå°±æ˜¯ä¿è¯æˆ‘å½“å‰åŸŸï¼Œèƒ½è·å–åˆ°é™æ€èµ„æºå’Œæ¥å£ï¼Œä¸å…³å¿ƒæ˜¯æ€ä¹ˆè·å–çš„ã€‚ nginxå®‰è£…æ•™ç¨‹ï¼šhttps://blog.csdn.net/diaojw090/article/details/89135073 é…ç½®hostsï¼š127.0.0.1 local.test é…ç½®nginxï¼š 12345678910server &#123; listen 80; server_name local.test; location /api &#123; proxy_pass http://localhost:8080; &#125; location / &#123; proxy_pass http://localhost:8000; &#125;&#125; å¯åŠ¨nginxï¼šsudo nginx é‡å¯nginxï¼šsudo nginx -s reload å‰ç«¯ä»£ç ï¼š 1234567891011&lt;script&gt; axios.defaults.withCredentials = true; getlist.onclick = () =&gt; &#123; axios.get(\"/api/corslist\").then(res =&gt; &#123; console.log(res.data); &#125;); &#125;; login.onclick = () =&gt; &#123; axios.post(\"/api/login\"); &#125;;&lt;/script&gt; åç«¯ä»£ç ï¼š 1234567891011&lt;script&gt; axios.defaults.withCredentials = true; getlist.onclick = () =&gt; &#123; axios.get(\"/api/corslist\").then(res =&gt; &#123; console.log(res.data); &#125;); &#125;; login.onclick = () =&gt; &#123; axios.post(\"/api/login\"); &#125;;&lt;/script&gt; ç–‘æƒ‘ï¼šä¸ºä»€ä¹ˆå®¢æˆ·ç«¯è®¿é—®nginxåå‘ä»£ç†æœåŠ¡å™¨ä¸ä¼šè·¨åŸŸï¼Œdomainéƒ½ä¸ä¸€æ ·ã€‚ã€‚ ç”¨nginxåå‘ä»£ç†è§£å†³è·¨åŸŸ å‚è€ƒï¼šhttps://blog.csdn.net/qq_34020571/article/details/80597136 ç¬¬ä¸€æ­¥ï¼šé…ç½®nginx.config 1234567891011121314151617181920212223242526272829server &#123; listen 8000; server_name localhost; #charset koi8-r; #access_log logs/host.access.log main; location / &#123; root E:/h5; #h5é¡¹ç›®è·¯å¾„ &#125; location /urm &#123; #ä»£ç†çš„æ¥å£è·¯å¾„ proxy_pass http://192.168.1.111:9003/urm; proxy_set_header Host $host; proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; add_header 'Access-Control-Allow-Origin' '*'; add_header 'Access-Control-Allow-Credentials' 'true'; add_header 'Access-Control-Allow-Methods' 'GET, POST, OPTIONS'; add_header 'Access-Control-Allow-Headers' 'DNT,X-CustomHeader,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type'; &#125; location = /favicon.ico &#123; log_not_found off; access_log off; &#125; &#125; ç¬¬äºŒæ­¥ï¼šå¯åŠ¨åç«¯æœåŠ¡å™¨ï¼Œå¯åŠ¨nginx ç¬¬ä¸‰æ­¥ï¼šä¿®æ”¹å‰ç«¯ajaxè®¿é—®çš„url ä»http://192.168.1.111:9003/urm â€”&gt; http://192.168.1.111:8000/urm ç¬¬å››æ­¥ï¼šè®¿é—®å‰ç«¯é¡¹ç›® http://192.168.1.111:8000/agent/merchant_manage.html æ­£å‘ä»£ç†å’Œåå‘ä»£ç†çš„åŒºåˆ« å‚è€ƒé“¾æ¥ï¼šhttps://blog.csdn.net/m13666368773/article/details/8060481 æ­£å‘ä»£ç†ï¼šå®¢æˆ·ç«¯çŸ¥é“æœåŠ¡ç«¯ï¼Œé€šè¿‡ä»£ç†ç«¯è¿æ¥æœåŠ¡ç«¯ã€‚ä»£ç†ç«¯ä»£ç†çš„æ˜¯æœåŠ¡ç«¯ã€‚ åå‘ä»£ç†ï¼šæ‰€è°“åå‘ï¼Œæ˜¯å¯¹æ­£å‘è€Œè¨€çš„ã€‚æœåŠ¡ç«¯çŸ¥é“å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯ä¸çŸ¥é“æœåŠ¡ç«¯ï¼Œé€šè¿‡ä»£ç†ç«¯è¿æ¥æœåŠ¡ç«¯ã€‚ä»£ç†ç«¯ä»£ç†å®¢æˆ·ç«¯ã€‚ä»£ç†å¯¹è±¡æ°å¥½ç›¸åï¼Œæ•…åä¸ºåå‘ä»£ç†ã€‚ JSONPJSONPä¸»è¦æ˜¯åˆ©ç”¨äº†scriptæ ‡ç­¾æ²¡æœ‰è·¨åŸŸé™åˆ¶çš„ç‰¹æ€§æ¥å®Œæˆçš„ã€‚ ä½¿ç”¨é™åˆ¶ä»…æ”¯æŒGETæ–¹æ³•ï¼Œå¦‚æœæƒ³è¦ä½¿ç”¨å®Œæ•´çš„RESTæ¥å£ï¼Œè¯·ä½¿ç”¨CORSæˆ–è€…å…¶ä»–ä»£ç†æ–¹å¼ã€‚ æµç¨‹è§£æ å‰ç«¯å®šä¹‰å›è°ƒå‡½æ•°ï¼ˆä¾‹å¦‚ jsonpCallback=function(){....}ï¼‰ é€šè¿‡paramså½¢å¼åŒ…è£…è¯·æ±‚å‚æ•°ï¼Œå¹¶ä¸”å£°æ˜æ‰§è¡Œå‡½æ•°ï¼ˆä¾‹å¦‚ï¼šcb=jsonpCallbackï¼‰ åç«¯è·å–å‰ç«¯å£°æ˜çš„æ‰§è¡Œå‡½æ•°ï¼ˆjsonpCallbackï¼‰ï¼Œå¹¶ä»¥å¸¦ä¸Šå‚æ•°å’Œè°ƒç”¨æ‰§è¡Œå‡½æ•°çš„æ–¹å¼ä¼ é€’ç»™å‰ç«¯ ä½¿ç”¨ç¤ºä¾‹åç«¯å®ç°ï¼š 12345678910111213const Koa = require(\"koa\");const fs = require(\"fs\");const app = new Koa();app.use(async (ctx, next) =&gt; &#123; if (ctx.path === \"/api/jsonp\") &#123; const &#123; cb, msg &#125; = ctx.query; ctx.body = `$&#123;cb&#125;($&#123;JSON.stringify(&#123; msg &#125;)&#125;)`; return; &#125;&#125;);app.listen(8080); å‰ç«¯æ™®é€šjsç¤ºä¾‹ï¼š 123456789&lt;script type=\"text/javascript\"&gt; window.jsonpCallback = function(res) &#123; console.log(res); &#125;;&lt;/script&gt;&lt;script src=\"http://localhost:8080/api/jsonp?msg=hello&amp;cb=jsonpCallback\" type=\"text/javascript\"&gt;&lt;/script&gt; jQuery Ajaxç¤ºä¾‹ï¼š 123456789101112131415&lt;script src=\"https://cdn.bootcss.com/jquery/3.5.0/jquery.min.js\"&gt;&lt;/script&gt;&lt;script&gt; $.ajax(&#123; url: \"http://localhost:8080/api/jsonp\", dataType: \"jsonp\", type: \"get\", data: &#123; msg: \"hello\" &#125;, jsonp: \"cb\", success: function(data) &#123; console.log(data); &#125; &#125;);&lt;/script&gt; WebsocketWebSocketåè®®æ˜¯html5ä¸€ç§æ–°çš„åè®®ã€‚åœ¨WebSocketåè®®ä¸­ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯éƒ½å¯ä»¥ä¸»åŠ¨åœ°æ¨é€æ¶ˆæ¯ï¼Œè€Œä¸”æ²¡æœ‰åŒæºç­–ç•¥çš„é™åˆ¶ï¼Œä¸å­˜åœ¨è·¨åŸŸé—®é¢˜ã€‚åè®®çš„æ ‡è¯†ç¬¦ä¸ºwsã€‚åƒhttpsä¸€æ ·å¦‚æœåŠ å¯†çš„è¯å°±æ˜¯wxsã€‚ åœ¨ WebSocket API ä¸­ï¼Œæµè§ˆå™¨å’ŒæœåŠ¡å™¨åªéœ€è¦å®Œæˆä¸€æ¬¡æ¡æ‰‹ï¼Œä¸¤è€…ä¹‹é—´å°±ç›´æ¥å¯ä»¥åˆ›å»ºæŒä¹…æ€§çš„è¿æ¥ï¼Œå¹¶è¿›è¡ŒåŒå‘æ•°æ®ä¼ è¾“ã€‚ è¿™ç§æ–¹å¼æœ¬è´¨æ²¡æœ‰ä½¿ç”¨äº† HTTP çš„å“åº”å¤´, å› æ­¤ä¹Ÿæ²¡æœ‰è·¨åŸŸçš„é™åˆ¶ã€‚ å‰ç«¯éƒ¨åˆ†ï¼š 123456789&lt;script&gt; let socket = new WebSocket(\"ws://localhost:8080\"); socket.onopen = function() &#123; socket.send(\"ç§‹é£çš„ç¬”è®°\"); &#125;; socket.onmessage = function(e) &#123; console.log(e.data); &#125;;&lt;/script&gt; åç«¯éƒ¨åˆ†ï¼š 1234567const WebSocket = require(\"ws\");const server = new WebSocket.Server(&#123; port: 8080 &#125;);server.on(\"connection\", function(socket) &#123; socket.on(\"message\", function(data) &#123; socket.send(data); &#125;);&#125;); æœ¬èŠ‚å†…å®¹ä»£ç ï¼šhttps://github.com/hua1995116/node-demo/tree/master/node-cors å‚è€ƒï¼š https://segmentfault.com/a/1190000022398875 https://blog.csdn.net/m13666368773/article/details/8060481","categories":[{"name":"æµè§ˆå™¨","slug":"æµè§ˆå™¨","permalink":"http://delaprada.com/categories/%E6%B5%8F%E8%A7%88%E5%99%A8/"}],"tags":[{"name":"æµè§ˆå™¨","slug":"æµè§ˆå™¨","permalink":"http://delaprada.com/tags/%E6%B5%8F%E8%A7%88%E5%99%A8/"}]},{"title":"Decoratorç”¨æ³•ä¸å®è·µ","slug":"Decoratorç”¨æ³•ä¸å®è·µ","date":"2020-12-01T06:19:07.000Z","updated":"2020-12-01T08:23:16.000Z","comments":true,"path":"2020/12/01/Decoratorç”¨æ³•ä¸å®è·µ/","link":"","permalink":"http://delaprada.com/2020/12/01/Decorator%E7%94%A8%E6%B3%95%E4%B8%8E%E5%AE%9E%E8%B7%B5/","excerpt":"","text":"ä»Šå¤©çœ‹å…³æ³¨çš„å…¬ä¼—å·å‘äº†ä¸€ç¯‡å…³äºDecoratoråœ¨ç»„ä»¶å½“ä¸­çš„åº”ç”¨ï¼Œè§‰å¾—æ¯”è¾ƒæ–°é¢–ï¼Œå› ä¸ºä¹‹å‰çœ‹è¿‡çš„æ–‡ç« éƒ½æ˜¯åœ¨ç±»å’Œç±»çš„æ–¹æ³•é‡Œåº”ç”¨çš„ã€‚æ‰€ä»¥æƒ³è¶æ­¤å¥‘æœºæ¢³ç†ä¸€ä¸‹DecoratorçŸ¥è¯†ã€‚ Decoratorç‰¹æ€§å¯èƒ½åœ¨å°†æ¥ä¼šå‘ç”Ÿæ”¹å˜ï¼Œéœ€ç­‰åˆ°å®šæ¡ˆä¹‹åå†å¯¹å…¶å†…å®¹è¿›è¡Œæ›´æ–°ã€‚ ä»€ä¹ˆæ˜¯Decoratorè£…é¥°å™¨è£…é¥°å™¨ï¼ˆDecoratorï¼‰æ˜¯ä¸€ç§ä¸ç±»ï¼ˆclassï¼‰ç›¸å…³çš„è¯­æ³•ï¼Œç”¨æ¥æ³¨é‡Šæˆ–ä¿®æ”¹ç±»å’Œç±»çš„æ–¹æ³•ã€‚å®ƒä½“ç°äº†ä¸€ç§æ§åˆ¶åè½¬çš„è®¾è®¡æ€æƒ³ï¼Œå¯ä»¥ç”¨æ¥é™ä½ä»£ç ä¹‹é—´çš„è€¦åˆåº¦ï¼Œä¹Ÿç§°ä½œä¾èµ–æ³¨å…¥ï¼ˆå¸¸è§çš„æ§åˆ¶åè½¬æ–¹æ³•ï¼‰ã€‚ è£…é¥°å™¨æ˜¯ä¸€ç§å‡½æ•°ï¼Œå†™æˆ@+å‡½æ•°åã€‚å®ƒå¯ä»¥æ”¾åœ¨ç±»å’Œç±»æ–¹æ³•å®šä¹‰çš„å‰é¢ã€‚ 123456789@frozenclass Foo &#123; @configurable(false) @enumerable(true) method() &#123;&#125; @throttle(500) expensiveMethod() &#123;&#125;&#125; ä»£ç ä¸­ä½¿ç”¨äº†å››ä¸ªè£…é¥°å™¨ï¼Œä¸€ä¸ªç”¨åœ¨ç±»æœ¬èº«ï¼Œå¦å¤–ä¸‰ä¸ªç”¨åœ¨ç±»æ–¹æ³•ã€‚è¿™æ˜¯ä¸€ç§æ–¹ä¾¿çš„æ‰‹æ®µæ¥å¢åŠ æˆ–ä¿®æ”¹ç±»çš„åŠŸèƒ½ã€‚ ç±»çš„è£…é¥°12345678@testableclass MyTestableClass &#123; // ...&#125;function testable(target) &#123; target.isTestable = true;&#125;MyTestableClass.isTestable // true @testableå°±æ˜¯ä¸€ä¸ªè£…é¥°å™¨ï¼Œå®ƒä¿®æ”¹äº†MyTestableClassè¿™ä¸ªç±»çš„çš„è¡Œä¸ºï¼Œä¸ºå®ƒæ·»åŠ äº†é™æ€å±æ€§isTestableã€‚testableå‡½æ•°çš„å‚æ•°targetå°±æ˜¯MyTestableClassç±»æœ¬èº«ã€‚ è£…é¥°å™¨å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°å°±æ˜¯æ‰€è¦ä¿®é¥°çš„ç›®æ ‡ç±»ã€‚å¦‚æœè§‰å¾—ä¸€ä¸ªå‚æ•°ä¸å¤Ÿç”¨ï¼Œå¯ä»¥åœ¨è£…é¥°å™¨å¤–é¢å†å°è£…ä¸€å±‚å‡½æ•°ï¼š 12345678910111213function testable(isTestable) &#123; return function(target) &#123; target.isTestable = isTestable; &#125;&#125;@testable(true)class MyTestableClass &#123;&#125;MyTestableClass.isTestable // true@testable(false)class MyClass &#123;&#125;MyClass.isTestable // false æ³¨æ„ï¼šè£…é¥°å™¨å¯¹ç±»çš„è¡Œä¸ºçš„æ”¹å˜ï¼Œæ˜¯ä»£ç ç¼–è¯‘æ—¶å‘ç”Ÿçš„ï¼Œè€Œä¸æ˜¯è¿è¡Œæ—¶ã€‚ å‰é¢çš„ä¾‹å­åªæ˜¯ä¸ºç±»æ·»åŠ ä¸€ä¸ªé™æ€å±æ€§ï¼Œå¦‚æœæƒ³æ·»åŠ å®ä¾‹å±æ€§ï¼Œå¯ä»¥é€šè¿‡ç›®æ ‡ç±»çš„prototypeå¯¹è±¡æ“ä½œï¼š 123456789function testable(target) &#123; target.prototype.isTestable = true;&#125;@testableclass MyTestableClass &#123;&#125;let obj = new MyTestableClass();obj.isTestable // true æ–¹æ³•çš„è£…é¥°1234567891011121314151617181920class Person &#123; @readonly name() &#123; return `$&#123;this.first&#125; $&#123;this.last&#125;` &#125;&#125;function readonly(target, name, descriptor) &#123; // descriptorå¯¹è±¡åŸæ¥çš„å€¼å¦‚ä¸‹ // &#123; // value: specifiedFunction, // enumerable: false, // configurable: true, // writable: true // &#125;; descriptor.writable = false; return descriptor;&#125;readonly(Person.prototype, 'name', descriptor);// ç±»ä¼¼äºObject.defineProperty(Person.prototype, 'name', descriptor); è£…é¥°å™¨ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ç±»çš„åŸå‹å¯¹è±¡ï¼Œä¸Šä¾‹æ˜¯Person.prototypeï¼Œè£…é¥°å™¨çš„æœ¬æ„æ˜¯è¦â€œè£…é¥°â€ç±»çš„å®ä¾‹ï¼Œä½†è¿™ä¸ªæ—¶å€™å®ä¾‹è¿˜æ²¡ç”Ÿæˆï¼Œæ‰€ä»¥åªèƒ½å»è£…é¥°åŸå‹ï¼ˆè¿™ä¸åŒäºç±»çš„è£…é¥°ï¼Œé‚£ç§æƒ…å†µtargetå‚æ•°æŒ‡çš„æ˜¯ç±»æœ¬èº«ï¼‰ ç¬¬äºŒä¸ªå‚æ•°æ˜¯æ‰€è¦è£…é¥°çš„å±æ€§å ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯è¯¥å±æ€§çš„æè¿°å¯¹è±¡ @logè£…é¥°å™¨ï¼Œå¯ä»¥èµ·åˆ°è¾“å‡ºæ—¥å¿—çš„ä½œç”¨ï¼ˆè¿™ä¸ªå¸¸å¸¸ä¼šä½¿ç”¨åˆ°ï¼‰ï¼š 12345678910111213141516171819202122class Math &#123; @log add(a, b) &#123; return a + b; &#125;&#125;function log(target, name, descriptor) &#123; var oldValue = descriptor.value; descriptor.value = function() &#123; console.log(`Calling $&#123;name&#125; with`, arguments); return oldValue.apply(this, arguments); &#125;; return descriptor;&#125;const math = new Math();// passed parameters should get logged nowmath.add(2, 4); å¦‚æœåŒä¸€ä¸ªæ–¹æ³•æœ‰å¤šä¸ªè£…é¥°å™¨ï¼Œä¼šåƒå‰¥æ´‹è‘±ä¸€æ ·ï¼Œå…ˆä»å¤–åˆ°å†…è¿›å…¥ï¼Œç„¶åç”±å†…å‘å¤–æ‰§è¡Œï¼š 1234567891011121314function dec(id)&#123; console.log('evaluated', id); return (target, property, descriptor) =&gt; console.log('executed', id);&#125;class Example &#123; @dec(1) @dec(2) method()&#123;&#125;&#125;// evaluated 1// evaluated 2// executed 2// executed 1 è£…é¥°å™¨ä¸èƒ½ç”¨äºå‡½æ•°è£…é¥°å™¨åªèƒ½ç”¨äºç±»å’Œç±»çš„æ–¹æ³•ï¼Œä¸èƒ½ç”¨äºå‡½æ•°ï¼Œå› ä¸ºå­˜åœ¨å‡½æ•°æå‡ã€‚ 123456789var counter = 0;var add = function () &#123; counter++;&#125;;@addfunction foo() &#123;&#125; ä¸Šé¢çš„ä»£ç ï¼Œæ„å›¾æ˜¯æ‰§è¡Œåcounterç­‰äº 1ï¼Œä½†æ˜¯å®é™…ä¸Šç»“æœæ˜¯counterç­‰äº 0ã€‚å› ä¸ºå‡½æ•°æå‡ï¼Œä½¿å¾—å®é™…æ‰§è¡Œçš„ä»£ç æ˜¯ä¸‹é¢è¿™æ ·ï¼š 123456789101112var counter;var add;@addfunction foo() &#123;&#125;counter = 0;add = function () &#123; counter++;&#125;; Mixinåœ¨è£…é¥°å™¨çš„åŸºç¡€ä¸Šï¼Œå¯ä»¥å®ç°Mixinæ¨¡å¼ã€‚æ‰€è°“Mixinæ¨¡å¼ï¼Œå°±æ˜¯å¯¹è±¡ç»§æ‰¿çš„ä¸€ç§æ›¿ä»£æ–¹æ¡ˆï¼Œæ„åœ¨ä¸ºä¸€ä¸ªå¯¹è±¡ä¹‹ä¸­æ··å…¥å¦å¤–ä¸€ä¸ªå¯¹è±¡çš„æ–¹æ³•ã€‚ ä¸€èˆ¬æ˜¯é€šè¿‡Object.assignæ–¹æ³•å®ç°ã€‚ æ¯”å¦‚ï¼š 12345export function mixins(...list) &#123; return function (target) &#123; Object.assign(target.prototype, ...list); &#125;;&#125; ä½¿ç”¨ä¸Šé¢è¿™ä¸ªè£…é¥°å™¨ï¼Œä¸ºç±»â€æ··å…¥â€å„ç§æ–¹æ³•ï¼š 1234567891011import &#123; mixins &#125; from './mixins';const Foo = &#123; foo() &#123; console.log('foo') &#125;&#125;;@mixins(Foo)class MyClass &#123;&#125;let obj = new MyClass();obj.foo() // \"foo\" å¦‚ä½•ä½“ç°ä¾èµ–æ³¨å…¥æˆ‘ä»¬ä»ä»£ç ä¸­å¯ä»¥å‘ç°ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦ä¸ºæŸä¸ªç±»æ·»åŠ ä¸€äº›æ–¹æ³•ï¼Œåªéœ€è¦åœ¨ç±»çš„å‰é¢æ·»åŠ ä¸€ä¸ªè£…é¥°å™¨å³å¯ã€‚åœ¨æ²¡æœ‰è£…é¥°å™¨ä¹‹å‰æˆ‘ä»¬ä¸€èˆ¬ä¼šæ€ä¹ˆåšå‘¢ï¼Ÿæˆ‘ä»¬ä¼šå®šä¹‰ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œåœ¨å…¶ä¸­å®šä¹‰ç»§æ‰¿è¿™ä¸ªæŠ½è±¡ç±»çš„æ‰€æœ‰ç±»å…±æœ‰çš„ä¸€äº›æ–¹æ³•ï¼Œè¿™æ ·çš„è¯å­ç±»å’Œå­ç±»ä¹‹é—´çš„è€¦åˆåº¦ä¼šæ¯”è¾ƒé«˜ã€‚é‚£è£…é¥°å™¨è¿™ç§æ¨¡å¼å°±å¯ä»¥é™ä½ç±»ä¸ç±»ä¹‹é—´çš„è€¦åˆåº¦ã€‚ Decoratorè£…é¥°å™¨åœ¨å‰ç«¯ç»„ä»¶ä¸­çš„åº”ç”¨Decoratorï¼ˆè£…é¥°å™¨æ¨¡å¼ï¼‰å±äºç»“æ„å‹æ¨¡å¼ï¼Œæ˜¯ä¸€ç§æ‹“å±•å¯¹è±¡é¢å¤–åŠŸèƒ½çš„è®¾è®¡æ¨¡å¼ï¼Œåˆ«åwrapperã€‚ æ„å›¾ï¼šåŠ¨æ€åœ°ç»™ä¸€ä¸ªå¯¹è±¡æ·»åŠ ä¸€äº›é¢å¤–çš„èŒè´£ã€‚å°±å¢åŠ åŠŸèƒ½æ¥è¯´ï¼ŒDecoratoræ¨¡å¼ç›¸æ¯”ç”Ÿæˆå­ç±»æ›´åŠ çµæ´»ã€‚ wrapperç»å¸¸åœ¨å‰ç«¯æ­å»ºåœºæ™¯ä¸­é‡åˆ°ï¼Œå½“æ­å»ºå¹³å°åŠ è½½ä¸€ä¸ªç»„ä»¶æ—¶ï¼Œå¸Œæœ›æ‹“å±•å…¶åŸºç¡€èƒ½åŠ›ï¼Œä¸€èˆ¬ä¼šä½¿ç”¨wrapperå±‚å¯¹ç»„ä»¶è¿›è¡ŒåµŒå¥—ï¼Œwrapperå±‚å°±æ˜¯åœ¨ä¸æ”¹å˜APIçš„æƒ…å†µä¸‹ï¼Œå¯¹ç¬¬ä¸‰æ–¹ç»„ä»¶è¿›è¡ŒåŠ å¼ºã€‚ ä¸åŒäºç»§æ‰¿ï¼Œç»„åˆå¯ä»¥åœ¨è¿è¡Œæ—¶è¿›è¡Œï¼Œæ‰€ä»¥ç§°ä¹‹ä¸ºâ€œåŠ¨æ€æ·»åŠ â€ï¼Œè¿™é‡Œçš„â€œé¢å¤–èŒè´£â€æ³›æŒ‡ä¸€åˆ‡åŠŸèƒ½ï¼Œæ¯”å¦‚åœ¨æŒ‰é’®ç‚¹å‡»æ—¶è¿›è¡Œä¸€äº›logæ—¥å¿—çš„æ‰“å°ï¼Œåœ¨ç»˜åˆ¶textæ–‡æœ¬æ¡†æ—¶ï¼Œé¢å¤–ç»˜åˆ¶ä¸€ä¸ªæ»šåŠ¨æ¡å’Œè¾¹æ¡†ç­‰ç­‰ã€‚ â€œå°±å¢åŠ åŠŸèƒ½æ¥è¯´ï¼ŒDecoratoræ¨¡å¼ç›¸æ¯”ç”Ÿæˆå­ç±»æ›´åŠ çµæ´»â€ è¿™å¥è¯çš„å«ä¹‰æ˜¯ï¼Œç»„åˆæ¯”ç»§æ‰¿æ›´çµæ´»ï¼Œå½“å¯æ‹“å±•çš„åŠŸèƒ½å¾ˆå¤šæ—¶ï¼Œç»§æ‰¿æ–¹æ¡ˆä¼šäº§ç”Ÿå¤§é‡çš„å­ç±»ï¼Œè€Œç»„åˆå¯ä»¥æå‰å†™å¥½å¤„ç†å‡½æ•°ï¼Œåœ¨éœ€è¦æ—¶åŠ¨æ€æ„é€ ï¼Œæ˜¾ç„¶æ˜¯æ›´çµæ´»çš„ã€‚ ç»“æ„å›¾ ConcreteComponentæŒ‡çš„æ˜¯éœ€è¦è¢«è£…é¥°çš„ç»„ä»¶ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œè£…é¥°å™¨Decoratorä¸ä»–éƒ½ç»§æ‰¿åŒä¸€ä¸ªç±»ï¼Œè¿™æ ·èƒ½ä¿è¯APIçš„ä¸€è‡´ï¼Œæ‰ä¿è¯æ— è®ºè£…é¥°å¤šå°‘å±‚ï¼Œå§‹ç»ˆç¬¦åˆComponentç±»å‹ã€‚ è£…é¥°å™¨å¦‚æœæœ‰å¤šç§ï¼Œå°±è¦å°†Decoratorç”³æ˜ä¸ºæŠ½è±¡ç±»ï¼ŒConcreteDecoratorAã€ConcreteDecoratorBåˆ†åˆ«å®ç°å®ƒä»¬ï¼Œå¦‚æœåªæœ‰ä¸€ç§è£…é¥°å™¨ï¼Œå¯ä»¥é€€åŒ–åˆ°Decoratorè‡ªèº«å°±æ˜¯ä¸€ç§å®ç°ã€‚ ä»£ç ä¾‹å­1234567891011121314151617181920class Component &#123; public onClick = () =&gt; &#123;&#125;&#125;class Decorator extends Component &#123; private _component constructor(component) &#123; this._component = component &#125; public onClick = () =&gt; &#123; log('æ‰“ç‚¹') this._component.onClick(); &#125;&#125;const component = new Component()// ä¸€ä¸ªæ™®é€šçš„ç‚¹å‡»component.onClick()const wrapperComponent = new Decorator(component)// ä¸€ä¸ªå…·æœ‰æ‰“ç‚¹åŠŸèƒ½çš„ç‚¹å‡»wrapperComponent.onClick() å…¶å®æ–¹æ³•å¾ˆç®€å•ï¼Œé€šè¿‡ç»„åˆï¼Œæˆ‘ä»¬å¾—åˆ°ä¸€ä¸ªèƒ½åŠ›æ›´å¼ºçš„ç»„ä»¶ï¼Œè€Œå®ç°æ–¹å¼å°±æ˜¯åˆ©ç”¨æ„é€ å‡½æ•°ä¿å­˜ç»„ä»¶å®ä¾‹ï¼Œå¹¶åœ¨å¤å†™å‡½æ•°æ—¶ï¼Œå¢åŠ ä¸€äº›å¢å¼ºå®ç°ã€‚ å¼Šç«¯è£…é¥°å™¨çš„é—®é¢˜ä¹Ÿæ˜¯ç»„åˆçš„é—®é¢˜ï¼Œè¿‡å¤šçš„ç»„åˆä¼šå¯¼è‡´ï¼š ç»„åˆè¿‡ç¨‹çš„å¤æ‚ï¼Œè¦ç”Ÿæˆè¿‡å¤šçš„å¯¹è±¡ åŒ…è£…å™¨å±‚æ¬¡å¢å¤šï¼Œä¼šå¢åŠ è°ƒè¯•æˆæœ¬ï¼Œæˆ‘ä»¬æ¯”è¾ƒéš¾è¿½æº¯åˆ°ä¸€ä¸ªbugæ˜¯åœ¨å“ªä¸€å±‚åŒ…è£…å¯¼è‡´çš„ æ€»ç»“è£…é¥°å™¨æ¨¡å¼æ˜¯éå¸¸å¸¸ç”¨çš„æ¨¡å¼ï¼ŒDecoratoræ˜¯ä¸€ä¸ªé€æ˜çš„åŒ…è£…ï¼Œåªè¦ä¿è¯åŒ…è£…çš„é€æ˜æ€§ï¼Œå°±å¯ä»¥æœ€å¤§é™åº¦å‘æŒ¥è£…é¥°å™¨æ¨¡å¼çš„ä¼˜åŠ¿ã€‚ æœ€åæ€»ç»“ä¸€ä¸ªè£…é¥°å™¨åº”ç”¨å›¾ï¼š å…³äºå…¼å®¹æ€§ç”±äºæ˜¯es7çš„æ–°ç‰¹æ€§ï¼Œéœ€è¦é…ç½®babelæ‰èƒ½æ”¯æŒè£…é¥°å™¨ã€‚ é…ç½®æ–¹æ³•ï¼š babelï¼š7.Xç‰ˆæœ¬ ä¾èµ–å®‰è£… 12npm install --save-dev @babel/plugin-proposal-decorators npm install --save-dev @babel/plugin-proposal-class-properties é…ç½®ï¼ˆä¸€èˆ¬åœ¨.babelrcæˆ–babel.config.jsä¸­è¿›è¡Œé…ç½®ï¼‰ 123456&#123; \"plugins\": [ [\"@babel/plugin-proposal-decorators\", &#123; \"legacy\": true &#125;], [\"@babel/plugin-proposal-class-properties\", &#123; \"loose\" : true &#125;] ]&#125;","categories":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://delaprada.com/categories/JavaScript/"}],"tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://delaprada.com/tags/JavaScript/"}]},{"title":"ES11æ–°å¢å±æ€§è§£æ","slug":"ES11æ–°å¢å±æ€§è§£æ","date":"2020-11-25T02:45:59.000Z","updated":"2020-11-25T03:00:02.000Z","comments":true,"path":"2020/11/25/ES11æ–°å¢å±æ€§è§£æ/","link":"","permalink":"http://delaprada.com/2020/11/25/ES11%E6%96%B0%E5%A2%9E%E5%B1%9E%E6%80%A7%E8%A7%A3%E6%9E%90/","excerpt":"","text":"ES11æ–°å¢å±æ€§è§£æES2020(ES11)å¼•å…¥äº†ä»¥ä¸‹æ–°ç‰¹æ€§ï¼ˆä¸ªäººè§‰å¾—æ¯”è¾ƒå®ç”¨çš„ä»¥ç²—ä½“å½¢å¼å±•ç¤ºï¼‰ï¼š Stringçš„matchAllæ–¹æ³• åŠ¨æ€å¯¼å…¥è¯­å¥import() import.meta export * as ns from &#39;module&#39; Promise.allSettled æ–°çš„æ•°æ®ç±»å‹BigInt GlobalThis Nullish coalescing Operator Optional Chaining matchAllmatchAll()æ–¹æ³•è¿”å›ä¸€ä¸ªåŒ…å«æ‰€æœ‰åŒ¹é…æ­£åˆ™è¡¨è¾¾å¼çš„ç»“æœçš„è¿­ä»£å™¨ã€‚ä½¿ç”¨for...oféå†æˆ–è€…ä½¿ç”¨æ“ä½œç¬¦...ã€Array.fromå°†å…¶è½¬æ¢æˆæ•°ç»„ã€‚ 12345678910const reg = /[0-3]/g;const data = '2020'; console.log(data.matchAll(reg));//data.matchAll çš„è¿”å›å€¼æ˜¯ä¸€ä¸ªè¿­ä»£å™¨console.log([...data.matchAll(reg)]);/** * 0: [\"2\", index: 0, input: \"2020\", groups: undefined] * 1: [\"0\", index: 1, input: \"2020\", groups: undefined] * 2: [\"2\", index: 2, input: \"2020\", groups: undefined] * 3: [\"0\", index: 3, input: \"2020\", groups: undefined] */ Dynamic importæ ‡å‡†ç”¨æ³•çš„importå¯¼å…¥çš„æ¨¡å—æ—¶é™æ€çš„ï¼Œä¼šä½¿æ‰€æœ‰è¢«å¯¼å…¥çš„æ¨¡å—ï¼Œåœ¨åŠ è½½æ—¶å°±è¢«ç¼–è¯‘ï¼ˆæ— æ³•åšåˆ°æŒ‰éœ€ç¼–è¯‘ï¼Œé™ä½é¦–é¡µåŠ è½½é€Ÿåº¦ï¼‰ã€‚æœ‰äº›åœºæ™¯ä¸­ï¼Œä½ å¯èƒ½å¸Œæœ›æ ¹æ®æ¡ä»¶å¯¼å…¥æ¨¡å—æˆ–è€…æŒ‰éœ€å¯¼å…¥æ¨¡å—ï¼Œè¿™æ—¶ä½ å¯ä»¥ä½¿ç”¨åŠ¨æ€å¯¼å…¥ä»£æ›¿é™æ€å¯¼å…¥ã€‚ åœ¨import()ï¼ˆä¹Ÿå°±æ˜¯åŠ¨æ€importï¼‰ä¹‹å‰ï¼Œå½“æˆ‘ä»¬éœ€è¦æ ¹æ®æ¡ä»¶å¯¼å…¥æ¨¡å—æ—¶ï¼Œä¸å¾—ä¸ä½¿ç”¨require()ã€‚ å¦‚ï¼š 123if(XXX) &#123; const menu = require('./menu');&#125; å¦‚ä»Šå¯ä»¥æ›¿æ¢ä¸ºï¼š 123if(XXX) &#123; const menu = import('./menu');&#125; @babel/preset-envå·²ç»åŒ…å«äº†@babel/plugin-syntax-dynamic-importï¼Œå› æ­¤å¦‚æœè¦ä½¿ç”¨import()è¯­æ³•ï¼Œåªéœ€è¦é…ç½®@babel/preset-envå³å¯ã€‚ æç¤ºï¼šè¯·ä¸è¦æ»¥ç”¨åŠ¨æ€å¯¼å…¥ï¼ˆåªæœ‰åœ¨å¿…è¦æƒ…å†µä¸‹é‡‡ç”¨ï¼‰ã€‚é™æ€æ¡†æ¶èƒ½æ›´å¥½åœ°åˆå§‹åŒ–ä¾èµ–ï¼Œè€Œä¸”æ›´æœ‰åˆ©äºé™æ€åˆ†æå·¥å…·å’Œtree shakingå‘æŒ¥ä½œç”¨ã€‚ å¦å¤–ï¼Œimport()è¿”å›çš„æ˜¯ä¸€ä¸ªpromiseå¯¹è±¡ã€‚ä¾‹å¦‚ï¼š 1234// menu.jsexport default &#123; menu: 'menu'&#125; 12345678//index.jsif(true) &#123; let menu = import('./menu'); console.log(menu); //Promise &#123;&lt;pending&gt; menu.then(data =&gt; console.log(data));//Module &#123;default: &#123;menu: \"menu\"&#125;, __esModule: true, Symbol(Symbol.toStringTag): \"Module\"&#125;&#125; else &#123; &#125; export * as ns from â€˜moduleâ€™12//menu.jsexport * as ns from './info'; å¯ä»¥ç†è§£ä¸ºæ˜¯å°†ä¸‹é¢ä¸¤æ¡è¯­å¥åˆå¹¶ä¸ºä¸€å¥ï¼š 12import * as ns from './info';export &#123; ns &#125;; ä¸è¿‡éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œexport * as ns from &#39;./info&#39;å¹¶ä¸ä¼šçœŸæ­£å¯¼å…¥æ¨¡å—ï¼Œå› æ­¤åœ¨è¯¥æ¨¡å—ï¼ˆmenu.jsï¼‰ä¸­ï¼Œæˆ‘ä»¬æ˜¯è·å–ä¸åˆ°nsçš„ã€‚ Promise.allSettledPromise.allæˆ–è€…Promise.raceæœ‰çš„æ—¶å€™å¹¶ä¸èƒ½æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬éœ€è¦åœ¨æ‰€æœ‰çš„promiseéƒ½ç»“æŸçš„æ—¶å€™åšä¸€äº›æ“ä½œï¼Œè€Œå¹¶ä¸åœ¨ä¹å®ƒä»¬æ˜¯æˆåŠŸè¿˜æ˜¯å¤±è´¥ã€‚åœ¨æ²¡æœ‰Promise.allSettledä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦è‡ªå·±å»å†™å®ç°ã€‚ Promise.allSettled()æ–¹æ³•è¿”å›ä¸€ä¸ªåœ¨æ‰€æœ‰ç»™å®šçš„promiseéƒ½å·²ç»fulfilledæˆ–rejectedåçš„promiseï¼Œå¹¶å¸¦æœ‰ä¸€ä¸ªå¯¹è±¡æ•°ç»„ï¼Œæ¯ä¸ªå¯¹è±¡è¡¨ç¤ºå¯¹åº”çš„promiseç»“æœã€‚ 12345678910111213const promise1 = Promise.resolve(100);const promise2 = new Promise((resolve, reject) =&gt; setTimeout(reject, 100, 'info'));const promise3 = new Promise((resolve, reject) =&gt; setTimeout(resolve, 200, 'name'))Promise.allSettled([promise1, promise2, promise3]). then((results) =&gt; console.log(result));/* [ &#123; status: 'fulfilled', value: 100 &#125;, &#123; status: 'rejected', reason: 'info' &#125;, &#123; status: 'fulfilled', value: 'name' &#125; ]*/ BigIntBigIntæ˜¯ä¸€ç§æ•°å­—ç±»å‹ï¼Œå®ƒå¯ä»¥è¡¨ç¤ºä»»æ„ç²¾åº¦æ ¼å¼çš„æ•´æ•°ã€‚åœ¨æ­¤ä¹‹å‰ï¼ŒJSä¸­å®‰å…¨çš„æœ€å¤§æ•°å­—æ˜¯2^53-1ï¼Œå¯åœ¨æ§åˆ¶å°è¾“å…¥Number.MAX_SAFE_INTEGERæŸ¥çœ‹ã€‚è¶…è¿‡è¿™ä¸ªå€¼ï¼ŒJSæ²¡æœ‰åŠæ³•ç²¾ç¡®è¡¨ç¤ºã€‚å¦å¤–ï¼Œå¤§äºæˆ–ç­‰äº2çš„1024æ¬¡æ–¹çš„æ•°å€¼ï¼ŒJSæ— æ³•è¡¨ç¤ºï¼Œä¼šè¿”å›Infinityã€‚ BigIntåˆ™è§£å†³äº†è¿™ä¸¤ä¸ªé—®é¢˜ã€‚BigIntåªç”¨æ¥è¡¨ç¤ºæ•´æ•°ï¼Œæ²¡æœ‰ä½æ•°é™åˆ¶ï¼Œä»»ä½•ä½æ•°çš„æ•´æ•°éƒ½å¯ä»¥ç²¾ç¡®è¡¨ç¤ºã€‚ä¸ºäº†å’ŒNumberç±»å‹è¿›è¡ŒåŒºåˆ†ï¼ŒBigIntç±»å‹çš„æ•°æ®å¿…é¡»æ·»åŠ åç¼€nã€‚ 1234567//Numberç±»å‹åœ¨è¶…è¿‡9009199254740991åï¼Œè®¡ç®—ç»“æœå³å‡ºç°é—®é¢˜const num1 = 90091992547409910;console.log(num1 + 1); //90091992547409900//BigInt è®¡ç®—ç»“æœæ­£ç¡®const num2 = 90091992547409910n;console.log(num2 + 1n); //90091992547409911n è¿˜å¯ä»¥ä½¿ç”¨BigIntå¯¹è±¡æ¥åˆå§‹åŒ–BigIntå®ä¾‹ï¼š 1console.log(BigInt(999)); // 999n æ³¨æ„ï¼šæ²¡æœ‰ new å…³é”®å­—ï¼ï¼ï¼ éœ€è¦è¯´æ˜çš„æ˜¯ï¼ŒBigIntå’ŒNumberæ˜¯ä¸¤ç§æ•°æ®ç±»å‹ï¼Œä¸èƒ½ç›´æ¥è¿›è¡Œå››åˆ™è¿ç®—ï¼Œä¸è¿‡å¯ä»¥è¿›è¡Œæ¯”è¾ƒæ“ä½œï¼š 123console.log(99n == 99); //trueconsole.log(99n === 99); //false console.log(99n + 1);//TypeError: Cannot mix BigInt and other types, use explicit conversionss GlobalThisJSä¸­å­˜åœ¨ä¸€ä¸ªé¡¶å±‚å¯¹è±¡ï¼Œä½†æ˜¯ï¼Œé¡¶å±‚å¯¹è±¡åœ¨å„ç§å®ç°é‡Œæ˜¯ä¸ç»Ÿä¸€çš„ã€‚ ä»ä¸åŒçš„JSç¯å¢ƒä¸­è·å–å…¨å±€å¯¹è±¡éœ€è¦ä¸åŒçš„è¯­å¥ã€‚åœ¨Webä¸­ï¼Œå¯ä»¥é€šè¿‡windowã€selfå–å¾—å…¨å±€å¯¹è±¡ï¼Œä½†æ˜¯åœ¨Web Workersä¸­ï¼Œåªæœ‰selfå¯ä»¥ã€‚åœ¨Node.jsä¸­ï¼Œå®ƒä»¬éƒ½æ— æ³•è·å–ï¼Œå¿…é¡»ä½¿ç”¨globalã€‚ åœ¨globalThisä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦è¿™æ ·å»è·å–å…¨å±€å¯¹è±¡ï¼š 123456var getGlobal = function () &#123; if (typeof self !== 'undefined') &#123; return self; &#125; if (typeof window !== 'undefined') &#123; return window; &#125; if (typeof global !== 'undefined') &#123; return global; &#125; throw new Error('unable to locate global object');&#125;; ES2020ä¸­å¼•å…¥globalThisä½œä¸ºé¡¶å±‚å¯¹è±¡ï¼Œåœ¨ä»»ä½•ç¯å¢ƒä¸­ï¼Œéƒ½å¯ä»¥ç®€å•åœ°é€šè¿‡globalThisæ‹¿åˆ°é¡¶å±‚å¯¹è±¡ã€‚ Nullish coalescing OperatorES2020æ–°å¢äº†ä¸€ä¸ªè¿ç®—ç¬¦??ã€‚å½“å·¦æ“ä½œæ•°ä¸ºnullæˆ–è€…undefinedæ—¶ï¼Œè¿”å›å…¶å³ä¾§æ“ä½œæ•°ï¼Œå¦åˆ™è¿”å›å·¦ä¾§æ“ä½œæ•°ã€‚ ä½¿ç”¨||æ“ä½œç¬¦ï¼Œå½“å·¦ä¾§çš„æ“ä½œæ•°ä¸º0ã€nullã€undefinedã€NaNã€falseã€&#39;&#39;æ—¶ï¼Œéƒ½ä¼šä½¿ç”¨å³ä¾§çš„æ“ä½œæ•°ã€‚å¦‚æœä½¿ç”¨||æ¥ä¸ºæŸäº›å˜é‡è®¾ç½®é»˜è®¤å€¼ï¼Œå¯èƒ½ä¼šé‡åˆ°æ„æ–™ä¹‹å¤–çš„è¡Œä¸ºã€‚ æ¯”å¦‚ï¼š 123const defaultValue = 100;let value = someValue || defaultValue;//å½“ someValue è½¬æˆ boolean å€¼ä¸º false æ—¶ï¼Œvalue çš„å€¼éƒ½æ˜¯ defaultValue å½“someValueçš„å€¼ä¸º0æ—¶ï¼Œæˆ‘ä»¬å…¶å®æœŸæœ›valueå€¼ä¸º0ï¼Œä½†æ˜¯å®ƒè¢«é”™è¯¯åˆ†é…æˆ100ã€‚ ??æ“ä½œç¬¦å¯ä»¥è§„é¿ä»¥ä¸Šé—®é¢˜ï¼Œå®ƒåªæœ‰åœ¨å·¦æ“ä½œæ•°ä¸ºnullæˆ–è€…æ˜¯undefinedæ—¶ï¼Œæ‰ä¼šè¿”å›å³æ“ä½œæ•°ã€‚ Optional Chainingå¯é€‰é“¾æ“ä½œç¬¦?.å…è®¸è¯»å–ä½äºè¿æ¥å¯¹è±¡é“¾æ·±å¤„çš„å±æ€§çš„å€¼ï¼Œè€Œä¸å¿…æ˜ç¡®éªŒè¯é“¾ä¸­æ¯ä¸€ä¸ªå¼•ç”¨æ˜¯å¦æœ‰æ•ˆã€‚ ä¾‹å¦‚ï¼Œæˆ‘ä»¬è¦è®¿é—®infoå¯¹è±¡çš„animalçš„reptileçš„tortoiseã€‚ä½†æ˜¯æˆ‘ä»¬ä¸ç¡®å®šanimalï¼Œreptileæ˜¯å¦å­˜åœ¨ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦è¿™æ ·å†™ï¼š 1const tortoise = info.animal &amp;&amp; info.animal.reptile &amp;&amp; info.animal.reptile.tortoise; å› ä¸ºnull.reptileæˆ–undefined.reptileä¼šæŠ›å‡ºé”™è¯¯ï¼šTypeError: Cannot read property &#39;reptile&#39; of undefined/nullã€‚å¦‚æœæˆ‘ä»¬éœ€è¦è®¿é—®çš„å±æ€§æ›´æ·±ï¼Œé‚£ä¹ˆè¿™å¥ä»£ç ä¼šè¶Šæ¥è¶Šé•¿ã€‚ è€Œæœ‰äº†å¯é€‰é“¾æ“ä½œç¬¦?.ï¼Œæˆ‘ä»¬åœ¨è®¿é—®reptileä¹‹å‰ï¼Œä¸å†éœ€è¦æ ¡éªŒinfo.animalçš„å€¼ã€‚åŒæ ·ï¼Œåœ¨è®¿é—®info.animal.reptile.tortoiseä¹‹å‰ï¼Œä¹Ÿä¸éœ€è¦æ ¡éªŒinfo.animal.reptileçš„å€¼ã€‚ ä¸Šé¢çš„ä»£ç ç®€åŒ–ä¸ºï¼š 1const tortoise = info.animal?.reptile?.tortoise; JSåœ¨å°è¯•è®¿é—®info.animal.reptileä¹‹å‰ï¼Œä¼šéšå¼æ£€æŸ¥å¹¶ç¡®å®šinfo.animalçš„å€¼ä¸æ˜¯nullæˆ–undefinedï¼Œå¦‚æœå…¶å€¼æ˜¯nullæˆ–undefinedï¼Œé‚£ä¹ˆè¡¨è¾¾å¼çŸ­è·¯è®¡ç®—ç›´æ¥è¿”å›undefinedã€‚","categories":[],"tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://delaprada.com/tags/JavaScript/"}]},{"title":"ä½¿ç”¨better-scrollåˆ›å»ºScrollç»„ä»¶","slug":"ä½¿ç”¨better-scrollåˆ›å»ºScrollç»„ä»¶","date":"2020-04-19T06:39:24.000Z","updated":"2020-12-16T02:21:00.000Z","comments":true,"path":"2020/04/19/ä½¿ç”¨better-scrollåˆ›å»ºScrollç»„ä»¶/","link":"","permalink":"http://delaprada.com/2020/04/19/%E4%BD%BF%E7%94%A8better-scroll%E5%88%9B%E5%BB%BAScroll%E7%BB%84%E4%BB%B6/","excerpt":"","text":"åœ¨å­¦ä¹ ã€ŠReact Hooksä¸Immutableæ•°æ®æµå®æˆ˜ã€‹è¿™æœ¬ä¹¦çš„æ—¶å€™ï¼Œå…¶ä¸­ä¸€ç« è®²åˆ°äº†ä½¿ç”¨better scrollæ‰“é€ ä¸€ä¸ªscrollç»„ä»¶ï¼ŒèŠ±äº†è›®é•¿æ—¶é—´å»ç†è§£é‡Œé¢ä½¿ç”¨åˆ°çš„å„ç§çš„æ–¹æ³•ï¼Œæ¯”å¦‚ï¼šbetter scrollã€forwardRefç­‰ï¼Œåœ¨æ­¤æ€»ç»“ä¸€ä¸‹ã€‚ better-scroll better-scrollçš„åŸºæœ¬åŸç†ï¼šhttps://juejin.im/post/59300b2e2f301e006bcdd91c#heading-0 better-scroll æ˜¯ä¸€ä¸ªç§»åŠ¨ç«¯æ»šåŠ¨çš„è§£å†³æ–¹æ¡ˆï¼Œå®ƒæ˜¯åŸºäº iscroll çš„é‡å†™ï¼Œå®ƒå’Œ iscroll çš„ä¸»è¦åŒºåˆ«åœ¨è¿™é‡Œã€‚better-scroll ä¹Ÿå¾ˆå¼ºå¤§ï¼Œä¸ä»…å¯ä»¥åšæ™®é€šçš„æ»šåŠ¨åˆ—è¡¨ï¼Œè¿˜å¯ä»¥åšè½®æ’­å›¾ã€picker ç­‰ç­‰ã€‚ better-scrollçš„æ»šåŠ¨åŸç†æµè§ˆå™¨çš„æ»šåŠ¨æ¡å¤§å®¶éƒ½ä¼šé‡åˆ°ï¼Œå½“é¡µé¢å†…å®¹çš„é«˜åº¦è¶…è¿‡è§†å£é«˜åº¦çš„æ—¶å€™ï¼Œä¼šå‡ºç°çºµå‘æ»šåŠ¨æ¡ï¼›å½“é¡µé¢å†…å®¹çš„å®½åº¦è¶…è¿‡è§†å£å®½åº¦çš„æ—¶å€™ï¼Œä¼šå‡ºç°æ¨ªå‘æ»šåŠ¨æ¡ã€‚ä¹Ÿå°±æ˜¯å½“æˆ‘ä»¬çš„è§†å£å±•ç¤ºä¸ä¸‹å†…å®¹çš„æ—¶å€™ï¼Œä¼šé€šè¿‡æ»šåŠ¨æ¡çš„æ–¹å¼è®©ç”¨æˆ·æ»šåŠ¨å±å¹•çœ‹åˆ°å‰©ä½™çš„å†…å®¹ã€‚ é‚£ä¹ˆå¯¹äº better-scroll ä¹Ÿæ˜¯ä¸€æ ·çš„é“ç†ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹ better-scroll å¸¸è§çš„ html ç»“æ„ï¼š 1234567&lt;div class=\"wrapper\"&gt; &lt;ul class=\"content\"&gt; &lt;li&gt;...&lt;/li&gt; &lt;li&gt;...&lt;/li&gt; ... &lt;/ul&gt;&lt;/div&gt; ä¸ºäº†æ›´åŠ ç›´è§‚ï¼Œæˆ‘ä»¬å†æ¥çœ‹ä¸€å¼ å›¾ï¼š ç»¿è‰²éƒ¨åˆ†ä¸º wrapperï¼Œä¹Ÿå°±æ˜¯çˆ¶å®¹å™¨ï¼Œå®ƒä¼šæœ‰å›ºå®šçš„é«˜åº¦ã€‚é»„è‰²éƒ¨åˆ†ä¸º contentï¼Œå®ƒæ˜¯çˆ¶å®¹å™¨çš„ç¬¬ä¸€ä¸ªå­å…ƒç´ ï¼Œå®ƒçš„é«˜åº¦ä¼šéšç€å†…å®¹çš„å¤§å°è€Œæ’‘é«˜ã€‚é‚£ä¹ˆï¼Œå½“ content çš„é«˜åº¦ä¸è¶…è¿‡çˆ¶å®¹å™¨çš„é«˜åº¦ï¼Œæ˜¯ä¸èƒ½æ»šåŠ¨çš„ï¼Œè€Œå®ƒä¸€æ—¦è¶…è¿‡äº†çˆ¶å®¹å™¨çš„é«˜åº¦ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ»šåŠ¨å†…å®¹åŒºäº†ï¼Œè¿™å°±æ˜¯ better-scroll çš„æ»šåŠ¨åŸç†ã€‚ é‚£ä¹ˆï¼Œæˆ‘ä»¬æ€ä¹ˆåˆå§‹åŒ– better-scroll å‘¢ï¼Œå¦‚æœæ˜¯ä¸Šè¿° html ç»“æ„ï¼Œé‚£ä¹ˆåˆå§‹åŒ–ä»£ç å¦‚ä¸‹ï¼š 123import BScroll from &#39;better-scroll&#39;let wrapper &#x3D; document.querySelector(&#39;.wrapper&#39;)let scroll &#x3D; new BScroll(wrapper, &#123;&#125;)å¤åˆ¶ä»£ç  better-scroll å¯¹å¤–æš´éœ²äº†ä¸€ä¸ª BScroll çš„ç±»ï¼Œæˆ‘ä»¬åˆå§‹åŒ–åªéœ€è¦ new ä¸€ä¸ªç±»çš„å®ä¾‹å³å¯ã€‚ç¬¬ä¸€ä¸ªå‚æ•°å°±æ˜¯æˆ‘ä»¬ wrapper çš„ DOM å¯¹è±¡ï¼Œç¬¬äºŒä¸ªæ˜¯ä¸€äº›é…ç½®å‚æ•°ï¼Œå…·ä½“å‚è€ƒ better-scroll çš„æ–‡æ¡£ã€‚ better-scroll çš„åˆå§‹åŒ–æ—¶æœºå¾ˆé‡è¦ï¼Œå› ä¸ºå®ƒåœ¨åˆå§‹åŒ–çš„æ—¶å€™ï¼Œä¼šè®¡ç®—çˆ¶å…ƒç´ å’Œå­å…ƒç´ çš„é«˜åº¦å’Œå®½åº¦ï¼Œæ¥å†³å®šæ˜¯å¦å¯ä»¥çºµå‘å’Œæ¨ªå‘æ»šåŠ¨ã€‚å› æ­¤ï¼Œæˆ‘ä»¬åœ¨åˆå§‹åŒ–å®ƒçš„æ—¶å€™ï¼Œå¿…é¡»ç¡®ä¿çˆ¶å…ƒç´ å’Œå­å…ƒç´ çš„å†…å®¹å·²ç»æ­£ç¡®æ¸²æŸ“äº†ã€‚å¦‚æœå­å…ƒç´ æˆ–è€…çˆ¶å…ƒç´  DOM ç»“æ„å‘ç”Ÿæ”¹å˜çš„æ—¶å€™ï¼Œå¿…é¡»é‡æ–°è°ƒç”¨ scroll.refresh() æ–¹æ³•é‡æ–°è®¡ç®—æ¥ç¡®ä¿æ»šåŠ¨æ•ˆæœçš„æ­£å¸¸ã€‚æ‰€ä»¥åŒå­¦ä»¬åé¦ˆçš„ better-scroll ä¸èƒ½æ»šåŠ¨çš„åŸå› å¤šåŠæ˜¯åˆå§‹åŒ– better-scroll çš„æ—¶æœºä¸å¯¹ï¼Œæˆ–è€…æ˜¯å½“ DOM ç»“æ„å‘é€å˜åŒ–çš„æ—¶å€™å¹¶æ²¡æœ‰é‡æ–°è®¡ç®— better-scrollã€‚ åˆ›å»ºä¸€ä¸ªscrollç»„ä»¶12&#x2F;&#x2F; å®‰è£… better-scrollnpm install better-scroll@next --save æˆ‘ä»¬ä¾ç„¶é‡‡ç”¨å‡½æ•°å¼ç»„ä»¶çš„å½¢å¼è¿›è¡Œå¼€å‘ï¼Œä¸è¿‡ä½œä¸ºä¸€ä¸ªé€šç”¨ç»„ä»¶ï¼Œscroll ç»„ä»¶åœ¨ä¸šåŠ¡ä¸­ä¼šè¢«ç»å¸¸å–åˆ°åŸç”Ÿ DOM å¯¹è±¡ï¼Œè€Œå‡½æ•°å¼ç»„ä»¶å¤©ç”Ÿä¸å…·å¤‡è¢«ä¸Šå±‚ç»„ä»¶ç›´æ¥è°ƒç”¨ ref çš„æ¡ä»¶ï¼Œå› æ­¤éœ€è¦ç”¨ React å½“ä¸­ä¸€äº›ç‰¹æ®Šçš„æ–¹å¼æ¥å¤„ç†ï¼Œå³ä½¿ç”¨ forwardRef è¿›è¡ŒåŒ…è£¹ã€‚ forwardRefå¯ä»¥å°†å­ç»„ä»¶é€šè¿‡refæš´éœ²ç»™çˆ¶ç»„ä»¶ï¼Œä½¿å¾—çˆ¶ç»„ä»¶å¯ä»¥é€šè¿‡refè·å–åˆ°å­ç»„ä»¶çš„domã€‚ 123const Scroll = forwardRef ((props, ref) =&gt; &#123; // ç¼–å†™ç»„ä»¶å†…å®¹&#125;) é¦–å…ˆæ¢³ç†ä¸€ä¸‹è¿™ä¸ªç»„ä»¶éœ€è¦æ¥å—å“ªäº›å‚æ•°: 123456789101112Scroll.propTypes = &#123; direction: PropTypes.oneOf (['vertical', 'horizental']),// æ»šåŠ¨çš„æ–¹å‘ click: true,// æ˜¯å¦æ”¯æŒç‚¹å‡» refresh: PropTypes.bool,// æ˜¯å¦åˆ·æ–° onScroll: PropTypes.func,// æ»‘åŠ¨è§¦å‘çš„å›è°ƒå‡½æ•° pullUp: PropTypes.func,// ä¸Šæ‹‰åŠ è½½é€»è¾‘ pullDown: PropTypes.func,// ä¸‹æ‹‰åŠ è½½é€»è¾‘ pullUpLoading: PropTypes.bool,// æ˜¯å¦æ˜¾ç¤ºä¸Šæ‹‰ loading åŠ¨ç”» pullDownLoading: PropTypes.bool,// æ˜¯å¦æ˜¾ç¤ºä¸‹æ‹‰ loading åŠ¨ç”» bounceTop: PropTypes.bool,// æ˜¯å¦æ”¯æŒå‘ä¸Šå¸é¡¶ bounceBottom: PropTypes.bool// æ˜¯å¦æ”¯æŒå‘ä¸‹å¸åº•&#125;; é€šè¿‡propTypeså®šä¹‰å‚æ•°çš„ç±»å‹ã€‚ ç›®å‰å½’çº³å‡ºäº†è¿™äº›å¯èƒ½çš„å‚æ•°ï¼Œä¹Ÿæ­£æ˜¯åé¢çš„å¼€å‘ä¸­æ‰€éœ€è¦çš„ï¼Œç»™ä»–ä»¬èµ‹é»˜è®¤å€¼: 123456789101112Scroll.defaultProps = &#123; direction: \"vertical\", click: true, refresh: true, onScroll:null, pullUpLoading: false, pullDownLoading: false, pullUp: null, pullDown: null, bounceTop: true, bounceBottom: true&#125;; é€šè¿‡defaultPropså®šä¹‰è¿™äº›å‚æ•°çš„é»˜è®¤å€¼ã€‚ ç°åœ¨æ¥å†™ scroll ç»„ä»¶çš„æ ¸å¿ƒé€»è¾‘ä»£ç ï¼Œé¦–å…ˆå£°æ˜å¦‚ä¸‹ hooks å˜é‡: 1234//better-scroll å®ä¾‹å¯¹è±¡const [bScroll, setBScroll] = useState ();//current æŒ‡å‘åˆå§‹åŒ– bs å®ä¾‹éœ€è¦çš„ DOM å…ƒç´  const scrollContaninerRef = useRef (); ä»å¤–é¢æ¥å— propsï¼Œè§£æ„èµ‹å€¼æ‹¿åˆ°è¿™äº›å‚æ•°: 12const &#123; direction, click, refresh, pullUpLoading, pullDownLoading, bounceTop, bounceBottom &#125; = props;const &#123; pullUp, pullDown, onScroll &#125; = props; æ¥ä¸‹æ¥åˆ›å»º better-scroll: 12345678910111213141516useEffect (() =&gt; &#123; const scroll = new BScroll (scrollContaninerRef.current, &#123; scrollX: direction === \"horizental\", scrollY: direction === \"vertical\", probeType: 3, click: click, bounce:&#123; top: bounceTop, bottom: bounceBottom &#125; &#125;); setBScroll (scroll); return () =&gt; &#123; setBScroll (null); &#125;&#125;, []); é€šè¿‡new BScrollåˆ›å»ºä¸€ä¸ªscrollå®ä¾‹ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯çˆ¶å®¹å™¨ï¼Œä¹Ÿå°±æ˜¯è¯´scrollContainerRefæ‰€æŒ‡å‘çš„DOMä½œä¸ºè¿™ä¸ªscrollç»„ä»¶çš„çˆ¶å®¹å™¨ã€‚ setBScrollæ–¹æ³•å°±æ˜¯å°†åˆ›å»ºå‡ºæ¥çš„scrollå®ä¾‹èµ‹å€¼ç»™bScrollã€‚ return()=&gt;{...}å°±æ˜¯åœ¨ç»„ä»¶é”€æ¯çš„æ—¶å€™å¯¹effectè¿›è¡Œæ¸…é™¤ æ¯æ¬¡é‡æ–°æ¸²æŸ“éƒ½è¦åˆ·æ–°å®ä¾‹ï¼Œé˜²æ­¢æ— æ³•æ»‘åŠ¨: 12345useEffect (() =&gt; &#123; if (refresh &amp;&amp; bScroll)&#123; bScroll.refresh (); &#125;&#125;); ç»™å®ä¾‹ç»‘å®š scroll äº‹ä»¶: 123456789useEffect (() =&gt; &#123; if (!bScroll || !onScroll) return; bScroll.on ('scroll', (scroll) =&gt; &#123; onScroll (scroll); &#125;) return () =&gt; &#123; bScroll.off ('scroll'); &#125;&#125;, [onScroll, bScroll]); è¿›è¡Œä¸Šæ‹‰åˆ°åº•çš„åˆ¤æ–­ï¼Œè°ƒç”¨ä¸Šæ‹‰åˆ·æ–°çš„å‡½æ•°: 123456789101112useEffect (() =&gt; &#123; if (!bScroll || !pullUp) return; bScroll.on ('scrollEnd', () =&gt; &#123; // åˆ¤æ–­æ˜¯å¦æ»‘åŠ¨åˆ°äº†åº•éƒ¨ if (bScroll.y &lt;= bScroll.maxScrollY + 100)&#123; pullUp (); &#125; &#125;); return () =&gt; &#123; bScroll.off ('scrollEnd'); &#125;&#125;, [pullUp, bScroll]); è¿›è¡Œä¸‹æ‹‰çš„åˆ¤æ–­ï¼Œè°ƒç”¨ä¸‹æ‹‰åˆ·æ–°çš„å‡½æ•°: 123456789101112useEffect (() =&gt; &#123; if (!bScroll || !pullDown) return; bScroll.on ('touchEnd', (pos) =&gt; &#123; // åˆ¤æ–­ç”¨æˆ·çš„ä¸‹æ‹‰åŠ¨ä½œ if (pos.y &gt; 50) &#123; pullDown (); &#125; &#125;); return () =&gt; &#123; bScroll.off ('touchEnd'); &#125;&#125;, [pullDown, bScroll]); ç°åœ¨å·²ç»å®Œæˆäº†æ»‘åŠ¨äº‹ä»¶ï¼Œä¸Šæ‹‰ä¸‹æ‹‰äº‹ä»¶çš„åˆ¤æ–­ï¼Œç°åœ¨éœ€è¦ç»™å¤–ç•Œæš´éœ²ç»„ä»¶æ–¹æ³•ï¼Œå‡è®¾è¿™æ ·çš„ä¸€ä¸ªæƒ…æ™¯ï¼š 1234// ä¸Šå±‚ç»„ä»¶ä»£ç const scrollRef = useRef ();...&lt;Scroll ref=&#123;scrollRef&#125;&gt;&lt;/Scroll&gt; æƒ³è¦é€šè¿‡è¿™ç§è°ƒç”¨æ–¹æ³•çš„æ–¹å¼åˆ·æ–° scroll ç»„ä»¶ï¼š 1scrollRef.current.refresh (); è¿™åº”è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ React Hooks ä¸­çš„ useImperativeHandle å·²ç»ç»™äº†æˆ‘ä»¬è§£å†³æ–¹æ¡ˆï¼Œæˆ‘ä»¬è¿™æ ·åšå°±å¥½äº†: 12345678910111213141516// ä¸€èˆ¬å’Œ forwardRef ä¸€èµ·ä½¿ç”¨ï¼Œref å·²ç»åœ¨ forWardRef ä¸­é»˜è®¤ä¼ å…¥useImperativeHandle (ref, () =&gt; (&#123; // ç»™å¤–ç•Œæš´éœ² refresh æ–¹æ³• refresh () &#123; if (bScroll) &#123; bScroll.refresh (); bScroll.scrollTo (0, 0); &#125; &#125;, // ç»™å¤–ç•Œæš´éœ² getBScroll æ–¹æ³•ï¼Œæä¾› bs å®ä¾‹ getBScroll () &#123; if (bScroll) &#123; return bScroll; &#125; &#125;&#125;)); è¿™æ ·ä¸Šå±‚ç»„ä»¶å°±å¯ä»¥é€šè¿‡refè·å–åˆ°è¿™äº›æ–¹æ³•ã€‚æ¯”å¦‚æœ‰æ—¶å€™è¦æ‰§è¡Œåˆ·æ–°ä¹‹ç±»çš„æ“ä½œçš„æ—¶å€™ï¼Œå°±éœ€è¦å»è°ƒç”¨refreshæ–¹æ³•ã€‚ å‰©ä¸‹çš„æ˜¯ UI çš„æ¸²æŸ“å·¥ä½œ: 12345return ( &lt;ScrollContainer ref=&#123;scrollContaninerRef&#125;&gt; &#123;props.children&#125; &lt;/ScrollContainer&gt;); scrollContainerRefæ‰€æŒ‡å‘çš„domå°±æ˜¯è¿™ä¸ªScrollContainerã€‚ åŒæ—¶è´´å‡ºæ ·å¼éƒ¨åˆ†çš„ js ä»£ç : 12345const ScrollContainer = styled.div` width: 100%; height: 100%; overflow: hidden;` å°†Scrollç»„ä»¶åº”ç”¨åˆ°Recommend.jsä¸­å¯¼å…¥Scrollç»„ä»¶ï¼š 1import Scroll from '../../scroll.js'; åœ¨returnä¸­åº”ç”¨ï¼š 12345678&lt;Content&gt; &lt;Scroll className=\"list\"&gt; &lt;div&gt; &lt;Slider bannerList=&#123;bannerList&#125;&gt;&lt;/Slider&gt; &lt;RecommendList recommendList=&#123;recommendList&#125;&gt;&lt;/RecommendList&gt; &lt;/div&gt; &lt;/Scroll&gt;&lt;/Content&gt; è¿™é‡Œä½œè€…ç”¨äº†ä¸ªContentï¼Œæ¥å»ä¿è¯çˆ¶ç»„ä»¶é«˜åº¦å›ºå®šï¼Œè¿™é‡Œæ˜¯æˆ‘ç–‘æƒ‘çš„ä¸€ä¸ªç‚¹ï¼ŒæŒ‰ç…§better-scrollçš„å®˜æ–¹æ–‡æ¡£çš„å†…å®¹ï¼Œæˆ‘ä»¬æ‰§è¡Œ 123456789new BScroll (scrollContaninerRef.current, &#123; scrollX: direction === \"horizental\", scrollY: direction === \"vertical\", probeType: 3, click: click, bounce:&#123; top: bounceTop, bottom: bounceBottom &#125;) æ“ä½œçš„æ—¶å€™ï¼Œå·²ç»å°†scrollContainerRef.currentä½œä¸ºçˆ¶å®¹å™¨äº†ã€‚ åæ¥æˆ‘ä»”ç»†æƒ³äº†ä¸€ä¸‹å‘è§‰è¿™ä¹ˆåšæ˜¯æœ‰é“ç†çš„ã€‚ ä½†æˆ‘ä»¬å¯ä»¥çœ‹åˆ°scrollContainerRefçš„æ ·å¼ï¼š 12345const ScrollContainer = styled.div` width: 100%; height: 100%; overflow: hidden;` scrollContainerçš„é«˜åº¦æ˜¯æ ¹æ®çˆ¶å…ƒç´ é«˜åº¦æ¥å›ºå®šçš„ã€‚è¿™ä¹ˆåšçš„ä¸€ä¸ªå¥½å¤„å°±æ˜¯scrollContainerèƒ½å¤Ÿåœ¨å¤šä¸ªåœ°æ–¹å¤ç”¨ï¼Œæ ¹æ®ä¸åŒçš„çˆ¶å…ƒç´ é«˜åº¦æ¥è°ƒèŠ‚è‡ªèº«çš„é«˜åº¦ï¼Œå› ä¸ºbetter-scrollå¾ˆé‡è¦çš„ä¸€ç‚¹å°±æ˜¯wrapperçš„é«˜åº¦è¦å›ºå®šï¼ˆå³scrollContainerRef.currentçš„é«˜åº¦è¦å›ºå®šï¼‰ã€‚å¦‚æœä¸€å¼€å§‹ä¾¿è®¾ç½®ScrollContainerçš„é«˜åº¦æ˜¯å›ºå®šçš„ï¼Œæ¯”å¦‚30pxï¼Œé‚£ä¹ˆå®ƒå°±ä¸èƒ½å¤Ÿåœ¨å¤šä¸ªåœ°æ–¹å¤ç”¨äº†ï¼Œå› ä¸ºä¸åŒåœ°æ–¹scrollçš„é«˜åº¦æ˜¯ä¸ä¸€æ ·çš„ã€‚","categories":[{"name":"React","slug":"React","permalink":"http://delaprada.com/categories/React/"}],"tags":[{"name":"React","slug":"React","permalink":"http://delaprada.com/tags/React/"}]},{"title":"React+Redux é€šè¿‡axioså‘æ¥å£è·å–æ•°æ®çš„æµç¨‹","slug":"React-Redux-é€šè¿‡axioså‘æ¥å£è·å–æ•°æ®çš„æµç¨‹","date":"2020-04-17T11:45:34.000Z","updated":"2020-04-17T12:34:40.000Z","comments":true,"path":"2020/04/17/React-Redux-é€šè¿‡axioså‘æ¥å£è·å–æ•°æ®çš„æµç¨‹/","link":"","permalink":"http://delaprada.com/2020/04/17/React-Redux-%E9%80%9A%E8%BF%87axios%E5%90%91%E6%8E%A5%E5%8F%A3%E8%8E%B7%E5%8F%96%E6%95%B0%E6%8D%AE%E7%9A%84%E6%B5%81%E7%A8%8B/","excerpt":"","text":"æœ€è¿‘åœ¨å­¦ä¹ ã€ŠReact Hooksä¸Immutableæ•°æ®æµå®æˆ˜ã€‹å°ä¹¦ï¼Œæƒ³æŠŠåœ¨React+Reduxé¡¹ç›®ä¸­ç”¨axioså‘èµ·è¯·æ±‚çš„é…ç½®æµç¨‹è®°å½•ä¸‹æ¥ï¼Œåšä¸ªæ€»ç»“ï¼ŒåŠ æ·±ä¸€äº›å°è±¡ã€‚ å¯åŠ¨æœåŠ¡å™¨é¦–å…ˆæ˜¯å°†githubä¸Šç½‘æ˜“äº‘éŸ³ä¹æ¥å£çš„node.jsé¡¹ç›®å¯åŠ¨ï¼Œåœ¨é¡¹ç›®ä¸­éƒ½æ˜¯å‘è¿™ä¸ªæœåŠ¡å™¨å»å‘èµ·è¯·æ±‚ï¼Œè·å–æ¥å£æ•°æ®ã€‚ 12&#x2F;&#x2F;å¯åŠ¨æœåŠ¡å™¨æŒ‡ä»¤node app.js å®‰è£…axios1npm install axios --save ç°åœ¨åœ¨ src/api ç›®å½•ä¸‹æ–°å»º config.js æ–‡ä»¶ï¼Œé‡Œé¢ç¼–å†™ axios çš„é…ç½®: 12345678910111213141516171819import axios from 'axios';export const baseUrl = 'http://xxxè‡ªå·±å¡«';//axios çš„å®ä¾‹åŠæ‹¦æˆªå™¨é…ç½®const axiosInstance = axios.create (&#123; baseURL: baseUrl&#125;);axiosInstance.interceptors.response.use ( res =&gt; res.data, err =&gt; &#123; console.log (err, \"ç½‘ç»œé”™è¯¯\"); &#125;);export &#123; axiosInstance&#125;; baseUrlçš„è¯å°±æ˜¯æœåŠ¡å™¨çš„åŸºåœ°å€ï¼Œæ¯”å¦‚http://localhost:3000ï¼Œé‚£è¯·æ±‚çš„ä¸€äº›æ¥å£æ•°æ®å°±ä¼šåœ¨è¿™ä¸ªbaseUrlçš„ä¸åŒè·¯ç”±ä¸‹ï¼Œæ¯”å¦‚banneræ•°æ®ä¼šé€šè¿‡http://localhost:3000/banneræ¥å£è·å–ã€‚ axios.createï¼šåˆ›å»ºä¸€ä¸ªaxioså®ä¾‹ï¼Œå¯ä»¥æ·»åŠ ä¸€äº›åŸºæœ¬é…ç½®ã€‚ å®˜ç½‘è§£é‡Šï¼š axios.create([config])12345const instance &#x3D; axios.create(&#123; baseURL: &#39;https:&#x2F;&#x2F;some-domain.com&#x2F;api&#x2F;&#39;, timeout: 1000, headers: &#123;&#39;X-Custom-Header&#39;: &#39;foobar&#39;&#125;&#125;); axiosInstance.interceptors.response.use ç”¨äºå°†å…¬å…±çš„ä¸šåŠ¡é€»è¾‘æŠ½ç¦»å‡ºæ¥ã€‚ ç„¶ååœ¨åŒä¸€ä¸ªç›®å½•ä¸‹æ–°å»º request.js ç”¨æ¥å°è£…ä¸åŒçš„ç½‘ç»œè¯·æ±‚ï¼Œå†…å®¹å¦‚ä¸‹: 123456789import &#123; axiosInstance &#125; from \"./config\";export const getBannerRequest = () =&gt; &#123; return axiosInstance.get ('/banner');&#125;export const getRecommendListRequest = () =&gt; &#123; return axiosInstance.get ('/personalized');&#125; åœ¨request.jsä¸­å°è£…ä¸€äº›å‘æœåŠ¡å™¨å‘èµ·è¯·æ±‚çš„æ–¹æ³•ï¼Œæ³¨æ„è¿”å›çš„æ˜¯promiseå¯¹è±¡ã€‚ reduxå±‚å¼€å‘åœ¨ Recommend ç›®å½•ä¸‹ï¼Œæ–°å»º store æ–‡ä»¶å¤¹ï¼Œç„¶åæ–°å»ºä»¥ä¸‹æ–‡ä»¶ï¼š 1234actionCreators.js&#x2F;&#x2F; æ‰§è¡Œä¸€äº›request.jsä¸­å°è£…å¥½çš„æ–¹æ³•ï¼Œè·å–åˆ°æ¥å£æ•°æ®ï¼Œå¹¶é€šè¿‡dispatchæ›´æ–°storeçš„å†…å®¹constants.js &#x2F;&#x2F; å¸¸é‡é›†åˆï¼Œå­˜æ”¾ä¸åŒ action çš„ type å€¼index.js &#x2F;&#x2F; ç”¨æ¥å¯¼å‡º reducerï¼Œactionreducer.js &#x2F;&#x2F; å­˜æ”¾ initialState å’Œ reducer å‡½æ•° constants.js1234//å®šä¹‰actionç±»å‹export const CHANGE_BANNER='recommend/CHANGE_BANNER';export const CHANGE_RECOMMEND_LIST='recommend/RECOMMEND_LIST'; reducer.jså®šä¹‰reducerå‡½æ•°ï¼Œå¹¶åˆå§‹åŒ–state: 123456789101112131415161718192021import * as actionTypes from './constants';import &#123;fromJS&#125; from 'immutable'; // è¿™é‡Œç”¨åˆ° fromJS æŠŠ JS æ•°æ®ç»“æ„è½¬åŒ–æˆ immutable æ•°æ®ç»“æ„import &#123;combineReducer&#125; from 'redux-immutable';const defaultState=fromJS(&#123; bannerList: [], recommendList: []&#125;)//å®šä¹‰reducerå‡½æ•°export default (state=defaultState, action)=&gt;&#123; switch(action.type)&#123; case actionTypes.CHANGE_BANNER: return state.set('bannerList', action.data); case actionTypes.CHANGE_RECOMMEND_LIST: return state.set('recommendList', action.data); default: return state; &#125;&#125; actionCreators.jsæ‰§è¡Œrequest.jsä¸­çš„æ–¹æ³•ï¼Œé€šè¿‡axiosä»æ¥å£è·å–æ•°æ®ï¼Œç„¶åé€šè¿‡dispatchæ–¹æ³•ï¼Œä½¿ç”¨è·å–åˆ°çš„æ–°æ•°æ®å»æ›´æ–°stateã€‚ 12345678910111213141516171819202122232425262728293031323334import * as actionTypes from './constants';import &#123;fromJS&#125; from 'immutable';import &#123;getBannerRequest, getRecommendListRequest&#125; from '../../../api/request'export const changeBannerList=(data)=&gt;(&#123; type: actionTypes.CHANGE_BANNER, data: fromJS(data)&#125;);export const changeRecommendList=(data)=&gt;(&#123; type: actionTypes.CHANGE_RECOMMEND_LIST, data: fromJS(data)&#125;)export const getBannerList=()=&gt;&#123; return (dispatch)=&gt;&#123; getBannerRequest().then(data=&gt;&#123; //è¿”å›çš„æ•°æ®æ ¼å¼ä¸ºï¼š&#123;banners: Array(8), code:200&#125; dispatch(changeBannerList(data.banners)); &#125;).catch(()=&gt;&#123; console.log(\"è½®æ’­å›¾æ•°æ®ä¼ è¾“é”™è¯¯\"); &#125;) &#125;&#125;export const getRecommendList=()=&gt;&#123; return (dispatch)=&gt;&#123; getRecommendListRequest().then(data=&gt;&#123; dispatch(changeRecommendList(data.result)); &#125;).catch(()=&gt;&#123; console.log(\"æ¨èæ­Œå•æ•°æ®ä¼ è¾“é”™è¯¯\"); &#125;) &#125;&#125; index.jsç”¨äºå°†ç›¸å…³å˜é‡å¯¼å‡ºï¼š 12345//index.jsimport reducer from './reducer'import * as actionCreators from './actionCreators'export &#123; reducer, actionCreators &#125;; ç»„ä»¶è¿æ¥Reduxé¦–å…ˆï¼Œéœ€è¦å°† recommend ä¸‹çš„ reducer æ³¨å†Œåˆ°å…¨å±€ storeï¼Œåœ¨ store/reducer.js ä¸­ï¼Œå†…å®¹å¦‚ä¸‹: 123456import &#123; combineReducers &#125; from 'redux-immutable';import &#123; reducer as recommendReducer &#125; from '../application/Recommend/store/index';export default combineReducers (&#123; recommend: recommendReducer,&#125;); æ³¨å†Œå®Œæˆï¼ ç°åœ¨åœ¨ Recommend/index.js ä¸­ï¼Œå‡†å¤‡è¿æ¥ Reduxã€‚ç»„ä»¶ä»£ç æ›´æ–°å¦‚ä¸‹: 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455import React, &#123; useEffect &#125; from 'react';import Slider from '../../components/slider/';import &#123; connect &#125; from \"react-redux\";import * as actionTypes from './store/actionCreators';import RecommendList from '../../components/list/';import Scroll from '../../baseUI/scroll/index';import &#123; Content &#125; from './style';function Recommend (props)&#123; const &#123; bannerList, recommendList &#125; = props; const &#123; getBannerDataDispatch, getRecommendListDataDispatch &#125; = props; useEffect (() =&gt; &#123; getBannerDataDispatch (); getRecommendListDataDispatch (); //eslint-disable-next-line &#125;, []); const bannerListJS = bannerList ? bannerList.toJS () : []; const recommendListJS = recommendList ? recommendList.toJS () :[]; return ( &lt;Content&gt; &lt;Scroll&gt; &lt;div&gt; &lt;Slider bannerList=&#123;bannerListJS&#125;&gt;&lt;/Slider&gt; &lt;RecommendList recommendList=&#123;recommendListJS&#125;&gt;&lt;/RecommendList&gt; &lt;/div&gt; &lt;/Scroll&gt; &lt;/Content&gt; );&#125;// æ˜ å°„ Redux å…¨å±€çš„ state åˆ°ç»„ä»¶çš„ props ä¸Šconst mapStateToProps = (state) =&gt; (&#123; // ä¸è¦åœ¨è¿™é‡Œå°†æ•°æ® toJS // ä¸ç„¶æ¯æ¬¡ diff æ¯”å¯¹ props çš„æ—¶å€™éƒ½æ˜¯ä¸ä¸€æ ·çš„å¼•ç”¨ï¼Œè¿˜æ˜¯å¯¼è‡´ä¸å¿…è¦çš„é‡æ¸²æŸ“ï¼Œå±äºæ»¥ç”¨ immutable bannerList: state.getIn (['recommend', 'bannerList']), recommendList: state.getIn (['recommend', 'recommendList']),&#125;);// æ˜ å°„ dispatch åˆ° props ä¸Šconst mapDispatchToProps = (dispatch) =&gt; &#123; return &#123; getBannerDataDispatch () &#123; dispatch (actionTypes.getBannerList ()); &#125;, getRecommendListDataDispatch () &#123; dispatch (actionTypes.getRecommendList ()); &#125;, &#125;&#125;;// å°† ui ç»„ä»¶åŒ…è£…æˆå®¹å™¨ç»„ä»¶export default connect (mapStateToProps, mapDispatchToProps)(React.memo (Recommend)); é€šè¿‡connecté«˜é˜¶å‡½æ•°ï¼Œå°†mapStateToPropsã€mapDispatchToPropsçš„å±æ€§å’Œæ–¹æ³•æ•´åˆèµ·æ¥ï¼Œä¼ å…¥å†…åµŒç»„ä»¶ï¼ˆRecommendï¼‰ï¼Œå†…åµŒç»„ä»¶å°±å¯ä»¥é€šè¿‡propsè·å–åˆ°æ•°æ®ã€‚ mapStateToPropsï¼šè·å–storeä¸­çš„stateï¼Œå¯¹æ•°æ®è¿›è¡Œåˆå§‹åŒ–æ“ä½œ mapDispatchToPropsï¼šå£°æ˜ä¸€äº›æ•°æ®æ›´æ–°ã€æ•°æ®è·å–æ“ä½œ åœ¨useEffecté˜¶æ®µæ‰§è¡ŒgetBannerDataDispatch (); getRecommendListDataDispatch ();æ“ä½œã€‚useEffectæ˜¯Hookçš„APIï¼Œç”¨äºå®Œæˆå‰¯ä½œç”¨æ“ä½œã€‚å®ƒç›¸å½“äºclassä¸­çš„ä¸€äº›å£°æ˜å‘¨æœŸï¼Œåœ¨ç‰¹å®šæ—¶æœŸæ‰§è¡Œå“åº”çš„æ“ä½œã€‚æ­¤å¤„useEffectçš„ç¬¬äºŒä¸ªå‚æ•°ä¸º[]ï¼Œè¡¨ç¤ºåªåœ¨ç¬¬ä¸€æ¬¡æ‰§è¡Œï¼Œç”¨æ¥è¯·æ±‚å¼‚æ­¥æ•°æ®ï¼›å¦‚æœç¬¬äºŒä¸ªå‚æ•°ä¸ä¸ºç©ºæ•°ç»„ï¼Œæ¯”å¦‚æ•°ç»„å†…æœ‰ä¸€äº›å±æ€§çš„è¯ï¼Œåˆ™åœ¨è¿™äº›å±æ€§å‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼ŒuseEffectæ‰ä¼šæ‰§è¡Œã€‚ Hookçš„APIä»‹ç»è¯¦æƒ…ï¼š Reactå®˜æ–¹æ–‡æ¡£ https://juejin.im/post/5e53d9116fb9a07c9070da44 å¯åŠ¨1npm start çœ‹åˆ°ç»“æœï¼š è¦æ³¨æ„çš„ç‚¹ï¼š 12345678910export const getBannerList=()=&gt;&#123; return (dispatch)=&gt;&#123; getBannerRequest().then(data=&gt;&#123; //è¿”å›çš„æ•°æ®æ ¼å¼ä¸ºï¼š&#123;banners: Array(8), code:200&#125; dispatch(changeBannerList(data.banners)); &#125;).catch(()=&gt;&#123; console.log(\"è½®æ’­å›¾æ•°æ®ä¼ è¾“é”™è¯¯\"); &#125;) &#125;&#125; è¦æ³¨æ„çœ‹æ¥å£è¿”å›çš„æ•°æ®ï¼Œæ¯”å¦‚getBannerRequest()è·å–åˆ°çš„æ•°æ®æ˜¯å¯¹è±¡ï¼Œé‚£æˆ‘ä»¬è¦ä½¿ç”¨data.bannersæ‰èƒ½è·å–åˆ°bannerçš„å†…å®¹ï¼Œç›´æ¥dataæ˜¯ä¼šå‡ºé”™çš„ã€‚","categories":[{"name":"React","slug":"React","permalink":"http://delaprada.com/categories/React/"}],"tags":[{"name":"React","slug":"React","permalink":"http://delaprada.com/tags/React/"}]},{"title":"Node.jsâ€”â€”Expresså’Œkoaæ¡†æ¶å¯¹æ¯”","slug":"Node-jsâ€”â€”Expresså’Œkoaæ¡†æ¶å¯¹æ¯”","date":"2020-04-07T03:10:47.000Z","updated":"2020-04-07T06:08:20.000Z","comments":true,"path":"2020/04/07/Node-jsâ€”â€”Expresså’Œkoaæ¡†æ¶å¯¹æ¯”/","link":"","permalink":"http://delaprada.com/2020/04/07/Node-js%E2%80%94%E2%80%94Express%E5%92%8Ckoa%E6%A1%86%E6%9E%B6%E5%AF%B9%E6%AF%94/","excerpt":"","text":"æ­¤æ–‡å‚è€ƒï¼šé˜¿é‡ŒæŠ€æœ¯åä¼šã€ŠNode.jsæ¡†æ¶ä¹‹expressä¸koaå¯¹æ¯”åˆ†æã€‹ https://yq.aliyun.com/articles/3062","categories":[{"name":"Node.js","slug":"Node-js","permalink":"http://delaprada.com/categories/Node-js/"}],"tags":[{"name":"Node.js","slug":"Node-js","permalink":"http://delaprada.com/tags/Node-js/"}]},{"title":"Nodeâ€”â€”äº‹ä»¶å¾ªç¯","slug":"Nodeâ€”â€”äº‹ä»¶å¾ªç¯","date":"2020-04-07T00:51:23.000Z","updated":"2020-04-07T02:23:08.000Z","comments":true,"path":"2020/04/07/Nodeâ€”â€”äº‹ä»¶å¾ªç¯/","link":"","permalink":"http://delaprada.com/2020/04/07/Node%E2%80%94%E2%80%94%E4%BA%8B%E4%BB%B6%E5%BE%AA%E7%8E%AF/","excerpt":"","text":"å¼‚æ­¥IOå¼‚æ­¥IOæ˜¯æŒ‡æ“ä½œç³»ç»Ÿæä¾›çš„IOï¼ˆæ•°æ®è¿›å‡ºï¼‰èƒ½åŠ›ï¼Œæ¯”å¦‚é”®ç›˜è¾“å…¥ï¼Œå¯¹åº”åˆ°æ˜¾ç¤ºå™¨ä¸Šä¼šæœ‰ä¸“é—¨çš„æ•°æ®è¾“å‡ºæ¥å£ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬ç”Ÿæ´»ä¸­å¯è§çš„IOèƒ½åŠ›ï¼›è¿™ä¸ªæ¥å£åœ¨å‘ä¸‹ä¼šè¿›å…¥åˆ°æ“ä½œç³»ç»Ÿè¿™ä¸ªå±‚é¢ï¼Œåœ¨æ“ä½œç³»ç»Ÿä¸­ï¼Œä¼šæä¾›è¯¸å¤šçš„èƒ½åŠ›ï¼Œæ¯”å¦‚ï¼šç£ç›˜çš„è¯»å†™ï¼ŒDNSçš„æŸ¥è¯¢ï¼Œæ•°æ®åº“çš„è¿æ¥å•Šï¼Œç½‘ç»œè¯·æ±‚çš„å¤„ç†ï¼Œç­‰ç­‰ã€‚ åœ¨ä¸åŒçš„æ“ä½œç³»ç»Ÿå±‚é¢ï¼Œè¡¨ç°çš„ä¸ä¸€è‡´ã€‚æœ‰çš„æ˜¯å¼‚æ­¥éé˜»å¡çš„ï¼›æœ‰çš„æ˜¯åŒæ­¥çš„é˜»å¡çš„ï¼Œæ— è®ºå¦‚ä½•ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥çœ‹åšæ˜¯ä¸Šå±‚åº”ç”¨äºä¸‹å±‚ç³»ç»Ÿä¹‹é—´çš„æ•°æ®äº¤äº’ï¼›ä¸Šå±‚ä¾èµ–äºä¸‹å±‚ï¼Œä½†æ˜¯åè¿‡æ¥ï¼Œä¸Šå±‚ä¹Ÿå¯ä»¥å¯¹ä¸‹å±‚æä¾›çš„è¿™äº›èƒ½åŠ›è¿›è¡Œæ”¹é€ ã€‚å¦‚æœè¿™ç§æ“ä½œæ˜¯å¼‚æ­¥çš„ï¼Œéé˜»å¡çš„ï¼Œé‚£ä¹ˆè¿™ç§å°±æ˜¯å¼‚æ­¥éé˜»å¡çš„å¼‚æ­¥IOæ¨¡å‹ï¼›å¦‚æœæ˜¯åŒæ­¥çš„é˜»å¡çš„ï¼Œé‚£ä¹ˆå°±æ˜¯åŒæ­¥IOæ¨¡å‹ã€‚ koaå°±æ˜¯ä¸€ä¸ªä¸Šå±‚çš„webæœåŠ¡æ¡†æ¶ï¼Œå…¨éƒ¨ç”±JavaScriptå®ç°ï¼Œä»–æœ‰æ“ä½œç³»ç»Ÿä¹‹é—´çš„äº¤äº’ï¼Œå…¨éƒ¨é€šè¿‡nodejsæ¥å®ç°ï¼›å¦‚nodejsçš„ readFileå°±æ˜¯ä¸€ä¸ªå¼‚æ­¥éé˜»å¡çš„æ¥å£ï¼ŒreadFileSyncå°±æ˜¯ä¸€ä¸ªåŒæ­¥é˜»å¡æ¥å£ã€‚ äº‹ä»¶å¾ªç¯äº‹ä»¶å¾ªç¯æ˜¯æŒ‡Node.jsæ‰§è¡Œéé˜»å¡I/Oæ“ä½œï¼Œå°½ç®¡JavaScriptæ˜¯å•çº¿ç¨‹çš„,ä½†ç”±äºå¤§å¤šæ•°å†…æ ¸éƒ½æ˜¯å¤šçº¿ç¨‹çš„ï¼Œnode.jsä¼šå°½å¯èƒ½å°†æ“ä½œè£…è½½åˆ°ç³»ç»Ÿå†…æ ¸ã€‚å› æ­¤å®ƒä»¬å¯ä»¥å¤„ç†åœ¨åå°æ‰§è¡Œçš„å¤šä¸ªæ“ä½œã€‚å½“å…¶ä¸­ä¸€ä¸ªæ“ä½œå®Œæˆæ—¶ï¼Œå†…æ ¸ä¼šå‘Šè¯‰Node.jsï¼Œä»¥ä¾¿node.jså¯ä»¥å°†ç›¸åº”çš„å›è°ƒæ·»åŠ åˆ°è½®è¯¢é˜Ÿåˆ—ä¸­ä»¥æœ€ç»ˆæ‰§è¡Œã€‚ Node.jsæ˜¯å•çº¿ç¨‹æ‰§è¡Œçš„ï¼ŒåŒæ—¶å®ƒåˆæ˜¯åŸºäºäº‹ä»¶é©±åŠ¨å’Œéé˜»å¡IOç¼–ç¨‹æ¨¡å‹ã€‚è¿™å°±ä½¿å¾—æˆ‘ä»¬ä¸ç”¨ç­‰å¾…å¼‚æ­¥æ“ä½œç»“æœè¿”å›ï¼Œå°±å¯ä»¥ç»§ç»­å¾€ä¸‹æ‰§è¡Œä»£ç ã€‚å½“å¼‚æ­¥äº‹ä»¶è§¦å‘ä¹‹åï¼Œå°±ä¼šé€šçŸ¥ä¸»çº¿ç¨‹ï¼Œä¸»çº¿ç¨‹æ‰§è¡Œç›¸åº”äº‹ä»¶çš„å›è°ƒã€‚ Node.jsæ¶æ„åˆ†æè¯´é“ Nodejs æ¶æ„, é¦–å…ˆè¦çŸ¥é“Nodejs ä¸ V8 å’Œ libUV çš„å…³ç³»å’Œä½œç”¨: V8: æ‰§è¡Œ JS çš„å¼•æ“. ä¹Ÿå°±æ˜¯ç¿»è¯‘ JS. åŒ…æ‹¬æˆ‘ä»¬ç†Ÿæ‚‰çš„ç¼–è¯‘ä¼˜åŒ–, åƒåœ¾å›æ”¶ç­‰ç­‰. libUV: æä¾› async I/O, æä¾›æ¶ˆæ¯å¾ªç¯. å¯è§, æ˜¯æ“ä½œç³»ç»Ÿ API å±‚çš„ä¸€ä¸ªæŠ½è±¡å±‚. JavaScriptå¼•æ“æ˜¯ä¸€ç§ä¸“é—¨å¤„ç†JavaScriptè„šæœ¬çš„è™šæ‹Ÿæœºï¼Œä¸€èˆ¬ä¼šé™„å¸¦åœ¨ç½‘é¡µæµè§ˆå™¨ä¸­ã€‚ V8ï¼šæ˜¯Googleå¼€å‘çš„JavaScriptå¼•æ“ï¼Œç”¨äºGoogle Chromeå’ŒChromiumã€‚V8èƒ½å¤Ÿå³æ—¶ç¼–è¯‘JavaScriptï¼Œä½¿å¾—JavaScriptä»£ç èƒ½å¤Ÿé«˜æ•ˆè¿è¡Œã€‚ ä»¥å¾€æˆ‘ä»¬åœ¨æ‰§è¡Œc++çš„æ—¶å€™ï¼Œä¼šå…ˆè¿›è¡Œç¼–è¯‘å·¥ä½œï¼Œå˜ä¸ºå¯æ‰§è¡Œæ–‡ä»¶åï¼Œå†æ‰§è¡Œè¿™ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ã€‚è¿™ä¸ªç¼–è¯‘å·¥ä½œæ˜¯ç”±ç¼–è¯‘å™¨å®Œæˆçš„ã€‚ è§£é‡Šå™¨å°±æä¾›äº†ä¸€ç§è¾¹ç¼–è¯‘è¾¹è¿è¡Œçš„åŠ¨æ€è¿è¡Œæ–¹æ³•ï¼Œè€Œä¹Ÿæ­£å› ä¸ºé€šè¿‡è§£é‡Šå™¨è¿è¡Œçš„ä»£ç æ˜¯è¾¹ç¼–è¯‘è¾¹è¿è¡Œçš„ï¼Œæ‰€ä»¥è¿è¡Œçš„é€Ÿåº¦æ¯”é™æ€ç¼–è¯‘çš„é‚£ç§æ…¢å¾ˆå¤šã€‚ æ‰€ä»¥ç¨‹åºè¿è¡Œçš„æ–¹å¼åˆ†ä¸ºé™æ€ç¼–è¯‘å’ŒåŠ¨æ€ç¼–è¯‘ã€‚ å›åˆ°Node.jsæ¶æ„ï¼ŒNode.jså¦‚ä½•ç»„ç»‡å®ƒä»¬å‘¢ï¼Ÿ Node.jsé€šè¿‡ä¸€å±‚C++ Bindingï¼ŒæŠŠJavaScriptä¼ ç»™V8ï¼ŒV8è§£æåäº¤ç»™libUVå‘èµ·å¼‚æ­¥IOï¼Œå¹¶ç­‰å¾…æ¶ˆæ¯å¾ªç¯è°ƒåº¦ã€‚æ‰€ä»¥ï¼ŒNode.jså®ç°å¼‚æ­¥æœºåˆ¶çš„æ ¸å¿ƒä¾¿æ˜¯libUVã€‚ Node.jså¯åŠ¨è¿‡ç¨‹å¯ä»¥åˆ†ä¸ºä»¥ä¸‹æ­¥éª¤ï¼š 1ã€è°ƒç”¨platformInitæ–¹æ³• ï¼Œåˆå§‹åŒ– nodejs çš„è¿è¡Œç¯å¢ƒã€‚ 2ã€è°ƒç”¨ performance_node_start æ–¹æ³•ï¼Œå¯¹ nodejs è¿›è¡Œæ€§èƒ½ç»Ÿè®¡ã€‚ 3ã€opensslè®¾ç½®çš„åˆ¤æ–­ã€‚ 4ã€è°ƒç”¨v8_platform.Initializeï¼Œåˆå§‹åŒ– libuv çº¿ç¨‹æ± ã€‚ 5ã€è°ƒç”¨ V8::Initializeï¼Œåˆå§‹åŒ– V8 ç¯å¢ƒã€‚ 6ã€åˆ›å»ºä¸€ä¸ªnodejsè¿è¡Œå®ä¾‹ã€‚ 7ã€å¯åŠ¨ä¸Šä¸€æ­¥åˆ›å»ºå¥½çš„å®ä¾‹ã€‚ 8ã€å¼€å§‹æ‰§è¡Œjsæ–‡ä»¶ï¼ŒåŒæ­¥ä»£ç æ‰§è¡Œå®Œæ¯•åï¼Œè¿›å…¥äº‹ä»¶å¾ªç¯ã€‚ 9ã€åœ¨æ²¡æœ‰ä»»ä½•å¯ç›‘å¬çš„äº‹ä»¶æ—¶ï¼Œé”€æ¯ nodejs å®ä¾‹ï¼Œç¨‹åºæ‰§è¡Œå®Œæ¯•ã€‚ ä»¥ä¸Šæ˜¯Node.jsæ‰§è¡Œä¸€ä¸ªJavaScriptæ–‡ä»¶çš„å…¨è¿‡ç¨‹ï¼Œäº‹ä»¶å¾ªç¯æ˜¯åœ¨ç¬¬å…«ä¸ªæ­¥éª¤ä¸­ã€‚ Nodejs å®Œå…¨æ˜¯å•çº¿ç¨‹çš„. ä»è¿›ç¨‹å¯åŠ¨å, ç”±ä¸»çº¿ç¨‹åŠ è½½æˆ‘ä»¬çš„ js æ–‡ä»¶(ä¸‹å›¾ä¸­ main.js), ç„¶åè¿›å…¥æ¶ˆæ¯å¾ªç¯. å¯è§å¯¹äº js ç¨‹åºè€Œè¨€, å®Œæ•´è¿è¡Œåœ¨å•çº¿ç¨‹ä¹‹ä¸­ã€‚ äº‹ä»¶å¾ªç¯Node.jsä¸­äº‹ä»¶å¾ªç¯åˆ†ä¸º6ä¸ªé˜¶æ®µï¼š timersï¼šæ‰§è¡ŒsetTimeout() å’Œ setInterval()ä¸­åˆ°æœŸçš„å›è°ƒã€‚ I/O callbacksï¼šä¸Šä¸€è½®å¾ªç¯ä¸­æœ‰å°‘æ•°çš„I/Ocallbackä¼šè¢«å»¶è¿Ÿåˆ°è¿™ä¸€è½®çš„è¿™ä¸€é˜¶æ®µæ‰§è¡Œ idle, prepareï¼šä»…å†…éƒ¨ä½¿ç”¨ pollï¼šæœ€ä¸ºé‡è¦çš„é˜¶æ®µï¼Œæ‰§è¡ŒI/O å›è°ƒï¼Œåœ¨é€‚å½“çš„æ¡ä»¶ä¸‹ä¼šé˜»å¡åœ¨è¿™ä¸ªé˜¶æ®µ checkï¼šæ‰§è¡ŒsetImmediateçš„å›è°ƒ close callbacksï¼šæ‰§è¡Œcloseäº‹ä»¶çš„å›è°ƒï¼Œä¾‹å¦‚socket.on(&quot;close&quot;,func) é‡ç‚¹å…³æ³¨timersã€pollã€checkä¸‰ä¸ªé˜¶æ®µ æ­¥éª¤ï¼š nodeçš„åˆå§‹åŒ– åˆå§‹åŒ–nodeç¯å¢ƒ æ‰§è¡ŒåŒæ­¥ä»»åŠ¡ï¼ˆä¾‹å¦‚console.logï¼‰ æ‰§è¡Œprocess.nextTickå›è°ƒ æ‰§è¡Œmicrotasksï¼ˆPromise.thenï¼‰ è¿›å…¥event-loop è¿›å…¥timersé˜¶æ®µ æ£€æŸ¥timeré˜Ÿåˆ—æ˜¯å¦æœ‰åˆ°æœŸçš„timerå›è°ƒï¼Œå¦‚æœæœ‰ï¼Œå°†åˆ°æœŸçš„timerå›è°ƒæŒ‰ç…§timerIDå‡åºæ‰§è¡Œ æ£€æŸ¥æ˜¯å¦æœ‰process.nextTickä»»åŠ¡ï¼Œå¦‚æœæœ‰ï¼Œå…¨éƒ¨æ‰§è¡Œ æ£€æŸ¥æ˜¯å¦æœ‰microtaskï¼Œå¦‚æœæœ‰ï¼Œå…¨éƒ¨æ‰§è¡Œ é€€å‡ºè¯¥é˜¶æ®µ è¿›å…¥IO callbacké˜¶æ®µ æ£€æŸ¥æ˜¯å¦æœ‰ pending çš„ I/O å›è°ƒã€‚å¦‚æœæœ‰ï¼Œæ‰§è¡Œå›è°ƒã€‚å¦‚æœæ²¡æœ‰ï¼Œé€€å‡ºè¯¥é˜¶æ®µã€‚ æ£€æŸ¥æ˜¯å¦æœ‰ process.nextTick ä»»åŠ¡ï¼Œå¦‚æœæœ‰ï¼Œå…¨éƒ¨æ‰§è¡Œã€‚ æ£€æŸ¥æ˜¯å¦æœ‰microtaskï¼Œå¦‚æœæœ‰ï¼Œå…¨éƒ¨æ‰§è¡Œã€‚ é€€å‡ºè¯¥é˜¶æ®µã€‚ è¿›å…¥idleã€prepareé˜¶æ®µï¼š è¿™ä¸¤ä¸ªé˜¶æ®µä¸æˆ‘ä»¬ç¼–ç¨‹å…³ç³»ä¸å¤§ï¼Œæš‚ä¸”æŒ‰ä¸‹ä¸è¡¨ã€‚ è¿›å…¥pollé˜¶æ®µ é¦–å…ˆæ£€æŸ¥æ˜¯å¦å­˜åœ¨å°šæœªå®Œæˆçš„å›è°ƒï¼Œå¦‚æœå­˜åœ¨ï¼Œåˆ†ä¸¤ç§æƒ…å†µï¼š å¦‚æœæœ‰å¯ç”¨å›è°ƒï¼ˆå¯ç”¨å›è°ƒåŒ…å«ï¼šåˆ°æœŸçš„å®šæ—¶å™¨ã€ä¸€äº›IOäº‹ä»¶ç­‰ï¼‰ï¼Œæ‰§è¡Œæ‰€æœ‰å¯ç”¨å›è°ƒã€‚ æ£€æŸ¥æ˜¯å¦æœ‰process.nextTickå›è°ƒï¼Œå¦‚æœæœ‰ï¼Œå…¨éƒ¨æ‰§è¡Œ æ£€æŸ¥æ˜¯å¦æœ‰ microtaksï¼Œå¦‚æœæœ‰ï¼Œå…¨éƒ¨æ‰§è¡Œã€‚ é€€å‡ºè¯¥é˜¶æ®µã€‚ å¦‚æœæ²¡æœ‰å¯ç”¨å›è°ƒ æ£€æŸ¥æ˜¯å¦æœ‰setImmediateå›è°ƒï¼Œå¦‚æœæœ‰ï¼Œé€€å‡ºpollé˜¶æ®µã€‚å¦‚æœæ²¡æœ‰ï¼Œé˜»å¡åœ¨æ­¤é˜¶æ®µï¼Œç­‰å¾…æ–°çš„äº‹ä»¶é€šçŸ¥ã€‚ å¦‚æœä¸å­˜åœ¨å°šæœªå®Œæˆçš„å›è°ƒï¼Œé€€å‡ºpollã€‚ è¿›å…¥checké˜¶æ®µ å¦‚æœæœ‰immediateå›è°ƒï¼Œåˆ™æ‰§è¡Œæ‰€æœ‰immediateå›è°ƒã€‚ æ£€æŸ¥æ˜¯å¦æœ‰ process.nextTick å›è°ƒï¼Œå¦‚æœæœ‰ï¼Œå…¨éƒ¨æ‰§è¡Œã€‚ æ£€æŸ¥æ˜¯å¦æœ‰ microtaksï¼Œå¦‚æœæœ‰ï¼Œå…¨éƒ¨æ‰§è¡Œã€‚ é€€å‡º check é˜¶æ®µ è¿›å…¥closingé˜¶æ®µ å¦‚æœæœ‰immediateå›è°ƒï¼Œåˆ™æ‰§è¡Œæ‰€æœ‰immediateå›è°ƒã€‚ æ£€æŸ¥æ˜¯å¦æœ‰ process.nextTick å›è°ƒï¼Œå¦‚æœæœ‰ï¼Œå…¨éƒ¨æ‰§è¡Œã€‚ æ£€æŸ¥æ˜¯å¦æœ‰ microtaksï¼Œå¦‚æœæœ‰ï¼Œå…¨éƒ¨æ‰§è¡Œã€‚ é€€å‡º closing é˜¶æ®µ åœ¨äº‹ä»¶å¾ªç¯çš„æ¯ä¸ªå­é˜¶æ®µé€€å‡ºä¹‹å‰éƒ½ä¼šæŒ‰é¡ºåºæ‰§è¡Œå¦‚ä¸‹è¿‡ç¨‹ï¼š æ£€æŸ¥æ˜¯å¦æœ‰ process.nextTick å›è°ƒï¼Œå¦‚æœæœ‰ï¼Œå…¨éƒ¨æ‰§è¡Œã€‚ æ£€æŸ¥æ˜¯å¦æœ‰ microtaksï¼Œå¦‚æœæœ‰ï¼Œå…¨éƒ¨æ‰§è¡Œã€‚ é€€å‡ºå½“å‰é˜¶æ®µã€‚ å¸¸è§é—®é¢˜process.nextTickå’ŒPromiseè¿™ä¸ªé˜Ÿåˆ—å…ˆä¿è¯æ‰€æœ‰çš„ process.nextTick å›è°ƒ, ç„¶åå°†æ‰€æœ‰çš„ Promise å›è°ƒè¿½åŠ åœ¨åé¢. æœ€ç»ˆåœ¨æ¯ä¸ª Phase ç»“æŸçš„æ—¶å€™ä¸€æ¬¡æ€§æ‹¿å‡ºæ¥æ‰§è¡Œã€‚ setTimeout(..., 0)vs. setImmediate åˆ°åº•è°å¿«?1234// index.jssetImmediate(() =&gt; console.log(2))setTimeout(() =&gt; console.log(1),0) ç­”æ¡ˆï¼šå¯èƒ½æ˜¯1 2ï¼Œä¹Ÿå¯èƒ½æ˜¯2 1ã€‚ é¦–å…ˆæˆ‘ä»¬åœ¨åˆå§‹åŒ–é˜¶æ®µä¼šå°†setImmediateæ·»åŠ åˆ°check phaseä¸­ï¼Œå°†setTimeoutæ·»åŠ åˆ°timer phaseä¸­ã€‚ å¦‚æœè¿›å…¥timer phaseçš„æ—¶é—´ &gt; æ¶ˆæ¯å¾ªç¯ä¿å­˜çš„æ—¶é—´ï¼ˆå³å°†ä»¥ä¸Šä¸¤ä¸ªå›è°ƒæ·»åŠ åˆ°å®ƒä»¬å„è‡ªçš„phaseçš„æ—¶é—´ï¼‰ é‚£åœ¨è¿›å…¥timer phaseçš„æ—¶å€™setTimeoutçš„å›è°ƒå·²ç»åœ¨é‡Œé¢äº†ï¼Œå°±å¯ä»¥ç«‹å³æ‰§è¡Œï¼Œç„¶ååˆ°check phaseçš„æ—¶å€™å†æ‰§è¡ŒsetImmediateçš„å›è°ƒã€‚æ­¤æ—¶è¾“å‡º1 2ã€‚ å¦‚æœè¿›å…¥timer phaseçš„æ—¶é—´ &lt; æ¶ˆæ¯å¾ªç¯ä¿å­˜çš„æ—¶é—´ï¼ˆå³å°†ä»¥ä¸Šä¸¤ä¸ªå›è°ƒæ·»åŠ åˆ°å®ƒä»¬å„è‡ªçš„phaseçš„æ—¶é—´ï¼‰ é‚£åœ¨è¿›å…¥timer phaseçš„æ—¶å€™setTimeoutçš„å›è°ƒè¿˜ä¸åœ¨é‡Œé¢ï¼Œé‚£å°±ä¼šå…ˆæ‰§è¡Œcheck phaseä¸­çš„setImmediateï¼Œç„¶ååœ¨ä¸‹ä¸€è½®å¾ªç¯ä¸­å†æ‰§è¡Œtimer phaseä¸­çš„setTimeoutã€‚æ­¤æ—¶è¾“å‡º2 1ã€‚ å¦‚æœæŠŠä»£ç æ”¹ä¸ºå¦‚ä¸‹ï¼Œåˆ™ä¸€å®šä¼šå¾—åˆ°ç¨³å®šè¾“å‡ºï¼š 12345require('fs').readFile('my-file-path.txt', () =&gt; &#123; setImmediate(() =&gt; console.log(2)) setTimeout(() =&gt; console.log(1))&#125;);// 2 1 å› ä¸ºæ¶ˆæ¯åœ¨poll phaseæ‰ä¼šå°†setImmediateè¿›å…¥check phaseï¼Œå°†setTimeoutè¿›å…¥timer phaseï¼Œé‚£pollé˜¶æ®µåå°±å›åˆ°checké˜¶æ®µï¼Œæ‰€ä»¥ä¼šè¾“å‡º2 1ã€‚ åˆ¤æ–­è¾“å‡ºé¡ºåº12345678910111213141516171819setImmediate(() =&gt; &#123; console.log('setImmediate1'); setTimeout(() =&gt; &#123; console.log('setTimeout1') &#125;, 0);&#125;);Promise.resolve().then(res=&gt;&#123; console.log('then');&#125;)setTimeout(() =&gt; &#123; process.nextTick(() =&gt; &#123; console.log('nextTick'); &#125;); console.log('setTimeout2'); setImmediate(() =&gt; &#123; console.log('setImmediate2'); &#125;);&#125;, 0);//then setTimeout2 nextTick setImmediate1 setImmediate2 setTimeout1 step1ï¼šåˆå§‹åŒ–é˜¶æ®µ setImmediateè¿›å…¥check phaseã€Promise.resolve().thenè¿›å…¥å¾®ä»»åŠ¡event queueã€setTimeoutè¿›å…¥timer phaseã€‚ æ²¡æœ‰process.nextTick æ‰§è¡Œmicrotaskï¼Œè¾“å‡ºthen ç»“æŸè¯¥é˜¶æ®µ step2ï¼šè¿›å…¥Timer phaseï¼ˆæˆ–è€…poll phaseï¼Ÿï¼‰ æ‰§è¡ŒsetTimeout æ‰§è¡Œconsole.log(&#39;setTimeout2&#39;)ï¼Œè¾“å‡ºsetTimeout2 setImmediateè¿›å…¥check phase æœ‰process.nextTickï¼Œè¾“å‡ºnextTick step3ï¼šè¿›å…¥check phase æ‰§è¡Œç¬¬ä¸€ä¸ªsetImmediateï¼Œè¾“å‡ºsetImmediate1ï¼Œå°†setTimeoutè¿›å…¥Timer phase æ‰§è¡Œç¬¬äºŒä¸ªsetImmediateï¼Œè¾“å‡ºsetImmediate2 step4ï¼šä¸‹ä¸€ä¸ªå¾ªç¯ï¼Œè¿›å…¥Timer phase æ‰§è¡ŒsetTimeoutï¼Œè¾“å‡ºsetTimeout1 å‚è€ƒï¼š https://juejin.im/post/5b61d8e3e51d45191d7a28a8 https://www.jianshu.com/p/906eafb41ea6","categories":[{"name":"Node.js","slug":"Node-js","permalink":"http://delaprada.com/categories/Node-js/"}],"tags":[{"name":"Node.js","slug":"Node-js","permalink":"http://delaprada.com/tags/Node-js/"}]},{"title":"Vueé¡¹ç›®ä¸­å¦‚ä½•ç”¨Nodeä½œåç«¯ä»£ç†è·å–æ¥å£æ•°æ®","slug":"Vueé¡¹ç›®ä¸­å¦‚ä½•ç”¨Nodeä½œåç«¯ä»£ç†è·å–æ¥å£æ•°æ®","date":"2020-04-06T02:12:17.000Z","updated":"2020-04-06T02:37:42.000Z","comments":true,"path":"2020/04/06/Vueé¡¹ç›®ä¸­å¦‚ä½•ç”¨Nodeä½œåç«¯ä»£ç†è·å–æ¥å£æ•°æ®/","link":"","permalink":"http://delaprada.com/2020/04/06/Vue%E9%A1%B9%E7%9B%AE%E4%B8%AD%E5%A6%82%E4%BD%95%E7%94%A8Node%E4%BD%9C%E5%90%8E%E7%AB%AF%E4%BB%A3%E7%90%86%E8%8E%B7%E5%8F%96%E6%8E%A5%E5%8F%A3%E6%95%B0%E6%8D%AE/","excerpt":"","text":"åœ¨åšéŸ³ä¹APPé¡¹ç›®çš„æ—¶å€™ï¼Œå‘è§‰QQéŸ³ä¹çš„æœ‰äº›æ¥å£æ˜¯æ²¡æœ‰åŠæ³•ç›´æ¥è·å–å…¶ä¸­çš„æ•°æ®çš„ï¼Œå› ä¸ºå®ƒæŒ‡å®šäº†è¯·æ±‚çš„hostå’Œrefererï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ç”¨Nodeåœ¨å…¶ä¸­åšä¸€å±‚ä»£ç†ï¼Œå»â€œæ¬ºéª—â€QQï¼Œè¿™æ ·å°±èƒ½å¤Ÿè·å–æ•°æ®ã€‚æœ‰ç‚¹åƒè·¨åŸŸçš„æ€æƒ³ï¼Œåªä¸è¿‡è·¨åŸŸæ˜¯ç”¨ä»£ç†ä½œä¸ºè·³æ¿ï¼Œè½¬å‘è¯·æ±‚ï¼Œä¸å­˜åœ¨è·¨åŸŸé—®é¢˜ï¼›è¿™é‡Œæ˜¯ç”¨Node Serverå‘èµ·è¯·æ±‚ï¼Œå°†è¯·æ±‚çš„refererå’Œhostæ”¹ä¸ºæ¥å£å…è®¸è®¿é—®çš„refererå’Œhostï¼Œæ¥â€œæ¬ºéª—â€QQã€‚ æ€ä¹ˆé…ç½®Nodeä»£ç†æˆ‘ä»¬ä½¿ç”¨Vue.cliæ­é¡¹ç›®çš„è„šæ‰‹æ¶çš„æ—¶å€™ï¼Œbuild/webpack.dev.conf.jsæ–‡ä»¶ä¸­æœ‰ä¸ªdevServerè¿™é‡Œå°±å¯ä»¥ç”¨æ¥é…ç½®ã€‚ä»¥å‰æ˜¯æœ‰å•ç‹¬çš„æ–‡ä»¶dev-server.jsï¼Œæœ€æ–°ç‰ˆæœ¬çš„Vue.cliæ”¾å¼ƒäº†è¿™ä¸ªã€‚ é¦–å…ˆè¦åœ¨devServerä¸­æ·»åŠ before(app){}ï¼Œå°†æˆ‘ä»¬çš„æ“ä½œæ”¾åœ¨before(app){}ä¸­ã€‚webpack 3 å†…ç½®äº† expressï¼Œapp å°±æ˜¯ express() è¿”å›çš„å¯¹è±¡ã€‚ 123456789101112131415161718devServer: &#123; before(app)&#123; app.get('/api/getDiscList',function(req,res)&#123; const url='https://c.y.qq.com/splcloud/fcgi-bin/fcg_get_diss_by_tag.fcg'; axios.get(url,&#123; headers:&#123; referer:'https://c.y.qq.com', host:'c.y.qq.com' &#125;, params:req.query &#125;).then((response)=&gt;&#123; res.json(response.data) &#125;).catch((e)=&gt;&#123; console.log(e); &#125;) &#125;)...&#125; å½“NodeæœåŠ¡å™¨æ¥æ”¶åˆ°æ¥è‡ª/api/getDiscListçš„getè¯·æ±‚æ—¶ï¼Œå°±ä¼šæ‰§è¡Œåé¢çš„å›è°ƒå‡½æ•°ï¼Œç”¨axioså‘QQçš„URLå‘èµ·è¯·æ±‚ï¼Œå…³é”®æ˜¯è¦æŒ‡å®šè¯·æ±‚çš„å¤´éƒ¨headersï¼Œè®¾å®šrefererå’Œhostï¼Œè¿™ä¸ªrefererå’Œhostæ˜¯URL &#39;https://c.y.qq.com/splcloud/fcgi-bin/fcg_get_diss_by_tag.fcg&#39; å…è®¸è®¿é—®çš„refererå’Œhostã€‚ å‘Nodeä»£ç†æœåŠ¡å™¨å‘èµ·è¯·æ±‚æˆ‘ä»¬ä½¿ç”¨æ¨¡å—åŒ–å¼€å‘çš„æ—¶å€™ï¼Œå°±å¯ä»¥åœ¨æ–¹æ³•å½“ä¸­ä½¿ç”¨axioså‘Nodeä»£ç†æœåŠ¡å™¨å‘èµ·è¯·æ±‚ï¼Œè¿”å›ä¸€ä¸ªPromiseå¯¹è±¡ã€‚ 1234567891011121314151617181920export function getDiscList()&#123; const url='/api/getDiscList'; const data=Object.assign(&#123;&#125;,commonParams,&#123; platform:'yqq', hostUin:0, sin:0, ein:29, sortId:5, needNewCode:0, categoryId:10000000, rnd:Math.random(), format:'json' &#125;) return axios.get(url,&#123; params:data &#125;).then((res)=&gt;&#123; return Promise.resolve(res.data); &#125;)&#125; ç»„ä»¶å½“ä¸­çš„è®¾ç½®é¦–å…ˆæ˜¯è¦å¯¼å…¥æ–¹æ³•ï¼š 1import &#123;getDiscList&#125; from 'api/recommend' æˆ‘ä»¬åœ¨createdç”Ÿå‘½å‘¨æœŸé˜¶æ®µæ‰§è¡Œæ–¹æ³•ï¼š 1234created()&#123; this._getRecommend(); this._getDiscList();&#125; è·å–åˆ°æ•°æ®ï¼š 123456789methods:&#123; _getDiscList()&#123; getDiscList().then((res)=&gt;&#123; if(res.code===ERR_OK)&#123; console.log(res.data.list); &#125; &#125;) &#125;&#125; æ‰§è¡Œnpm run devï¼Œå¯åœ¨æ§åˆ¶å°çœ‹åˆ°æ•°æ®ï¼š","categories":[{"name":"Node.js","slug":"Node-js","permalink":"http://delaprada.com/categories/Node-js/"}],"tags":[{"name":"Node.js","slug":"Node-js","permalink":"http://delaprada.com/tags/Node-js/"}]},{"title":"Nodeâ€”â€”Connectå’ŒExpress","slug":"Nodeâ€”â€”Connectå’ŒExpress","date":"2020-04-05T06:03:20.000Z","updated":"2020-04-05T07:56:26.000Z","comments":true,"path":"2020/04/05/Nodeâ€”â€”Connectå’ŒExpress/","link":"","permalink":"http://delaprada.com/2020/04/05/Node%E2%80%94%E2%80%94Connect%E5%92%8CExpress/","excerpt":"","text":"å‰è¨€Connectå’ŒExpressæ˜¯ä¸¤ä¸ªçƒ­é—¨çš„Nodeæ¨¡å—ã€‚Expresså°±æ˜¯åœ¨Connectçš„åŸºç¡€ä¸Šï¼Œé€šè¿‡æ·»åŠ é«˜å±‚ç³–è¡£æ‰©å±•å’Œæ­å»ºå‡ºæ¥çš„ã€‚ Connectåˆ›å»ºç®€å•çš„Connectç¨‹åºæŒ‡ä»¤ï¼š 1npm install connect@3.4.0 åœ¨è¦å®‰è£…çš„æ¨¡å—ååŠ @å¯ä»¥æŒ‡å®šç‰ˆæœ¬å· ç®€å•çš„Connectç¨‹åºåº”è¯¥æ˜¯è¿™æ ·çš„ï¼š 12345const app&#x3D;require(&#39;connect&#39;)();app.use((req,res,next)&#x3D;&gt;&#123; res.end(&#39;Hello, world!&#39;);&#125;);app.listen(3000); è¿™ä¸ªç¨‹åºä¼šç”¨Hello, World!åšå‡ºå“åº”ã€‚ä¹Ÿå°±æ˜¯è®¿é—®http://localhost:3000çš„æ—¶å€™ï¼Œé¡µé¢æ˜¾ç¤ºHello, world!ã€‚ä¼ ç»™app.useçš„å‡½æ•°æ˜¯ä¸ªä¸­é—´ä»¶ï¼Œå®ƒä»¥æ–‡æœ¬Hello, world!ä½œä¸ºå“åº”ç»“æŸäº†è¯·æ±‚å¤„ç†è¿‡ç¨‹ã€‚ä¸­é—´ä»¶æ˜¯æ‰€æœ‰Connectå’ŒExpressç¨‹åºçš„åŸºç¡€ã€‚ Connectä¸­é—´ä»¶çš„å·¥ä½œæœºåˆ¶Connectä¸­é—´ä»¶å°±æ˜¯JavaScriptå‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°ä¸€èˆ¬ä¼šæœ‰ä¸‰ä¸ªå‚æ•°ï¼šè¯·æ±‚å¯¹è±¡ã€å“åº”å¯¹è±¡ã€ä»¥åŠä¸€ä¸ªåä¸ºnextçš„å›è°ƒå‡½æ•°ã€‚ä¸€ä¸ªä¸­é—´ä»¶å®Œæˆè‡ªå·±çš„å·¥ä½œï¼Œè¦æ‰§è¡Œåç»­çš„ä¸­é—´ä»¶æ—¶ï¼Œå¯ä»¥è°ƒç”¨è¿™ä¸ªnextå›è°ƒå‡½æ•°ã€‚ åœ¨ä¸­é—´ä»¶è¿è¡Œä¹‹å‰ï¼ŒConnectä¼šç”¨åˆ†æ´¾å™¨æ¥ç®¡è¯·æ±‚å¯¹è±¡ï¼Œç„¶åäº¤ç»™ç¨‹åºä¸­çš„ç¬¬ä¸€ä¸ªä¸­é—´ä»¶ã€‚ å€ŸåŠ©ä¸­é—´ä»¶APIï¼Œå¯ä»¥æŠŠä¸€äº›å°çš„æ„ä»¶å—ç»„åˆåˆ°ä¸€èµ·ï¼Œå®ç°å¤æ‚çš„å¤„ç†é€»è¾‘ã€‚ ç»„åˆä¸­é—´ä»¶Connectä¸­çš„useæ–¹æ³•å°±æ˜¯ç”¨æ¥ç»„åˆä¸­é—´ä»¶çš„ã€‚æˆ‘ä»¬å…ˆæ¥å®šä¹‰ä¸¤ä¸ªä¸­é—´ä»¶å‡½æ•°ï¼Œç„¶åæŠŠå®ƒä»¬éƒ½æ·»åŠ åˆ°ç¨‹åºä¸­ã€‚ 12345678910111213const connect=require('connect');function logger(req,res,next)&#123; console.log('%s %s', req.method, req.url); next();&#125;function hello(req,res)&#123; res.setHeader('Content-Type', 'text/plain'); res.end('hello world');&#125;connect() .use(logger) .use(hello) .listen(3000); è¿™ä¸¤ä¸ªä¸­é—´ä»¶çš„åç§°ç­¾åä¸ä¸€æ ·ï¼šä¸€ä¸ªæœ‰nextï¼Œä¸€ä¸ªæ²¡æœ‰ã€‚å› ä¸ºåé¢è¿™ä¸ªä¸­é—´ä»¶å®Œæˆäº†HTTPå“åº”ï¼Œå†ä¹Ÿä¸éœ€è¦æŠŠæ§åˆ¶æƒäº¤è¿˜ç»™åˆ†æ´¾å™¨äº†ã€‚ use()å‡½æ•°è¿”å›çš„æ˜¯Connectç¨‹åºçš„å®ä¾‹ï¼Œæ”¯æŒæ–¹æ³•é“¾ã€‚ä¹Ÿå¯ä»¥ä¸å†™æˆé“¾å¼è°ƒç”¨çš„å½¢å¼ï¼š 1234const app=connect();app.use(logger);app.use(hello);app.listen(3000); éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœæŸä¸ªä¸­é—´ä»¶ä¸è°ƒç”¨next()ï¼Œé‚£é“¾åœ¨å®ƒåé¢çš„ä¸­é—´ä»¶å°±ä¸ä¼šè¢«è°ƒç”¨ã€‚æ‰€ä»¥å¦‚æœloggerå’Œhelloä¸¤ä¸ªå‡½æ•°çš„è°ƒç”¨é¡ºåºåè¿‡æ¥ï¼Œåˆ™loggeræ˜¯ä¸ä¼šæ‰§è¡Œçš„ã€‚ ä½¿ç”¨é”™è¯¯å¤„ç†ä¸­é—´ä»¶Connectä¸­æœ‰ä¸€ç§ç”¨æ¥å¤„ç†é”™è¯¯çš„ä¸­é—´ä»¶å˜ä½“ã€‚è·Ÿå¸¸è§„çš„ä¸­é—´ä»¶ç›¸æ¯”ï¼Œé™¤äº†è¯·æ±‚å’Œå“åº”å¯¹è±¡å¤–ï¼Œé”™è¯¯å¤„ç†ä¸­é—´ä»¶çš„å‚æ•°ä¸­è¿˜å¤šäº†ä¸€ä¸ªé”™è¯¯å¯¹è±¡ã€‚ 1234567891011121314151617//Connectä¸­çš„é”™è¯¯å¤„ç†ä¸­é—´ä»¶const env=process.env.NODE_ENV||'development';function errorHandler(err,req,res,next)&#123; res.statusCode=500; switch(env)&#123; //å¼€å‘æ¨¡å¼å’Œç”Ÿäº§æ¨¡å¼çš„å“åº”ä¸åŒ case 'development': console.error('Error:'); console.error(err); res.setHeader('Content-Type','application/json'); res.end(JSON.stringify(err)); break; default: res.end('Server error'); &#125;&#125;module.exports=errorHandler; å¼€å‘ç¯å¢ƒï¼ˆdevelopmentï¼‰ï¼šå¼€å‘åŒå­¦å¼€å‘æ—¶ä½¿ç”¨çš„ç¯å¢ƒï¼Œæ¯ä½å¼€å‘åŒå­¦åœ¨è‡ªå·±çš„devåˆ†æ”¯ä¸Šå·¥ä½œï¼Œå¼€å‘åˆ°ä¸€å®šç¨‹åº¦åï¼Œå„ä½åŒå­¦ä¼šåˆå¹¶ä»£ç ï¼Œè¿›è¡Œè”è°ƒã€‚ ç”Ÿäº§ç¯å¢ƒï¼ˆproductionï¼‰ï¼šçº¿ä¸Šç¯å¢ƒï¼Œç”¨æˆ·ä½¿ç”¨çš„ç¯å¢ƒã€‚ç”±ç‰¹å®šäººå‘˜æ¥ç»´æŠ¤ã€‚ è®¾ç½®ç¯å¢ƒå˜é‡ UNIXç³»ç»Ÿä¸­è®¾ç½®ç¯å¢ƒå˜é‡çš„æŒ‡ä»¤ï¼š$ NODE_ENV=production node app Windowsä¸­ç”¨è¿™ä¸ªï¼š $ set NODE_ENV=production $ node app äº§å“åœ¨å¼€å‘ç¯å¢ƒä¸­è¿è¡Œæ—¶ï¼Œä½ å¯èƒ½æƒ³è¦çœ‹åˆ°å°½å¯èƒ½è¯¦ç»†çš„æ—¥å¿—ï¼›ä½†åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œä½ å¯èƒ½æƒ³è®©æ—¥å¿—å°½é‡ç²¾ç®€ï¼Œå¯èƒ½è¿˜è¦ç”¨gzipè¿›è¡Œå‹ç¼©ã€‚ ç”¨NODE_ENVè®¾å®šç¨‹åºçš„æ¨¡å¼ï¼ŒConnectä¸€èˆ¬ä¼šæ ¹æ®ç¯å¢ƒå˜é‡NODE_ENV(process.env.NODE_ENV)æ¥åˆ‡æ¢ä¸åŒæœåŠ¡å™¨ç¯å¢ƒï¼ˆæ¯”å¦‚ç”Ÿäº§ç¯å¢ƒå’Œå¼€å‘ç¯å¢ƒï¼‰ä¸‹çš„è¡Œä¸ºã€‚ å½“Connecté‡åˆ°é”™è¯¯æ—¶ï¼Œå®ƒä¼šåˆ‡æ¢ï¼Œåªå»è°ƒç”¨é”™è¯¯å¤„ç†ä¸­é—´ä»¶ã€‚ å‡è®¾æœ‰ä¸€ä¸ªå…è®¸ç”¨æˆ·ç™»å½•åˆ°ç®¡ç†åŒºåŸŸçš„åšå®¢ç¨‹åºã€‚å¦‚æœè´Ÿè´£ç”¨æˆ·è·¯ç”±çš„ä¸­é—´ä»¶å¼•å‘äº†ä¸€ä¸ªé”™è¯¯ï¼Œåˆ™ä¸­é—´ä»¶blogå’Œadminéƒ½ä¼šè¢«è·³è¿‡ï¼Œå› ä¸ºå®ƒä»¬ä¸æ˜¯é”™è¯¯å¤„ç†ä¸­é—´ä»¶ï¼ˆåªæœ‰ä¸‰ä¸ªå‚æ•°ï¼‰ã€‚ç„¶åConnectçœ‹åˆ°æ¥å—é”™è¯¯å‚æ•°çš„errorHandlerï¼Œå°±ä¼šè°ƒç”¨å®ƒã€‚ä¸­é—´ä»¶çœ‹èµ·æ¥åƒä¸‹é¢è¿™æ ·ï¼š 12345connect() .use(router(require('./routes/user'))) .use(router(require('./routes/blog'))) //è·³è¿‡ .use(router(require('./routes/admin'))) //è·³è¿‡ .use(errorHandler); ExpressExpressæ˜¯éå¸¸æµè¡Œçš„Webæ¡†æ¶ï¼Œä»¥å‰æ˜¯åœ¨Connectçš„åŸºç¡€ä¸Šæ­å»ºçš„ã€‚å°½ç®¡æä¾›äº†ä¸€äº›åŸºæœ¬çš„åŠŸèƒ½ï¼Œæ¯”å¦‚é™æ€æ–‡ä»¶æœåŠ¡ã€URLè·¯ç”±å’Œç¨‹åºé…ç½®ç­‰ï¼Œä½†å®ƒä¾ç„¶æ˜¯æç®€çš„Webæ¡†æ¶ã€‚ ç®€å•çš„Expressç¨‹åº 12345678const express=require('express');const app=express();app.get('/',(req,res)=&gt;&#123; res.send('Hello');&#125;);app.listen(3000); ç”Ÿæˆç¨‹åºæ¡†æ¶å®‰è£…æŒ‡ä»¤ï¼š 1npm install -g express-generator ç”Ÿæˆç¨‹åº ç”¨-eæˆ–ï¼ˆ--ejsï¼‰æŒ‡å®šè¦ä½¿ç”¨çš„æ¨¡æ¿å¼•æ“æ˜¯EJSï¼ˆEJSæ˜¯ä¸€ä¸ªåµŒå…¥JavaScriptæ¨¡æ¿å¼•æ“ï¼Œé€šè¿‡ç¼–è¯‘ç”ŸæˆHTMLä»£ç ï¼‰ã€‚æ‰§è¡Œexpress -e shoutboxï¼Œshoutboxæ˜¯æ–‡ä»¶åã€‚ä¸€ä¸ªåŠŸèƒ½å®Œå¤‡çš„ç¨‹åºä¼šå‡ºç°åœ¨shoutboxç›®å½•ä¸­ã€‚å…¶ä¸­ä¼šæœ‰æè¿°é¡¹ç›®å’Œä¾èµ–é¡¹çš„package.jsonæ–‡ä»¶ã€ç¨‹åºä¸»æ–‡ä»¶ã€publicç›®å½•ï¼Œä»¥åŠä¸€ä¸ªæ”¾è·¯ç”±å¤„ç†å™¨çš„ç›®å½•ã€‚ Expressè·¯ç”±å…¥é—¨æ ¹æ®å®˜ç½‘å®šä¹‰ï¼š Routing refers to determining how an application responds to a client request to a particular endpoint, which is a URI (or path) and a specific HTTP request method (GET, POST, and so on). è·¯ç”±çš„å®šä¹‰ï¼š 1app.METHOD(PATH, HANDLER) appæ˜¯expressçš„ä¸€ä¸ªå®ä¾‹ METHODæ˜¯HTTPè¯·æ±‚æ–¹æ³•ï¼ˆå°å†™ï¼‰ PATHæ˜¯æœåŠ¡å™¨ä¸Šçš„è·¯å¾„ HANDLERæ˜¯åœ¨è¿™ä¸ªè·¯å¾„ä¸Šå‘èµ·HTTPè¯·æ±‚æ—¶æ‰§è¡Œçš„å›è°ƒå‡½æ•° Respond with Hello World! on the homepage: 123app.get('/', function (req, res) &#123; res.send('Hello World!')&#125;) Respond to POST request on the root route (/), the applicationâ€™s home page: 123app.post('/', function (req, res) &#123; res.send('Got a POST request')&#125;) Respond to a PUT request to the /user route: 123app.put('/user', function (req, res) &#123; res.send('Got a PUT request at /user')&#125;) Respond to a DELETE request to the /user route: 123app.delete('/user', function (req, res) &#123; res.send('Got a DELETE request at /user')&#125;) åšä¸ªç®€å•çš„ç•™è¨€æ¿ç¨‹åºæ•ˆæœï¼š æ­¥éª¤ï¼š åˆ›å»ºæ¶ˆæ¯æ¨¡å‹ æ·»åŠ ä¸æ¶ˆæ¯ç›¸å…³çš„è·¯ç”± åˆ›å»ºæ¶ˆæ¯è¡¨å• æ·»åŠ ä¸šåŠ¡é€»è¾‘ï¼Œç”¨æäº¤ä¸Šæ¥çš„è¡¨å•æ•°æ®åˆ›å»ºæ¶ˆæ¯ åˆ›å»ºæ¶ˆæ¯æ¨¡å‹åœ¨åˆ›å»ºæ¶ˆæ¯æ¨¡å‹ä¹‹å‰ï¼Œéœ€è¦å…ˆå®‰è£…Node redisæ¨¡å—ã€‚æ‰§è¡Œå‘½ä»¤npm install --save redisã€‚è€Œä¸”è¦å®‰è£…Redisï¼ŒWindowsç³»ç»Ÿå¯ä»¥ä½¿ç”¨Redis Chocolatelyã€‚ å®‰è£…æ•™ç¨‹ï¼šhttps://www.cnblogs.com/julyluo/p/6646155.html å®˜ç½‘æ²¡æœ‰windowsç‰ˆæœ¬ï¼Œgithubä¸‹è½½é€Ÿåº¦å¤ªæ…¢ã€‚ Rediså°±æ˜¯ä¸€ä¸ªæ•°æ®åº“ï¼Œå¯ä»¥å°†æˆ‘ä»¬postçš„ç•™è¨€å­˜å‚¨èµ·æ¥ã€‚ åˆ›å»ºä¿å­˜åœ¨çº¿ç•™è¨€æ¿æ¶ˆæ¯æ¡ç›®çš„æ¨¡å‹ã€‚ åˆ›å»ºmodels/entry.jsæ–‡ä»¶ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940'use strict';const redis = require('redis');const db = redis.createClient();class Entry &#123; constructor(obj) &#123; for (let key in obj) &#123; this[key] = obj[key]; &#125; &#125; static getRange(from, to, cb) &#123; db.lrange('entries', from, to, (err, items) =&gt; &#123; if (err) return cb(err); let entries = []; items.forEach((item) =&gt; &#123; entries.push(JSON.parse(item)); &#125;); cb(null, entries); &#125;); &#125; save(cb) &#123; const entryJSON = JSON.stringify(this); db.lpush( 'entries', entryJSON, (err) =&gt; &#123; if (err) return cb(err); cb(); &#125; ); &#125; static count(cb) &#123; db.llen('entries', cb); &#125;&#125;module.exports = Entry; åˆ›å»ºæ¶ˆæ¯è¡¨å• åœ¨app.jsä¸­æ·»åŠ å¦‚ä¸‹è·¯ç”±éƒ¨åˆ† 12app.get('/post', entries.form);app.post('/post', entries.submit); å³ï¼šä½¿ç”¨getå‘/postå‘èµ·httpè¯·æ±‚æ—¶ï¼Œæ‰§è¡Œentries.formå›è°ƒå‡½æ•°ã€‚ä½¿ç”¨postå‘/postå‘èµ·httpè¯·æ±‚æ—¶ï¼Œæ‰§è¡Œentries.submitå›è°ƒã€‚ è¿™ä¸ªentriesæ˜¯ä»routesä¸­å¯¼å…¥çš„æ¨¡å—ã€‚çœ‹ä¸€ä¸‹å®šä¹‰ï¼š è¡¨å•æ¨¡å—éƒ¨åˆ†ï¼š 1234//routes/entries.jsexports.form = (req, res) =&gt; &#123; res.render('post', &#123; title: 'Post' &#125;);&#125;; è¿™é‡Œæ˜¯ç”¨views/post.ejsï¼Œå³è¡¨å•ï¼Œå»æ¸²æŸ“é¡µé¢ã€‚ 123456789101112131415161718192021222324&#x2F;&#x2F;views&#x2F;post.ejs&lt;!DOCTYPE html&gt;&lt;html&gt; &lt;head&gt; &lt;title&gt;&lt;%&#x3D; title %&gt;&lt;&#x2F;title&gt; &lt;link rel&#x3D;&#39;stylesheet&#39; href&#x3D;&#39;&#x2F;stylesheets&#x2F;style.css&#39; &#x2F;&gt; &lt;&#x2F;head&gt; &lt;body&gt; &lt;% include menu %&gt; &lt;h1&gt;&lt;%&#x3D; title %&gt;&lt;&#x2F;h1&gt; &lt;p&gt;Fill in the form below to add a new post.&lt;&#x2F;p&gt; &lt;form action&#x3D;&#39;&#x2F;post&#39; method&#x3D;&#39;post&#39;&gt; &lt;p&gt; &lt;input type&#x3D;&#39;text&#39; name&#x3D;&#39;entry[title]&#39; placeholder&#x3D;&#39;Title&#39; &#x2F;&gt; &lt;&#x2F;p&gt; &lt;p&gt; &lt;textarea name&#x3D;&#39;entry[body]&#39; placeholder&#x3D;&#39;Body&#39;&gt;&lt;&#x2F;textarea&gt; &lt;&#x2F;p&gt; &lt;p&gt; &lt;input type&#x3D;&#39;submit&#39; value&#x3D;&#39;Post&#39; &#x2F;&gt; &lt;&#x2F;p&gt; &lt;&#x2F;form&gt; &lt;&#x2F;body&gt;&lt;&#x2F;html&gt; è¡¨å•ä¸­ç”¨äº†å½¢å¦‚entry[title]ä¹‹ç±»çš„è¾“å…¥æ§ä»¶åç§°ï¼Œéœ€è¦ç”¨æ‰©å±•çš„æ¶ˆæ¯ä½“è§£æå™¨æ¥è§£æã€‚æ‰¾åˆ°app.jså°† 1app.use(bodyParser.urlencoded(&#123; extended: true &#125;)); æ”¹ä¸ºï¼š 1app.use(bodyParser.urlencoded(&#123; extended: true &#125;)); å®ç°æ¶ˆæ¯æäº¤åŠŸèƒ½ 123456789101112131415//å°†ä»£ç æ·»åŠ åˆ°æ–‡ä»¶routes/entries.jsä¸­ï¼Œå®ç°ç”¨è¡¨å•æäº¤ä¸Šæ¥çš„æ•°æ®åˆ›å»ºæ¶ˆæ¯exports.submit = (req, res, next) =&gt; &#123; const data = req.body.entry; const user = res.locals.user; const username = user ? user.name : null; const entry = new Entry(&#123; username: username, title: data.title, body: data.body &#125;); entry.save((err) =&gt; &#123; if (err) return next(err); res.redirect('/'); &#125;);&#125;; è¿™é‡Œä½¿ç”¨äº†Common JSè¿›è¡Œæ¨¡å—åŒ–å¼€å‘ æ·»åŠ æ˜¾ç¤ºæ¶ˆæ¯çš„é¦–é¡µ åœ¨routes/entries.jsä¸­æ·»åŠ ï¼š 123456789101112const Entry = require('../models/entry');exports.list = (req, res, next) =&gt; &#123; const page = req.page; Entry.getRange(0, -1, (err, entries) =&gt; &#123; if (err) return next(err); res.render('entries', &#123; title: 'Entries', entries: entries &#125;); &#125;);&#125;; è§†å›¾entries.ejs 1234567891011121314151617&lt;!DOCTYPE html&gt;&lt;html&gt; &lt;head&gt; &lt;title&gt;&lt;%&#x3D; title %&gt;&lt;&#x2F;title&gt; &lt;link rel&#x3D;&#39;stylesheet&#39; href&#x3D;&#39;&#x2F;stylesheets&#x2F;style.css&#39; &#x2F;&gt; &lt;&#x2F;head&gt; &lt;body&gt; &lt;% include menu %&gt; &lt;% entries.forEach((entry) &#x3D;&gt; &#123; %&gt; &lt;div class&#x3D;&#39;entry&#39;&gt; &lt;h3&gt;&lt;%&#x3D; entry.title %&gt;&lt;&#x2F;h3&gt; &lt;p&gt;&lt;%&#x3D; entry.body %&gt;&lt;&#x2F;p&gt; &lt;p&gt;Posted by &lt;%&#x3D; entry.username %&gt;&lt;&#x2F;p&gt; &lt;&#x2F;div&gt; &lt;% &#125;) %&gt; &lt;&#x2F;body&gt;&lt;&#x2F;html&gt; åœ¨ç¨‹åºè¿è¡Œä¹‹å‰å…ˆåœ¨åŒä¸€ç›®å½•ä¸‹åˆ›å»ºmenu.ejsåˆ›å»ºèœå•æ¨¡æ¿æ–‡ä»¶ï¼Œåç»­ä¼šç”¨åˆ°ã€‚ç›®å‰ç©ºç™½ç€å…ˆã€‚ æ·»åŠ ä¸æ¶ˆæ¯ç›¸å…³çš„è·¯ç”± åœ¨app.jsä¸­ï¼š 1const entries = require('./routes/entries'); æ·»åŠ è·¯ç”±ï¼š 1app.get('/', entries.list); è¿è¡Œç¨‹åº å…ˆä»¥ç®¡ç†å‘˜èº«ä»½è¿›å…¥CMDï¼Œè¿è¡Œredis-serverå¯ç”¨Redisã€‚ åœ¨terminalä¸­è¿è¡Œnpm startï¼Œè®¿é—®http://localhost:3000/post ç‚¹å‡»poståè·³è½¬åˆ°é¦–é¡µï¼š å®Œæˆã€‚","categories":[{"name":"Node.js","slug":"Node-js","permalink":"http://delaprada.com/categories/Node-js/"}],"tags":[{"name":"Node.js","slug":"Node-js","permalink":"http://delaprada.com/tags/Node-js/"}]},{"title":"Nodeâ€”â€”GulpåŸºäºæµçš„è‡ªåŠ¨åŒ–æ„å»ºå·¥å…·","slug":"Nodeâ€”â€”GulpåŸºäºæµçš„è‡ªåŠ¨åŒ–æ„å»ºå·¥å…·","date":"2020-04-03T02:59:55.000Z","updated":"2020-04-03T04:01:48.000Z","comments":true,"path":"2020/04/03/Nodeâ€”â€”GulpåŸºäºæµçš„è‡ªåŠ¨åŒ–æ„å»ºå·¥å…·/","link":"","permalink":"http://delaprada.com/2020/04/03/Node%E2%80%94%E2%80%94Gulp%E5%9F%BA%E4%BA%8E%E6%B5%81%E7%9A%84%E8%87%AA%E5%8A%A8%E5%8C%96%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/","excerpt":"","text":"ç”¨Gulpå®ç°è‡ªåŠ¨åŒ–Gulpæ˜¯åŸºäºæµçš„æ„å»ºç³»ç»Ÿã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å¯¹è¿™äº›æµçš„å¼•å¯¼æ¥åˆ›å»ºæ„å»ºè¿‡ç¨‹ï¼Œé™¤äº†è½¬è¯‘å’Œç¼©ç ï¼Œè¿˜èƒ½åšå¾ˆå¤šäº‹æƒ…ã€‚ Gulpä¹‹æ‰€ä»¥èƒ½å®ç°é«˜åº¦é‡ç”¨ï¼Œä¸»è¦å½’åŠŸäºä¸¤é¡¹æŠ€æœ¯ï¼šä½¿ç”¨æ’ä»¶å’Œè‡ªå®šä¹‰æ„å»ºä»»åŠ¡ã€‚Gulpçš„æ„å»ºè¿‡ç¨‹æ˜¯ä¸€ä¸ªæµï¼Œæ‰€ä»¥è¿™äº›ä»»åŠ¡å’Œæ’ä»¶æ˜¯å¯ä»¥ä¸€ä¸ªæ¥ä¸€ä¸ªæ‹¼åœ¨ä¸€èµ·çš„ã€‚ æŠŠGulpæ·»åŠ åˆ°é¡¹ç›®ä¸­æ·»åŠ Gulpéœ€è¦ç”¨npmå®‰è£…gulp-cliå’Œgulpä¸¤ä¸ªåŒ…ã€‚ä¸‹é¢è¿™æ®µä»£ç ä¸­ï¼Œå…¨å±€å®‰è£…gulp-cliï¼Œå¹¶åˆ›å»ºä¸€ä¸ªå¸¦æœ‰Gulpå¼€å‘ä¾èµ–é¡¹çš„æ–°Nodeé¡¹ç›®ã€‚ 123npm i --global gulp-clinpm init -ynpm i -save-dev gulp æ¥ç€åˆ›å»ºgulpfile.js 1touch gulpfile.js touchä¸ºlinuxæŒ‡ä»¤ ç°åœ¨ç”¨Gulpæ„å»ºä¸€ä¸ªå°å‹çš„Reacté¡¹ç›®ã€‚è¿™é‡Œä¼šç”¨åˆ°gulp-babelã€gulp-sourcemapså’Œgulp-concatï¼š 12npm i --save-dev gulp-sourcemaps gulp-babel babel-preset-es2015npm i --save-dev gulp-concat react react-dom babel-preset-react è¿™é‡Œè¦æ³¨æ„çš„æ˜¯ï¼Œå®‰è£…gulp-babelçš„æ—¶å€™è¦å®‰è£…7ç‰ˆæœ¬çš„ï¼Œåç»­è¿˜è¦å®‰è£…babel-coreã€‚å¦‚æœç›´æ¥å®‰è£…ï¼Œæ˜¯å®‰è£…8ç‰ˆæœ¬ï¼Œbabel-coreæ˜¯7ï¼Œå°±ä¼šå‡ºé”™ã€‚ Gulpä»»åŠ¡çš„åˆ›å»ºåŠè¿è¡Œåˆ›å»ºGulpä»»åŠ¡éœ€è¦åœ¨gulpfile.jsä¸­ç¼–å†™Nodeä»£ç ï¼Œè°ƒç”¨Gulpçš„APIã€‚Gulpçš„APIå¯ä»¥åšå¾ˆå¤šäº‹æƒ…ï¼Œæ¯”å¦‚æŸ¥æ‰¾æ–‡ä»¶ï¼ŒæŠŠå¯¹æ–‡ä»¶è¿›è¡ŒæŸç§è½¬æ¢çš„æ’ä»¶æ‹¼åˆ°ä¸€èµ·ç­‰ã€‚ æ‰“å¼€gulpfile.jsè®¾ç½®ä¸€ä¸ªæ„å»ºä»»åŠ¡ï¼Œç”¨gulp.srcæŸ¥æ‰¾JSXæ–‡ä»¶ï¼Œç”¨Babelå¤„ç†ES6å’ŒReactï¼Œç„¶åæŠŠè¿™äº›æ–‡ä»¶æ‹¼åˆ°ä¸€èµ·ã€‚ gulpfile.js 123456789101112131415const gulp=require('gulp');const sourcemaps=require('gulp-sourcemaps');const babel=require('gulp-babel');const concat=require('gulp-concat');gulp.task('default',()=&gt;&#123; return gulp.src('app/*.jsx') .pipe(sourcemaps.init()) .pipe(babel(&#123; presets:['es2015','react'] &#125;)) .pipe(concat('all.js')) .pipe(sourcemaps.write('.')) .pipe(gulp.dest('dist'));&#125;) gulp.srcï¼šGulpè‡ªå¸¦çš„æ–‡ä»¶èšé›†å·¥å…·ï¼ŒæŸ¥æ‰¾æ‰€æœ‰çš„React jsxæ–‡ä»¶ sourcemaps.init()ï¼šå¼€å§‹ç›‘è§†æºæ–‡ä»¶ï¼Œä¸ºè°ƒè¯•æ„å»ºæºç æ˜ å°„ concat(&#39;all.js&#39;)ï¼šæŠŠæ‰€æœ‰æºç æ–‡ä»¶æ‹¼åˆ°ä¸€ä¸ªall.jsä¸­ soucemaps.write(&#39;.&#39;)ï¼šå•ç‹¬å†™å…¥æºç æ˜ å°„æ–‡ä»¶ gulp.dest(&#39;dist&#39;)ï¼šå°†æ‰€æœ‰æ–‡ä»¶æ”¾åˆ°dist/ç›®å½•ä¸‹ åˆ›å»ºä¸€ä¸ªåä¸ºapp/index.jsxçš„æ–‡ä»¶ï¼Œå°±å¯ä»¥è¯•éªŒä¸€ä¸‹Gulpäº†ã€‚å¯ä»¥ç”¨ä¸‹é¢è¿™æ®µJSXä»£ç ï¼š 1234567import React from 'react';import ReactDOM from 'react-dom';ReactDOM.render( &lt;h1&gt;Hello,world!&lt;/h1&gt;, document.getElementById('example')) åœ¨ç»ˆç«¯è¿è¡Œgulpï¼š 123[10:21:44] Using gulpfile ~\\Desktop\\å¤§ä¸‰\\å®ä¹ \\ç¬”è®°\\Node.js\\gulp_test\\gulpfile.js[10:21:44] Starting &#39;default&#39;...[10:21:44] Finished &#39;default&#39; after 213 ms ç›®å½•ï¼š æ‰“åŒ…ç”Ÿæˆçš„all.jsï¼š 123456789101112131415161718'use strict';var _react = require('react');var _react2 = _interopRequireDefault(_react);var _reactDom = require('react-dom');var _reactDom2 = _interopRequireDefault(_reactDom);function _interopRequireDefault(obj) &#123; return obj &amp;&amp; obj.__esModule ? obj : &#123; default: obj &#125;; &#125;_reactDom2.default.render(_react2.default.createElement( 'h1', null, 'Hello,world'), document.getElementById('example'));//# sourceMappingURL=all.js.map æ€»ç»“åœ¨Gulpä¸­ï¼Œç”¨JavaScriptè¡¨ç¤ºæ„å»ºé˜¶æ®µå¾ˆå®¹æ˜“ã€‚å¹¶ä¸”æˆ‘ä»¬å¯ä»¥ç”¨gulp.task()å¾€è¿™ä¸ªæ–‡ä»¶é‡Œæ·»åŠ è‡ªå·±çš„ä»»åŠ¡ã€‚è¿™äº›ä»»åŠ¡é€šå¸¸éƒ½éµå¾ªç›¸åŒçš„æ¨¡å¼ã€‚ æºæ–‡ä»¶ï¼šæ”¶é›†è¾“å…¥æ–‡ä»¶ è½¬è¯‘ï¼šè®©å®ƒä»¬ä¾æ¬¡é€šè¿‡ä¸€ä¸ªä¸ªå¯¹å®ƒä»¬è¿›è¡Œè½¬æ¢çš„æ’ä»¶ åˆå¹¶ï¼šæŠŠè¿™äº›æ–‡ä»¶åˆåˆ°ä¸€èµ·ï¼Œåˆ›å»ºä¸€ä¸ªæ•´ä½“æ„å»ºæ–‡ä»¶ è¾“å‡ºï¼šè®¾å®šæ–‡ä»¶çš„ç›®æ ‡åœ°å€æˆ–ç§»åŠ¨è¾“å‡ºæ–‡ä»¶ åœ¨å‰é¢é‚£ä¸ªä¾‹å­ä¸­ï¼Œsourcemapsæ˜¯ä¸ªç‰¹ä¾‹ï¼Œå› ä¸ºå®ƒéœ€è¦ä¸¤æ¬¡pipeï¼šç¬¬ä¸€æ¬¡æ˜¯é…ç½®ï¼Œæœ€åä¸€æ¬¡æ˜¯è¾“å‡ºæ–‡ä»¶ã€‚","categories":[{"name":"Node.js","slug":"Node-js","permalink":"http://delaprada.com/categories/Node-js/"}],"tags":[{"name":"Node.js","slug":"Node-js","permalink":"http://delaprada.com/tags/Node-js/"}]},{"title":"Nodeâ€”â€”ä¸²è¡ŒåŒ–/å¹¶è¡ŒåŒ–æµç¨‹æ§åˆ¶","slug":"Nodeâ€”â€”ä¸²è¡ŒåŒ–-å¹¶è¡ŒåŒ–æµç¨‹æ§åˆ¶","date":"2020-04-01T03:15:11.000Z","updated":"2020-04-01T04:05:58.000Z","comments":true,"path":"2020/04/01/Nodeâ€”â€”ä¸²è¡ŒåŒ–-å¹¶è¡ŒåŒ–æµç¨‹æ§åˆ¶/","link":"","permalink":"http://delaprada.com/2020/04/01/Node%E2%80%94%E2%80%94%E4%B8%B2%E8%A1%8C%E5%8C%96-%E5%B9%B6%E8%A1%8C%E5%8C%96%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6/","excerpt":"","text":"å¼‚æ­¥é€»è¾‘çš„é¡ºåºåŒ–åœ¨å¼‚æ­¥ç¨‹åºçš„æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œæœ‰äº›ä»»åŠ¡å¯èƒ½ä¼šéšæ—¶å‘ç”Ÿï¼Œè·Ÿç¨‹åºä¸­çš„å…¶ä»–éƒ¨åˆ†åœ¨åšä»€ä¹ˆæ²¡å…³ç³»ï¼Œä»€ä¹ˆæ—¶å€™åšè¿™äº›ä»»åŠ¡éƒ½ä¸ä¼šå‡ºé—®é¢˜ã€‚ä½†æœ‰äº›ä»»åŠ¡åªèƒ½åœ¨æŸäº›ç‰¹å®šçš„ä»»åŠ¡ä¹‹å‰æˆ–ä¹‹ååšã€‚ è®©ä¸€ç»„å¼‚æ­¥ä»»åŠ¡é¡ºåºæ‰§è¡Œçš„æ¦‚å¿µè¢«Nodeç¤¾åŒºç§°ä¸ºæµç¨‹æ§åˆ¶ã€‚è¿™ç§æ§åˆ¶åˆ†ä¸ºä¸¤ç±»ï¼šä¸²è¡Œå’Œå¹¶è¡Œã€‚ ä¸²è¡Œä»»åŠ¡ï¼šéœ€è¦ä¸€ä¸ªæ¥ç€ä¸€ä¸ªæ‰§è¡Œçš„ä»»åŠ¡ å¹¶è¡Œä»»åŠ¡ï¼šä¸éœ€è¦ä¸€ä¸ªæ¥ç€ä¸€ä¸ªæ‰§è¡Œçš„ä»»åŠ¡ã€‚è¿™äº›ä»»åŠ¡å½¼æ­¤ä¹‹é—´å¼€å§‹å’Œç»“æŸæ—¶é—´å¹¶ä¸é‡è¦ï¼Œä½†åœ¨åç»­é€»è¾‘æ‰§è¡Œå‰å®ƒä»¬åº”è¯¥å…¨éƒ¨æ‰§è¡Œå®Œæˆã€‚ å®ç°ä¸²è¡ŒåŒ–æµç¨‹æ§åˆ¶ä¸ºäº†ç”¨ä¸²è¡ŒåŒ–æµç¨‹æ§åˆ¶è®©å‡ ä¸ªå¼‚æ­¥ä»»åŠ¡æŒ‰é¡ºåºæ‰§è¡Œï¼Œéœ€è¦å…ˆæŠŠè¿™äº›ä»»åŠ¡æŒ‰é¢„æœŸçš„æ‰§è¡Œé¡ºåºæ”¾åˆ°ä¸€ä¸ªæ•°ç»„ä¸­ã€‚è¿™ä¸ªæ•°ç»„èµ·åˆ°é˜Ÿåˆ—çš„ä½œç”¨ï¼šå®Œæˆä¸€ä¸ªä»»åŠ¡åæŒ‰é¡ºåºä»æ•°ç»„ä¸­å–å‡ºä¸‹ä¸€ä¸ªã€‚ å®ä¾‹åšä¸€ä¸ªå°ç¨‹åºï¼Œè®©å®ƒä»ä¸€ä¸ªéšæœºé€‰æ‹©çš„RSSé¢„è®¢æºä¸­è·å–ä¸€ç¯‡æ–‡ç« çš„æ ‡é¢˜å’ŒURLï¼Œå¹¶æ˜¾ç¤ºå‡ºæ¥ã€‚RSSé¢„è®¢æºåˆ—è¡¨æ”¾åœ¨ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ä¸­ã€‚ ä¾‹å¦‚ï¼š 123&#x2F;&#x2F;rss_feeds.txthttp:&#x2F;&#x2F;www.read.org.cn&#x2F;feedhttps:&#x2F;&#x2F;nodejs.org&#x2F;en&#x2F;feed&#x2F;blog.xml è¿™ä¸ªrss_feeds.txtæ”¾åœ¨æ–‡ä»¶å¤¹sequenceä¸­ã€‚ ä»npmå­˜å‚¨åº“ä¸­ä¸‹è½½ä¸¤ä¸ªè¾…åŠ©æ¨¡å—ã€‚åœ¨sequenceæ–‡ä»¶ç›®å½•ä¸‹ï¼Œterminalä¸­è¾“å…¥ï¼š 123npm init -ynpm install --save request@2.60.0npm install --save htmlparser@1.7.7 requestæ¨¡å—æ˜¯ä¸ªç»è¿‡ç®€åŒ–çš„HTTPå®¢æˆ·ç«¯ï¼Œä½ å¯ä»¥ç”¨å®ƒè·å–RSSæ•°æ®ã€‚htmlparseræ¨¡å—èƒ½æŠŠåŸå§‹çš„RSSæ•°æ®è½¬æ¢æˆJavaScriptæ•°æ®ç»“æ„ã€‚ ç„¶åå†ç›®å½•ä¸‹åˆ›å»ºindex.jsï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172const fs=require('fs');const request=require('request');const htmlparser=require('htmlparser');const configFilename='./rss_feeds.txt';//ç¡®ä¿åŒ…å«RSSé¢„è®¢æºURLåˆ—è¡¨çš„æ–‡ä»¶å­˜åœ¨function checkForRSSFile()&#123; fs.exists(configFilename,(exists)=&gt;&#123; if(!exists)&#123; return next(new Error(`Missing RSS file:$&#123;configFilename&#125;`)); &#125; next(null,configFilename); &#125;)&#125;//è¯»å–å¹¶è§£æåŒ…å«é¢„è®¢æºURLçš„æ–‡ä»¶function readRSSFile(configFilename)&#123; fs.readFile(configFilename,(err,feedList)=&gt;&#123; if(err)&#123; return next(err); &#125; feedList=feedList.toString().replace(/^\\s+|\\s+$/g,'').split('\\n'); //ä»é¢„è®¢æºURLæ•°ç»„ä¸­éšæœºé€‰æ‹©ä¸€ä¸ªé¢„è®¢æºURL const random=Math.floor(Math.random()*feedList.length); next(null,feedList[random]); &#125;)&#125;//å‘é€‰å®šçš„é¢„è®¢æºå‘é€HTTPè¯·æ±‚ä»¥è·å–æ•°æ®function downloadRSSFeed(feedUrl)&#123; request(&#123;uri:feedUrl&#125;,(err,res,body)=&gt;&#123; if(err) return next(err); if(res.statusCode!==200)&#123; return next(new Error('Abnormal response status code')); &#125; next(null,body); &#125;)&#125;//å°†é¢„è®¢æºæ•°æ®è§£æåˆ°ä¸€ä¸ªæ¡ç›®æ•°ç»„ä¸­function parseRSSFeed(rss)&#123; const handler=new htmlparser.RssHandler(); const parser=new htmlparser.Parser(handler); parser.parseComplete(rss); if(!handler.dom.items.length)&#123; return next(new Error('No RSS items found')); &#125; const item=handler.dom.items.shift(); //å¦‚æœæœ‰æ•°æ®ï¼Œæ˜¾ç¤ºç¬¬ä¸€ä¸ªé¢„è®¢æºæ¡ç›®çš„æ ‡é¢˜å’ŒURL console.log(item.title); console.log(item.link);&#125;//æŠŠæ‰€æœ‰è¦åšçš„ä»»åŠ¡æŒ‰æ‰§è¡Œé¡ºåºæ·»åŠ åˆ°ä¸€ä¸ªæ•°ç»„ä¸­const tasks=[ checkForRSSFile, readRSSFile, downloadRSSFeed, parseRSSFeed];//è´Ÿè´£æ‰§è¡Œä»»åŠ¡çš„nextå‡½æ•°function next(err,result)&#123; if(err)&#123; throw err; &#125; const currentTask=tasks.shift(); //ä»ä»»åŠ¡æ•°ç»„ä¸­å–å‡ºä¸‹ä¸ªä»»åŠ¡ if(currentTask)&#123; currentTask(result); &#125;&#125;next(); //å¼€å§‹æ‰§è¡Œ ä¸²è¡ŒåŒ–æ‰§è¡Œçš„å®ç°æ˜¯é€šè¿‡ä¸€ä¸ªæ•°ç»„taskså»æ‰¿è½½è¦æ‰§è¡Œçš„ä»»åŠ¡ã€‚é¦–å…ˆé€šè¿‡tasks.shift()æ–¹æ³•ä»tasksæ•°ç»„ä¸­å–å‡ºç¬¬ä¸€ä¸ªä»»åŠ¡checkForRSSFileï¼Œåœ¨æ‰§è¡Œè¿™ä¸ªä»»åŠ¡çš„æ—¶å€™ï¼Œå®ƒå†…éƒ¨åˆè°ƒç”¨äº†nextæ–¹æ³•ï¼Œä½¿å¾—æˆ‘ä»¬èƒ½å¤Ÿæ‰§è¡Œä¸‹ä¸€ä¸ªä»»åŠ¡ï¼Œä»¥æ­¤ç±»æ¨ã€‚è¿™ä¸ªè´Ÿè´£æ‰§è¡Œä»»åŠ¡çš„nextå‡½æ•°ä¼šå¤šæ¬¡æ‰§è¡Œã€‚ æ‰§è¡Œnode index.jsï¼Œè¾“å‡ºç»“æœï¼š 12ã€Šèªæ˜äººç”¨æ–¹æ ¼ç¬”è®°æœ¯ã€‹â€œé»„é‡‘ä¸‰åˆ†æ³•â€http:&#x2F;&#x2F;www.read.org.cn&#x2F;html&#x2F;2438-cong-ming-ren-yong-fang-ge-bi-ji-shu-huang-jin-san-fen-fa.html å®ç°å¹¶è¡ŒåŒ–æµç¨‹æ§åˆ¶ä¸ºäº†è®©å¼‚æ­¥ä»»åŠ¡å¹¶è¡Œæ‰§è¡Œï¼Œä»ç„¶æ˜¯è¦æŠŠä»»åŠ¡æ”¾åœ¨æ•°ç»„ä¸­ï¼Œä½†ä»»åŠ¡çš„å­˜æ”¾é¡ºåºæ— å…³ç´§è¦ã€‚æ¯ä¸ªä»»åŠ¡éƒ½åº”è¯¥è°ƒç”¨å¤„ç†å™¨å‡½æ•°å¢åŠ å·²å®Œæˆä»»åŠ¡çš„è®¡æ•°å€¼ã€‚å½“æ‰€æœ‰ä»»åŠ¡éƒ½å®Œæˆåï¼Œå¤„ç†å™¨å‡½æ•°åº”è¯¥æ‰§è¡Œåç»­é€»è¾‘ã€‚ è¿™é‡Œçš„ä¾‹å­å°±åšä¸€ä¸ªç®€å•çš„ç¨‹åºï¼Œè¯»å–å‡ ä¸ªæ–‡æœ¬æ–‡ä»¶çš„å†…å®¹ï¼Œå¹¶è¾“å‡ºå•è¯åœ¨æ•´ä¸ªæ–‡ä»¶ä¸­å‡ºç°çš„æ¬¡æ•°ã€‚æˆ‘ä»¬ä¼šç”¨å¼‚æ­¥çš„readFileå‡½æ•°è¯»å–æ–‡æœ¬æ–‡ä»¶çš„å†…å®¹ï¼Œæ‰€ä»¥å‡ ä¸ªæ–‡ä»¶çš„è¯»å–å¯ä»¥å¹¶è¡Œæ‰§è¡Œã€‚ è¿™æ˜¯ç›®å½•ç»„æˆï¼š 1.txtï¼š 1do you love me 2.txtï¼š 1yes i do love you word_count.jsï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647const fs=require('fs');const tasks=[];const wordCounts=&#123;&#125;;const filesDir='../text';let completedTasks=0;function checkIfComplete()&#123; completedTasks++; if(completedTasks===tasks.length)&#123; for(let index in wordCounts)&#123; console.log(`$&#123;index&#125;:$&#123;wordCounts[index]&#125;`); &#125; &#125;&#125;function addWordCount(word)&#123; wordCounts[word]=(wordCounts[word])?wordCounts[word]+1:1;&#125;function countWordsInText(text)&#123; const words=text.toString().toLowerCase().split(/\\W+/).sort(); words.filter(word=&gt;word).forEach(word=&gt;addWordCount(word));&#125;fs.readdir(filesDir,(err,files)=&gt;&#123; if(err)&#123; throw err; &#125; files.forEach(file=&gt;&#123; //taskå‡½æ•°å£°æ˜ï¼Œæ˜¯ç«‹å³æ‰§è¡Œçš„ï¼Œè·å–filename const task=(file=&gt;&#123; return ()=&gt;&#123; fs.readFile(file,(err,text)=&gt;&#123; if(err)&#123; throw err; &#125; countWordsInText(text); checkIfComplete(); &#125;) &#125; &#125;)(`$&#123;filesDir&#125;/$&#123;file&#125;`); //å°†å½“å‰tast pushåˆ°tasksæ•°ç»„ä¸­ tasks.push(task); &#125;) //å¼€å§‹å¹¶è¡Œæ‰§è¡Œæ‰€æœ‰ä»»åŠ¡ tasks.forEach(task=&gt;task());&#125;) æ‰§è¡Œnode word_count.jsï¼š 123456do:2i:1love:2yes:1you:2me:1","categories":[{"name":"Node.js","slug":"Node-js","permalink":"http://delaprada.com/categories/Node-js/"}],"tags":[{"name":"Node.js","slug":"Node-js","permalink":"http://delaprada.com/tags/Node-js/"}]},{"title":"è™šæ‹ŸDOM","slug":"è™šæ‹ŸDOM","date":"2020-03-31T08:37:58.000Z","updated":"2020-03-31T09:24:54.000Z","comments":true,"path":"2020/03/31/è™šæ‹ŸDOM/","link":"","permalink":"http://delaprada.com/2020/03/31/%E8%99%9A%E6%8B%9FDOM/","excerpt":"","text":"æ˜¨å¤©é¢è¯•çš„æ—¶å€™ï¼Œé¢è¯•å®˜é—®åˆ°è™šæ‹ŸDOMçš„åŸç†ï¼Œè¢«é—®åˆ°çš„æ—¶å€™ï¼Œå°±æŠŠè‡ªå·±ä¹‹å‰çš„ç†è§£è¯´äº†ä¸€é€šï¼Œå› ä¸ºä¹‹å‰é¢è¯•çš„æ—¶å€™ä¹Ÿè¢«é—®åˆ°è¿‡ï¼Œè§‰å¾—åº”è¯¥æ²¡é—®é¢˜ã€‚åæ¥é¢è¯•å®˜è´¨é—®äº†ä¸€ä¸‹ï¼šâ€œè™šæ‹ŸDOMæœ€ç»ˆä¹Ÿæ˜¯ä½¿ç”¨DOM APIå»æ“ä½œDOMï¼Œå®ƒçš„æ€§èƒ½å°±ä¸€å®šä¼šæ›´å¥½ä¹ˆ ? â€ ç„¶åå°±æ‡µäº†â€¦.åæ¥åœ¨ç½‘ä¸Šæœäº†äº›èµ„æ–™ï¼Œåˆæœ‰äº†äº›æ–°çš„è§è§£ã€‚ è™šæ‹ŸDOMçš„å«ä¹‰è™šæ‹ŸDOMæ˜¯ä½¿ç”¨JSå»æ¨¡æ‹ŸçœŸå®çš„DOMã€‚DOMæ ‘ä¸Šçš„ç»“æ„ã€å±æ€§ä¿¡æ¯æˆ‘ä»¬éƒ½å¯ä»¥ä½¿ç”¨JavaScriptå¯¹è±¡è¡¨ç¤ºå‡ºæ¥ï¼š 1234567891011var element = &#123; tagName: 'ul', // èŠ‚ç‚¹æ ‡ç­¾å props: &#123; // DOMçš„å±æ€§ï¼Œç”¨ä¸€ä¸ªå¯¹è±¡å­˜å‚¨é”®å€¼å¯¹ id: 'list' &#125;, children: [ // è¯¥èŠ‚ç‚¹çš„å­èŠ‚ç‚¹ &#123;tagName: 'li', props: &#123;class: 'item'&#125;, children: [\"Item 1\"]&#125;, &#123;tagName: 'li', props: &#123;class: 'item'&#125;, children: [\"Item 2\"]&#125;, &#123;tagName: 'li', props: &#123;class: 'item'&#125;, children: [\"Item 3\"]&#125;, ]&#125; ä¸Šé¢å¯¹åº”çš„HTMLå†™æ³•æ˜¯ï¼š 12345&lt;ul id='list'&gt; &lt;li class='item'&gt;Item 1&lt;/li&gt; &lt;li class='item'&gt;Item 2&lt;/li&gt; &lt;li class='item'&gt;Item 3&lt;/li&gt;&lt;/ul&gt; æ—¢ç„¶åŸæ¥ DOM æ ‘çš„ä¿¡æ¯éƒ½å¯ä»¥ç”¨ JavaScript å¯¹è±¡æ¥è¡¨ç¤ºï¼Œåè¿‡æ¥ï¼Œä½ å°±å¯ä»¥æ ¹æ®è¿™ä¸ªç”¨ JavaScript å¯¹è±¡è¡¨ç¤ºçš„æ ‘ç»“æ„æ¥æ„å»ºä¸€æ£µçœŸæ­£çš„DOMæ ‘ã€‚ ç”¨JSæ“ä½œçœŸå®DOMçš„æ“ä½œï¼šçŠ¶æ€å˜æ›´-&gt;é‡æ–°æ¸²æŸ“æ•´ä¸ªè§†å›¾çš„æ–¹å¼ï¼Œå¯ä»¥ç¨å¾®ä¿®æ”¹ä¸€ä¸‹ï¼šç”¨ JavaScript å¯¹è±¡è¡¨ç¤º DOM ä¿¡æ¯å’Œç»“æ„ï¼Œå½“çŠ¶æ€å˜æ›´çš„æ—¶å€™ï¼Œé‡æ–°æ¸²æŸ“è¿™ä¸ª JavaScript çš„å¯¹è±¡ç»“æ„ã€‚å½“ç„¶è¿™æ ·åšå…¶å®æ²¡ä»€ä¹ˆåµç”¨ï¼Œå› ä¸ºçœŸæ­£çš„é¡µé¢å…¶å®æ²¡æœ‰æ”¹å˜ã€‚ ä½†æ˜¯å¯ä»¥ç”¨æ–°æ¸²æŸ“çš„å¯¹è±¡æ ‘å»å’Œæ—§çš„æ ‘è¿›è¡Œå¯¹æ¯”ï¼Œè®°å½•è¿™ä¸¤æ£µæ ‘å·®å¼‚ã€‚è®°å½•ä¸‹æ¥çš„ä¸åŒå°±æ˜¯æˆ‘ä»¬éœ€è¦å¯¹é¡µé¢çœŸæ­£çš„ DOM æ“ä½œï¼Œç„¶åæŠŠå®ƒä»¬åº”ç”¨åœ¨çœŸæ­£çš„ DOM æ ‘ä¸Šï¼Œé¡µé¢å°±å˜æ›´äº†ã€‚è¿™æ ·å°±å¯ä»¥åšåˆ°ï¼šè™šæ‹ŸDOMæ˜¯å±€éƒ¨æ›´æ–°çš„ã€‚è™½ç„¶è§†å›¾çš„ç»“æ„ç¡®å®æ˜¯æ•´ä¸ªå…¨æ–°æ¸²æŸ“äº†ï¼Œä½†æ˜¯æœ€åæ“ä½œDOMçš„æ—¶å€™ç¡®å®åªå˜æ›´æœ‰ä¸åŒçš„åœ°æ–¹ï¼Œå‡å°‘äº†ä¸å¿…è¦çš„è°ƒç”¨DOM APIå»æ“ä½œDOMçš„æ“ä½œã€‚ ç®—æ³•å®ç°æ­¥éª¤ä¸€ï¼šç”¨JSå¯¹è±¡æ¨¡æ‹ŸçœŸå®DOMç”¨ JavaScript æ¥è¡¨ç¤ºä¸€ä¸ª DOM èŠ‚ç‚¹æ˜¯å¾ˆç®€å•çš„äº‹æƒ…ï¼Œä½ åªéœ€è¦è®°å½•å®ƒçš„èŠ‚ç‚¹ç±»å‹ã€å±æ€§ï¼Œè¿˜æœ‰å­èŠ‚ç‚¹ï¼š element.js 123456789function Element (tagName, props, children) &#123; this.tagName = tagName this.props = props this.children = children&#125;module.exports = function (tagName, props, children) &#123; return new Element(tagName, props, children)&#125; ä¾‹å¦‚ä¸Šé¢çš„ DOM ç»“æ„å°±å¯ä»¥ç®€å•çš„è¡¨ç¤ºï¼š 1234567var el = require('./element') //æ¨¡å—åŒ–å¯¼å…¥Elementå‡½æ•°var ul = el('ul', &#123;id: 'list'&#125;, [ el('li', &#123;class: 'item'&#125;, ['Item 1']), el('li', &#123;class: 'item'&#125;, ['Item 2']), el('li', &#123;class: 'item'&#125;, ['Item 3'])]) ç°åœ¨ulåªæ˜¯ä¸€ä¸ª JavaScript å¯¹è±¡è¡¨ç¤ºçš„ DOM ç»“æ„ï¼Œé¡µé¢ä¸Šå¹¶æ²¡æœ‰è¿™ä¸ªç»“æ„ã€‚æˆ‘ä»¬å¯ä»¥æ ¹æ®è¿™ä¸ªulæ„å»ºçœŸæ­£çš„&lt;ul&gt;ï¼š 1234567891011121314151617181920Element.prototype.render = function () &#123; var el = document.createElement(this.tagName) // æ ¹æ®tagNameæ„å»º var props = this.props for (var propName in props) &#123; // è®¾ç½®èŠ‚ç‚¹çš„DOMå±æ€§ var propValue = props[propName] el.setAttribute(propName, propValue) &#125; var children = this.children || [] children.forEach(function (child) &#123; var childEl = (child instanceof Element) ? child.render() // å¦‚æœå­èŠ‚ç‚¹ä¹Ÿæ˜¯è™šæ‹ŸDOMï¼Œé€’å½’æ„å»ºDOMèŠ‚ç‚¹ : document.createTextNode(child) // å¦‚æœå­—ç¬¦ä¸²ï¼Œåªæ„å»ºæ–‡æœ¬èŠ‚ç‚¹ el.appendChild(childEl) &#125;) return el&#125; renderæ–¹æ³•ä¼šæ ¹æ®tagNameæ„å»ºä¸€ä¸ªçœŸæ­£çš„DOMèŠ‚ç‚¹ï¼Œç„¶åè®¾ç½®è¿™ä¸ªèŠ‚ç‚¹çš„å±æ€§ï¼Œæœ€åé€’å½’åœ°æŠŠè‡ªå·±çš„å­èŠ‚ç‚¹ä¹Ÿæ„å»ºèµ·æ¥ã€‚æ‰€ä»¥åªéœ€è¦ï¼š 12var ulRoot = ul.render()document.body.appendChild(ulRoot) ä¸Šé¢çš„ulRootæ˜¯çœŸæ­£çš„DOMèŠ‚ç‚¹ï¼ŒæŠŠå®ƒå¡å…¥æ–‡æ¡£ä¸­ï¼Œè¿™æ ·bodyé‡Œé¢å°±æœ‰äº†çœŸæ­£çš„&lt;ul&gt;çš„DOMç»“æ„ï¼š 12345&lt;ul id='list'&gt; &lt;li class='item'&gt;Item 1&lt;/li&gt; &lt;li class='item'&gt;Item 2&lt;/li&gt; &lt;li class='item'&gt;Item 3&lt;/li&gt;&lt;/ul&gt; æ­¥éª¤äºŒï¼šæ¯”è¾ƒä¸¤æ£µè™šæ‹ŸDOMæ ‘çš„å·®å¼‚å½“æˆ‘ä»¬è¦åšå‡ºä¿®æ”¹çš„æ—¶å€™ï¼Œé¦–å…ˆæ˜¯è¦åˆ›å»ºä¸€ä¸ªæ–°çš„ç»“ç‚¹ï¼Œç„¶åä½¿ç”¨diffç®—æ³•å»å¯¹æ¯”æ–°æ—§èŠ‚ç‚¹çš„ä¸åŒï¼Œè¿™ç§å¯¹æ¯”åªä¼šåœ¨åŒå±‚çº§è¿›è¡Œï¼Œä¸ä¼šè·¨å±‚è¿›è¡Œï¼Œæ­¤å¤„æ˜¯ä½¿ç”¨æ·±åº¦ä¼˜å…ˆéå†ç®—æ³•ï¼Œç„¶åå°†å·®å¼‚è®°å½•åœ¨patcheså¯¹è±¡å½“ä¸­ã€‚ åŒå±‚çº§æ¯”è¾ƒçš„è¯ç®—æ³•å¤æ‚åº¦æ›´ä½ï¼Œé™åˆ°O(n)ã€‚ æ·±åº¦ä¼˜å…ˆéå†ï¼Œè®°å½•å·®å¼‚ï¼š åœ¨å®é™…çš„ä»£ç ä¸­ï¼Œä¼šå¯¹æ–°æ—§ä¸¤æ£µæ ‘è¿›è¡Œä¸€ä¸ªæ·±åº¦ä¼˜å…ˆçš„éå†ï¼Œè¿™æ ·æ¯ä¸ªèŠ‚ç‚¹éƒ½ä¼šæœ‰ä¸€ä¸ªå”¯ä¸€çš„æ ‡è®°ï¼š åœ¨æ·±åº¦ä¼˜å…ˆéå†çš„æ—¶å€™ï¼Œæ¯éå†åˆ°ä¸€ä¸ªèŠ‚ç‚¹å°±æŠŠè¯¥èŠ‚ç‚¹å’Œæ–°çš„çš„æ ‘è¿›è¡Œå¯¹æ¯”ã€‚å¦‚æœæœ‰å·®å¼‚çš„è¯å°±è®°å½•åˆ°ä¸€ä¸ªå¯¹è±¡é‡Œé¢ã€‚ 1234567891011121314151617181920212223242526272829// diff å‡½æ•°ï¼Œå¯¹æ¯”ä¸¤æ£µæ ‘function diff (oldTree, newTree) &#123; var index = 0 // å½“å‰èŠ‚ç‚¹çš„æ ‡å¿— var patches = &#123;&#125; // ç”¨æ¥è®°å½•æ¯ä¸ªèŠ‚ç‚¹å·®å¼‚çš„å¯¹è±¡ dfsWalk(oldTree, newTree, index, patches) return patches&#125;// å¯¹ä¸¤æ£µæ ‘è¿›è¡Œæ·±åº¦ä¼˜å…ˆéå†function dfsWalk (oldNode, newNode, index, patches) &#123; // å¯¹æ¯”oldNodeå’ŒnewNodeçš„ä¸åŒï¼Œè®°å½•ä¸‹æ¥ patches[index] = [...] diffChildren(oldNode.children, newNode.children, index, patches)&#125;// éå†å­èŠ‚ç‚¹function diffChildren (oldChildren, newChildren, index, patches) &#123; var leftNode = null var currentNodeIndex = index oldChildren.forEach(function (child, i) &#123; var newChild = newChildren[i] currentNodeIndex = (leftNode &amp;&amp; leftNode.count) // è®¡ç®—èŠ‚ç‚¹çš„æ ‡è¯† ? currentNodeIndex + leftNode.count + 1 : currentNodeIndex + 1 dfsWalk(child, newChild, currentNodeIndex, patches) // æ·±åº¦éå†å­èŠ‚ç‚¹ leftNode = child &#125;)&#125; ä¾‹å¦‚ï¼Œä¸Šé¢çš„divå’Œæ–°çš„divæœ‰å·®å¼‚ï¼Œå½“å‰çš„æ ‡è®°æ˜¯0ï¼Œé‚£ä¹ˆï¼š 1patches[0] = [&#123;difference&#125;, &#123;difference&#125;, ...] // ç”¨æ•°ç»„å­˜å‚¨æ–°æ—§èŠ‚ç‚¹çš„ä¸åŒ åŒç†pæ˜¯patches[1]ï¼Œulæ˜¯patches[3]ï¼Œç±»æ¨ã€‚ å·®å¼‚ç±»å‹ï¼š ä¸Šé¢è¯´çš„èŠ‚ç‚¹çš„å·®å¼‚æŒ‡çš„æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿå¯¹ DOM æ“ä½œå¯èƒ½ä¼šï¼š æ›¿æ¢æ‰åŸæ¥çš„èŠ‚ç‚¹ï¼Œä¾‹å¦‚æŠŠä¸Šé¢çš„divæ¢æˆäº†section ç§»åŠ¨ã€åˆ é™¤ã€æ–°å¢å­èŠ‚ç‚¹ï¼Œä¾‹å¦‚ä¸Šé¢divçš„å­èŠ‚ç‚¹ï¼ŒæŠŠpå’Œulé¡ºåºäº’æ¢ ä¿®æ”¹äº†èŠ‚ç‚¹çš„å±æ€§ å¯¹äºæ–‡æœ¬èŠ‚ç‚¹ï¼Œæ–‡æœ¬å†…å®¹å¯èƒ½ä¼šæ”¹å˜ã€‚ä¾‹å¦‚ä¿®æ”¹ä¸Šé¢çš„æ–‡æœ¬èŠ‚ç‚¹2å†…å®¹ä¸ºVirtual DOM 2ã€‚ æ‰€ä»¥æˆ‘ä»¬å®šä¹‰äº†å‡ ç§å·®å¼‚ç±»å‹ï¼š 1234var REPLACE = 0var REORDER = 1var PROPS = 2var TEXT = 3 å¯¹äºèŠ‚ç‚¹æ›¿æ¢ï¼Œå¾ˆç®€å•ã€‚åˆ¤æ–­æ–°æ—§èŠ‚ç‚¹çš„tagNameå’Œæ˜¯ä¸æ˜¯ä¸€æ ·çš„ï¼Œå¦‚æœä¸ä¸€æ ·çš„è¯´æ˜éœ€è¦æ›¿æ¢æ‰ã€‚å¦‚divæ¢æˆsectionï¼Œå°±è®°å½•ä¸‹ï¼š 1234patches[0] = [&#123; type: REPALCE, node: newNode // el('section', props, children)&#125;] å¦‚æœç»™divæ–°å¢äº†å±æ€§idä¸ºcontainerï¼Œå°±è®°å½•ä¸‹ï¼š 123456789patches[0] &#x3D; [&#123; type: REPALCE, node: newNode &#x2F;&#x2F; el(&#39;section&#39;, props, children)&#125;, &#123; type: PROPS, props: &#123; id: &quot;container&quot; &#125;&#125;] å¦‚æœæ˜¯æ–‡æœ¬èŠ‚ç‚¹ï¼Œå¦‚ä¸Šé¢çš„æ–‡æœ¬èŠ‚ç‚¹2ï¼Œå°±è®°å½•ä¸‹ï¼š 1234patches[2] = [&#123; type: TEXT, content: \"Virtual DOM2\"&#125;] é‚£å¦‚æœæŠŠæˆ‘divçš„å­èŠ‚ç‚¹é‡æ–°æ’åºå‘¢ï¼Ÿä¾‹å¦‚p, ul, divçš„é¡ºåºæ¢æˆäº†div, p, ulã€‚è¿™ä¸ªè¯¥æ€ä¹ˆå¯¹æ¯”ï¼Ÿå¦‚æœæŒ‰ç…§åŒå±‚çº§è¿›è¡Œé¡ºåºå¯¹æ¯”çš„è¯ï¼Œå®ƒä»¬éƒ½ä¼šè¢«æ›¿æ¢æ‰ã€‚å¦‚på’Œdivçš„tagNameä¸åŒï¼Œpä¼šè¢«divæ‰€æ›¿ä»£ã€‚æœ€ç»ˆï¼Œä¸‰ä¸ªèŠ‚ç‚¹éƒ½ä¼šè¢«æ›¿æ¢ï¼Œè¿™æ ·DOMå¼€é”€å°±éå¸¸å¤§ã€‚è€Œå®é™…ä¸Šæ˜¯ä¸éœ€è¦æ›¿æ¢èŠ‚ç‚¹ï¼Œè€Œåªéœ€è¦ç»è¿‡èŠ‚ç‚¹ç§»åŠ¨å°±å¯ä»¥è¾¾åˆ°ï¼Œæˆ‘ä»¬åªéœ€çŸ¥é“æ€ä¹ˆè¿›è¡Œç§»åŠ¨ã€‚ è¿™å°±æ¶‰åŠåˆ°ä¸¤ä¸ªåˆ—è¡¨çš„å¯¹æ¯”ç®—æ³•ï¼Œå…¶å®å¯ä»¥æŠ½è±¡å‡ºæ¥æ˜¯æœ€å°ç¼–è¾‘è·ç¦»é—®é¢˜ï¼ˆåŠ¨æ€è§„åˆ’æ€æƒ³ï¼‰ã€‚ æˆ‘ä»¬èƒ½å¤Ÿè·å–åˆ°æŸä¸ªçˆ¶èŠ‚ç‚¹çš„å­èŠ‚ç‚¹çš„æ“ä½œï¼Œå°±å¯ä»¥è®°å½•ä¸‹æ¥ï¼š 1234patches[0] = [&#123; type: REORDER, moves: [&#123;remove or insert&#125;, &#123;remove or insert&#125;, ...]&#125;] æ­¥éª¤ä¸‰ï¼šæŠŠå·®å¼‚åº”ç”¨åˆ°çœŸæ­£çš„DOMæ ‘ä¸Šå› ä¸ºæ­¥éª¤ä¸€æ‰€æ„å»ºçš„ JavaScript å¯¹è±¡æ ‘å’Œrenderå‡ºæ¥çœŸæ­£çš„DOMæ ‘çš„ä¿¡æ¯ã€ç»“æ„æ˜¯ä¸€æ ·çš„ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¯¹é‚£æ£µDOMæ ‘ä¹Ÿè¿›è¡Œæ·±åº¦ä¼˜å…ˆçš„éå†ï¼Œéå†çš„æ—¶å€™ä»æ­¥éª¤äºŒç”Ÿæˆçš„patcheså¯¹è±¡ä¸­æ‰¾å‡ºå½“å‰éå†çš„èŠ‚ç‚¹å·®å¼‚ï¼Œç„¶åè¿›è¡Œ DOM æ“ä½œã€‚ ä½¿ç”¨patchæ–¹æ³•å°†å¯¹è±¡patcheså½“ä¸­è®°å½•çš„æ›´æ”¹åº”ç”¨åˆ°çœŸå®DOMä¸Šã€‚ 123456789101112131415161718192021function patch (node, patches) &#123; var walker = &#123;index: 0&#125; dfsWalk(node, walker, patches)&#125;function dfsWalk (node, walker, patches) &#123; var currentPatches = patches[walker.index] // ä»patchesæ‹¿å‡ºå½“å‰èŠ‚ç‚¹çš„å·®å¼‚ var len = node.childNodes ? node.childNodes.length : 0 for (var i = 0; i &lt; len; i++) &#123; // æ·±åº¦éå†å­èŠ‚ç‚¹ var child = node.childNodes[i] walker.index++ dfsWalk(child, walker, patches) &#125; if (currentPatches) &#123; applyPatches(node, currentPatches) // å¯¹å½“å‰èŠ‚ç‚¹è¿›è¡ŒDOMæ“ä½œ &#125;&#125; applyPatchesï¼Œæ ¹æ®ä¸åŒç±»å‹çš„å·®å¼‚å¯¹å½“å‰èŠ‚ç‚¹è¿›è¡Œ DOM æ“ä½œï¼š 1234567891011121314151617181920function applyPatches (node, currentPatches) &#123; currentPatches.forEach(function (currentPatch) &#123; switch (currentPatch.type) &#123; case REPLACE: node.parentNode.replaceChild(currentPatch.node.render(), node) break case REORDER: reorderChildren(node, currentPatch.moves) break case PROPS: setProps(node, currentPatch.props) break case TEXT: node.textContent = currentPatch.content break default: throw new Error('Unknown patch type ' + currentPatch.type) &#125; &#125;)&#125; æ€»ç»“è™šæ‹ŸDOMçš„ä¼˜ç¼ºç‚¹ä¼˜ç‚¹ï¼š å¾ˆå¤š DOM API çš„è¯»å†™éƒ½æ¶‰åŠé¡µé¢å¸ƒå±€çš„â€œé‡æ–°è®¡ç®—â€ï¼Œä»¥ç¡®ä¿è¿”å›å€¼çš„å‡†ç¡®ï¼Œæ¶‰åŠæ ·å¼ã€ç»“æ„çš„è¿˜ä¼šè§¦å‘é¡µé¢â€œé‡æ–°ç»˜åˆ¶â€ï¼Œæ›´è€—æ€§èƒ½ã€‚ ç»¼ä¸Šï¼Œå•æ¬¡ DOM API è°ƒç”¨æ€§èƒ½å°±ä¸å¤Ÿå¥½ï¼Œé¢‘ç¹è°ƒç”¨å°±ä¼šè¿…é€Ÿç§¯ç´¯ä¸Šè¿°æŸè€—ï¼Œå¯¼è‡´ DOM å¼•æ“å ç”¨ä¸»çº¿ç¨‹è¿‡ä¹…ï¼Œç”¨æˆ·æ“ä½œä¸èƒ½åŠæ—¶è§¦å‘ JS äº‹ä»¶å›è°ƒï¼Œè®©ç”¨æˆ·æ„Ÿè§‰å¡é¡¿ã€‚ è™šæ‹ŸDOMå®é™…ä¸Šæœ€ç»ˆè¿˜æ˜¯ä¼šè°ƒç”¨DOM APIï¼Œä½†å®ƒèƒ½å¤Ÿå‡å°‘ä¸å¿…è¦çš„DOM APIè°ƒç”¨ã€‚è™šæ‹ŸDOMéµå¾ªâ€œåœ¨JSä¸­ç¼“å­˜å¿…è¦æ•°æ®ï¼Œè®¡ç®—ç•Œé¢æ›´æ–°æ—¶çš„é˜¶æ®µæ•°æ®å·®å¼‚ï¼Œåªæäº¤æœ€ç»ˆå·®é›†â€çš„åŸºæœ¬æ€è·¯ã€‚ ç¼ºç‚¹ï¼š ä½¿ç”¨JSå»æ¨¡æ‹ŸçœŸå®DOMï¼Œä¼šå ç”¨ä¸€å®šå†…å­˜ diffç®—æ³•ï¼Œæœ‰è®¡ç®—æ–¹é¢çš„é¢å¤–å¼€é”€ å‚è€ƒï¼š [https://www.zhihu.com/search?type=content&amp;q=%E8%99%9A%E6%8B%9Fdom](https://www.zhihu.com/search?type=content&amp;q=è™šæ‹Ÿdom)","categories":[{"name":"Vue","slug":"Vue","permalink":"http://delaprada.com/categories/Vue/"}],"tags":[{"name":"Vue","slug":"Vue","permalink":"http://delaprada.com/tags/Vue/"}]},{"title":"ä½¿ç”¨JSONPå®ç°è·¨åŸŸ","slug":"ä½¿ç”¨JSONPå®ç°è·¨åŸŸ","date":"2020-03-29T07:23:53.000Z","updated":"2020-03-30T07:11:38.000Z","comments":true,"path":"2020/03/29/ä½¿ç”¨JSONPå®ç°è·¨åŸŸ/","link":"","permalink":"http://delaprada.com/2020/03/29/%E4%BD%BF%E7%94%A8JSONP%E5%AE%9E%E7%8E%B0%E8%B7%A8%E5%9F%9F/","excerpt":"","text":"åŒæºç­–ç•¥ åŒæºç­–ç•¥æ˜¯æµè§ˆå™¨çš„ä¸€ä¸ªå®‰å…¨åŠŸèƒ½ åŒæºæŒ‡çš„æ˜¯ï¼šåè®®ï¼ŒåŸŸåï¼Œç«¯å£å·éƒ½ç›¸åŒ åŒæºç­–ç•¥è§„å®šï¼šä¸åŒæºçš„å®¢æˆ·ç«¯è„šæœ¬ï¼ˆåœ¨æ²¡æœ‰æ˜ç¡®æˆæƒçš„æƒ…å†µä¸‹ï¼‰ä¸èƒ½è¯»å†™å¯¹æ–¹çš„èµ„æº åŒæºç­–ç•¥é™åˆ¶çš„å†…å®¹æœ‰ï¼š cookieã€localStorageç­‰å­˜å‚¨æ€§å†…å®¹ DOMèŠ‚ç‚¹ AJAXè¯·æ±‚å‘é€åï¼ŒéåŒæºä¼šè¢«æµè§ˆå™¨æ‹¦æˆª ä½†æ˜¯æœ‰ä¸‰ä¸ªæ ‡ç­¾æ—¶å…è®¸è·¨åŸŸåŠ è½½èµ„æºçš„ï¼š &lt;img src=XXX&gt; &lt;link href=XXX&gt; &lt;script src=XXX&gt; è¿™å°±æ˜¯JSONPçš„æ¥æº JSONPå®ç°è·¨åŸŸåŸºæœ¬æ€æƒ³ï¼šç½‘é¡µé€šè¿‡æ·»åŠ ä¸€ä¸ª&lt;script&gt;å…ƒç´ ï¼ˆå› ä¸ºsrcå±æ€§ï¼‰ï¼Œå‘æœåŠ¡å™¨è¯·æ±‚jsonæ•°æ®ï¼Œè¿™ç§åšæ³•ä¸å—åŒæºç­–ç•¥é™åˆ¶ï¼›æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚åï¼Œå°†æ•°æ®æ”¾åœ¨ä¸€ä¸ªæŒ‡å®šåå­—çš„å›è°ƒå‡½æ•°é‡Œä¼ å›æ¥ã€‚ä½†åªæ”¯æŒGETè¯·æ±‚ã€‚ å®è·µä»£ç ï¼š åˆ›å»ºä¸€ä¸ªJSONPæ–‡ä»¶å¤¹ï¼Œåœ¨å…¶ä¸­æ·»åŠ template.htmlä»¥åŠserver.jsã€‚ template.html 123456789101112131415161718192021222324252627282930313233343536373839&lt;!doctype html&gt;&lt;html lang=\"en\"&gt;&lt;head&gt; &lt;meta charset=\"UTF-8\"&gt; &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;p&gt;jsonp testing&lt;/p&gt;&lt;/body&gt;&lt;script&gt; function jsonp(&#123;url,params,callback&#125;)&#123; return new Promise((resolve,reject)=&gt;&#123; let script=document.createElement('script'); params=JSON.parse(JSON.stringify(params)); let arrs=[]; for(let key in params)&#123; arrs.push(`$&#123;key&#125;=$&#123;params[key]&#125;`); &#125; arrs.push(`callback=$&#123;callback&#125;`); script.src=`$&#123;url&#125;?$&#123;arrs.join('&amp;')&#125;`; document.body.appendChild(script); window[callback]=function(data)&#123; resolve(data); document.body.removeChild(script); &#125; &#125;) &#125; jsonp(&#123; url:'http://localhost:3000/say', params:&#123; wd:'I love you' &#125;, callback:'show' &#125;).then(data=&gt;&#123; console.log(data); &#125;)&lt;/script&gt;&lt;/html&gt; server.js 123456789101112131415161718var express = require('express');var router = express.Router();var app = express();router.get('/say',function(req,res,next) &#123; //è¦å“åº”å›å»çš„æ•°æ® let data = &#123; username : 'zs', password : 123456 &#125; let &#123;wd , callback&#125; = req.query; console.log(wd); console.log(callback); // è°ƒç”¨å›è°ƒå‡½æ•° , å¹¶å“åº” res.end(`$&#123;callback&#125;($&#123;JSON.stringify(data)&#125;)`);&#125;)app.use(router);app.listen(3000); ä¸Šè¿°ä»£ç å®ç°çš„å°±æ˜¯æˆ‘ä»¬çš„htmlæ–‡æ¡£ï¼Œä½¿ç”¨jsonpæ–¹æ³•å‘http://localhost:3000/sayå‘èµ·è¯·æ±‚ã€‚å½“æœåŠ¡å™¨ç›‘å¬åˆ°è¯·æ±‚ä¹‹åï¼Œå°†å“åº”çš„æ•°æ®æ”¾åœ¨æŒ‡å®šåå­—çš„å›è°ƒå‡½æ•°ä¸­ä¼ å›æ¥ï¼Œç„¶åè°ƒç”¨callbackå›è°ƒå‡½æ•°æ‰§è¡Œresolve(data)ã€‚å› ä¸ºjsonpå‡½æ•°è¿”å›çš„æ˜¯ä¸€ä¸ªPromiseå¯¹è±¡ï¼Œæ‰€ä»¥ä¹‹åå¯ä»¥è°ƒç”¨.thenæ‰§è¡Œåç»­çš„console.logæ“ä½œã€‚ ç»“æœï¼š å¦‚æœæ˜¯AJAXè¯·æ±‚ï¼š 12345678var xhr=new XMLHttpRequest();xhr.onReadyStateChange=function()&#123; if(xhr.readyState==4&amp;&amp;xhr.status==200)&#123; alert(xhr.responseText); &#125;&#125;xhr.open('get','http://localhost:3000/say',true);xhr.send(); å°±ä¼šæŠ¥è·¨åŸŸçš„é”™è¯¯ï¼š","categories":[{"name":"æµè§ˆå™¨","slug":"æµè§ˆå™¨","permalink":"http://delaprada.com/categories/%E6%B5%8F%E8%A7%88%E5%99%A8/"}],"tags":[{"name":"æµè§ˆå™¨","slug":"æµè§ˆå™¨","permalink":"http://delaprada.com/tags/%E6%B5%8F%E8%A7%88%E5%99%A8/"}]},{"title":"ä¹±åºæ•°ç»„çš„ä¸‰ç§æ–¹æ³•","slug":"ä¹±åºæ•°ç»„çš„ä¸‰ç§æ–¹æ³•","date":"2020-03-28T05:27:18.000Z","updated":"2020-03-30T01:50:00.000Z","comments":true,"path":"2020/03/28/ä¹±åºæ•°ç»„çš„ä¸‰ç§æ–¹æ³•/","link":"","permalink":"http://delaprada.com/2020/03/28/%E4%B9%B1%E5%BA%8F%E6%95%B0%E7%BB%84%E7%9A%84%E4%B8%89%E7%A7%8D%E6%96%B9%E6%B3%95/","excerpt":"","text":"ä»Šå¤©é¢è¯•çš„æ—¶å€™è¢«é—®åˆ°å®ç°ä¹±åºæ•°ç»„çš„æœ€ç®€ä¾¿çš„æ–¹æ³•ï¼Œè‡ªå·±åªçŸ¥é“ä½¿ç”¨Math.random()å’Œç»“æœæ•°ç»„çš„ç¬¨æ–¹æ³•â€¦æ€»ç»“ä¸€ä¸‹ã€‚ sort()æ–¹æ³•æ•°ç»„çš„sort()æ–¹æ³•æ˜¯æŒ‰ç…§returnçš„å€¼çš„æ­£è´Ÿæ¥å»åšæ’åºåˆ¤å®šï¼Œæ‰€ä»¥å®ç°çš„æ€è·¯å¯ä»¥æ˜¯ä½¿å¾—è¿”å›çš„å€¼éšæœºæ­£è´Ÿã€‚ 12345function randArr(arr)&#123; return arr.sort(()=&gt;&#123; return (Math.random()-0.5); &#125;)&#125; Math.random()æ˜¯ç”Ÿæˆ0.0ï¼ˆåŒ…å«ï¼‰~1.0ï¼ˆä¸åŒ…å«ï¼‰ä¹‹é—´çš„éšæœºæ•°ã€‚ ä½†è¿™ä¹ˆåšæ˜¯ä¸€ä¸ªä¼ªæ’åºã€‚å‚è€ƒï¼šhttps://zhuanlan.zhihu.com/p/33260052 æœ‰å¤§ç¥åšè¿‡æµ‹è¯•ï¼Œè¿›è¡Œ10000æ¬¡ä¹±åºæ“ä½œåï¼Œå…ƒç´ å¤§æ¦‚ç‡åœç•™åœ¨è‡ªå·±çš„åˆå§‹ä½ç½®ä¸Šã€‚ æ´—ç‰Œç®—æ³•æ€è·¯æ˜¯ï¼š æ‰¾åˆ°æ•°ç»„çš„æœ€åä¸€ä¸ªå…ƒç´  ä»æ•°ç»„å¼€å¤´åˆ°æœ€åä¸€ä¸ªå…ƒç´ ä¹‹é—´ï¼Œæ‰¾åˆ°éšæœºçš„ä¸€ä¸ªæ•° äº¤æ¢ä¸¤ä¸ªå…ƒç´ çš„ä½ç½® æ­¤æ—¶æœ€åä¸€ä¸ªå…ƒç´ å·²ç»æ˜¯ä¹±åºåçš„ç»“æœ æŒ‡å‘æœ€åä¸€ä¸ªå…ƒç´ çš„ç´¢å¼•å‰ç§» ç›´åˆ°æŒ‡å‘ç´¢å¼•ä¸º0 1234567891011//æ´—ç‰Œç®—æ³•function randArr3(arr)&#123; var length=arr.length; var r=length; var rand=0; while(r)&#123; rand=Math.floor(Math.random()*(r--)); [arr[r],arr[rand]]=[arr[rand],arr[r]]; &#125; return arr;&#125; Math.random()+ç»“æœæ•°ç»„12345678910function randArr2(arr)&#123; var res=[]; var len=arr.length; for(var i=0;i&lt;len;++i)&#123; var index=Math.floor(Math.random()*arr.length); res.push(arr[index]); arr.splice(index,1); &#125; return res;&#125;","categories":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://delaprada.com/categories/JavaScript/"}],"tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://delaprada.com/tags/JavaScript/"}]},{"title":"æ¯æ—¥ä¸€é¢˜â€”â€”å•è¯çš„å‹ç¼©ç¼–ç ","slug":"æ¯æ—¥ä¸€é¢˜â€”â€”å•è¯çš„å‹ç¼©ç¼–ç ","date":"2020-03-28T01:18:31.000Z","updated":"2020-03-28T01:25:54.000Z","comments":true,"path":"2020/03/28/æ¯æ—¥ä¸€é¢˜â€”â€”å•è¯çš„å‹ç¼©ç¼–ç /","link":"","permalink":"http://delaprada.com/2020/03/28/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98%E2%80%94%E2%80%94%E5%8D%95%E8%AF%8D%E7%9A%84%E5%8E%8B%E7%BC%A9%E7%BC%96%E7%A0%81/","excerpt":"","text":"å•è¯çš„å‹ç¼©ç¼–ç ç»™å®šä¸€ä¸ªå•è¯åˆ—è¡¨ï¼Œæˆ‘ä»¬å°†è¿™ä¸ªåˆ—è¡¨ç¼–ç æˆä¸€ä¸ªç´¢å¼•å­—ç¬¦ä¸² S ä¸ä¸€ä¸ªç´¢å¼•åˆ—è¡¨ Aã€‚ ä¾‹å¦‚ï¼Œå¦‚æœè¿™ä¸ªåˆ—è¡¨æ˜¯ [â€œtimeâ€, â€œmeâ€, â€œbellâ€]ï¼Œæˆ‘ä»¬å°±å¯ä»¥å°†å…¶è¡¨ç¤ºä¸º S = â€œtime#bell#â€ å’Œ indexes = [0, 2, 5]ã€‚ å¯¹äºæ¯ä¸€ä¸ªç´¢å¼•ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä»å­—ç¬¦ä¸² S ä¸­ç´¢å¼•çš„ä½ç½®å¼€å§‹è¯»å–å­—ç¬¦ä¸²ï¼Œç›´åˆ° â€œ#â€ ç»“æŸï¼Œæ¥æ¢å¤æˆ‘ä»¬ä¹‹å‰çš„å•è¯åˆ—è¡¨ã€‚ é‚£ä¹ˆæˆåŠŸå¯¹ç»™å®šå•è¯åˆ—è¡¨è¿›è¡Œç¼–ç çš„æœ€å°å­—ç¬¦ä¸²é•¿åº¦æ˜¯å¤šå°‘å‘¢ï¼Ÿ ç¤ºä¾‹ï¼š 123è¾“å…¥: words &#x3D; [&quot;time&quot;, &quot;me&quot;, &quot;bell&quot;]è¾“å‡º: 10è¯´æ˜: S &#x3D; &quot;time#bell#&quot; ï¼Œ indexes &#x3D; [0, 2, 5] ã€‚ æç¤ºï¼š 1231 &lt;&#x3D; words.length &lt;&#x3D; 20001 &lt;&#x3D; words[i].length &lt;&#x3D; 7æ¯ä¸ªå•è¯éƒ½æ˜¯å°å†™å­—æ¯ ã€‚ æ€è·¯ï¼š é¦–å…ˆè¦å…ˆè¯»æ‡‚é¢˜æ„ï¼Œå¦‚æœæ˜¯å•è¯ä¹‹é—´çš„è¦†ç›–ï¼Œåªèƒ½æ˜¯åç¼€è¦†ç›–ï¼Œè€Œä¸èƒ½æ˜¯ä¸­é—´è¦†ç›–ï¼›å…¶æ¬¡ï¼Œä¸ä¸€å®šæ˜¯ç›¸é‚»çš„å•è¯ä¹‹é—´ä¼šå‡ºç°è¦†ç›–ï¼Œæœ‰å¯èƒ½åƒ[&quot;time&quot;, &quot;me&quot;, &quot;bell&quot;, &quot;atime&quot;]è·¨ç€æ¥è¦†ç›–ã€‚ æ‰€ä»¥æˆ‘ä»¬å…ˆæŒ‰å•è¯çš„é•¿åº¦è¿›è¡Œé™åºæ’åˆ—ï¼Œè¿™æ ·å…ˆå°†æœ€å¤§çš„æ·»åŠ åˆ°ç»“æœå­—ç¬¦ä¸²ä¸­ï¼Œåç»­åˆ¤æ–­è¾ƒå°çš„å•è¯åªéœ€è¦ä½¿ç”¨indexOfæ–¹æ³•ï¼Œå°±èƒ½å¤Ÿåˆ¤æ–­æ˜¯å¦åœ¨ç»“æœå­—ç¬¦ä¸²ä¸­ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå•è¯ä¹‹é—´çš„è¦†ç›–åªèƒ½æ˜¯åç¼€è¦†ç›–ï¼Œæ‰€ä»¥ä½¿ç”¨indexOfåˆ¤æ–­çš„æ—¶å€™è¦åŠ ä¸Šâ€œ#â€ã€‚ é¢˜è§£ï¼š 123456789101112131415161718/** * @param &#123;string[]&#125; words * @return &#123;number&#125; */var minimumLengthEncoding = function(words) &#123; words.sort(function(a,b)&#123; return b.length-a.length; &#125;) var res=\"\"; res+=words[0]+\"#\"; for(var i=1;i&lt;words.length;++i)&#123; //åŠ ä¸Š#å·å°±æ§åˆ¶å¿…é¡»æ˜¯åç¼€éƒ¨åˆ† if(res.indexOf(words[i]+\"#\")===-1)&#123; res+=words[i]+\"#\"; &#125; &#125; return res.length;&#125;;","categories":[{"name":"æ¯æ—¥ä¸€é¢˜","slug":"æ¯æ—¥ä¸€é¢˜","permalink":"http://delaprada.com/categories/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98/"}],"tags":[{"name":"æ¯æ—¥ä¸€é¢˜","slug":"æ¯æ—¥ä¸€é¢˜","permalink":"http://delaprada.com/tags/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98/"}]},{"title":"æ¯æ—¥ä¸€é¢˜â€”â€”åˆå¹¶åŒºé—´","slug":"æ¯æ—¥ä¸€é¢˜â€”â€”åˆå¹¶åŒºé—´","date":"2020-03-26T07:16:28.000Z","updated":"2020-03-26T07:23:00.000Z","comments":true,"path":"2020/03/26/æ¯æ—¥ä¸€é¢˜â€”â€”åˆå¹¶åŒºé—´/","link":"","permalink":"http://delaprada.com/2020/03/26/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98%E2%80%94%E2%80%94%E5%90%88%E5%B9%B6%E5%8C%BA%E9%97%B4/","excerpt":"","text":"åˆå¹¶åŒºé—´ç»™å‡ºä¸€ä¸ªåŒºé—´çš„é›†åˆï¼Œè¯·åˆå¹¶æ‰€æœ‰é‡å çš„åŒºé—´ã€‚ ç¤ºä¾‹ 1: 123è¾“å…¥: [[1,3],[2,6],[8,10],[15,18]]è¾“å‡º: [[1,6],[8,10],[15,18]]è§£é‡Š: åŒºé—´ [1,3] å’Œ [2,6] é‡å , å°†å®ƒä»¬åˆå¹¶ä¸º [1,6]. ç¤ºä¾‹ 2: 123è¾“å…¥: [[1,4],[4,5]]è¾“å‡º: [[1,5]]è§£é‡Š: åŒºé—´ [1,4] å’Œ [4,5] å¯è¢«è§†ä¸ºé‡å åŒºé—´ã€‚ æ€è·¯ï¼š å°†æ¯ä¸ªåŒºé—´çš„ç¬¬ä¸€ä¸ªæ•°å­—æ”¾å…¥startæ•°ç»„ä¸­ï¼Œå°†æ¯ä¸ªåŒºé—´çš„ç¬¬äºŒä¸ªæ•°å­—æ”¾å…¥endæ•°ç»„ä¸­ï¼Œå¯¹startæ•°ç»„å’Œendæ•°ç»„è¿›è¡Œæ’åºã€‚åˆ¤æ–­start[i+1]å’Œend[i]çš„å¤§å°ï¼Œå¦‚æœå‰è€…å°ï¼Œåˆ™è¯´æ˜åŒºé—´æœ‰è¦†ç›–ï¼Œi++ï¼›å¦‚æœå‰è€…å¤§ï¼Œè¯´æ˜åŒºé—´æ²¡æœ‰è¦†ç›–ï¼Œå¯ä»¥å°†è¿™ä¸ªç»“æœpushè¿›ç»“æœæ•°ç»„resä¸­ï¼ŒåŒæ—¶j=i+1ï¼ˆjæœ€å¼€å§‹ä¸º0ï¼‰ã€‚ é¢˜è§£ï¼š 123456789101112131415161718192021222324252627282930/** * @param &#123;number[][]&#125; intervals * @return &#123;number[][]&#125; */var merge = function(intervals) &#123; var start=[]; var end=[]; var res=[]; for(var i=0;i&lt;intervals.length;++i)&#123; start.push(intervals[i][0]); end.push(intervals[i][1]); &#125; start.sort(function(a,b)&#123; return a-b; &#125;) end.sort(function(a,b)&#123; return a-b; &#125;) for(var n=0,m=0;n&lt;intervals.length;++n)&#123; if(n==intervals.length-1||start[n+1]&gt;end[n])&#123; res.push([start[m],end[n]]); m=n+1; &#125; &#125; return res;&#125;;","categories":[{"name":"æ¯æ—¥ä¸€é¢˜","slug":"æ¯æ—¥ä¸€é¢˜","permalink":"http://delaprada.com/categories/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98/"}],"tags":[{"name":"æ¯æ—¥ä¸€é¢˜","slug":"æ¯æ—¥ä¸€é¢˜","permalink":"http://delaprada.com/tags/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98/"}]},{"title":"æ¯æ—¥ä¸€é¢˜â€”â€”ç¼–è¾‘è·ç¦»","slug":"æ¯æ—¥ä¸€é¢˜â€”â€”ç¼–è¾‘è·ç¦»","date":"2020-03-25T02:15:59.000Z","updated":"2020-03-25T02:44:34.000Z","comments":true,"path":"2020/03/25/æ¯æ—¥ä¸€é¢˜â€”â€”ç¼–è¾‘è·ç¦»/","link":"","permalink":"http://delaprada.com/2020/03/25/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98%E2%80%94%E2%80%94%E7%BC%96%E8%BE%91%E8%B7%9D%E7%A6%BB/","excerpt":"","text":"ç¼–è¾‘è·ç¦»ç»™å®šä¸¤ä¸ªå•è¯ word1 å’Œ word2ï¼Œè®¡ç®—å‡ºå°† word1 è½¬æ¢æˆ word2 æ‰€ä½¿ç”¨çš„æœ€å°‘æ“ä½œæ•° ã€‚ ä½ å¯ä»¥å¯¹ä¸€ä¸ªå•è¯è¿›è¡Œå¦‚ä¸‹ä¸‰ç§æ“ä½œï¼š æ’å…¥ä¸€ä¸ªå­—ç¬¦åˆ é™¤ä¸€ä¸ªå­—ç¬¦æ›¿æ¢ä¸€ä¸ªå­—ç¬¦ ç¤ºä¾‹ 1: 123456è¾“å…¥: word1 &#x3D; &quot;horse&quot;, word2 &#x3D; &quot;ros&quot;è¾“å‡º: 3è§£é‡Š: horse -&gt; rorse (å°† &#39;h&#39; æ›¿æ¢ä¸º &#39;r&#39;)rorse -&gt; rose (åˆ é™¤ &#39;r&#39;)rose -&gt; ros (åˆ é™¤ &#39;e&#39;) ç¤ºä¾‹ 2: 12345678è¾“å…¥: word1 &#x3D; &quot;intention&quot;, word2 &#x3D; &quot;execution&quot;è¾“å‡º: 5è§£é‡Š: intention -&gt; inention (åˆ é™¤ &#39;t&#39;)inention -&gt; enention (å°† &#39;i&#39; æ›¿æ¢ä¸º &#39;e&#39;)enention -&gt; exention (å°† &#39;n&#39; æ›¿æ¢ä¸º &#39;x&#39;)exention -&gt; exection (å°† &#39;n&#39; æ›¿æ¢ä¸º &#39;c&#39;)exection -&gt; execution (æ’å…¥ &#39;u&#39;) æ€è·¯ï¼š åŠ¨æ€è§„åˆ’çš„æ€æƒ³ã€‚ å¦‚æœword1[i]===word2[j]ï¼Œdp[i][j]=dp[i-1][j-1]ï¼Œä¹Ÿå°±æ˜¯è¯´word1çš„ç¬¬iä¸ªå•è¯å’Œword2çš„ç¬¬jä¸ªå•è¯ç›¸åŒçš„è¯ï¼Œé‚£word1å‰iä¸ªå•è¯è¦å˜ä¸ºword2å‰jä¸ªå•è¯çš„ç¼–è¾‘æ¬¡æ•°å°±ä¼šç­‰äºword1å‰i-1å’Œå•è¯å˜ä¸ºword2å‰j-1ä¸ªå•è¯çš„ç¼–è¾‘æ¬¡æ•°ã€‚ å¦‚æœword1[i]!=word2[j]ï¼Œé‚£dp[i][j]=Math.min(dp[i-1][j-1],dp[i-1][j],dp[i][j-1])+1 dp[i-1][j-1]è¡¨ç¤ºæ›¿æ¢æ“ä½œï¼Œä¹Ÿå°±æ˜¯å°†word1[i]æ›¿æ¢ä¸ºword2[j]ï¼Œé‚£dp[i][j]å°±ç­‰äºdp[i-1][j-1]+1ï¼Œä¹Ÿå°±æ˜¯å°†word1å‰i-1ä¸ªå•è¯å˜ä¸ºword2å‰j-1ä¸ªå•è¯æ‰€è¦æ‰§è¡Œçš„ç¼–è¾‘æ¬¡æ•°+1ï¼ˆä¸€æ¬¡æ›¿æ¢æ“ä½œï¼‰ã€‚ dp[i-1][j]è¡¨ç¤ºåˆ é™¤æ“ä½œï¼Œå°±æ˜¯å°†word1å‰i-1ä¸ªå­—ç¬¦å˜ä¸ºword2å‰jä¸ªå­—ç¬¦æ‰€è¦æ‰§è¡Œçš„æ“ä½œ+1ï¼ˆä¸€æ¬¡åˆ é™¤æ“ä½œï¼Œå³å°†word1çš„ç¬¬iä¸ªå­—ç¬¦åˆ æ‰ï¼‰ dp[i][j-1]è¡¨ç¤ºæ’å…¥æ“ä½œï¼Œå°±æ˜¯å°†word1å‰iä¸ªå­—ç¬¦å˜ä¸ºword2å‰j-1ä¸ªå­—ç¬¦æ‰€è¦æ‰§è¡Œçš„æ“ä½œ+1ï¼ˆä¸€æ¬¡æ’å…¥æ“ä½œï¼Œåœ¨word1æ’å…¥ä¸€ä¸ªå’Œword2ç¬¬jä¸ªå­—ç¬¦ä¸€æ ·çš„å­—ç¬¦ï¼‰ é¢˜è§£ï¼š 12345678910111213141516171819202122232425262728293031/** * @param &#123;string&#125; word1 * @param &#123;string&#125; word2 * @return &#123;number&#125; */var minDistance = function(word1, word2) &#123; var dp=[]; var len1=word1.length; var len2=word2.length; for(var i=0;i&lt;=len1;++i)&#123; dp[i]=new Array(); &#125; for(var j=0;j&lt;=len1;++j)&#123; dp[j][0]=j; &#125; for(var k=0;k&lt;=len2;++k)&#123; dp[0][k]=k; &#125; for(var n=1;n&lt;=len1;++n)&#123; for(var m=1;m&lt;=len2;++m)&#123; //è¿™é‡Œè¡¨ç¤ºçš„æ˜¯word1[n]==word2[m],ä½†æ˜¯å› ä¸ºnå’Œmæ˜¯ä»1å¼€å§‹å–çš„,æ‰€ä»¥æ¯”è¾ƒçš„æ—¶å€™è¦-1 if(word1[n-1]==word2[m-1])&#123; dp[n][m]=dp[n-1][m-1]; &#125; else&#123; dp[n][m]=Math.min(dp[n-1][m-1],dp[n][m-1],dp[n-1][m])+1; &#125; &#125; &#125; return dp[len1][len2];&#125;;","categories":[{"name":"æ¯æ—¥ä¸€é¢˜","slug":"æ¯æ—¥ä¸€é¢˜","permalink":"http://delaprada.com/categories/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98/"}],"tags":[{"name":"æ¯æ—¥ä¸€é¢˜","slug":"æ¯æ—¥ä¸€é¢˜","permalink":"http://delaprada.com/tags/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98/"}]},{"title":"æ¯æ—¥ä¸€é¢˜â€”â€”æŒ‰æ‘©å¸ˆ","slug":"æ¯æ—¥ä¸€é¢˜â€”â€”æŒ‰æ‘©å¸ˆ","date":"2020-03-24T08:57:23.000Z","updated":"2020-03-24T08:58:22.000Z","comments":true,"path":"2020/03/24/æ¯æ—¥ä¸€é¢˜â€”â€”æŒ‰æ‘©å¸ˆ/","link":"","permalink":"http://delaprada.com/2020/03/24/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98%E2%80%94%E2%80%94%E6%8C%89%E6%91%A9%E5%B8%88/","excerpt":"","text":"é¢è¯•é¢˜ 17.16. æŒ‰æ‘©å¸ˆä¸€ä¸ªæœ‰åçš„æŒ‰æ‘©å¸ˆä¼šæ”¶åˆ°æºæºä¸æ–­çš„é¢„çº¦è¯·æ±‚ï¼Œæ¯ä¸ªé¢„çº¦éƒ½å¯ä»¥é€‰æ‹©æ¥æˆ–ä¸æ¥ã€‚åœ¨æ¯æ¬¡é¢„çº¦æœåŠ¡ä¹‹é—´è¦æœ‰ä¼‘æ¯æ—¶é—´ï¼Œå› æ­¤å¥¹ä¸èƒ½æ¥å—ç›¸é‚»çš„é¢„çº¦ã€‚ç»™å®šä¸€ä¸ªé¢„çº¦è¯·æ±‚åºåˆ—ï¼Œæ›¿æŒ‰æ‘©å¸ˆæ‰¾åˆ°æœ€ä¼˜çš„é¢„çº¦é›†åˆï¼ˆæ€»é¢„çº¦æ—¶é—´æœ€é•¿ï¼‰ï¼Œè¿”å›æ€»çš„åˆ†é’Ÿæ•°ã€‚ æ³¨æ„ï¼šæœ¬é¢˜ç›¸å¯¹åŸé¢˜ç¨ä½œæ”¹åŠ¨ ç¤ºä¾‹ 1ï¼š 123è¾“å…¥ï¼š [1,2,3,1]è¾“å‡ºï¼š 4è§£é‡Šï¼š é€‰æ‹© 1 å·é¢„çº¦å’Œ 3 å·é¢„çº¦ï¼Œæ€»æ—¶é•¿ &#x3D; 1 + 3 &#x3D; 4ã€‚ ç¤ºä¾‹ 2ï¼š 123è¾“å…¥ï¼š [2,7,9,3,1]è¾“å‡ºï¼š 12è§£é‡Šï¼š é€‰æ‹© 1 å·é¢„çº¦ã€ 3 å·é¢„çº¦å’Œ 5 å·é¢„çº¦ï¼Œæ€»æ—¶é•¿ &#x3D; 2 + 9 + 1 &#x3D; 12ã€‚ ç¤ºä¾‹ 3ï¼š 123è¾“å…¥ï¼š [2,1,4,5,3,1,1,3]è¾“å‡ºï¼š 12è§£é‡Šï¼š é€‰æ‹© 1 å·é¢„çº¦ã€ 3 å·é¢„çº¦ã€ 5 å·é¢„çº¦å’Œ 8 å·é¢„çº¦ï¼Œæ€»æ—¶é•¿ &#x3D; 2 + 4 + 3 + 3 &#x3D; 12ã€‚ æ€è·¯ï¼š åŠ¨æ€è§„åˆ’çš„æ€æƒ³ã€‚ä½†æ˜¯è¿™é¢˜å’Œæœ€å¤§ä¸Šå‡å­åºåˆ—çš„åŠ¨æ€è§„åˆ’æ€æƒ³ä¸åŒã€‚è¿™é¢˜ä¸èƒŒåŒ…é—®é¢˜éƒ½æ˜¯è¦æ±‚ä¸€ä¸ªå¯¹äºæ•´ä½“æ¥è¯´æœ€å¤§çš„å’Œï¼Œä½†æ˜¯æœ€å¤§ä¸Šå‡å­åºåˆ—æ˜¯æ±‚ä¸€ä¸ªæœ€é•¿çš„ä¸Šå‡å­åºåˆ—ï¼Œä¹‹å‰çš„æ•°è¦æ¯”å½“å‰çš„æ•°å°æ‰èƒ½åšä¸€æ¬¡è®¡ç®—ï¼Œå’Œæ˜¯å¦ç›¸é‚»æ— å…³ï¼Œæ‰€ä»¥æœ€å¤§ä¸Šå‡å­åºåˆ—è¿˜éœ€è¦åœ¨å†…å±‚åŠ å¤šä¸€å±‚å¾ªç¯ã€‚ é¢˜è§£ï¼š æœ€åˆæƒ³çš„æ–¹æ¡ˆï¼š å†…å±‚å¤šäº†ä¸€ä¸ªå¾ªç¯ã€‚ 123456789101112131415161718192021222324252627/** * @param &#123;number[]&#125; nums * @return &#123;number&#125; */var massage = function(nums) &#123; var F=[]; if(nums.length==1)&#123; return nums[0]; &#125; for(var m=0;m&lt;nums.length;++m)&#123; F[m]=0; &#125; F[0]=nums[0]; F[1]=nums[1]; for(var i=2;i&lt;nums.length;++i)&#123; for(var j=0;j&lt;=i-2;++j)&#123; F[i]=Math.max(F[j]+nums[i],F[i]); &#125; &#125; var max=0; for(var t=0;t&lt;F.length;++t)&#123; if(F[t]&gt;max)&#123; max=F[t]; &#125; &#125; return max;&#125;; åæ¥çœ‹è¯„è®ºä¼˜åŒ–çš„é¢˜è§£ï¼š dpæ€æƒ³ï¼šF[i]=Math.max(F[i-1],F[i-2]+nums[i]); 12345678910111213141516171819202122/** * @param &#123;number[]&#125; nums * @return &#123;number&#125; */var massage = function(nums) &#123; var F=[]; if(nums.length==0)&#123; return 0; &#125; if(nums.length==1)&#123; return nums[0]; &#125; for(var m=0;m&lt;nums.length;++m)&#123; F[m]=0; &#125; F[0]=nums[0]; F[1]=Math.max(nums[0],nums[1]); for(var i=2;i&lt;nums.length;++i)&#123; F[i]=Math.max(F[i-1],F[i-2]+nums[i]); &#125; return F[nums.length-1];&#125;;","categories":[{"name":"æ¯æ—¥ä¸€é¢˜","slug":"æ¯æ—¥ä¸€é¢˜","permalink":"http://delaprada.com/categories/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98/"}],"tags":[{"name":"æ¯æ—¥ä¸€é¢˜","slug":"æ¯æ—¥ä¸€é¢˜","permalink":"http://delaprada.com/tags/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98/"}]},{"title":"ç”±instanceofåŸç”Ÿå®ç°ç†è§£__proto__å’Œprototypeçš„åŒºåˆ«","slug":"ç”±instanceofåŸç”Ÿå®ç°ç†è§£-proto-å’Œprototypeçš„åŒºåˆ«","date":"2020-03-24T08:04:15.000Z","updated":"2020-03-24T08:55:42.000Z","comments":true,"path":"2020/03/24/ç”±instanceofåŸç”Ÿå®ç°ç†è§£-proto-å’Œprototypeçš„åŒºåˆ«/","link":"","permalink":"http://delaprada.com/2020/03/24/%E7%94%B1instanceof%E5%8E%9F%E7%94%9F%E5%AE%9E%E7%8E%B0%E7%90%86%E8%A7%A3-proto-%E5%92%8Cprototype%E7%9A%84%E5%8C%BA%E5%88%AB/","excerpt":"","text":"å‰å‡ å¤©é¢è¯•çš„æ—¶å€™è¢«é—®åˆ°instanceofçš„åŸç”Ÿå®ç°ï¼Œå½“æ—¶å¯¹__proto__å’Œprototypeçš„åŒºåˆ«ç†è§£ä¸æ˜¯å¾ˆé€å½»ï¼Œä¸€ç›´è®°å¾—çš„æ˜¯å‡ ä¸ªæœˆå‰åœ¨ç½‘ä¸Šçš„æŸç¯‡åšå®¢ä¸Šçœ‹åˆ°çš„ç»“è®ºï¼šâ€œ__proto__ï¼šå’Œprototypeå…¶å®æ˜¯ä¸€ä¸ªä¸œè¥¿ï¼Œprototypeæ˜¯å®˜æ–¹æ‰€å®šä¹‰çš„å±æ€§ï¼Œ__proto__æ˜¯æµè§ˆå™¨è‡ªå·±å¯¹prototypeæ‰€åšçš„å®ç°ã€‚â€åæ¥ä»”ç»†å†æŸ¥äº†äº›æ–‡ç« å‘ç°ä¼¼ä¹å¹¶ä¸æ˜¯è¿™æ ·ã€‚ __proto__å’Œprototypeçš„åŒºåˆ«åŸå‹prototypeåŸå‹çš„å®šä¹‰ï¼šæ¯ä¸ªjså¯¹è±¡ï¼ˆé™¤äº†nullï¼‰åœ¨åˆ›å»ºçš„æ—¶å€™å°±ä¼šä¸ä¹‹å…³è”å¦ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡å°±æ˜¯æˆ‘ä»¬æ‰€è¯´çš„åŸå‹ï¼Œæ¯ä¸€ä¸ªå¯¹è±¡éƒ½ä¼šä»åŸå‹â€œç»§æ‰¿â€å±æ€§ã€‚ æ¯”å¦‚æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªæ„é€ å‡½æ•°Personï¼š 123function Person(name)&#123; this.name=name;&#125; è¿™æ ·æˆ‘ä»¬å°±åˆ›å»ºäº†ä¸€ä¸ªå¯¹è±¡ï¼ˆfunctionä¹Ÿæ˜¯å¯¹è±¡ï¼‰ï¼Œé‚£è¿™ä¸ªPersonæ„é€ å‡½æ•°æ˜¯æœ‰å®ƒçš„prototypeçš„ã€‚è¿™ä¸ªPerson prototypeçš„æ„é€ å‡½æ•°constructorå°±æ˜¯è¿™ä¸ªPersonæ„é€ å‡½æ•°ã€‚æˆ‘ä»¬è¿˜å¯ä»¥åœ¨è¿™ä¸ªPerson prototypeä¸Šå»å®šä¹‰ä¸€äº›å…±äº«çš„å±æ€§å’Œæ–¹æ³•ã€‚ 1234567function Person(name)&#123; this.name=name;&#125;Person.prototype.name=\"Alice\";Person.prototype.sayHello=function()&#123; console.log(\"Hello \"+this.name);&#125; è¿™æ ·å†™å°±åœ¨Person prototypeä¸Šå®šä¹‰äº†å…¬ç”¨çš„å±æ€§nameå’ŒsayHelloã€‚ ç°åœ¨åˆ›å»ºä¸¤ä¸ªå¯¹è±¡å®ä¾‹ï¼š 12345var person1=new Person();var person2=new Person();person1.name=\"Emma\";console.log(person1.name); //Emmaconsole.log(person2.name); //Alice æˆ‘ä»¬ä¸ºè¿™ä¸ªperson1å®šä¹‰äº†å®ƒçš„å®ä¾‹å±æ€§nameä¸ºâ€Emmaâ€ï¼Œé‚£person2æ²¡æœ‰å®šä¹‰å®ƒçš„å®ä¾‹å±æ€§ï¼Œæ‰€ä»¥å®ƒä¼šæ²¿ç€åŸå‹é“¾å»æ‰¾å®ƒçš„åŸå‹å»æ‰¾æ˜¯å¦æœ‰è¿™ä¸ªå±æ€§ï¼Œå› ä¸ºPerson.prototypeé‡Œå®šä¹‰äº†nameå±æ€§ï¼Œæ‰€ä»¥è¾“å‡ºAliceã€‚ å¦‚æœPerson.prototypeä¸­æ²¡æœ‰å®šä¹‰nameå±æ€§ï¼Œé‚£person2.nameè¾“å‡ºçš„æ˜¯undefinedï¼Œæ„é€ å‡½æ•°é‡Œçš„this.nameæ˜¯ä¸èµ·ä½œç”¨çš„ã€‚ __proto__ ä»¥ä¸Šè¿™å¹…å›¾å¤§è‡´å¯ä»¥è¯´æ˜__proto__å’Œprototypeçš„å…³ç³»ã€‚ ç°åœ¨æ¥è¯´ä¸€ä¸‹æˆ‘ä»¬ä½¿ç”¨newå»åˆ›å»ºä¸€ä¸ªæ„é€ å‡½æ•°å®ä¾‹çš„æ—¶å€™åšäº†äº›ä»€ä¹ˆï¼š newçš„åŸç”Ÿå®ç°ï¼š 123456function new(Parent,...args)&#123; var obj=&#123;&#125;; obj.__proto__=Parent.prototype; var res=Parent.apply(obj,args); return typeof res==\"object\"?res:obj;&#125; æˆ‘ä»¬ä½¿ç”¨newåˆ›å»ºä¸€ä¸ªå®ä¾‹çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°†è¿™ä¸ªå®ä¾‹çš„__proto__æŒ‡å‘æ„é€ å‡½æ•°çš„åŸå‹ã€‚ __proto__å’Œprototypeå¹¶ä¸æ˜¯ä¸€æ ·çš„ï¼š constructor1234function Person()&#123;&#125;Person.prototype.constructor===Person; //true è¿™ä¸ªç”±ä¸Šå›¾å¯ä»¥çœ‹å‡ºã€‚ 12345function Person()&#123;&#125;var person1=new Person();person1.constructor===Person; //true ä½†æ˜¯person1æ˜¯æ²¡æœ‰constructorå±æ€§çš„ï¼Œè€Œæ˜¯é€šè¿‡åŸå‹é“¾å»æ‰¾åˆ°Person.prototypeä¸Šçš„constructorå±æ€§ã€‚ Object.prototypeObject.prototypeæ˜¯æ²¡æœ‰åŸå‹çš„ï¼ŒObject.prototypeå°±æ˜¯å°½å¤´ã€‚ instanceofçš„åŸç”Ÿå®ç°instanceofåœ¨MDNå½“ä¸­çš„å®šä¹‰å°±æ˜¯object instanceof constructorï¼Œåˆ¤æ–­è¿™ä¸ªconstructorçš„prototypeæ˜¯å¦åœ¨objectçš„åŸå‹é“¾ä¸Šã€‚objectåŸå‹é“¾ä¸Šçš„åŸå‹æˆ‘ä»¬å¯ä»¥é€šè¿‡__proto__æ¥å»è·å–ã€‚ 12345678910111213function myinstanceof(left,right)&#123; var leftval=left.__proto__; //å®ä¾‹ç”¨__proto__ var rightval=right.prototype; //æ„é€ å‡½æ•°ç”¨prototype while(true)&#123; if(leftval==null)&#123; return false; //Object.prototype.__proto__ä¸ºnull &#125; if(leftval==rightval)&#123; return true; &#125; leftval=leftval.__proto__; &#125;&#125;","categories":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://delaprada.com/categories/JavaScript/"}],"tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://delaprada.com/tags/JavaScript/"}]},{"title":"Promiseå®ç°ä»»åŠ¡é¡ºåºæ‰§è¡Œ&å¹¶è¡Œæ‰§è¡Œ&å‘èµ·ajaxè¯·æ±‚","slug":"Promiseå®ç°ä»»åŠ¡é¡ºåºæ‰§è¡Œå’Œå¹¶è¡Œæ‰§è¡Œ","date":"2020-03-21T13:46:14.000Z","updated":"2020-03-24T01:17:02.000Z","comments":true,"path":"2020/03/21/Promiseå®ç°ä»»åŠ¡é¡ºåºæ‰§è¡Œå’Œå¹¶è¡Œæ‰§è¡Œ/","link":"","permalink":"http://delaprada.com/2020/03/21/Promise%E5%AE%9E%E7%8E%B0%E4%BB%BB%E5%8A%A1%E9%A1%BA%E5%BA%8F%E6%89%A7%E8%A1%8C%E5%92%8C%E5%B9%B6%E8%A1%8C%E6%89%A7%E8%A1%8C/","excerpt":"","text":"Promiseå®ç°ä»»åŠ¡å¹¶è¡Œæ‰§è¡Œä½¿ç”¨Promise.allæ–¹æ³•ï¼š 123456789101112var p1=new Promise((resolve,reject)=&gt;&#123; resolve('hello');&#125;)p1.then(result=&gt;result);var p2=new Promise((resolve,reject)=&gt;&#123; resolve('hi');&#125;)p1.then(result=&gt;result);var p=Promise.all([p1,p2]);p.then(result=&gt;console.log(result)); Promiseå®ç°ä»»åŠ¡é¡ºåºæ‰§è¡Œåœ¨.thené‡Œè¦returnä¸€ä¸ªnew Promiseï¼Œè¿™æ ·åç»­æ‰èƒ½ç»§ç»­ä½¿ç”¨.thenæ‰§è¡Œåç»­æ“ä½œï¼š 1234567891011121314var result=new Promise(function(resolve,reject)&#123; setTimeout(function()&#123; resolve(\"one\"); &#125;,3000)&#125;).then(function(data)&#123; console.log(data); return new Promise(function(resolve,reject)&#123; setTimeout(function()&#123; resolve(\"two\"); &#125;,3000) &#125;)&#125;).then(function(data)&#123; console.log(data);&#125;) è¾“å‡ºï¼š Promiseå°è£…ajaxè¯·æ±‚123456789101112131415161718192021222324252627282930function myHttpClient(method,url,data)&#123; return new Promise(function(resolve,reject)&#123; var xhr; if(window.XMLHttpRequest)&#123; xhr=new XMLHttpRequest(); &#125; else&#123; xhr=new ActiveXObject('Microsoft XMLHttp'); &#125; var method=method||'GET'; var data=data||null; xhr.open(method,url,true); xhr.onReadyStateChange=function()&#123; if(xhr.readyState==4)&#123; if((xhr.status&gt;=200&amp;&amp;xhr.status&lt;=300)||xhr.status==304)&#123; resolve(xhr.responseText); &#125; else&#123; reject(new Error(xhr.statusText)); &#125; &#125; &#125; xhr.send(data); &#125;)&#125;myHttpClient('GET',url,null).then(function(data)&#123; console.log(data);&#125;,function(error)&#123; console.log(error);&#125;) æ€æƒ³å°±æ˜¯ï¼šå°†æ•´ä¸ªä½¿ç”¨XMLHttpRequestå»å‘èµ·å¼‚æ­¥ç½‘ç»œè¯·æ±‚çš„æ“ä½œå°è£…åœ¨new Promiseå½“ä¸­ï¼Œæ‰§è¡Œå‡½æ•°è¿”å›ä¸€ä¸ªPromiseï¼Œé‚£åç»­å¯ä»¥ä½¿ç”¨.thenæ¥æ‰§è¡Œåç»­çš„æ“ä½œã€‚","categories":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://delaprada.com/categories/JavaScript/"}],"tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://delaprada.com/tags/JavaScript/"}]},{"title":"è®¾ç½®display:noneå¯¹DOMæ ‘å’Œæ¸²æŸ“æ ‘çš„å½±å“","slug":"è®¾ç½®display-noneå¯¹DOMæ ‘å’Œæ¸²æŸ“æ ‘çš„å½±å“","date":"2020-03-21T01:50:17.000Z","updated":"2020-03-30T03:38:28.000Z","comments":true,"path":"2020/03/21/è®¾ç½®display-noneå¯¹DOMæ ‘å’Œæ¸²æŸ“æ ‘çš„å½±å“/","link":"","permalink":"http://delaprada.com/2020/03/21/%E8%AE%BE%E7%BD%AEdisplay-none%E5%AF%B9DOM%E6%A0%91%E5%92%8C%E6%B8%B2%E6%9F%93%E6%A0%91%E7%9A%84%E5%BD%B1%E5%93%8D/","excerpt":"","text":"åŸæœ¬çš„æ ·å¼12345678910111213141516171819&lt;html lang=\"en\"&gt;&lt;head&gt; &lt;meta charset=\"UTF-8\"&gt; &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"&gt; &lt;title&gt;Document&lt;/title&gt; &lt;style&gt; .main&#123; width:100px; height:100px; background-color: lightyellow; &#125; &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;div class=\"main\"&gt; displayå±æ€§testing &lt;/div&gt;&lt;/body&gt;&lt;/html&gt; è®¾ç½®display:noneå¯¹æ¸²æŸ“æ ‘çš„å½±å“åœ¨åŸæœ¬çš„styleä¸­æ·»åŠ ä¸Šdisplay:noneï¼š 12345678&lt;style&gt; .main&#123; width:100px; height:100px; background-color: lightyellow; display:none; &#125;&lt;/style&gt; é¡µé¢ä¸Šæ²¡æœ‰æ˜¾ç¤ºä»»ä½•ä¸œè¥¿ï¼š æ‰€ä»¥è®¾ç½®display:noneæ˜¯ä¼šå°†èŠ‚ç‚¹ä»æ¸²æŸ“æ ‘ä¸­æ‘˜é™¤çš„ã€‚ è®¾ç½®display:noneå¯¹DOMæ ‘çš„å½±å“æˆ‘ä»¬åœ¨åˆšæ‰çš„ä»£ç ä¸­æ·»åŠ ä¸Šä¸€æ®µjsä»£ç ï¼š 1234&lt;script&gt; var node=document.getElementsByClassName(\"main\")[0]; console.log(node.innerText);&lt;/script&gt; æ§åˆ¶å°è¾“å‡ºï¼š è¯´æ˜DOMæ ‘ä¸­è¯¥èŠ‚ç‚¹å¹¶æ²¡æœ‰æ¶ˆå¤±ï¼Œå¦åˆ™ä¸ä¼šè·å–åˆ°DOMä¸Šçš„ä¿¡æ¯ã€‚ è®¾ç½®display:noneå¯¹CSSè§„åˆ™æ ‘çš„å½±å“æˆ‘ä»¬åœ¨divå½“ä¸­æ·»åŠ styleæ ·å¼ï¼š 123&lt;div class=\"main\" style=\"width:100px\"&gt; displayå±æ€§testing&lt;/div&gt; åœ¨scriptä¸­æ·»åŠ ï¼š 1console.log(node.style.width); æ§åˆ¶å°è¾“å‡ºï¼š è¯´æ˜CSSè§„åˆ™æ ‘ä¸­è¯¥èŠ‚ç‚¹çš„æ ·å¼æ²¡æœ‰æ¶ˆå¤±ã€‚","categories":[{"name":"CSS","slug":"CSS","permalink":"http://delaprada.com/categories/CSS/"}],"tags":[{"name":"CSS","slug":"CSS","permalink":"http://delaprada.com/tags/CSS/"}]},{"title":"æ¯æ—¥ä¸€é¢˜â€”â€”æ°´å£¶é—®é¢˜","slug":"æ¯æ—¥ä¸€é¢˜â€”â€”æ°´å£¶é—®é¢˜","date":"2020-03-21T00:37:01.000Z","updated":"2020-03-21T00:43:48.000Z","comments":true,"path":"2020/03/21/æ¯æ—¥ä¸€é¢˜â€”â€”æ°´å£¶é—®é¢˜/","link":"","permalink":"http://delaprada.com/2020/03/21/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98%E2%80%94%E2%80%94%E6%B0%B4%E5%A3%B6%E9%97%AE%E9%A2%98/","excerpt":"","text":"æœ‰ä¸¤ä¸ªå®¹é‡åˆ†åˆ«ä¸º xå‡ å’Œ yå‡ çš„æ°´å£¶ä»¥åŠæ— é™å¤šçš„æ°´ã€‚è¯·åˆ¤æ–­èƒ½å¦é€šè¿‡ä½¿ç”¨è¿™ä¸¤ä¸ªæ°´å£¶ï¼Œä»è€Œå¯ä»¥å¾—åˆ°æ°å¥½ zå‡ çš„æ°´ï¼Ÿ å¦‚æœå¯ä»¥ï¼Œæœ€åè¯·ç”¨ä»¥ä¸Šæ°´å£¶ä¸­çš„ä¸€æˆ–ä¸¤ä¸ªæ¥ç››æ”¾å–å¾—çš„ zå‡ æ°´ã€‚ ä½ å…è®¸ï¼š è£…æ»¡ä»»æ„ä¸€ä¸ªæ°´å£¶ æ¸…ç©ºä»»æ„ä¸€ä¸ªæ°´å£¶ ä»ä¸€ä¸ªæ°´å£¶å‘å¦å¤–ä¸€ä¸ªæ°´å£¶å€’æ°´ï¼Œç›´åˆ°è£…æ»¡æˆ–è€…å€’ç©º ç¤ºä¾‹ 1: (From the famous â€œDie Hardâ€ example) 12è¾“å…¥: x &#x3D; 3, y &#x3D; 5, z &#x3D; 4è¾“å‡º: True ç¤ºä¾‹ 2: 12è¾“å…¥: x &#x3D; 2, y &#x3D; 6, z &#x3D; 5è¾“å‡º: False æ€è·¯ï¼š å½“x=3,y=5,z=4çš„æ—¶å€™æ€ä¹ˆå€’å‡º4Læ°´ï¼š é¦–å…ˆè£…æ»¡xï¼Œå°†xä¸­çš„3Læ°´å€’å…¥yä¸­ï¼Œ ç„¶åå†è£…æ»¡xï¼Œå°†xçš„æ°´å€’å…¥yä¸­ï¼Œæ­¤æ—¶åªèƒ½å€’2Lï¼Œé‚£xä¸­å°±å‰©ä¸‹1Læ°´ å°†yä¸­çš„æ°´å€’æ‰ï¼Œå°†xä¸­çš„1Læ°´å€’å…¥ xå†è£…æ»¡3Læ°´ï¼Œå€’å…¥yä¸­ï¼Œæ­¤æ—¶yå°±æœ‰4Læ°´ å®ƒçš„æ€è·¯å°±æ˜¯ï¼šxå’Œyçš„æœ€å¤§å…¬çº¦æ•°æ˜¯å¦èƒ½å¤Ÿè¢«zæ•´é™¤ã€‚ä¸æ­¤åŒæ—¶è¦è€ƒè™‘ï¼Œxå’ŒyåŠ èµ·æ¥çš„å¤§å°æ˜¯å¦æ¯”zè¦å°ï¼Œå¦‚æœå°çš„è¯å°±ä¸å¯èƒ½è£…å¾—ä¸‹ã€‚è¿˜è¦è€ƒè™‘ï¼Œä¸¤ä¸ªå£¶ä¸º0çš„æƒ…å†µï¼Œå› ä¸ºmodæ“ä½œæ˜¯ä¸èƒ½mod0çš„ã€‚ é¢˜è§£ï¼š 123456789101112131415161718192021222324252627282930313233343536/** * @param &#123;number&#125; x * @param &#123;number&#125; y * @param &#123;number&#125; z * @return &#123;boolean&#125; */var canMeasureWater = function(x, y, z) &#123; var temp; if(x&gt;y)&#123; temp=x; x=y; y=temp; &#125; if(x+y&lt;z)&#123; return false; &#125; while(x!=0)&#123; temp=y; y=x; x=temp%x; &#125; if(y==0&amp;&amp;z==0)&#123; return true; &#125; else if(y==0&amp;&amp;z!=0)&#123; return false; &#125; else&#123; if(z%y==0)&#123; return true; &#125; else&#123; return false; &#125; &#125;&#125;;","categories":[{"name":"æ¯æ—¥ä¸€é¢˜","slug":"æ¯æ—¥ä¸€é¢˜","permalink":"http://delaprada.com/categories/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98/"}],"tags":[{"name":"æ¯æ—¥ä¸€é¢˜","slug":"æ¯æ—¥ä¸€é¢˜","permalink":"http://delaprada.com/tags/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98/"}]},{"title":"æ¯æ—¥ä¸€é¢˜â€”â€”çŸ©é˜µé‡å ","slug":"æ¯æ—¥ä¸€é¢˜â€”â€”çŸ©é˜µé‡å ","date":"2020-03-18T01:28:56.000Z","updated":"2020-03-18T01:31:06.000Z","comments":true,"path":"2020/03/18/æ¯æ—¥ä¸€é¢˜â€”â€”çŸ©é˜µé‡å /","link":"","permalink":"http://delaprada.com/2020/03/18/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98%E2%80%94%E2%80%94%E7%9F%A9%E9%98%B5%E9%87%8D%E5%8F%A0/","excerpt":"","text":"çŸ©å½¢é‡å çŸ©å½¢ä»¥åˆ—è¡¨ [x1, y1, x2, y2] çš„å½¢å¼è¡¨ç¤ºï¼Œå…¶ä¸­ (x1, y1) ä¸ºå·¦ä¸‹è§’çš„åæ ‡ï¼Œ(x2, y2) æ˜¯å³ä¸Šè§’çš„åæ ‡ã€‚ å¦‚æœç›¸äº¤çš„é¢ç§¯ä¸ºæ­£ï¼Œåˆ™ç§°ä¸¤çŸ©å½¢é‡å ã€‚éœ€è¦æ˜ç¡®çš„æ˜¯ï¼Œåªåœ¨è§’æˆ–è¾¹æ¥è§¦çš„ä¸¤ä¸ªçŸ©å½¢ä¸æ„æˆé‡å ã€‚ ç»™å‡ºä¸¤ä¸ªçŸ©å½¢ï¼Œåˆ¤æ–­å®ƒä»¬æ˜¯å¦é‡å å¹¶è¿”å›ç»“æœã€‚ ç¤ºä¾‹ 1ï¼š 12è¾“å…¥ï¼šrec1 &#x3D; [0,0,2,2], rec2 &#x3D; [1,1,3,3]è¾“å‡ºï¼štrue ç¤ºä¾‹ 2ï¼š 12è¾“å…¥ï¼šrec1 &#x3D; [0,0,1,1], rec2 &#x3D; [1,0,2,1]è¾“å‡ºï¼šfalse è¯´æ˜ï¼š ä¸¤ä¸ªçŸ©å½¢ rec1 å’Œ rec2 éƒ½ä»¥å«æœ‰å››ä¸ªæ•´æ•°çš„åˆ—è¡¨çš„å½¢å¼ç»™å‡ºã€‚çŸ©å½¢ä¸­çš„æ‰€æœ‰åæ ‡éƒ½å¤„äº -10^9 å’Œ 10^9 ä¹‹é—´ã€‚ æ€è·¯ï¼š ä¸¤ä¸ªçŸ©å½¢ï¼Œæˆ‘ä»¬åªéœ€è¦å…³æ³¨å®ƒä»¬ç¦»å½¼æ­¤æœ€è¿‘çš„ä¸¤ä¸ªç‚¹ã€‚ä¸¤ä¸ªçŸ©é˜µåªè¦é å·¦è¾¹çŸ©å½¢çš„å³ä¸Šè§’çš„xæ¯”å³è¾¹çŸ©å½¢å·¦ä¸‹è§’çš„xè¦å°ï¼ˆå°äºç­‰äºï¼‰çš„è¯ï¼Œå°±ä¸ä¼šé‡å ï¼›æˆ–è€…æ˜¯ï¼Œé å·¦è¾¹çŸ©å½¢çš„å³ä¸‹è§’çš„yæ¯”å³è¾¹çŸ©å½¢å³ä¸Šè§’yè¦å¤§ï¼ˆå¤§äºç­‰äºï¼‰çš„è¯ï¼Œä¹Ÿä¸ä¼šé‡å ã€‚å› ä¸ºrec1å’Œrec2çš„é¡ºåºä¸ä¸€å®šå°±æ˜¯rec1åœ¨å·¦ï¼Œrec2åœ¨å³ï¼Œæ‰€ä»¥è¦è€ƒè™‘åè¿‡æ¥æƒ…å†µã€‚ é¢˜è§£ï¼š 12345678/** * @param &#123;number[]&#125; rec1 * @param &#123;number[]&#125; rec2 * @return &#123;boolean&#125; */var isRectangleOverlap = function(rec1, rec2) &#123; return !(rec1[2]&lt;=rec2[0]||rec2[2]&lt;=rec1[0]||rec1[1]&gt;=rec2[3]||rec2[1]&gt;=rec1[3]);&#125;;","categories":[{"name":"æ¯æ—¥ä¸€é¢˜","slug":"æ¯æ—¥ä¸€é¢˜","permalink":"http://delaprada.com/categories/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98/"}],"tags":[{"name":"æ¯æ—¥ä¸€é¢˜","slug":"æ¯æ—¥ä¸€é¢˜","permalink":"http://delaprada.com/tags/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98/"}]},{"title":"æ¯æ—¥ä¸€é¢˜â€”â€”å²›å±¿çš„æœ€å¤§é¢ç§¯","slug":"æ¯æ—¥ä¸€é¢˜â€”â€”å²›å±¿çš„æœ€å¤§é¢ç§¯","date":"2020-03-15T01:13:59.000Z","updated":"2020-03-15T01:20:02.000Z","comments":true,"path":"2020/03/15/æ¯æ—¥ä¸€é¢˜â€”â€”å²›å±¿çš„æœ€å¤§é¢ç§¯/","link":"","permalink":"http://delaprada.com/2020/03/15/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98%E2%80%94%E2%80%94%E5%B2%9B%E5%B1%BF%E7%9A%84%E6%9C%80%E5%A4%A7%E9%9D%A2%E7%A7%AF/","excerpt":"","text":"å²›å±¿çš„æœ€å¤§é¢ç§¯ç»™å®šä¸€ä¸ªåŒ…å«äº†ä¸€äº› 0 å’Œ 1çš„éç©ºäºŒç»´æ•°ç»„ grid , ä¸€ä¸ª å²›å±¿ æ˜¯ç”±å››ä¸ªæ–¹å‘ (æ°´å¹³æˆ–å‚ç›´) çš„ 1 (ä»£è¡¨åœŸåœ°) æ„æˆçš„ç»„åˆã€‚ä½ å¯ä»¥å‡è®¾äºŒç»´çŸ©é˜µçš„å››ä¸ªè¾¹ç¼˜éƒ½è¢«æ°´åŒ…å›´ç€ã€‚ æ‰¾åˆ°ç»™å®šçš„äºŒç»´æ•°ç»„ä¸­æœ€å¤§çš„å²›å±¿é¢ç§¯ã€‚(å¦‚æœæ²¡æœ‰å²›å±¿ï¼Œåˆ™è¿”å›é¢ç§¯ä¸º0ã€‚) ç¤ºä¾‹ 1: 12345678[[0,0,1,0,0,0,0,1,0,0,0,0,0], [0,0,0,0,0,0,0,1,1,1,0,0,0], [0,1,1,0,1,0,0,0,0,0,0,0,0], [0,1,0,0,1,1,0,0,1,0,1,0,0], [0,1,0,0,1,1,0,0,1,1,1,0,0], [0,0,0,0,0,0,0,0,0,0,1,0,0], [0,0,0,0,0,0,0,1,1,1,0,0,0], [0,0,0,0,0,0,0,1,1,0,0,0,0]] å¯¹äºä¸Šé¢è¿™ä¸ªç»™å®šçŸ©é˜µåº”è¿”å› 6ã€‚æ³¨æ„ç­”æ¡ˆä¸åº”è¯¥æ˜¯11ï¼Œå› ä¸ºå²›å±¿åªèƒ½åŒ…å«æ°´å¹³æˆ–å‚ç›´çš„å››ä¸ªæ–¹å‘çš„â€˜1â€™ã€‚ ç¤ºä¾‹ 2: 1[[0,0,0,0,0,0,0,0]] å¯¹äºä¸Šé¢è¿™ä¸ªç»™å®šçš„çŸ©é˜µ, è¿”å› 0ã€‚ æ³¨æ„: ç»™å®šçš„çŸ©é˜µgrid çš„é•¿åº¦å’Œå®½åº¦éƒ½ä¸è¶…è¿‡ 50ã€‚ æ€è·¯ï¼šå’Œè…çƒ‚çš„æ©˜å­çš„æ€æƒ³ç±»ä¼¼ï¼Œä½¿ç”¨å¹¿åº¦ä¼˜å…ˆéå†ï¼Œç„¶åqueueæ¥å®ç°ï¼ˆJSä¸­ç”¨æ™®é€šæ•°ç»„ï¼Œä½¿ç”¨shiftæ¥è·å–åˆ—å¤´å…ƒç´ ï¼Œä¸è¦å†™é”™æˆpop()ï¼Œc++ä¸­é˜Ÿåˆ—çš„pop()å’ŒJSä¸­æ™®é€šæ•°ç»„çš„shift()æ‰æ˜¯å¯¹åº”çš„ï¼‰ã€‚è€Œä¸”è¦å¦å¤–ç»´æŠ¤ä¸€ä¸ªflagæ•°ç»„ï¼Œç”¨æ¥è®°å½•æ¯ä¸ªæ•°ç»„ä¸­çš„å…ƒç´ æ˜¯å¦å·²ç»åˆ¤æ–­è¿‡äº†ï¼Œå¦‚æœåˆ¤æ–­è¿‡äº†çš„è¯ï¼Œå°±è¦å°†flagå˜ä¸ºtrueï¼Œä¸‹ä¸€æ¬¡ä¸ç”¨å†å»åˆ¤æ–­ã€‚ ç”¨JSå£°æ˜äºŒç»´æ•°ç»„çš„æ–¹å¼ï¼š 12345678var a = new Array();for(var i=0;i&lt;3;i++)&#123; //ä¸€ç»´é•¿åº¦ä¸º3 a[i] = new Array(); for(var j=0;j&lt;5;j++)&#123; //äºŒç»´é•¿åº¦ä¸º5 a[i][j] = i+j; &#125;&#125; é¢˜è§£ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445/** * @param &#123;number[][]&#125; grid * @return &#123;number&#125; */var maxAreaOfIsland = function(grid) &#123; var q=[]; var res=0; var count=0; var step=[[-1,0],[1,0],[0,1],[0,-1]]; //ç”¨æ¥è¿›è¡Œå¹¿åº¦éå† var flag=new Array(); for(var n=0;n&lt;grid.length;++n)&#123; flag[n]=new Array(); for(var m=0;m&lt;grid[0].length;++m)&#123; flag[n][m]=false; &#125; &#125; for(var i=0;i&lt;grid.length;++i)&#123; for(var j=0;j&lt;grid[0].length;++j)&#123; if(grid[i][j]==1&amp;&amp;flag[i][j]==false)&#123; count++; q.push([i,j]); flag[i][j]=true; while(q.length!==0)&#123; var temp=q.shift(); for(var k=0;k&lt;step.length;++k)&#123; var x=temp[0]+step[k][0]; var y=temp[1]+step[k][1]; if(x&gt;=0&amp;&amp;x&lt;grid.length&amp;&amp;y&gt;=0&amp;&amp;y&lt;grid[0].length)&#123; if(grid[x][y]==1&amp;&amp;flag[x][y]==false)&#123; q.push([x,y]); flag[x][y]=true; count++; &#125; &#125; &#125; &#125; if(count&gt;res)&#123; res=count; &#125; count=0; &#125; &#125; &#125; return res;&#125;;","categories":[{"name":"æ¯æ—¥ä¸€é¢˜","slug":"æ¯æ—¥ä¸€é¢˜","permalink":"http://delaprada.com/categories/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98/"}],"tags":[{"name":"æ¯æ—¥ä¸€é¢˜","slug":"æ¯æ—¥ä¸€é¢˜","permalink":"http://delaprada.com/tags/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98/"}]},{"title":"æ¯æ—¥ä¸€é¢˜â€”â€”æœ€å¤§ä¸Šå‡å­åºåˆ—","slug":"æœ€å¤§ä¸Šå‡å­åºåˆ—","date":"2020-03-14T03:11:50.000Z","updated":"2020-03-14T03:13:46.000Z","comments":true,"path":"2020/03/14/æœ€å¤§ä¸Šå‡å­åºåˆ—/","link":"","permalink":"http://delaprada.com/2020/03/14/%E6%9C%80%E5%A4%A7%E4%B8%8A%E5%8D%87%E5%AD%90%E5%BA%8F%E5%88%97/","excerpt":"","text":"æœ€é•¿ä¸Šå‡å­åºåˆ—ç»™å®šä¸€ä¸ªæ— åºçš„æ•´æ•°æ•°ç»„ï¼Œæ‰¾åˆ°å…¶ä¸­æœ€é•¿ä¸Šå‡å­åºåˆ—çš„é•¿åº¦ã€‚ ç¤ºä¾‹: 123è¾“å…¥: [10,9,2,5,3,7,101,18]è¾“å‡º: 4 è§£é‡Š: æœ€é•¿çš„ä¸Šå‡å­åºåˆ—æ˜¯ [2,3,7,101]ï¼Œå®ƒçš„é•¿åº¦æ˜¯ 4ã€‚ è¯´æ˜: å¯èƒ½ä¼šæœ‰å¤šç§æœ€é•¿ä¸Šå‡å­åºåˆ—çš„ç»„åˆï¼Œä½ åªéœ€è¦è¾“å‡ºå¯¹åº”çš„é•¿åº¦å³å¯ã€‚ä½ ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦åº”è¯¥ä¸º O(n2) ã€‚è¿›é˜¶: ä½ èƒ½å°†ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦é™ä½åˆ° O(n log n) å—? æ€è·¯ï¼š åŠ¨æ€è§„åˆ’çš„æ€æƒ³ã€‚å…ˆåˆå§‹åŒ–æ¯ä¸ªå…ƒç´ çš„æœ€å¤§ä¸Šå‡å­åºåˆ—é•¿åº¦ä¸º1ã€‚å½“å‰å…ƒç´ çš„æœ€å¤§ä¸Šå‡å­åºåˆ—æ•°åº”ä¸ºåœ¨å®ƒå‰é¢æ¯”è¯¥å…ƒç´ å°çš„å…ƒç´ çš„æœ€å¤§ä¸Šå‡å­åºåˆ—æ•°çš„æœ€å¤§å€¼+1ã€‚ é¢˜è§£ï¼š 123456789101112131415161718192021222324252627/** * @param &#123;number[]&#125; nums * @return &#123;number&#125; */var lengthOfLIS = function(nums) &#123; if(nums.length==0)&#123; return 0; &#125; var dp=[]; for(var i=0;i&lt;nums.length;++i)&#123; dp[i]=1; &#125; for(var j=0;j&lt;nums.length;++j)&#123; for(var k=0;k&lt;j;++k)&#123; if(nums[j]&gt;nums[k])&#123; dp[j]=Math.max(dp[k]+1,dp[j]); &#125; &#125; &#125; var res=1; for(var p=0;p&lt;nums.length;++p)&#123; if(dp[p]&gt;res)&#123; res=dp[p]; &#125; &#125; return res;&#125;;","categories":[{"name":"æ¯æ—¥ä¸€é¢˜","slug":"æ¯æ—¥ä¸€é¢˜","permalink":"http://delaprada.com/categories/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98/"}],"tags":[{"name":"æ¯æ—¥ä¸€é¢˜","slug":"æ¯æ—¥ä¸€é¢˜","permalink":"http://delaprada.com/tags/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98/"}]},{"title":"å¦‚ä½•ç†è§£å¼‚æ­¥","slug":"å¦‚ä½•ç†è§£å¼‚æ­¥","date":"2020-03-13T02:59:49.000Z","updated":"2021-03-17T02:10:56.000Z","comments":true,"path":"2020/03/13/å¦‚ä½•ç†è§£å¼‚æ­¥/","link":"","permalink":"http://delaprada.com/2020/03/13/%E5%A6%82%E4%BD%95%E7%90%86%E8%A7%A3%E5%BC%82%E6%AD%A5/","excerpt":"","text":"ä»€ä¹ˆæ˜¯å¼‚æ­¥æ‰€è°“â€å¼‚æ­¥â€ï¼Œç®€å•è¯´å°±æ˜¯ä¸€ä¸ªä»»åŠ¡ä¸æ˜¯è¿ç»­å®Œæˆçš„ï¼Œå¯ä»¥ç†è§£æˆè¯¥ä»»åŠ¡è¢«äººä¸ºåˆ†æˆä¸¤æ®µï¼Œå…ˆæ‰§è¡Œç¬¬ä¸€æ®µï¼Œç„¶åè½¬è€Œæ‰§è¡Œå…¶ä»–ä»»åŠ¡ï¼Œç­‰åšå¥½äº†å‡†å¤‡ï¼Œå†å›è¿‡å¤´æ‰§è¡Œç¬¬äºŒæ®µã€‚ ç›¸åº”åœ°ï¼Œè¿ç»­çš„æ‰§è¡Œå°±å«åšåŒæ­¥ã€‚ç”±äºæ˜¯è¿ç»­æ‰§è¡Œï¼Œä¸èƒ½æ’å…¥å…¶ä»–ä»»åŠ¡ã€‚ ä¾‹å¦‚ï¼š 1234setTimeout(function()&#123; XXX;&#125;,1000)console.log(\"XXX\"); setTimeoutå°±æ˜¯ä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡ï¼Œä»»åŠ¡åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼Œä¸€ä¸ªéƒ¨åˆ†æ˜¯å»¶è¿Ÿ1000msï¼Œå¦ä¸€ä¸ªéƒ¨åˆ†æ˜¯æ‰§è¡ŒXXXã€‚setTimeoutæ˜¯å…ˆæ‰§è¡Œ1000msçš„å»¶è¿Ÿï¼Œç„¶åå†å»¶è¿ŸæœŸé—´å°†æ‰§è¡Œæƒäº¤ç»™äº†console.logï¼Œè¾“å‡ºäº†â€œXXXâ€ä¹‹åï¼Œå†å»æ‰§è¡ŒsetTimeoutä»»åŠ¡çš„ç¬¬äºŒéƒ¨åˆ†ï¼Œæ‰§è¡ŒXXXã€‚ å¦‚æœæ˜¯åŒæ­¥çš„è¯ï¼Œå®ƒä¼šç­‰åˆ°1000msè¿‡å»ï¼Œæ‰§è¡ŒXXXä¹‹åï¼Œå†è¾“å‡ºâ€XXXâ€ï¼Œæ˜¾ç„¶JavaScriptä¸æƒ³è¿™æ ·æµªè´¹æ—¶é—´ã€‚ å¼‚æ­¥ç¼–ç¨‹çš„è§£å†³æ–¹æ¡ˆå›è°ƒå‡½æ•°æ‰€è°“å›è°ƒå‡½æ•°ï¼Œå°±æ˜¯æŠŠä»»åŠ¡çš„ç¬¬äºŒæ®µå•ç‹¬å†™åœ¨ä¸€ä¸ªå‡½æ•°é‡Œé¢ï¼Œç­‰åˆ°é‡æ–°æ‰§è¡Œè¿™ä¸ªä»»åŠ¡çš„æ—¶å€™ï¼Œå°±ç›´æ¥è°ƒç”¨è¿™ä¸ªå‡½æ•°ã€‚callbackçš„æ„æ€å°±æ˜¯â€œé‡æ–°è°ƒç”¨â€ã€‚ è¯»å–æ–‡ä»¶è¿›è¡Œå¤„ç†ï¼Œæ˜¯è¿™æ ·å†™çš„ã€‚ 1234fs.readFile('/etc/passwd', 'utf-8', function (err, data) &#123; if (err) throw err; console.log(data);&#125;); ä¸Šé¢ä»£ç ä¸­ï¼ŒreadFileå‡½æ•°çš„ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œå°±æ˜¯å›è°ƒå‡½æ•°ï¼Œä¹Ÿå°±æ˜¯ä»»åŠ¡çš„ç¬¬äºŒæ®µã€‚ç­‰åˆ°æ“ä½œç³»ç»Ÿè¿”å›äº†/etc/passwdè¿™ä¸ªæ–‡ä»¶ä»¥åï¼Œå›è°ƒå‡½æ•°æ‰ä¼šæ‰§è¡Œã€‚ PromisePromise å¯¹è±¡å°±æ˜¯ä¸ºäº†è§£å†³å›è°ƒåœ°ç‹±è€Œæå‡ºçš„ã€‚å®ƒä¸æ˜¯æ–°çš„è¯­æ³•åŠŸèƒ½ï¼Œè€Œæ˜¯ä¸€ç§æ–°çš„å†™æ³•ï¼Œå…è®¸å°†å›è°ƒå‡½æ•°çš„åµŒå¥—ï¼Œæ”¹æˆé“¾å¼è°ƒç”¨ã€‚é‡‡ç”¨ Promiseï¼Œè¿ç»­è¯»å–å¤šä¸ªæ–‡ä»¶ï¼Œå†™æ³•å¦‚ä¸‹ã€‚ 123456789101112131415var readFile = require('fs-readfile-promise');readFile(fileA).then(function (data) &#123; console.log(data.toString());&#125;).then(function () &#123; return readFile(fileB);&#125;).then(function (data) &#123; console.log(data.toString());&#125;).catch(function (err) &#123; console.log(err);&#125;); ä¸Šé¢ä»£ç ä¸­ï¼Œæˆ‘ä½¿ç”¨äº†fs-readfile-promiseæ¨¡å—ï¼Œå®ƒçš„ä½œç”¨å°±æ˜¯è¿”å›ä¸€ä¸ª Promise ç‰ˆæœ¬çš„readFileå‡½æ•°ã€‚ Promiseçš„è¯ä»»åŠ¡ä¹Ÿæ˜¯åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼Œnew Promiseä½œä¸ºç¬¬ä¸€éƒ¨åˆ†ç«‹å³æ‰§è¡Œï¼Œç„¶åå°†æ‰§è¡Œæƒäº¤ç»™å…¶ä»–ä»»åŠ¡ï¼Œå½“æ‰§è¡Œå®Œæ¯•åæ‰ä¼šæ‰§è¡Œevent queueå½“ä¸­çš„å›è°ƒå‡½æ•°ã€‚ Promiseçš„æœ€å¤§é—®é¢˜æ˜¯ä»£ç å†—ä½™ï¼šåŸæ¥çš„ä»»åŠ¡è¢« Promise åŒ…è£…äº†ä¸€ä¸‹ï¼Œä¸ç®¡ä»€ä¹ˆæ“ä½œï¼Œä¸€çœ¼çœ‹å»éƒ½æ˜¯ä¸€å †thenï¼ŒåŸæ¥çš„è¯­ä¹‰å˜å¾—å¾ˆä¸æ¸…æ¥šã€‚ Generatoråç¨‹ä¼ ç»Ÿçš„ç¼–ç¨‹è¯­è¨€ï¼Œæ—©æœ‰å¼‚æ­¥ç¼–ç¨‹çš„è§£å†³æ–¹æ¡ˆï¼ˆå…¶å®æ˜¯å¤šä»»åŠ¡çš„è§£å†³æ–¹æ¡ˆï¼‰ã€‚å…¶ä¸­æœ‰ä¸€ç§å«åšâ€åç¨‹â€ï¼ˆcoroutineï¼‰ï¼Œæ„æ€æ˜¯å¤šä¸ªçº¿ç¨‹äº’ç›¸åä½œï¼Œå®Œæˆå¼‚æ­¥ä»»åŠ¡ã€‚ åç¨‹æœ‰ç‚¹åƒå‡½æ•°ï¼Œåˆæœ‰ç‚¹åƒçº¿ç¨‹ã€‚å®ƒçš„è¿è¡Œæµç¨‹å¤§è‡´å¦‚ä¸‹ã€‚ ç¬¬ä¸€æ­¥ï¼Œåç¨‹Aå¼€å§‹æ‰§è¡Œã€‚ ç¬¬äºŒæ­¥ï¼Œåç¨‹Aæ‰§è¡Œåˆ°ä¸€åŠï¼Œè¿›å…¥æš‚åœï¼Œæ‰§è¡Œæƒè½¬ç§»åˆ°åç¨‹Bã€‚ ç¬¬ä¸‰æ­¥ï¼Œï¼ˆä¸€æ®µæ—¶é—´åï¼‰åç¨‹Bäº¤è¿˜æ‰§è¡Œæƒã€‚ ç¬¬å››æ­¥ï¼Œåç¨‹Aæ¢å¤æ‰§è¡Œã€‚ ä¸Šé¢æµç¨‹çš„åç¨‹Aï¼Œå°±æ˜¯å¼‚æ­¥ä»»åŠ¡ï¼Œå› ä¸ºå®ƒåˆ†æˆä¸¤æ®µï¼ˆæˆ–å¤šæ®µï¼‰æ‰§è¡Œã€‚ ä¸¾ä¾‹æ¥è¯´ï¼Œè¯»å–æ–‡ä»¶çš„åç¨‹å†™æ³•å¦‚ä¸‹ã€‚ 12345function* asyncJob() &#123; // ...å…¶ä»–ä»£ç  var f = yield readFile(fileA); // ...å…¶ä»–ä»£ç &#125; ä¸Šé¢ä»£ç çš„å‡½æ•°asyncJobæ˜¯ä¸€ä¸ªåç¨‹ï¼Œå®ƒçš„å¥¥å¦™å°±åœ¨å…¶ä¸­çš„yieldå‘½ä»¤ã€‚å®ƒè¡¨ç¤ºæ‰§è¡Œåˆ°æ­¤å¤„ï¼Œæ‰§è¡Œæƒå°†äº¤ç»™å…¶ä»–åç¨‹ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œyieldå‘½ä»¤æ˜¯å¼‚æ­¥ä¸¤ä¸ªé˜¶æ®µçš„åˆ†ç•Œçº¿ã€‚ ï¼ˆå…¶ä»–ä»£ç éƒ¨åˆ†å±äºä¸€ä¸ªåç¨‹ï¼Œä¸­é—´çš„yieldéƒ¨åˆ†å±äºå¦ä¸€ä¸ªåç¨‹ï¼‰ åç¨‹é‡åˆ°yieldå‘½ä»¤å°±æš‚åœï¼Œç­‰åˆ°æ‰§è¡Œæƒè¿”å›ï¼Œå†ä»æš‚åœçš„åœ°æ–¹ç»§ç»­å¾€åæ‰§è¡Œã€‚å®ƒçš„æœ€å¤§ä¼˜ç‚¹ï¼Œå°±æ˜¯ä»£ç çš„å†™æ³•éå¸¸åƒåŒæ­¥æ“ä½œï¼Œå¦‚æœå»é™¤yieldå‘½ä»¤ï¼Œç®€ç›´ä¸€æ¨¡ä¸€æ ·ã€‚ Generator å‡½æ•°æ˜¯åç¨‹åœ¨ ES6 çš„å®ç°ï¼Œæœ€å¤§ç‰¹ç‚¹å°±æ˜¯å¯ä»¥äº¤å‡ºå‡½æ•°çš„æ‰§è¡Œæƒï¼ˆå³æš‚åœæ‰§è¡Œï¼‰ã€‚ å¼‚æ­¥ä»»åŠ¡çš„å°è£…ä¸‹é¢çœ‹çœ‹å¦‚ä½•ä½¿ç”¨ Generator å‡½æ•°ï¼Œæ‰§è¡Œä¸€ä¸ªçœŸå®çš„å¼‚æ­¥ä»»åŠ¡ã€‚ 1234567var fetch = require('node-fetch');function* gen()&#123; var url = 'https://api.github.com/users/github'; var result = yield fetch(url); console.log(result.bio);&#125; ä¸Šé¢ä»£ç ä¸­ï¼ŒGenerator å‡½æ•°å°è£…äº†ä¸€ä¸ªå¼‚æ­¥æ“ä½œï¼Œè¯¥æ“ä½œå…ˆè¯»å–ä¸€ä¸ªè¿œç¨‹æ¥å£ï¼Œç„¶åä» JSON æ ¼å¼çš„æ•°æ®è§£æä¿¡æ¯ã€‚å°±åƒå‰é¢è¯´è¿‡çš„ï¼Œè¿™æ®µä»£ç éå¸¸åƒåŒæ­¥æ“ä½œï¼Œé™¤äº†åŠ ä¸Šäº†yieldå‘½ä»¤ã€‚ æ‰§è¡Œè¿™æ®µä»£ç çš„æ–¹æ³•å¦‚ä¸‹ã€‚ 12345678var g = gen();var result = g.next();result.value.then(function(data)&#123; return data.json();&#125;).then(function(data)&#123; g.next(data);&#125;); æ‰§è¡Œgenï¼ˆï¼‰çš„æ—¶å€™ï¼Œå®ƒæ‰§è¡Œäº†var url = &#39;https://api.github.com/users/github&#39;;æ“ä½œï¼Œå› ä¸ºé‡åˆ°äº†yieldï¼Œæ‰€ä»¥äº¤å‡ºäº†å½“å‰å¼‚æ­¥ä»»åŠ¡çš„æ‰§è¡Œæƒã€‚æ‰§è¡Œ.next()æ–¹æ³•çš„æ—¶å€™æ‰ä¼šæ‰§è¡Œfetch(url)æ“ä½œï¼Œfetch(url)ä»»åŠ¡æ‰§è¡Œå®Œæ¯•ä¹‹åï¼Œæ‰ä¼šå°†æ‰§è¡Œæƒäº¤è¿˜ç»™å¼‚æ­¥ä»»åŠ¡ï¼Œå»æ‰§è¡Œå¼‚æ­¥ä»»åŠ¡çš„ç¬¬äºŒéƒ¨åˆ†ã€‚","categories":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://delaprada.com/categories/JavaScript/"}],"tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://delaprada.com/tags/JavaScript/"}]},{"title":"æ¯æ—¥ä¸€é¢˜â€”â€”é›¶é’±å…‘æ¢","slug":"æ¯æ—¥ä¸€é¢˜â€”â€”é›¶é’±å…‘æ¢","date":"2020-03-08T00:33:18.000Z","updated":"2020-03-08T00:38:38.000Z","comments":true,"path":"2020/03/08/æ¯æ—¥ä¸€é¢˜â€”â€”é›¶é’±å…‘æ¢/","link":"","permalink":"http://delaprada.com/2020/03/08/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98%E2%80%94%E2%80%94%E9%9B%B6%E9%92%B1%E5%85%91%E6%8D%A2/","excerpt":"","text":"é›¶é’±å…‘æ¢ç»™å®šä¸åŒé¢é¢çš„ç¡¬å¸ coins å’Œä¸€ä¸ªæ€»é‡‘é¢ amountã€‚ç¼–å†™ä¸€ä¸ªå‡½æ•°æ¥è®¡ç®—å¯ä»¥å‡‘æˆæ€»é‡‘é¢æ‰€éœ€çš„æœ€å°‘çš„ç¡¬å¸ä¸ªæ•°ã€‚å¦‚æœæ²¡æœ‰ä»»ä½•ä¸€ç§ç¡¬å¸ç»„åˆèƒ½ç»„æˆæ€»é‡‘é¢ï¼Œè¿”å› -1ã€‚ ç¤ºä¾‹ 1: 123è¾“å…¥: coins &#x3D; [1, 2, 5], amount &#x3D; 11è¾“å‡º: 3 è§£é‡Š: 11 &#x3D; 5 + 5 + 1 ç¤ºä¾‹ 2: 12è¾“å…¥: coins &#x3D; [2], amount &#x3D; 3è¾“å‡º: -1 è¯´æ˜:ä½ å¯ä»¥è®¤ä¸ºæ¯ç§ç¡¬å¸çš„æ•°é‡æ˜¯æ— é™çš„ã€‚ æ€è·¯ï¼šåŠ¨æ€è§„åˆ’çš„æ€æƒ³ï¼Œæ¯ç§ç¡¬å¸éƒ½æ‰¾åˆ°å½“å‰è‡ªèº«çš„æœ€ä¼˜è§£ï¼Œä»è€Œæ±‚å‡ºç»“æœä¸ºamountæ—¶çš„æœ€ä¼˜è§£ã€‚åœ¨åˆå§‹åŒ–çš„æ—¶å€™ï¼Œè¦ä¸ºæ¯ç§é‡‘é¢çš„ç¡¬å¸å£°æ˜ä¸€ä¸ªåˆå§‹çš„è§£ï¼Œè¿™ä¸ªè§£åº”è¯¥æ˜¯ä¸ªæ¯”amountè¦å¤§çš„å€¼ï¼ˆå› ä¸ºè§£æœ€å¤§ä¸ºamountï¼‰ã€‚è¿™æ ·æˆ‘ä»¬åœ¨åšç»“æœåˆ¤æ–­çš„æ—¶å€™å°±å¯ä»¥çŸ¥é“ï¼Œå¦‚æœå½“å‰è§£æ˜¯amount+1å°±è¯´æ˜æ²¡æœ‰ç»„åˆèƒ½ç»„æˆæ€»é‡‘é¢ã€‚ é¢˜è§£ï¼š 123456789101112131415161718192021222324252627282930/** * @param &#123;number[]&#125; coins * @param &#123;number&#125; amount * @return &#123;number&#125; */var coinChange = function(coins, amount) &#123; coins.sort(function(a,b)&#123; return a-b; &#125;) console.log(coins); var F=[]; for(var i=0;i&lt;=amount;++i)&#123; F[i]=amount+1; &#125; F[0]=0; for(var j=0;j&lt;=amount;++j)&#123; for(var k=0;k&lt;coins.length;++k)&#123; if(j&lt;coins[k])&#123; break; &#125; else&#123; F[j]=Math.min(F[j-coins[k]]+1,F[j]); //æ³¨æ„æ­¤å¤„æ˜¯F[j] &#125; &#125; &#125; return F[amount]!==amount+1?F[amount]:-1;&#125;;","categories":[{"name":"æ¯æ—¥ä¸€é¢˜","slug":"æ¯æ—¥ä¸€é¢˜","permalink":"http://delaprada.com/categories/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98/"}],"tags":[{"name":"æ¯æ—¥ä¸€é¢˜","slug":"æ¯æ—¥ä¸€é¢˜","permalink":"http://delaprada.com/tags/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98/"}]},{"title":"æ¯æ—¥ä¸€é¢˜â€”â€”è…çƒ‚çš„æ©˜å­","slug":"æ¯æ—¥ä¸€é¢˜â€”â€”è…çƒ‚çš„æ©˜å­","date":"2020-03-04T01:47:21.000Z","updated":"2020-03-04T07:26:48.000Z","comments":true,"path":"2020/03/04/æ¯æ—¥ä¸€é¢˜â€”â€”è…çƒ‚çš„æ©˜å­/","link":"","permalink":"http://delaprada.com/2020/03/04/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98%E2%80%94%E2%80%94%E8%85%90%E7%83%82%E7%9A%84%E6%A9%98%E5%AD%90/","excerpt":"","text":"åœ¨ç»™å®šçš„ç½‘æ ¼ä¸­ï¼Œæ¯ä¸ªå•å…ƒæ ¼å¯ä»¥æœ‰ä»¥ä¸‹ä¸‰ä¸ªå€¼ä¹‹ä¸€ï¼š å€¼ 0 ä»£è¡¨ç©ºå•å…ƒæ ¼ï¼›å€¼ 1 ä»£è¡¨æ–°é²œæ©˜å­ï¼›å€¼ 2 ä»£è¡¨è…çƒ‚çš„æ©˜å­ã€‚æ¯åˆ†é’Ÿï¼Œä»»ä½•ä¸è…çƒ‚çš„æ©˜å­ï¼ˆåœ¨ 4 ä¸ªæ­£æ–¹å‘ä¸Šï¼‰ç›¸é‚»çš„æ–°é²œæ©˜å­éƒ½ä¼šè…çƒ‚ã€‚ è¿”å›ç›´åˆ°å•å…ƒæ ¼ä¸­æ²¡æœ‰æ–°é²œæ©˜å­ä¸ºæ­¢æ‰€å¿…é¡»ç»è¿‡çš„æœ€å°åˆ†é’Ÿæ•°ã€‚å¦‚æœä¸å¯èƒ½ï¼Œè¿”å› -1ã€‚ ç¤ºä¾‹ 1ï¼š 123456789101112è¾“å…¥ï¼š[[2,1,1],[1,1,0],[0,1,1]]è¾“å‡ºï¼š4ç¤ºä¾‹ 2ï¼šè¾“å…¥ï¼š[[2,1,1],[0,1,1],[1,0,1]]è¾“å‡ºï¼š-1è§£é‡Šï¼šå·¦ä¸‹è§’çš„æ©˜å­ï¼ˆç¬¬ 2 è¡Œï¼Œ ç¬¬ 0 åˆ—ï¼‰æ°¸è¿œä¸ä¼šè…çƒ‚ï¼Œå› ä¸ºè…çƒ‚åªä¼šå‘ç”Ÿåœ¨ 4 ä¸ªæ­£å‘ä¸Šã€‚ç¤ºä¾‹ 3ï¼šè¾“å…¥ï¼š[[0,2]]è¾“å‡ºï¼š0è§£é‡Šï¼šå› ä¸º 0 åˆ†é’Ÿæ—¶å·²ç»æ²¡æœ‰æ–°é²œæ©˜å­äº†ï¼Œæ‰€ä»¥ç­”æ¡ˆå°±æ˜¯ 0 ã€‚ æç¤ºï¼š 1231 &lt;&#x3D; grid.length &lt;&#x3D; 101 &lt;&#x3D; grid[0].length &lt;&#x3D; 10grid&#96;[i][j]&#96; ä»…ä¸º 0ã€1 æˆ– 2 æ€è·¯ï¼š å¹¿åº¦ä¼˜å…ˆæœç´¢ã€‚å¹¿åº¦ä¼˜å…ˆæœç´¢çš„è¯ä¸€èˆ¬ä¼šä½¿ç”¨é˜Ÿåˆ—çš„æ€æƒ³ï¼Œæ·±åº¦ä¼˜å…ˆæœç´¢ä½¿ç”¨æ ˆçš„æ€æƒ³ã€‚æœ€ä¸»è¦è¿˜æœ‰å¦‚ä½•å»æ§åˆ¶èŠ‚ç‚¹å»ä¸Šä¸‹å·¦å³éå†ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦è®¾ç½®ä¸€ä¸ªlocsæ•°ç»„ä¸ºï¼š[[0,-1],[0,1],[1,0],[-1,0]]ï¼Œåœ¨éå†æ¯ä¸ªé˜Ÿåˆ—å…ƒç´ æ—¶ï¼Œéƒ½è®©å®ƒå»å’Œlocsæ•°ç»„çš„æ¯ä¸ªå…ƒç´ è¿›è¡Œç›¸åŠ å‡ï¼Œå¾—åˆ°è¿™ä¸ªå…ƒç´ ä¸Šä¸‹å·¦å³çš„å…ƒç´ ï¼Œå°†ä¸º1çš„å…ƒç´ ï¼ˆå³æ–°é²œæ©™å­ï¼‰ï¼Œå˜ä¸º2ï¼ˆå³è…çƒ‚æ©™å­ï¼‰ã€‚å› ä¸ºæˆ‘ä»¬è¦è®¡ç®—æ—¶é—´ï¼Œä½†åˆä¸èƒ½å°†å¾ªç¯æ¬¡æ•°ç”¨æ¥è®¡æ—¶ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†æ—¶é—´å’ŒèŠ‚ç‚¹çš„xï¼Œyåæ ‡ä¸€é½ä½œä¸ºä¸€ä¸ªå…ƒç´ è¿›å…¥é˜Ÿåˆ—ã€‚ é¢˜è§£ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041/** * @param &#123;number[][]&#125; grid * @return &#123;number&#125; */var orangesRotting = function(grid) &#123; var row=grid.length; var col=grid[0].length; var queue=[]; var locs=[[0,-1],[0,1],[1,0],[-1,0]]; var time=0; var x,y; for(var i=0;i&lt;row;++i)&#123; for(var j=0;j&lt;col;++j)&#123; if(grid[i][j]==2)&#123; queue.push([i,j,time]); &#125; &#125; &#125; while(queue.length!==0)&#123; //è¿™æ˜¯queueï¼ï¼ä¸è¦å†™æˆstack,å…ˆè¿›å…ˆå‡ºæ˜¯ç”¨shift [x,y,time]=queue.shift(); for(var t=0;t&lt;locs.length;++t)&#123; var new_x=x+locs[t][0]; var new_y=y+locs[t][1]; if(new_x&gt;=0&amp;&amp;new_x&lt;row&amp;&amp;new_y&gt;=0&amp;&amp;new_y&lt;col)&#123; if(grid[new_x][new_y]===1)&#123; queue.push([new_x,new_y,time+1]); grid[new_x][new_y]=2; &#125; &#125; &#125; &#125; for(var p=0;p&lt;row;++p)&#123; for(var q=0;q&lt;col;++q)&#123; if(grid[p][q]==1)&#123; return -1; &#125; &#125; &#125; return time;&#125;;","categories":[{"name":"æ¯æ—¥ä¸€é¢˜","slug":"æ¯æ—¥ä¸€é¢˜","permalink":"http://delaprada.com/categories/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98/"}],"tags":[{"name":"æ¯æ—¥ä¸€é¢˜","slug":"æ¯æ—¥ä¸€é¢˜","permalink":"http://delaprada.com/tags/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98/"}]},{"title":"æ¯æ—¥ä¸€é¢˜â€”â€”ç‰ˆæœ¬å·æ¯”è¾ƒ éšæœºç”Ÿæˆå­—ç¬¦ä¸² ç±»å‹æ¯”è¾ƒ","slug":"æ¯æ—¥ä¸€é¢˜â€”â€”ç‰ˆæœ¬å·æ¯”è¾ƒ-éšæœºç”Ÿæˆå­—ç¬¦ä¸²","date":"2020-03-03T09:01:38.000Z","updated":"2020-03-03T14:14:38.000Z","comments":true,"path":"2020/03/03/æ¯æ—¥ä¸€é¢˜â€”â€”ç‰ˆæœ¬å·æ¯”è¾ƒ-éšæœºç”Ÿæˆå­—ç¬¦ä¸²/","link":"","permalink":"http://delaprada.com/2020/03/03/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98%E2%80%94%E2%80%94%E7%89%88%E6%9C%AC%E5%8F%B7%E6%AF%94%E8%BE%83-%E9%9A%8F%E6%9C%BA%E7%94%9F%E6%88%90%E5%AD%97%E7%AC%A6%E4%B8%B2/","excerpt":"","text":"ç‰ˆæœ¬å·æ¯”è¾ƒæ¯”è¾ƒç‰ˆæœ¬å· ï¼ˆç±»ä¼¼1.0.1/1.2.0/1.2/0.1ï¼‰å®ç°ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºæ¯”è¾ƒä¸¤ä¸ªç‰ˆæœ¬å·ï¼ˆversion1ã€version2ï¼‰å¦‚æœversion1 &gt; version2ï¼Œè¿”å›1ï¼›å¦‚æœversion1 &lt; version2ï¼Œè¿”å›-1ï¼Œå…¶ä»–æƒ…å†µè¿”å›0ã€‚ç‰ˆæœ¬å·è§„åˆ™x.y.zï¼Œxyzå‡ä¸ºå¤§äºç­‰äº0çš„æ•´æ•°ï¼Œè‡³å°‘æœ‰xä½ 123456789101112131415161718192021222324252627282930313233function compare(str1,str2)&#123; str1=str1.split(\".\"); str2=str2.split(\".\"); str1=str1.map(Number); str2=str2.map(Number); var len; var len1=str1.length; var len2=str2.length; if(len1&gt;len2)&#123; len=len2; &#125; else&#123; len=len1; &#125; for(var i=0;i&lt;len;++i)&#123; if(str1[i]&gt;str2[i])&#123; return 1; &#125; else if(str1[i]&lt;str2[i])&#123; return -1; &#125; &#125; if(len1===len2)&#123; return 0; &#125; else if(len1&gt;len2)&#123; return 1; &#125; else&#123; return -1; &#125;&#125;console.log(compare('1.0.1','1.0')); éšæœºç”Ÿæˆå­—ç¬¦ä¸²éšæœºç”Ÿæˆå­—ç¬¦ä¸²å®ç°ä¸€ä¸ªéšæœºç¬¦ä¸²ç”Ÿæˆå‡½æ•° randomStr()ï¼Œè¦æ±‚å¦‚ä¸‹ï¼šç”Ÿæˆçš„éšæœºçš„å­—ç¬¦ä¸²åº”è¯¥ä»¥å­—æ¯å¼€å¤´ï¼Œå¹¶åŒ…å« [a-z][0-9] è¿™äº›å­—ç¬¦ã€‚ç”Ÿæˆçš„å­—ç¬¦ä¸²é•¿åº¦ä¸º 8ã€‚ç”Ÿæˆçš„å­—ç¬¦ä¸²ä¸èƒ½å¤Ÿåœ¨ç¨‹åºè¿è¡Œçš„ç”Ÿå‘½å‘¨æœŸä¸­å­˜åœ¨é‡å¤çš„æƒ…å½¢ã€‚ 1234567891011121314function randomString(len,chars)&#123; var res=''; for(var i=0;i&lt;len;++i)&#123; //å› ä¸ºMath.random()åŒ…æ‹¬0ä½†ä¸åŒ…æ‹¬1ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥ä¹˜ä¸Šchars.length if(i==0)&#123; res+=chars[Math.floor(Math.random()*26)]; &#125; else&#123; res+=chars[Math.floor(Math.random()*chars.length)]; &#125; &#125; return res;&#125;console.log(randomString(8,'abcdefghijklmnopqrstuvwxyz0123456789')); éšå¼ç±»å‹è½¬æ¢ä¸‹é¢ä»£ç ä¸­ a åœ¨ä»€ä¹ˆæƒ…å†µä¸‹ä¼šæ‰“å° 1ï¼Ÿ1234var a = ?;if(a == 1 &amp;&amp; a == 2 &amp;&amp; a == 3)&#123; console.log(1);&#125; é¢˜è§£ï¼š 123456789var a=&#123; i:1, toString()&#123; return this.i++; &#125;&#125;if(a==1&amp;&amp;a==2&amp;&amp;a==3)&#123; console.log(1);&#125;","categories":[{"name":"æ¯æ—¥ä¸€é¢˜","slug":"æ¯æ—¥ä¸€é¢˜","permalink":"http://delaprada.com/categories/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98/"}],"tags":[{"name":"æ¯æ—¥ä¸€é¢˜","slug":"æ¯æ—¥ä¸€é¢˜","permalink":"http://delaprada.com/tags/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98/"}]},{"title":"æ˜“æ··æ·†JSé¢˜ç›®â€”â€”thisæŒ‡å‘ é—­åŒ…","slug":"æ˜“æ··æ·†JSé¢˜ç›®â€”â€”thisæŒ‡å‘-é—­åŒ…","date":"2020-02-18T02:23:00.000Z","updated":"2020-02-18T02:24:08.000Z","comments":true,"path":"2020/02/18/æ˜“æ··æ·†JSé¢˜ç›®â€”â€”thisæŒ‡å‘-é—­åŒ…/","link":"","permalink":"http://delaprada.com/2020/02/18/%E6%98%93%E6%B7%B7%E6%B7%86JS%E9%A2%98%E7%9B%AE%E2%80%94%E2%80%94this%E6%8C%87%E5%90%91-%E9%97%AD%E5%8C%85/","excerpt":"","text":"Qï¼šä»£ç è¿è¡Œç»“æœ 1234567var a = function () &#123; this.b = 3; &#125;var c = new a();a.prototype.b = 9;var b = 7;a();console.log(b);console.log(c.b); è§£ï¼š æ•´ä¸ªä»£ç åœ¨å˜é‡æå‡ä¹‹åå¯ä»¥å†™ä¸ºï¼š 123456789101112var a;var c;var b;a=function()&#123; this.b=3;&#125;c=new a();a.prototype.b=9;b=7;a();console.log(b);console.log(c.b); æ³¨æ„ï¼šå‡½æ•°å£°æ˜çš„æ—¶å€™è¿˜æ²¡æœ‰æ‰§è¡Œï¼ä¸è¦å¼„æ··äº†ã€‚å½“æ‰§è¡Œc=new a()çš„æ—¶å€™ï¼Œä¼šå°†å‡½æ•°aå†…éƒ¨çš„thisæŒ‡å‘cï¼Œæ‰€ä»¥c.bæ­¤æ—¶å°±æ˜¯3ã€‚a.prototype.b=9æ²¡æœ‰ä»€ä¹ˆå½±å“ã€‚b=7;è¡¨ç¤ºå°†å…¨å±€å˜é‡bèµ‹å€¼ä¸º7ã€‚æ­¤åæ‰§è¡Œäº†å‡½æ•°a()ï¼Œè¦æ³¨æ„åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œå‡½æ•°ä¸­thisçš„æŒ‡å‘æ˜¯æŒ‡å‘å…¨å±€ä½œç”¨åŸŸçš„ï¼Œæ‰€ä»¥æ‰§è¡Œå‡½æ•°a()çš„è¯æ˜¯æŠŠå…¨å±€å˜é‡bçš„å€¼å˜ä¸º3ã€‚æ‰€ä»¥è¾“å‡ºçš„æ˜¯3 3ã€‚ Qï¼šä»¥æœ€å°çš„æ”¹åŠ¨è§£å†³ä»¥ä¸‹ä»£ç çš„é”™è¯¯ï¼ˆå¯ä»¥ä½¿ç”¨es6ï¼‰ 123456789101112131415const obj = &#123;name: \" jsCoder\",skill: [\"es6\", \"react\", \"angular\"],say: function () &#123; for(var i = 0, len = this.skill.length; i&lt; len; i++)&#123; setTimeout(function()&#123; console.log('No.' + i + this.name); console.log(this.skill[i]); console.log('--------------------------'); &#125;, 0); console.log(i); &#125;&#125;&#125;;obj.say(); è§£ï¼š ç¬¬ä¸€ç‚¹ï¼šforå¾ªç¯å½“ä¸­æœ‰ä¸ªå¼‚æ­¥å‡½æ•°ï¼Œè€Œä¸”å¼‚æ­¥å‡½æ•°æ ¹æ®forå¾ªç¯içš„å€¼ä¾æ¬¡è¾“å‡ºNo.1ï¼ŒNo.2ï¼ŒNo.3ï¼Œè¿™æ ·çš„è¯forå¾ªç¯ä¸­iå¿…é¡»ä½¿ç”¨letå»å£°æ˜ï¼Œå› ä¸ºä½¿ç”¨letæ‰èƒ½è®©å¼‚æ­¥å‡½æ•°è®°ä½æ¯ä¸€è½®içš„å€¼ï¼Œå¾—åˆ°ç›¸åº”çš„è¾“å‡ºç»“æœã€‚ ç¬¬äºŒç‚¹ï¼šåœ¨å¯¹è±¡å‡½æ•°sayä¸­ï¼Œæœ‰ä¸€ä¸ªå¼‚æ­¥å‡½æ•°ï¼Œå®ƒä½¿ç”¨äº†thisã€‚æºä»£ç çš„æ„å›¾æ˜¯æƒ³è®©è¿™ä¸ªthisè¡¨ç¤ºå¯¹è±¡objï¼Œä½†æ˜¯å¯¹è±¡çš„æ–¹æ³•sayçš„thisæŒ‡å‘çš„æ˜¯objï¼Œä½†æ˜¯è¿™ä¸ªæ–¹æ³•å†…éƒ¨çš„å‡½æ•°ï¼ˆä½¿ç”¨äº†é—­åŒ…ï¼‰æ˜¯æŒ‡å‘å…¨å±€å˜é‡çš„ï¼è¿™ä¹ˆå†™æ˜¯å¾—ä¸åˆ°æƒ³è¦çš„ç»“æœçš„ã€‚æ‰€ä»¥è¦å°†setTimeoutå‡½æ•°æ”¹ä¸ºç®­å¤´å‡½æ•°ï¼Œå› ä¸ºç®­å¤´å‡½æ•°å®ƒä¼šç»§æ‰¿ä¸Šä¸€å±‚ä½œç”¨åŸŸçš„thisï¼Œæ‰€ä»¥å®ƒä¼šç»§æ‰¿sayå‡½æ•°çš„thisï¼Œå°±ä¼šæŒ‡å‘objäº†ã€‚ ä¿®æ”¹åçš„ä»£ç ä¸ºï¼š 12345678910111213141516const obj = &#123; name: \" jsCoder\", skill: [\"es6\", \"react\", \"angular\"], say: function () &#123; for(let i = 0,len=this.skill.length; i&lt;len; i++)&#123; //é—­åŒ…ï¼ï¼ setTimeout(()=&gt;&#123; console.log('No.' + (i+1) + this.name); console.log(this.skill[i]); console.log('--------------------------'); &#125;, 0); console.log(i+1); &#125; &#125;&#125;;obj.say(); Qï¼šrepeat å®ç°ï¼Œä½¿ç”¨JSå®ç°ä¸€ä¸ªrepeatæ–¹æ³•ï¼Œè°ƒç”¨è¿™ä¸ª repeatedFunc(â€œhelloworldâ€)ï¼Œä¼šalert4æ¬¡ helloworld, æ¯æ¬¡é—´éš”3ç§’ 1234function repeat(func, times, wait) &#123;&#125;const repeatFunc = repeat(alert, 4, 3000)repearFunc(\"helloworld\"); è§£ï¼š è¿™ç§é—®é¢˜ä¸€èˆ¬è¦ç»“åˆé—­åŒ…æ¥å®ç°ã€‚ 1234567891011121314function repeat(func, times, wait)&#123; var count=0; var timer=null; return function()&#123; var args=[].slice.call(arguments); timer=setInterval(function()&#123; if(count==(times-1))&#123; clearTimeout(timer); &#125; func(args.join(\"\")); count++; &#125;,wait) &#125;&#125; é¢˜ç›®ä¸­è¯´ï¼Œè°ƒç”¨repeatedFunc(&quot;helloworld&quot;)ä¼šæœ‰ç›¸å…³çš„ç»“æœï¼Œæ‰€ä»¥å®ƒåº”è¯¥æ˜¯åœ¨å‡½æ•°ä¸­è¿˜æœ‰ä¸€ä¸ªå‡½æ•°çš„ï¼Œæ‰€ä»¥åº”è¯¥æœ‰ä¸ªé—­åŒ…ã€‚é€šè¿‡é—­åŒ…å¯ä»¥è®°ä½countçš„å€¼ã€‚æ³¨æ„clearTimeoutè¦å†™åœ¨setIntervalå‡½æ•°å½“ä¸­ï¼Œè¿™ä¸ªå’Œé˜²æŠ–èŠ‚æµä¸åŒï¼Œå› ä¸ºå®ƒåªæ‰§è¡Œäº†ä¸€æ¬¡å‡½æ•°ï¼Œå®ƒæ˜¯é€šè¿‡setIntervalå‡½æ•°çš„å¾ªç¯æ‰ä¼šè¾“å‡ºå¤šæ¬¡ç»“æœï¼Œæ‰€ä»¥è¦å†™åœ¨é‡Œé¢æ‰èƒ½å¤Ÿåˆ¤æ–­countçš„å€¼æ˜¯å¦å·²ç»åˆ°è¾¾è¾“å‡ºæ¬¡æ•°ã€‚ Qï¼šå®ç°æ¯éš”1sè¾“å‡ºä¸€ä¸ªæ•°ç»„çš„å…ƒç´ åŠå…¶ç´¢å¼• è§£ï¼š è¿™é¢˜å’Œä¸Šä¸€é¢˜çš„æ€è·¯ç±»ä¼¼ï¼Œä½†æ˜¯å®ƒæ²¡æœ‰éœ€è¦è¯´è¦è°ƒç”¨çš„æ—¶å€™å†å»æ‰§è¡Œï¼Œé‚£å°±ä¸éœ€è¦å†™return functionf(){}äº†ã€‚å› ä¸ºsetIntervalå‡½æ•°å·²ç»æ˜¯outputå‡½æ•°çš„å†…éƒ¨å‡½æ•°ï¼Œæœ‰é—­åŒ…èƒ½å¤Ÿè®°ä½countçš„å€¼äº†ã€‚ 123456789101112131415function output(arr) &#123; var length = arr.length; var count = 0; var timer = null; timer = setInterval(function() &#123; if (count == length - 1) &#123; clearTimeout(timer); &#125; console.log(arr[count]); console.log(count); count++; &#125;, 1000);&#125;output([1, 2, 3, 4, 5]);","categories":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://delaprada.com/categories/JavaScript/"}],"tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://delaprada.com/tags/JavaScript/"}]},{"title":"Vueä¹‹è®¡ç®—å±æ€§çš„åº”ç”¨","slug":"Vueä¹‹è®¡ç®—å±æ€§çš„åº”ç”¨","date":"2020-02-17T02:52:19.000Z","updated":"2020-02-17T02:54:24.000Z","comments":true,"path":"2020/02/17/Vueä¹‹è®¡ç®—å±æ€§çš„åº”ç”¨/","link":"","permalink":"http://delaprada.com/2020/02/17/Vue%E4%B9%8B%E8%AE%A1%E7%AE%97%E5%B1%9E%E6%80%A7%E7%9A%84%E5%BA%94%E7%94%A8/","excerpt":"","text":"æ˜¨å¤©é¢è¯•çš„æ—¶å€™è¢«é—®åˆ°äº†Vueè®¡ç®—å±æ€§ç›¸å…³çš„ä»£ç é¢˜ï¼Œåˆæ˜¯ä¸€è„¸æ‡µé€¼å‘€â€¦èµ¶ç´§æ¥æ€»ç»“ä¸€ä¸‹ã€‚ é¢è¯•å®˜å…ˆå‡ºäº†ç¬¬ä¸€é“é¢˜ï¼Œç‚¹å‡»divæ—¶è¾“å‡ºæ˜¯ä»€ä¹ˆï¼Ÿ 123456789101112131415161718&lt;body&gt; &lt;div id=\"app\" @click=\"b += 1\"&gt;&#123;&#123;c&#125;&#125;&lt;/div&gt; &lt;script type=\"text/javascript\"&gt; var vm = new Vue(&#123; el: \"#app\", data() &#123; return &#123; a: 1, b: 2 &#125;; &#125;, computed: &#123; c() &#123; console.log(this.b); return this.a; &#125;, &#125; &#125;); &lt;/script&gt;&lt;/body&gt; è¾“å‡ºæ˜¯3ã€‚ é¦–å…ˆï¼Œcomputedä¸­çš„å±æ€§éƒ½æ˜¯ä»¥å‡½æ•°çš„å½¢å¼å£°æ˜çš„ï¼Œçœ‹çœ‹å®˜ç½‘çš„ä¾‹å­ï¼š ç»“æœæ˜¯ï¼š 123Original message: &quot;Hello&quot;Computed reversed message: &quot;olleH&quot; computedå±æ€§å®ƒæ‰€ä¾èµ–çš„æ•°æ®æ˜¯dataå½“ä¸­çš„ï¼Œæ˜¯è¦ä½¿ç”¨thisæ¥å»è·å–çš„ã€‚æ‰€ä»¥è®¡ç®—å±æ€§cä¸­çš„this.bå’Œthis.aå…¶å®æ˜¯dataå½“ä¸­çš„å±æ€§å€¼ã€‚æ‰§è¡Œç‚¹å‡»äº‹ä»¶ä¹‹åï¼Œbæ˜¯ä¼šå‘ç”Ÿå˜åŒ–çš„ï¼Œæ‰€ä»¥åœ¨è®¡ç®—å±æ€§cä¸­è¾“å‡ºthis.bæ˜¯ä¼šå‘ç”Ÿå˜åŒ–çš„ï¼Œæ‰€ä»¥åœ¨æ§åˆ¶å°ä¼šè¾“å‡º3ã€‚å› ä¸ºè®¡ç®—å±æ€§creturnçš„æ˜¯this.aï¼Œæ‰€ä»¥çš„å€¼æ˜¯ä¸å˜çš„ï¼Œæ˜¯1ã€‚ æ¥ç€é¢è¯•å®˜åˆå‡ºäº†ç¬¬äºŒé“é¢˜ï¼Œæ­¤æ—¶åˆè¾“å‡ºä»€ä¹ˆï¼Ÿï¼ˆå…¶å®é¢è¯•å®˜äººçœŸçš„å¥½å¥½ï¼Œä»–çš„è¡¨è¿°æ˜¯æ­¤æ—¶ä¼šè¾“å‡ºä¹ˆï¼Ÿä»–è¿™ä¹ˆé—®çš„è¯æˆ‘å°±ä¼šå€¾å‘äºå›ç­”ä¸ä¼šè¾“å‡ºï¼‰ 1234567891011121314151617181920&lt;body&gt; &lt;div id=\"app\" @click=\"b += 1\"&gt;&#123;&#123;c&#125;&#125;&lt;/div&gt; &lt;script type=\"text/javascript\"&gt; var vm = new Vue(&#123; el: \"#app\", data() &#123; return &#123; a: 1, b: 2 &#125;; &#125;, computed: &#123; c() &#123; if(false)&#123; console.log(this.b); return this.a; &#125; &#125;, &#125; &#125;); &lt;/script&gt;&lt;/body&gt; ç­”æ¡ˆæ˜¯ä¸è¾“å‡ºã€‚æ­¤æ—¶cè¿æ¸²æŸ“éƒ½ä¸ä¼šå‘ç”Ÿã€‚ æœ€åé¢è¯•å®˜åˆé—®äº†ç¬¬ä¸‰é“é¢˜ï¼Œæ­¤æ—¶ä¼šè¾“å‡ºä»€ä¹ˆï¼Ÿ 123456789101112131415161718&lt;body&gt; &lt;div id=\"app\" @click=\"b += 1\"&gt;absdflj&lt;/div&gt; &lt;script type=\"text/javascript\"&gt; var vm = new Vue(&#123; el: \"#app\", data() &#123; return &#123; a: 1, b: 2 &#125;; &#125;, computed: &#123; c() &#123; console.log(this.b); return this.a; &#125;, &#125; &#125;); &lt;/script&gt;&lt;/body&gt; æ­¤æ—¶è¿™ä¸ªè®¡ç®—å±æ€§å¹¶æ²¡æœ‰å†™åœ¨é¡µé¢ä¸Šï¼Œæ‰€ä»¥æ˜¯ä¸ä¼šç›‘å¬cçš„å€¼ï¼Œæ­¤æ—¶æ§åˆ¶å°æ²¡æœ‰è¾“å‡ºï¼Œé¡µé¢æ˜¾ç¤ºçš„æ˜¯ï¼šabsdfljã€‚","categories":[{"name":"Vue","slug":"Vue","permalink":"http://delaprada.com/categories/Vue/"}],"tags":[{"name":"Vue","slug":"Vue","permalink":"http://delaprada.com/tags/Vue/"}]},{"title":"JavaScriptä¹‹å˜é‡æå‡","slug":"JavaScriptä¹‹å˜é‡æå‡","date":"2020-02-17T01:58:59.000Z","updated":"2020-02-17T02:32:14.000Z","comments":true,"path":"2020/02/17/JavaScriptä¹‹å˜é‡æå‡/","link":"","permalink":"http://delaprada.com/2020/02/17/JavaScript%E4%B9%8B%E5%8F%98%E9%87%8F%E6%8F%90%E5%8D%87/","excerpt":"","text":"ä»Šå¤©é¢è¯•çš„æ—¶å€™è¢«é—®åˆ°äº†å˜é‡æå‡çš„é—®é¢˜ï¼Œä¸€è„¸æ‡µé€¼ï¼ŒæŒæ¡å¾—ä¸å¤Ÿç†Ÿç»ƒï¼Œå†™ç¯‡åšå®¢æ¥æ€»ç»“ä¸€ä¸‹ã€‚ JSä»£ç è§£æè§„åˆ™ ç¬¬ä¸€æ­¥ä¸ºè§£é‡Šï¼šå…ˆæ‰«ææ‰€æœ‰çš„JSä»£ç ï¼ŒæŠŠæ‰€æœ‰å£°æ˜æå‡åˆ°é¡¶ç«¯ã€‚ ç¬¬äºŒæ­¥ä¸ºæ‰§è¡Œï¼šæ‰§è¡Œå°±æ˜¯æ“ä½œä¸€ç±»çš„ã€‚ å˜é‡æå‡ä¾‹ä¸€ï¼š 12console.log(a); //undefinedvar a=10; å› ä¸ºæœ‰å˜é‡æå‡ï¼Œä¸Šé¢çš„ä»£ç ç›¸å½“äºï¼š 123var a;console.log(a);a=10; å‡½æ•°æå‡å‡½æ•°å£°æ˜çš„ä¸¤ç§æ–¹å¼ å‡½æ•°å£°æ˜å¼ 1function bar()&#123; &#125; å‡½æ•°å­—é¢é‡å¼ 1var bar=function()&#123; &#125; æ³¨æ„ï¼šå‡½æ•°å­—é¢é‡å¼çš„æå‡å’Œå˜é‡æå‡ä¸€æ ·ï¼Œéƒ½æ˜¯åªæå‡å£°æ˜ï¼Œä¸æå‡èµ‹å€¼ï¼Œæ¯”å¦‚ä¸Šé¢ä»£ç ä¸­å‡½æ•°å­—é¢é‡å¼ï¼Œåªä¼šæŠŠvar baræå‡ä¸Šå»ï¼Œä½†æ˜¯å‡½æ•°å£°æ˜å¼æ˜¯ä¼šå°†æ•´ä¸ªå‡½æ•°ä½“éƒ½æå‡ä¸Šå»ã€‚ ä¾‹äºŒï¼š 1234foo(); //aaafunction foo()&#123; console.log(\"aaa\");&#125; å› ä¸ºå­˜åœ¨å‡½æ•°å£°æ˜æå‡ï¼Œå‡½æ•°å£°æ˜æå‡ä¼šç›´æ¥æŠŠæ•´ä¸ªå‡½æ•°æå‡åˆ°æ‰§è¡Œç¯å¢ƒçš„æœ€é¡¶ç«¯ã€‚ç›¸å½“äºï¼š 1234function foo()&#123; console.log(\"aaa\");&#125;foo(); æ³¨æ„ï¼šå˜é‡æå‡åªæå‡å˜é‡åï¼Œè€Œå‡½æ•°æå‡æ˜¯ä¼šæå‡æ•´ä¸ªå‡½æ•°ä½“ã€‚å‡½æ•°æå‡åœ¨å˜é‡æå‡ä¹‹å‰ã€‚ ä¾‹ä¸‰ï¼š 1234foo(); //foo is not a functionvar foo = function()&#123; console.log(\"aaa\");&#125; å› ä¸ºè¿›è¡Œäº†å˜é‡æå‡ï¼ˆå‡½æ•°å­—é¢é‡å¼ï¼‰ï¼Œä¸Šé¢çš„ä»£ç ç›¸å½“äºï¼š 12345var foo;foo();foo=function()&#123; console.log(\"aaa\");&#125; JSè§£æåœ¨é‡åˆ°foo()æ—¶ä¼šé»˜è®¤å½“åšå‡½æ•°æ¥è§£æï¼Œæ‰€ä»¥ä¼šè¾“å‡ºfoo is not a functionã€‚ ä¾‹å››ï¼š 1234567console.log(foo);var foo=10;console.log(foo);function foo()&#123; console.log(10);&#125;console.log(foo); è¾“å‡ºï¼š ä¸Šé¢çš„ä»£ç ç›¸å½“äºï¼š 12345678function foo()&#123; console.log(10);&#125;var foo;console.log(foo); //foo()&#123;console.log(10);&#125;foo=10;console.log(foo); //10console.log(foo); //10 ç¬¬ä¸€ä¸ªconsole.log(foo)ä¹‹æ‰€ä»¥è¾“å‡ºå‡½æ•°ä½“ï¼Œæ˜¯å› ä¸ºvar fooåªæ˜¯å£°æ˜ï¼ˆæå‡äº†çš„å£°æ˜ï¼‰ï¼Œå¹¶æ²¡æœ‰èµ‹å€¼ï¼Œæ‰€ä»¥å®ƒä¼šè°ƒç”¨ä¸Šé¢çš„å‡½æ•°ä½“ã€‚ é¢è¯•é¢˜å…ˆçœ‹ä¸€é“ç»å…¸é¢è¯•é¢˜ï¼š 123456789console.log(v1);var v1 = 100;function foo() &#123; console.log(v1); var v1 = 200; console.log(v1);&#125;foo();console.log(v1); è¾“å‡ºæ˜¯ï¼š 1234&#x2F;&#x2F;undefined&#x2F;&#x2F;undefined&#x2F;&#x2F;200&#x2F;&#x2F;100 ä¸Šé¢çš„ä»£ç ç›¸å½“äºï¼š 1234567891011var v1;console.log(v1); //undefinedv1=100;function foo()&#123; var v1; console.log(v1); //undefined v1=200; console.log(v1); //200&#125;foo();console.log(v1); //100 æ³¨æ„ï¼Œå¦‚æœå†…éƒ¨æ²¡æœ‰å£°æ˜v1çš„æ—¶å€™ï¼Œå‡½æ•°æ‰ä¼šåˆ°å…¨å±€ä½œç”¨åŸŸå»æŸ¥æ‰¾å˜é‡çš„èµ‹å€¼ã€‚ä½†æ˜¯å¦‚æœå‡½æ•°ä½œç”¨åŸŸå†…éƒ¨å®šä¹‰äº†çš„è¯ï¼Œå°±ä¸ä¼šåˆ°å…¨å±€ä½œç”¨åŸŸå»æ‰¾ã€‚å‚ç…§ä½œç”¨åŸŸé“¾çš„å®šä¹‰ã€‚ çœ‹ä¸€é“å­—èŠ‚é¢è¯•æ—¶å€™çš„é¢˜ç›®ï¼š 1234567891011var a = 'byte'function foo() &#123; if (a === undefined) &#123; var a = 'dance' &#125; else &#123; a = 'bytedance' &#125; return a;&#125;console.log(foo());console.log(a); è¾“å‡ºä¸ºï¼š 12&#x2F;&#x2F;dance&#x2F;&#x2F;byte ä¸Šé¢ä»£ç å®é™…æ•ˆæœæ˜¯ï¼š 1234567891011121314function foo()&#123; var a; if(a===undefined)&#123; a='dance'; &#125; else&#123; a='bytedance'; &#125; return a;&#125;var a;a='byte';console.log(foo());console.log(a); åœ¨å½“å‰ä½œç”¨åŸŸæœ‰å¯¹å˜é‡è¿›è¡Œå£°æ˜çš„æ—¶å€™ï¼Œæ˜¯ä¸ä¼šå»ä¸Šä¸€çº§ä½œç”¨åŸŸå»å¯»æ‰¾å˜é‡çš„å£°æ˜çš„ã€‚ å› ä¸ºconsole.log(a)åœ¨å½“å‰å‡½æ•°ä½œç”¨åŸŸæ‰¾åˆ°äº†var a;ï¼Œå³açš„å®šä¹‰ï¼Œæ‰€ä»¥å®ƒä¸ä¼šå»å…¨å±€ä½œç”¨åŸŸå»æ‰¾açš„å£°æ˜ï¼ˆåŠå€¼ï¼‰ã€‚ ä¸Šé¢çš„ä»£ç ä¹Ÿæ˜¯è¿™ä¸ªé“ç†ï¼Œa===undefinedä¼šæ‰¾åˆ°å½“å‰å‡½æ•°ä½œç”¨åŸŸçš„var a;çš„å®šä¹‰ï¼Œæ‰€ä»¥açš„å€¼ä¸ºundefinedã€‚ å‚è€ƒï¼šhttps://blog.csdn.net/qq_39712029/article/details/80951958 â€‹ https://blog.csdn.net/Demo_18/article/details/78493489","categories":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://delaprada.com/categories/JavaScript/"}],"tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://delaprada.com/tags/JavaScript/"}]},{"title":"Math.floor()å’Œ~~è¿ç®—ç¬¦çš„å¼‚åŒ","slug":"Math-floor-å’Œ-çš„å¼‚åŒ","date":"2020-02-10T03:14:06.000Z","updated":"2020-02-10T03:30:40.000Z","comments":true,"path":"2020/02/10/Math-floor-å’Œ-çš„å¼‚åŒ/","link":"","permalink":"http://delaprada.com/2020/02/10/Math-floor-%E5%92%8C-%E7%9A%84%E5%BC%82%E5%90%8C/","excerpt":"","text":"ä»Šå¤©åœ¨ç”¨JavaScriptå®ç°å¤§æ•°ç›¸åŠ çš„æ—¶å€™ï¼Œå‘ç°ç½‘ä¸Šçš„è§£æ³•å½“ä¸­æœ‰ä½¿ç”¨~~è¿ç®—ç¬¦ï¼Œä¹‹å‰æ²¡æœ‰è§è¿‡ã€‚åœ¨ç½‘ä¸Šä¸€æŸ¥ï¼Œè¯´æ˜¯Math.floor()çš„æ›´å¥½çš„ä¸€ç§è¡¨ç¤ºæ–¹æ³•ï¼Œè¿è¡Œé€Ÿåº¦æ›´å¿«ã€‚ä½†æ˜¯å°†å¤§æ•°ç›¸åŠ çš„ä»£ç ä¸­çš„~~æ¢æˆMath.floor()å‘è§‰å¾—ä¸åˆ°æ­£ç¡®çš„ç­”æ¡ˆï¼Œæ‰€ä»¥æƒ³æ¥åˆ†æä¸€ä¸‹å¼‚åŒã€‚ ~å’Œ~~~è¿ç®—ç¬¦ç”¨äºå°†æ•´æ•°å˜ä¸º-(N+1)ã€‚ ä¾‹å¦‚ï¼š 1234~2 &#x3D;&#x3D;&#x3D; -3; &#x2F;&#x2F;true~1 &#x3D;&#x3D;&#x3D; -2; &#x2F;&#x2F;true~0 &#x3D;&#x3D;&#x3D; -1; &#x2F;&#x2F;true~-1 &#x3D;&#x3D;&#x3D; 0; &#x2F;&#x2F;true ~~è¿ç®—ç¬¦~~æ˜¯Math.floor()çš„ä¸€ä¸ªæ›¿ä»£ï¼Œç›¸åŒçš„æ“ä½œä½†æ˜¯æ›´å¿«ã€‚å¯ä»¥ä½¿ç”¨å®ƒå°†ä»»ä½•æµ®ç‚¹æ•°è½¬æ¢ä¸ºæ•´æ•°ï¼ˆä¸‹å–æ•´ï¼‰ã€‚ ä¾‹å¦‚ï¼š 123~~2 &#x3D;&#x3D;&#x3D; Math.floor(2); &#x2F;&#x2F;true, 2~~2.4 &#x3D;&#x3D;&#x3D; Math.floor(2); &#x2F;&#x2F;true, 2~~3.9 &#x3D;&#x3D;&#x3D; Math.floor(3); &#x2F;&#x2F;true, 3 ~~å’ŒMath.floor()åœ¨æ€§èƒ½ä¸Šçš„ä¸åŒï¼š # Browser Math.floor() Bitwise double NOT ~~ #1 Firefox 7.0.1 42ms 29ms #2 Firefox 7.0.1 44ms 28ms #3 Chrome 15 63ms 64ms #4 Chrome 15 63ms 68ms #5 IE8 265ms 192ms #6 IE8 324ms 190ms å¤§æ•°ç›¸åŠ åœ¨å¤§æ•°ç›¸åŠ æ—¶ï¼Œä½¿ç”¨~~èƒ½å¤Ÿçš„åˆ°æ­£ç¡®çš„ç»“æœï¼š ä½†æ˜¯ä½¿ç”¨Math.floor()æ—¶ï¼Œç»“æœæ˜¯ï¼š ä¸»è¦æ˜¯å› ä¸ºå½“aæ•°ç»„å·²ç»popå®Œæ¯•ä¹‹åï¼Œå†å¯¹aæ‰§è¡Œpopæ“ä½œæ—¶ï¼Œè¾“å‡ºçš„æ˜¯undefinedã€‚è€Œ~~æ“ä½œundefinedå’ŒMath.floor()æ“ä½œundefinedæ˜¯ä¼šå¾—å‡ºä¸åŒçš„ç»“æœçš„ï¼š æ‰€ä»¥æ‰ä¼šå¯¼è‡´ä¸Šé¢çš„ç»“æœã€‚ å‚è€ƒï¼šhttp://rocha.la/JavaScript-bitwise-operators-in-practice","categories":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://delaprada.com/categories/JavaScript/"}],"tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://delaprada.com/tags/JavaScript/"}]},{"title":"æµè§ˆå™¨ç¼“å­˜","slug":"æµè§ˆå™¨ç¼“å­˜","date":"2020-02-04T10:17:33.000Z","updated":"2020-02-17T10:17:46.000Z","comments":true,"path":"2020/02/04/æµè§ˆå™¨ç¼“å­˜/","link":"","permalink":"http://delaprada.com/2020/02/04/%E6%B5%8F%E8%A7%88%E5%99%A8%E7%BC%93%E5%AD%98/","excerpt":"","text":"ç¼“å­˜è¿‡ç¨‹åˆ†æï¼š æµè§ˆå™¨æ¯æ¬¡å‘èµ·è¯·æ±‚ï¼Œéƒ½ä¼šå…ˆåœ¨æµè§ˆå™¨ç¼“å­˜ä¸­æŸ¥æ‰¾è¯·æ±‚çš„ç»“æœä»¥åŠç¼“å­˜æ ‡è¯† å¦‚æœæ²¡æœ‰è¯¥è¯·æ±‚çš„ç¼“å­˜ç»“æœå’Œç¼“å­˜æ ‡è¯†çš„è¯ï¼Œæµè§ˆå™¨ä¼šå‘æœåŠ¡å™¨å‘èµ·httpè¯·æ±‚ï¼ŒæœåŠ¡å™¨è¿”å›è¯¥è¯·æ±‚ç»“æœå’Œç¼“å­˜è§„åˆ™ æµè§ˆå™¨æ¯æ¬¡æ‹¿åˆ°è¿”å›çš„è¯·æ±‚ç»“æœéƒ½ä¼šå°†è¯¥ç»“æœå’Œç¼“å­˜æ ‡è¯†å­˜å…¥æµè§ˆå™¨ç¼“å­˜ä¸­ å¼ºç¼“å­˜å’Œåå•†ç¼“å­˜æµè§ˆå™¨ç¼“å­˜åˆ†ä¸ºï¼šå¼ºç¼“å­˜å’Œåå•†ç¼“å­˜ å¼ºç¼“å­˜ï¼šä¸ä¼šå‘æœåŠ¡å™¨å‘é€è¯·æ±‚ï¼Œç›´æ¥ä»ç¼“å­˜ä¸­è¯»å–èµ„æºã€‚å¯ä»¥é€šè¿‡è®¾ç½®ä¸¤ç§http headerå®ç°ï¼šExpireså’ŒCache-Controlã€‚ Expiresæ˜¯http/1çš„äº§ç‰©ã€‚å®ƒç”¨æ¥æŒ‡å®šèµ„æºåˆ°æœŸçš„æ—¶é—´ï¼ŒExpiresæ˜¯webæœåŠ¡å™¨å“åº”æ¶ˆæ¯å¤´å­—æ®µï¼Œåœ¨å“åº”httpè¯·æ±‚æ—¶å‘Šè¯‰æµè§ˆå™¨åœ¨è¿‡æœŸæ—¶é—´ä¹‹å‰æµè§ˆå™¨å¯ä»¥ç›´æ¥ä»æµè§ˆå™¨ç¼“å­˜å–æ•°æ®ï¼Œè€Œæ— éœ€å†æ¬¡è¯·æ±‚ã€‚ 1Expires: Thu, 10 Nov 2017 08:45:11 GMT è¿™ä¸ªå­—æ®µè®¾ç½®æ—¶æœ‰ä¸¤ä¸ªç¼ºç‚¹ï¼š ç”±äºæ˜¯ç»å¯¹æ—¶é—´ï¼Œç”¨æˆ·å¯èƒ½ä¼šå°†å®¢æˆ·ç«¯æœ¬åœ°çš„æ—¶é—´ä¿®æ”¹ï¼Œè€Œå¯¼è‡´æµè§ˆå™¨åˆ¤æ–­ç¼“å­˜å¤±æ•ˆï¼Œé‡æ–°è¯·æ±‚è¯¥èµ„æºã€‚ å†™æ³•å¤ªå¤æ‚ï¼Œè¡¨ç¤ºæ—¶é—´çš„å­—ç¬¦ä¸²å¤šä¸ªç©ºæ ¼ï¼Œå°‘ä¸ªå­—æ¯éƒ½ä¼šå¯¼è‡´éæ³•å±æ€§ä»è€Œå¤±æ•ˆ Cache-controlæ˜¯http/1.1çš„äº§ç‰©ã€‚å’ŒExpiresçš„å·®åˆ«åœ¨äºï¼ŒExpiresæ˜¯ç»å¯¹æ—¶é—´ï¼ŒCache-controlè¡¨ç¤ºçš„æ˜¯ç›¸å¯¹æ—¶é—´ 1Cache-control: max-age=2592000 Cache-controlå­—æ®µå¸¸ç”¨çš„å€¼ï¼š max-ageï¼šå³æœ€å¤§æœ‰æ•ˆæ—¶é—´ must-revalidateï¼šå¦‚æœè¶…è¿‡äº†max-ageçš„æ—¶é—´ï¼Œæµè§ˆå™¨å¿…é¡»å‘æœåŠ¡å™¨å‘é€è¯·æ±‚ï¼ŒéªŒè¯èµ„æºæ˜¯å¦è¿˜æœ‰æ•ˆ no-cacheï¼šä¸æ˜¯ä¸ç¼“å­˜çš„æ„æ€ï¼è¡¨ç¤ºå¯ä»¥åœ¨æœ¬åœ°ç¼“å­˜ï¼Œå¯ä»¥åœ¨ä»£ç†æœåŠ¡å™¨ç¼“å­˜ï¼Œä½†æ˜¯è¿™ä¸ªç¼“å­˜è¦æœåŠ¡å™¨éªŒè¯æ‰å¯ä»¥ä½¿ç”¨ã€‚ no-storeï¼šå½»åº•ç¦ç”¨ç¼“å­˜ï¼Œæœ¬åœ°å’Œä»£ç†æœåŠ¡å™¨éƒ½ä¸ç¼“å­˜ï¼Œæ¯æ¬¡éƒ½ä»æœåŠ¡å™¨è·å– publicï¼šæ‰€æœ‰å†…å®¹éƒ½å¯ä»¥è¢«ç¼“å­˜ï¼ˆåŒ…æ‹¬å®¢æˆ·ç«¯å’Œä»£ç†æœåŠ¡å™¨ï¼Œå¦‚CDNï¼‰ privateï¼šæ‰€æœ‰çš„å†…å®¹åªæœ‰å®¢æˆ·ç«¯æ‰å¯ä»¥ç¼“å­˜ï¼Œä»£ç†æœåŠ¡å™¨ä¸èƒ½ç¼“å­˜ã€‚é»˜è®¤å€¼ã€‚ è‡ªä»http/1.1å¼€å§‹ï¼ŒExpiresé€æ¸è¢«Cache-controlå–ä»£ã€‚Cache-controlæ˜¯ä¸€ä¸ªç›¸å¯¹æ—¶é—´ï¼Œå³ä½¿å®¢æˆ·ç«¯æ—¶é—´å‘ç”Ÿæ”¹å˜ï¼Œç›¸å¯¹æ—¶é—´ä¹Ÿä¸ä¼šéšä¹‹æ”¹å˜ï¼Œè¿™æ ·å¯ä»¥ä¿æŒæœåŠ¡å™¨å’Œå®¢æˆ·ç«¯çš„æ—¶é—´ä¸€è‡´æ€§ã€‚è€Œä¸”Cache-controlçš„å¯é…ç½®æ€§æ¯”è¾ƒå¼ºå¤§ã€‚ å¼ºç¼“å­˜åˆ¤æ–­æ˜¯å¦ç¼“å­˜çš„ä¾æ®æ¥è‡ªäºæ˜¯å¦è¶…å‡ºæŸä¸ªæ—¶é—´æˆ–è€…æ—¶é—´æ®µï¼Œè€Œä¸å…³å¿ƒæœåŠ¡å™¨ç«¯æ–‡ä»¶æ˜¯å¦å·²ç»æ›´æ–°ï¼Œè¿™å¯èƒ½å¯¼è‡´åŠ è½½æ–‡ä»¶ä¸æ˜¯æœåŠ¡å™¨ç«¯æœ€æ–°çš„å†…å®¹ã€‚é‚£æˆ‘ä»¬å¦‚ä½•è·çŸ¥æœåŠ¡å™¨ç«¯å†…å®¹æ˜¯å¦å·²ç»å‘ç”Ÿäº†æ›´æ–°å‘¢ï¼Ÿæ­¤æ—¶æˆ‘ä»¬éœ€è¦ç”¨åˆ°åå•†ç¼“å­˜ç­–ç•¥ã€‚ åå•†ç¼“å­˜ï¼šæ˜¯ç”±æœåŠ¡å™¨æ¥ç¡®å®šç¼“å­˜èµ„æºæ˜¯å¦å¯ç”¨ï¼Œæ‰€ä»¥å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ç«¯éœ€è¦é€šè¿‡æŸç§æ ‡è¯†æ¥è¿›è¡Œé€šä¿¡ï¼Œä»è€Œè®©æœåŠ¡å™¨åˆ¤æ–­è¯·æ±‚èµ„æºæ˜¯å¦å¯ä»¥ç¼“å­˜è®¿é—®ã€‚ ä¸»è¦æœ‰ä»¥ä¸‹ä¸¤ç§æ ‡è¯†ï¼š Last-Modifiedå’ŒIf-Modified-Sinceï¼š Last-Modifiedï¼šæµè§ˆå™¨åœ¨ç¬¬ä¸€æ¬¡è®¿é—®èµ„æºæ—¶ï¼ŒæœåŠ¡å™¨è¿”å›èµ„æºçš„åŒæ—¶ï¼Œåœ¨response headerä¸­æ·»åŠ Last-Modifiedçš„headerï¼Œå€¼æ˜¯è¿™ä¸ªèµ„æºåœ¨æœåŠ¡å™¨ç«¯çš„æœ€åä¿®æ”¹æ—¶é—´ã€‚ If-Modified-Sinceï¼šæµè§ˆå™¨ä¸‹ä¸€æ¬¡è¯·æ±‚è¿™ä¸ªèµ„æºï¼Œæµè§ˆå™¨æ£€æµ‹æœ‰Last-Modifiedè¿™ä¸ªheaderï¼Œäºæ˜¯æ·»åŠ If-Modified-Sinceè¿™ä¸ªheaderï¼Œå€¼å°±æ˜¯Last-Modifiedä¸­çš„å€¼ã€‚æœåŠ¡å™¨å†æ¬¡æ”¶åˆ°è¿™ä¸ªèµ„æºçš„è¯·æ±‚ï¼Œä¼šæ ¹æ®If-Modified-Sinceä¸­çš„å€¼ä¸æœåŠ¡å™¨ä¸­è¿™ä¸ªèµ„æºçš„æœ€åä¿®æ”¹æ—¶é—´å¯¹æ¯”ï¼Œå¦‚æœæ²¡æœ‰å˜åŒ–ï¼Œè¿”å›304å’Œç©ºçš„å“åº”ä½“ï¼Œå¯ä»¥ç›´æ¥ä»ç¼“å­˜è¯»å–ã€‚å¦‚æœæœåŠ¡å™¨ç«¯è¿™ä¸ªèµ„æºåœ¨If-Modified-Sinceä¹‹åè¢«ä¿®æ”¹äº†ï¼Œè¯´æ˜æ–‡ä»¶æœ‰æ›´æ–°ï¼Œè¿”å›æ–°çš„èµ„æºæ–‡ä»¶å’Œ200ã€‚ Etagå’ŒIf-None-Match: Etagå’ŒIf-None-Matchè¿”å›çš„æ˜¯ä¸€ä¸ªæ ¡éªŒç ã€‚Etagå¯ä»¥ä¿è¯æ¯ä¸€ä¸ªèµ„æºæ˜¯å”¯ä¸€çš„ï¼Œèµ„æºå˜åŒ–éƒ½ä¼šå¯¼è‡´Etagå˜åŒ–ã€‚ å½“æµè§ˆå™¨ç¬¬ä¸€æ¬¡è¯·æ±‚èµ„æºçš„æ—¶å€™ï¼ŒæœåŠ¡å™¨ä¼šåœ¨å“åº”æŠ¥æ–‡ä¸­æ·»åŠ Etagï¼ˆè¡¨ç¤ºèµ„æºçš„æ ‡ç­¾ï¼‰ã€‚å½“æµè§ˆå™¨å†æ¬¡å‘èµ·è¯·æ±‚çš„æ—¶å€™ï¼Œè¯·æ±‚æŠ¥æ–‡ä¸­ä¼šæ·»åŠ If-None-Matchå­—æ®µï¼Œå…¶å€¼æ˜¯ä¸Šä¸€æ¬¡å“åº”æŠ¥æ–‡ä¸­Etagçš„å€¼ã€‚æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚æŠ¥æ–‡çš„æ—¶å€™ï¼Œä¼šæ£€æŸ¥If-None-Matchçš„å€¼ä¸å½“å‰èµ„æºEtagçš„å€¼æ˜¯å¦åŒ¹é…ã€‚å¦‚æœåŒ¹é…ï¼Œä¹Ÿå°±æ˜¯èµ„æºæ²¡æœ‰è¢«ä¿®æ”¹ï¼Œè¿”å›304ï¼›å¦‚æœä¸åŒ¹é…ï¼Œä¹Ÿå°±æ˜¯æœåŠ¡å™¨ç«¯èµ„æºè¢«ä¿®æ”¹äº†ï¼Œè¿”å›200ï¼Œå¹¶è¿”å›æ–°çš„èµ„æºã€‚ ä¸ºä»€ä¹ˆæœ‰äº†Last-Modifiedå’ŒIf-Modified-Sinceè¿˜è¦Etagå’ŒIf-None-Matchå‘¢ï¼Ÿ å¦‚æœæ–‡ä»¶æ˜¯é€šè¿‡æœåŠ¡å™¨åŠ¨æ€ç”Ÿæˆçš„ï¼Œé‚£ä¹ˆè¯¥æ–¹æ³•çš„æ›´æ–°æ—¶é—´æ°¸è¿œæ˜¯ç”Ÿæˆçš„æ—¶é—´ï¼Œå°½ç®¡æ–‡ä»¶å¯èƒ½æ²¡æœ‰å˜åŒ–ï¼Œæ‰€ä»¥èµ·ä¸åˆ°ç¼“å­˜çš„ä½œç”¨ æŸäº›æ–‡ä»¶ä¿®æ”¹éå¸¸é¢‘ç¹ï¼Œæ¯”å¦‚åœ¨ç§’ä»¥ä¸‹çº§åˆ«çš„æ—¶é—´å†…è¿›è¡Œä¿®æ”¹ï¼ˆæ¯”å¦‚1så†…ä¿®æ”¹äº†Næ¬¡ï¼‰ï¼ŒIf-Modified-Sinceèƒ½æ£€æŸ¥åˆ°çš„ç²’åº¦åªèƒ½æ˜¯ç§’çº§åˆ«çš„ï¼Œè¿™ç§ä¿®æ”¹æ— æ³•åˆ¤æ–­ã€‚ åå•†ç¼“å­˜ç”Ÿæ•ˆï¼šè¿”å›304å’ŒNot Modifiedã€‚å³æœåŠ¡å™¨ç«¯èµ„æºå¹¶æ²¡æœ‰æ›´æ–°ï¼Œå¯ä»¥ç»§ç»­ä½¿ç”¨æµè§ˆå™¨ç¼“å­˜ä¸­çš„ç»“æœã€‚ åå•†ç¼“å­˜å¤±è´¥ï¼Œè¿”å›200å’Œè¯·æ±‚ç»“æœã€‚å³æœåŠ¡å™¨ç«¯èµ„æºæ›´æ–°äº†ï¼Œè·å–æœåŠ¡å™¨ç«¯çš„è¿”å›ç»“æœï¼Œå¹¶æŠŠè¯·æ±‚ç»“æœå’Œç¼“å­˜æ ‡è¯†å­˜å…¥æµè§ˆå™¨ç¼“å­˜ä¸­ æ€»ç»“ç¼“å­˜æœºåˆ¶ï¼š å¼ºåˆ¶ç¼“å­˜ä¼˜å…ˆäºåå•†ç¼“å­˜è¿›è¡Œ è‹¥å¼ºåˆ¶ç¼“å­˜(Expireså’ŒCache-Control)ç”Ÿæ•ˆåˆ™ç›´æ¥ä½¿ç”¨ç¼“å­˜ï¼Œè‹¥ä¸ç”Ÿæ•ˆåˆ™è¿›è¡Œåå•†ç¼“å­˜(Last-Modified / If-Modified-Sinceå’ŒEtag / If-None-Match) åå•†ç¼“å­˜ç”±æœåŠ¡å™¨å†³å®šæ˜¯å¦ä½¿ç”¨ç¼“å­˜ï¼Œè‹¥åå•†ç¼“å­˜å¤±æ•ˆï¼Œé‚£ä¹ˆä»£è¡¨è¯¥è¯·æ±‚çš„ç¼“å­˜å¤±æ•ˆï¼Œè¿”å›200ï¼Œé‡æ–°è¿”å›èµ„æºå’Œç¼“å­˜æ ‡è¯†ï¼Œå†å­˜å…¥æµè§ˆå™¨ç¼“å­˜ä¸­ï¼›ç”Ÿæ•ˆåˆ™è¿”å›304ï¼Œç»§ç»­ä½¿ç”¨ç¼“å­˜ã€‚ Last-Modified/If-Modified-Since å’Œ Etag/If-None-Matchçš„ä¸»è¦åŒºåˆ«å°±æ˜¯ä¸€ä¸ªæ˜¯é€šè¿‡æ—¶é—´åˆ¤æ–­èµ„æºæ˜¯å¦å·²è¢«æ›´æ”¹ï¼Œä¸€ä¸ªæ˜¯é€šè¿‡Etagæ¥åˆ¤æ–­ã€‚Etag/If-None-Matchç›¸æ¯”äºLast-Modified/If-Modified-Sinceæ¥è¯´æ›´å¥½ã€‚ æ‘˜è‡ªï¼šhttps://www.cnblogs.com/yayaxuping/p/9707471.html â€‹ https://mp.weixin.qq.com/s?__biz=MjM5MTA1MjAxMQ==&amp;mid=2651229883&amp;idx=1&amp;sn=0a775144fc84fc16c0ce581b80ab2a6c&amp;chksm=bd49573f8a3ede2957d0074c8fe047bdeff7614e6439d9077e15d0864eb90b8ae7e25abf2a1b&amp;scene=21#wechat_redirect","categories":[{"name":"æµè§ˆå™¨","slug":"æµè§ˆå™¨","permalink":"http://delaprada.com/categories/%E6%B5%8F%E8%A7%88%E5%99%A8/"}],"tags":[{"name":"æµè§ˆå™¨","slug":"æµè§ˆå™¨","permalink":"http://delaprada.com/tags/%E6%B5%8F%E8%A7%88%E5%99%A8/"}]},{"title":"æµè§ˆå™¨æ¸²æŸ“è¿‡ç¨‹","slug":"æµè§ˆå™¨æ¸²æŸ“è¿‡ç¨‹","date":"2020-01-31T01:50:01.000Z","updated":"2020-02-18T03:29:32.000Z","comments":true,"path":"2020/01/31/æµè§ˆå™¨æ¸²æŸ“è¿‡ç¨‹/","link":"","permalink":"http://delaprada.com/2020/01/31/%E6%B5%8F%E8%A7%88%E5%99%A8%E6%B8%B2%E6%9F%93%E8%BF%87%E7%A8%8B/","excerpt":"","text":"æµè§ˆå™¨æ¸²æŸ“çš„è¿‡ç¨‹ä¸»è¦åŒ…æ‹¬ä»¥ä¸‹5æ­¥ æµè§ˆå™¨å°†è·å–çš„HTMLæ–‡æ¡£è§£æä¸ºDOMæ ‘ å¤„ç†CSSæ ‡è®°ï¼Œæ„æˆCSSè§„åˆ™æ ‘ å°†DOMæ ‘å’ŒCSSè§„åˆ™æ ‘åˆå¹¶ä¸ºæ¸²æŸ“æ ‘ï¼ˆrendering treeï¼‰ï¼Œç”Ÿæˆæ¸²æŸ“æ ‘ æ¸²æŸ“æ ‘å¸ƒå±€ï¼Œç¡®å®šæ¯ä¸ªèŠ‚ç‚¹å¯¹è±¡åœ¨é¡µé¢ä¸Šçš„ç¡®åˆ‡å¤§å°å’Œä½ç½® å°†æ¸²æŸ“æ ‘çš„å„ä¸ªèŠ‚ç‚¹ç»˜åˆ¶åˆ°å±å¹•ä¸Š å…·ä½“æµç¨‹æ„å»ºDOMæ ‘å½“æµè§ˆå™¨æ¥å—åˆ°æœåŠ¡å™¨å“åº”æ¥çš„HTMLæ–‡æ¡£åï¼Œä¼šéå†æ–‡æ¡£èŠ‚ç‚¹ï¼Œç”ŸæˆDOMæ ‘ã€‚æ³¨æ„ï¼šDOMæ ‘åœ¨æ„å»ºçš„è¿‡ç¨‹ä¸­å¯èƒ½ä¼šè¢«CSSå’ŒJSçš„åŠ è½½è€Œæ‰§è¡Œé˜»å¡ã€‚ æ„å»ºCSSè§„åˆ™æ ‘æµè§ˆå™¨è§£æCSSæ–‡ä»¶å¹¶ç”ŸæˆCSSè§„åˆ™æ ‘ã€‚æ³¨æ„ï¼šCSSè§£æå¯ä»¥ä¸DOMè§£æåŒæ—¶æ‰§è¡Œï¼Œä½†ä¸scriptçš„æ‰§è¡Œäº’æ–¥ã€‚ æ„å»ºæ¸²æŸ“æ ‘ï¼ˆRender Treeï¼‰é€šè¿‡DOMæ ‘å’ŒCSSè§„åˆ™æ ‘ï¼Œæµè§ˆå™¨å¯ä»¥é€šè¿‡å®ƒä»¬æ„å»ºæ¸²æŸ“æ ‘ã€‚æµè§ˆå™¨ä¼šå…ˆä»DOMæ ‘çš„æ ¹èŠ‚ç‚¹å¼€å§‹éå†æ¯ä¸ªå¯è§èŠ‚ç‚¹ï¼Œç„¶åå¯¹æ¯ä¸ªå¯è§èŠ‚ç‚¹æ‰¾åˆ°é€‚é…çš„CSSæ ·å¼è§„åˆ™å¹¶åº”ç”¨ã€‚ æ¸²æŸ“æ ‘ç”Ÿæˆåï¼Œè¿˜ä¸èƒ½æ¸²æŸ“åˆ°å±å¹•ä¸Šã€‚å› ä¸ºæ¸²æŸ“åˆ°å±å¹•ä¸Šéœ€è¦å¾—åˆ°å„ä¸ªèŠ‚ç‚¹çš„ä½ç½®ä¿¡æ¯ï¼Œè¿™å°±éœ€è¦å¸ƒå±€çš„å¤„ç†ã€‚ æ¸²æŸ“æ ‘å¸ƒå±€å¸ƒå±€é˜¶æ®µä»æ¸²æŸ“æ ‘çš„æ ¹èŠ‚ç‚¹å¼€å§‹éå†ï¼Œæ¸²æŸ“æ ‘çš„æ¯ä¸ªèŠ‚ç‚¹éƒ½æ˜¯ä¸€ä¸ªRender Objectå¯¹è±¡ï¼ŒåŒ…å«å®½é«˜ï¼Œä½ç½®ï¼ŒèƒŒæ™¯è‰²ç­‰æ ·å¼ä¿¡æ¯ã€‚æµè§ˆå™¨é€šè¿‡è¿™äº›æ ·å¼ä¿¡æ¯æ¥ç¡®å®šæ¯ä¸ªèŠ‚ç‚¹å¯¹è±¡åœ¨é¡µé¢ä¸Šçš„ç¡®åˆ‡å¤§å°å’Œä½ç½®ã€‚ æ¸²æŸ“æ ‘ç»˜åˆ¶å°†æ¸²æŸ“æ ‘ç»˜åˆ¶åˆ°æµè§ˆå™¨ä¸Šã€‚ ä¸»æµçš„ä¸€äº›æµè§ˆå™¨æ’ç‰ˆï¼ˆæ¸²æŸ“ï¼‰å¼•æ“ æµè§ˆå™¨ æ’ç‰ˆå¼•æ“ Chrome Opera Blink Firefox Gecko IE Trident Safari WebKit æ¸²æŸ“é˜»å¡æ¸²æŸ“é˜»å¡çš„åŸå› ï¼šç”±äºJavaScriptå¯ä»¥æ“ä½œDOMæ¥ä¿®æ”¹DOMç»“æ„ï¼Œå¯ä»¥æ“ä½œCSSè§„åˆ™æ ‘æ¥ä¿®æ”¹èŠ‚ç‚¹æ ·å¼ï¼Œè¿™å°±å¯¼è‡´æµè§ˆå™¨åœ¨é‡åˆ°&lt;script&gt;æ ‡ç­¾æ—¶ï¼ŒDOMæ„å»ºå°†æš‚åœï¼Œç›´åˆ°è„šæœ¬å®Œæˆæ‰§è¡Œï¼Œç„¶åç»§ç»­æ„å»ºDOMã€‚å¦‚æœè„šæœ¬æ˜¯å¤–éƒ¨çš„ï¼Œä¼šç­‰å¾…è„šæœ¬ä¸‹è½½å®Œæ¯•ï¼Œå†ç»§ç»­è§£ææ–‡æ¡£ã€‚ ç°åœ¨å¯ä»¥é€šè¿‡åœ¨&lt;script&gt;æ ‡ç­¾ä¸Šå¢åŠ å±æ€§deferæˆ–è€…asyncï¼Œè§£å†³ä¸Šè¿°é—®é¢˜ã€‚è¿™ä¸¤ä¸ªå±æ€§ä½¿å¾—scriptæ ‡ç­¾ä¸ä¼šé˜»å¡DOMçš„æ¸²æŸ“ï¼Œèƒ½å¤Ÿå¼‚æ­¥åŠ è½½scriptè„šæœ¬ï¼Œä¸é˜»å¡DOMæ¸²æŸ“ã€‚ deferå¦‚æœscriptæ ‡ç­¾è®¾ç½®äº†è¯¥å±æ€§ï¼Œæµè§ˆå™¨åˆ™ä¼šå¼‚æ­¥åœ°ä¸‹è½½è¯¥æ–‡ä»¶å¹¶ä¸”ä¸ä¼šå½±å“åˆ°åç»­DOMçš„æ¸²æŸ“ã€‚å¦‚æœæœ‰å¤šä¸ªè®¾ç½®äº†deferçš„scriptæ ‡ç­¾å­˜åœ¨ï¼Œåˆ™ä¼šæŒ‰ç…§é¡ºåºæ‰§è¡Œæ‰€æœ‰çš„scriptã€‚ï¼ˆdeferæŒ‰scriptè„šæœ¬çš„å£°æ˜é¡ºåºæ‰§è¡Œï¼‰ ä½¿ç”¨æ–¹æ³•ï¼š asyncasyncçš„è®¾ç½®ï¼Œä¼šä½¿å¾—scriptè„šæœ¬å¼‚æ­¥åŠ è½½ã€‚asyncçš„æ‰§è¡Œï¼Œä¸ä¼šæŒ‰ç…§scriptåœ¨é¡µé¢ä¸­çš„é¡ºåºæ¥æ‰§è¡Œï¼Œè€Œæ˜¯è°å…ˆåŠ è½½å®Œè°æ‰§è¡Œï¼ˆæ­¤å¤„ä¸deferæœ‰æ‰€ä¸åŒï¼‰ã€‚ ç”¨å›¾è¡¨æ¥å±•ç¤ºï¼š æ–‡æ¡£æ¸²æŸ“ åº”è¯¥ä¸º æ–‡æ¡£è§£æ æ™®é€šçš„scriptæ–‡æ¡£è§£æçš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœé‡åˆ°scriptè„šæœ¬ï¼Œå°±ä¼šåœæ­¢é¡µé¢çš„è§£æè¿›è¡Œä¸‹è½½ã€‚ èµ„æºçš„ä¸‹è½½æ˜¯åœ¨è§£æè¿‡ç¨‹ä¸­è¿›è¡Œçš„ï¼Œè™½è¯´script1è„šæœ¬ä¼šå¾ˆå¿«çš„åŠ è½½å®Œæ¯•ï¼Œä½†æ˜¯ä»–å‰è¾¹çš„script2å¹¶æ²¡æœ‰åŠ è½½&amp;æ‰§è¡Œï¼Œæ‰€ä»¥ä»–åªèƒ½å¤„äºä¸€ä¸ªæŒ‚èµ·çš„çŠ¶æ€ï¼Œç­‰å¾…script2æ‰§è¡Œå®Œæ¯•åå†æ‰§è¡Œã€‚å½“è¿™ä¸¤ä¸ªè„šæœ¬éƒ½æ‰§è¡Œå®Œæ¯•åï¼Œæ‰ä¼šç»§ç»­è§£æé¡µé¢ã€‚ deferæ–‡æ¡£è§£ææ—¶ï¼Œé‡åˆ°è®¾ç½®äº†deferçš„è„šæœ¬ï¼Œå°±ä¼šåœ¨åå°è¿›è¡Œä¸‹è½½ï¼Œä½†æ˜¯å¹¶ä¸ä¼šé˜»æ­¢æ–‡æ¡£çš„æ¸²æŸ“ï¼Œå½“é¡µé¢è§£æ&amp;æ¸²æŸ“å®Œæ¯•åã€‚ä¼šç­‰åˆ°æ‰€æœ‰çš„deferè„šæœ¬åŠ è½½å®Œæ¯•å¹¶æŒ‰ç…§é¡ºåºæ‰§è¡Œï¼Œæ‰§è¡Œå®Œæ¯•åä¼šè§¦å‘DOMContentLoadedäº‹ä»¶ã€‚ asyncasyncè„šæœ¬ä¼šåœ¨åŠ è½½å®Œæ¯•åæ‰§è¡Œã€‚asyncè„šæœ¬çš„åŠ è½½ä¸è®¡å…¥DOMContentLoadedäº‹ä»¶ç»Ÿè®¡ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸‹å›¾ä¸¤ç§æƒ…å†µéƒ½æ˜¯æœ‰å¯èƒ½å‘ç”Ÿçš„ã€‚ æµè§ˆå™¨çš„å›æµä¸é‡ç»˜å›æµï¼šå¯¹äºæ•´ä¸ªç½‘é¡µé‡æ–°æ¸²æŸ“ä¸€éã€‚ ä¼šå¯¼è‡´å›æµçš„æ“ä½œæœ‰ï¼š é¡µé¢é¦–æ¬¡æ¸²æŸ“ æµè§ˆå™¨çª—å£å¤§å°å‘ç”Ÿå˜åŒ– å…ƒç´ å°ºå¯¸æˆ–ä½ç½®å‘ç”Ÿå˜åŒ– å…ƒç´ å†…å®¹å‘ç”Ÿå˜åŒ–ï¼ˆæ–‡å­—æ•°é‡æˆ–å›¾ç‰‡å¤§å°ç­‰ï¼‰ å…ƒç´ å­—ä½“å¤§å°å˜åŒ– æ·»åŠ æˆ–åˆ é™¤å¯è§çš„DOMå…ƒç´  æ¿€æ´»cssä¼ªç±»ï¼ˆä¾‹å¦‚:hoverï¼‰ é‡ç»˜ï¼šæµè§ˆå™¨åªéœ€è¦å¯¹æŸä¸ªå…ƒç´ è¿›è¡Œé‡æ–°ç»˜åˆ¶å³å¯ ä¼šå¯¼è‡´é‡ç»˜çš„æ“ä½œæœ‰ï¼š ä¿®æ”¹color/background-color/visibility ç”±ä¸Šè¿°å¯è§ï¼Œå…¶å®å›æµå¯¹æµè§ˆå™¨æ€§èƒ½çš„æ¶ˆè€—æ˜¯é«˜äºé‡ç»˜çš„ï¼Œè€Œä¸”å›æµæ“ä½œä¸€å®šä¼šä¼´éšé‡ç»˜ï¼Œé‡ç»˜å´ä¸ä¸€å®šä¼´éšå›æµã€‚ é‚£ä¹ˆå¦‚ä½•é’ˆå¯¹å›æµå’Œé‡ç»˜å†™å‡ºæ€§èƒ½æ›´å¥½çš„ä»£ç å‘¢ï¼Ÿ CSSï¼š é¿å…ä½¿ç”¨tableå¸ƒå±€ å°½å¯èƒ½åœ¨DOMæ ‘çš„æœ€æœ«ç«¯æ”¹å˜class é¿å…è®¾ç½®å¤šå±‚å†…è”æ ·å¼ å°†åŠ¨ç”»æ•ˆæœåº”ç”¨åˆ°positionå±æ€§ä¸ºabsoluteæˆ–fixedçš„å…ƒç´ ä¸Š é¿å…ä½¿ç”¨cssè¡¨è¾¾å¼ï¼ˆä¾‹å¦‚ï¼šcalc()ï¼‰ JavaScript é¿å…é¢‘ç¹æ“ä½œæ ·å¼ é¿å…é¢‘ç¹æ“ä½œDOMã€‚åˆ›å»ºä¸€ä¸ªdocumentFragmentï¼Œåœ¨å®ƒä¸Šé¢åº”ç”¨æ‰€æœ‰çš„DOMæ“ä½œï¼Œæœ€åå†æŠŠå®ƒæ·»åŠ åˆ°æ–‡æ¡£ä¸­ ä¹Ÿå¯ä»¥å…ˆä¸ºå…ƒç´ è®¾ç½®display: noneï¼Œæ“ä½œç»“æŸåå†æŠŠå®ƒæ˜¾ç¤ºå‡ºæ¥ã€‚å› ä¸ºåœ¨displayå±æ€§ä¸ºnoneçš„å…ƒç´ ä¸Šè¿›è¡ŒDOMæ“ä½œä¸ä¼šå¼•å‘å›æµå’Œé‡ç»˜ã€‚ é¿å…é¢‘ç¹è¯»å–ä¼šå¼•å‘å›æµ/é‡ç»˜çš„å±æ€§ï¼Œå¦‚æœç¡®å®éœ€è¦å¤šæ¬¡ä½¿ç”¨ï¼Œå°±ç”¨ä¸€ä¸ªå˜é‡ç¼“å­˜èµ·æ¥ã€‚ å¯¹å…·æœ‰å¤æ‚åŠ¨ç”»çš„å…ƒç´ ä½¿ç”¨ç»å¯¹å®šä½ï¼Œä½¿å®ƒè„±ç¦»æ–‡æ¡£æµï¼Œå¦åˆ™ä¼šå¼•èµ·çˆ¶å…ƒç´ åŠåç»­å…ƒç´ é¢‘ç¹å›æµã€‚ DOM CSS JSä¹‹é—´çš„å…³ç³» CSSæ˜¯ä¸ä¼šé˜»å¡DOMçš„è§£æçš„ï¼ŒJSæ˜¯ä¼šé˜»å¡DOMçš„è§£æçš„ CSSæ˜¯ä¼šé˜»å¡DOMçš„æ¸²æŸ“çš„ã€‚å¦‚æœæ²¡æœ‰è¿™ä¸ªç­–ç•¥çš„è¯ï¼Œé¡µé¢é¦–å…ˆä¼šå‘ˆç°ä¸€ä¸ªåŸå§‹çš„æ¨¡æ ·ï¼Œå¾…CSSä¸‹è½½å®Œååˆå˜æˆå¦ä¸€ä¸ªæ¨¡æ ·ï¼Œè¿™æ ·ä¼šå¯¼è‡´ç”¨æˆ·ä½“éªŒå˜å·®è€Œä¸”æ¸²æŸ“æ˜¯æœ‰æˆæœ¬çš„ã€‚ JSæ˜¯ä¼šç­‰å¾…CSSåŠ è½½å®Œæ‰ä¼šæ‰§è¡Œçš„ï¼ˆå¦‚æœCSSæ–‡ä»¶åœ¨JSæ–‡ä»¶ä¹‹å‰å£°æ˜çš„è¯ï¼Œé‚£JSéœ€è¦ç­‰å¾…CSSæ–‡ä»¶åŠ è½½å®Œæ¯•åæ‰ä¼šæ‰§è¡Œï¼‰ã€‚ åŸå› ï¼šå› ä¸ºJSæœ‰æ—¶éœ€è¦æŸ¥è¯¢ï¼ˆè·å–ï¼‰å…ƒç´ çš„ä¸€äº›æ ·å¼ï¼Œè¿™äº›æ ·å¼æ˜¯å®šä¹‰åœ¨CSSæ–‡ä»¶é‡Œçš„ï¼Œæ‰€ä»¥CSSåŠ è½½å®Œä¹‹åå†å»æ‰§è¡ŒJSä¼šæ›´å¥½ä¸€äº›ã€‚ æ‰€ä»¥&lt;script&gt;æœ€å¥½æ”¾åœ¨åº•éƒ¨ï¼Œ&lt;link&gt;æœ€å¥½æ”¾åœ¨å¤´éƒ¨ï¼Œæ˜¯å› ä¸ºJSä¼šé˜»å¡DOMæ ‘çš„è§£æï¼ŒCSSä¸ä¼šé˜»å¡DOMæ ‘çš„è§£æã€‚ å¦‚æœå¤´éƒ¨åŒæ—¶æœ‰&lt;script&gt;å’Œ&lt;link&gt;çš„æƒ…å†µä¸‹ï¼Œæœ€å¥½å°†&lt;script&gt;æ”¾åœ¨&lt;link&gt;ä¸Šé¢ï¼Œæ˜¯å› ä¸ºJSä¼šç­‰å¾…CSSåŠ è½½å®Œæ¯•åæ‰ä¼šæ‰§è¡Œï¼Œä½†æ˜¯æ”¾åœ¨å¤´éƒ¨çš„JSä¸€èˆ¬ä¸ä¼šå¯¹æ ·å¼è¿›è¡ŒæŸ¥è¯¢ä¿®æ”¹ï¼Œæ‰€ä»¥æ”¾åœ¨å‰é¢æ²¡æœ‰å¤ªå¤§å½±å“ï¼ˆæ¯”å¦‚è¯´å¼•å…¥VUEçš„CDNçš„jsä»£ç å°±ä¼šåœ¨å¤´éƒ¨ï¼Œä½†æ˜¯å’ŒCSSæ ·å¼æ˜¯æ— å…³çš„ï¼‰ å‚è€ƒï¼š https://www.cnblogs.com/jiasm/p/7683930.html https://www.jianshu.com/p/e6252dc9be32","categories":[{"name":"æµè§ˆå™¨","slug":"æµè§ˆå™¨","permalink":"http://delaprada.com/categories/%E6%B5%8F%E8%A7%88%E5%99%A8/"}],"tags":[{"name":"æµè§ˆå™¨","slug":"æµè§ˆå™¨","permalink":"http://delaprada.com/tags/%E6%B5%8F%E8%A7%88%E5%99%A8/"}]},{"title":"ä»€ä¹ˆæ˜¯å“ˆå¸Œhash","slug":"ä»€ä¹ˆæ˜¯å“ˆå¸Œhash","date":"2020-01-29T10:55:11.000Z","updated":"2020-01-30T09:36:30.000Z","comments":true,"path":"2020/01/29/ä»€ä¹ˆæ˜¯å“ˆå¸Œhash/","link":"","permalink":"http://delaprada.com/2020/01/29/%E4%BB%80%E4%B9%88%E6%98%AF%E5%93%88%E5%B8%8Chash/","excerpt":"","text":"å“ˆå¸ŒHashä»€ä¹ˆæ˜¯Hashé€šè¿‡ä¸€äº›è®¡ç®—ï¼ŒæŠŠå…³é”®ç å€¼æ˜ å°„åˆ°æ•°ç»„ä¸­çš„ä½ç½®æ¥è®¿é—®è®°å½•ï¼Œè¿™ä¸ªè¿‡ç¨‹ç§°ä¸ºæ•£åˆ—ï¼ˆhashï¼‰ã€‚ é‡è¦ç»„æˆï¼š hashå‡½æ•°ï¼šæŠŠå…³é”®ç å€¼æ˜ å°„åˆ°ä½ç½®çš„å‡½æ•°ç§°ä¸ºæ•£åˆ—å‡½æ•°ã€‚ç”¨hè¡¨ç¤ºã€‚ hashè¡¨ï¼šå­˜æ”¾è®°å½•çš„æ•°ç»„ç§°ä¸ºæ•£åˆ—è¡¨ã€‚ç”¨HTè¡¨ç¤ºã€‚ æ§½ï¼ˆslotï¼‰ï¼šæ•£åˆ—è¡¨ä¸­çš„ä¸€ä¸ªä½ç½®ç§°ä¸ºä¸€ä¸ªæ§½ã€‚ è®¾è®¡hashè¡¨çš„ç›®æ ‡æ˜¯ï¼šä½¿å¾—å¯¹äºä»»ä½•å…³é”®ç å€¼Kå’ŒæŸä¸ªæ•£åˆ—å‡½æ•°hï¼Œi=h(K)æ˜¯è¡¨ä¸­æ»¡è¶³0&lt;=h(K)&lt;Mï¼ˆMä¸ºHTä¸­æ§½çš„æ•°ç›®ï¼‰çš„ä¸€ä¸ªæ§½ï¼Œå¹¶ä¸”è®°å½•åœ¨HT[i]å­˜å‚¨çš„å…³é”®ç å€¼ä¸Kç›¸ç­‰ã€‚ å†²çªè§£å†³åœ¨å®é™…æƒ…å†µä¸­ï¼Œæˆ‘ä»¬æ ¹æ®æ•£åˆ—æ–¹æ³•ç»„ç»‡çš„æ•°æ®åº“å¿…é¡»æŠŠå­˜å‚¨çš„è®°å½•å­˜æ”¾åœ¨ä¸å¤§çš„æ•£åˆ—è¡¨ä¸­ï¼Œä»¥é¿å…æµªè´¹è¿‡å¤šçš„ç©ºé—´ã€‚è¿™æ ·çš„è¯ï¼Œæœ‰å¯èƒ½æœ‰å¤šä¸ªå…³é”®ç å€¼è®¡ç®—å‡ºæ¥çš„h(K)æ˜¯ä¸€æ ·çš„ï¼Œä½†åˆä¸èƒ½åŒæ—¶æ”¾åœ¨åŒä¸€ä¸ªæ§½ä¸­ï¼Œæ­¤æ—¶å°±è¦ä½¿ç”¨å†²çªè§£å†³ç­–ç•¥ã€‚ å†²çªè§£å†³ç­–ç•¥å†²çªè§£å†³ç­–ç•¥ä¸€èˆ¬åˆ†ä¸ºä¸¤ç±»ï¼š å¼€æ•£åˆ—æ–¹æ³•ï¼ˆopen hashingï¼›ä¹Ÿç§°ä¸ºå•é“¾æ–¹æ³•ï¼‰ é—­æ•£åˆ—æ–¹æ³•ï¼ˆclosed hashingï¼›ä¹Ÿç§°ä¸ºå¼€åœ°å€æ–¹æ³•ï¼‰ å¼€æ•£åˆ—æ–¹æ³•å¼€æ•£åˆ—æ–¹æ³•çš„æœ€ç®€å•å½¢å¼æŠŠæ•£åˆ—è¡¨ä¸­çš„æ¯ä¸ªæ§½å®šä¹‰ä¸ºä¸€ä¸ªé“¾è¡¨çš„è¡¨å¤´ï¼Œæ•£åˆ—åˆ°ä¸€ä¸ªæ§½çš„æ‰€æœ‰è®°å½•éƒ½æ”¾åœ¨è¿™ä¸ªæ§½çš„é“¾è¡¨å†…ã€‚ é—­æ•£åˆ—æ–¹æ³•é—­æ•£åˆ—æ–¹æ³•æŠŠæ‰€æœ‰è®°å½•ç›´æ¥å­˜å‚¨åˆ°æ•£åˆ—è¡¨ä¸­ã€‚æ¯æ¡å…³é”®ç å€¼æ ‡è®°ä¸ºkRï¼Œè®°å½•Ræœ‰ä¸€ä¸ªåŸºæ§½ï¼Œå°±æ˜¯h(kR)ï¼Œå³ç”±æ•£åˆ—å‡½æ•°è®¡ç®—å‡ºæ¥çš„æ§½ã€‚å¦‚æœè¦æ’å…¥ä¸€æ¡è®°å½•Rï¼Œè€Œå¦ä¸€æ¡è®°å½•å·²ç»å æ®äº†Rçš„åŸºæ§½ï¼Œé‚£ä¹ˆå°±æŠŠRå­˜å‚¨åœ¨è¡¨çš„å…¶ä»–æ§½å†…ã€‚ æ¡¶å¼æ•£åˆ— ä¸€ç§å®ç°é—­æ•£åˆ—çš„æ–¹æ³•æ˜¯æŠŠæ•£åˆ—è¡¨ä¸­çš„æ§½åˆ†æˆå¤šä¸ªæ¡¶(bucket)ã€‚æŠŠæ•£åˆ—è¡¨ä¸­çš„Mä¸ªæ§½åˆ†æˆBä¸ªæ¡¶ï¼Œæ¯ä¸ªæ¡¶ä¸­åŒ…å«M/Bä¸ªæ§½ã€‚ æ•£åˆ—å‡½æ•°æŠŠæ¯ä¸€æ¡è®°å½•åˆ†é…åˆ°æŸä¸ªæ¡¶çš„ç¬¬ä¸€ä¸ªæ§½ä¸­ã€‚ å¦‚æœè¿™ä¸ªæ§½å·²ç»è¢«å ç”¨ï¼Œé‚£ä¹ˆå°±é¡ºåºåœ°æ²¿ç€æ¡¶æŸ¥æ‰¾ï¼Œç›´åˆ°æ‰¾åˆ°ä¸€ä¸ªç©ºæ§½ã€‚ å¦‚æœä¸€ä¸ªæ¡¶å…¨éƒ¨è¢«å æ»¡äº†ï¼Œé‚£ä¹ˆå°±æŠŠè¿™æ¡è®°å½•å­˜å‚¨åœ¨è¡¨åå…·æœ‰æ— é™å®¹é‡çš„æº¢å‡ºæ¡¶ï¼ˆoverflow bucketï¼‰ä¸­ã€‚ çº¿æ€§æ¢æŸ¥æœ€å¸¸ç”¨çš„æ•£åˆ—æ–¹æ³•ã€‚å½“å‘ç”Ÿå†²çªæ—¶ï¼Œä»å½“å‰åŸºæ§½å¼€å§‹å¾€åæŸ¥æ‰¾ï¼Œæœ‰ç©ºä½åˆ™å°†è®°å½•æ”¾è¿›å»ã€‚ä¾‹å¦‚ï¼Œ2037åŸæœ¬åº”æ”¾åœ¨7çš„æ§½ä¸­ï¼Œä½†æ˜¯7å·²ç»è¢«å ç”¨ï¼Œæ‰€ä»¥å¾€åæŸ¥æ‰¾ç©ºä½ï¼Œ8æ˜¯ç©ºçš„ï¼Œäºæ˜¯å°†2037æ”¾è¿›å»ã€‚ ä½†æ˜¯è¿™ç§æ–¹æ³•ä¼šå¯¼è‡´åŸºæœ¬èšé›†ã€‚ä¾‹å¦‚åœ¨ä¸Šä¾‹ä¸­ï¼Œä¸‹ä¸€æ¡è®°å½•æ”¾åˆ°ç¬¬2ä¸ªæ§½çš„æ¦‚ç‡å°±æ˜¯6/10äº†ï¼Œå› ä¸ºå–æ¨¡åå€¼ä¸º7,8,9,0,1,2éƒ½ä¼šæ”¾åˆ°ç¬¬2ä¸ªæ§½ä¸­ã€‚åœ¨ç†æƒ³æƒ…å†µä¸‹ï¼Œè¡¨ä¸­çš„æ¯ä¸ªç©ºæ§½éƒ½åº”è¯¥æœ‰ç›¸åŒçš„æœºä¼šæ¥å—åˆ°ä¸‹ä¸€ä¸ªè¦æ’å…¥çš„è®°å½•ã€‚ æ”¹è¿›çš„å†²çªè§£å†³æ–¹æ³•å¦‚ä½•é¿å…åŸºæœ¬èšé›†å‘¢ï¼Ÿ ä¸€ç§å¯èƒ½çš„æ”¹è¿›æ–¹å¼æ˜¯ä»ç„¶ä½¿ç”¨çº¿æ€§æ¢æŸ¥ï¼Œä½†æ˜¯è·³è¿‡ä¸€äº›æ§½ï¼Œè€Œä¸”æ¯æ¬¡è·³è¿‡å¸¸æ•°cä¸ªè€Œä¸æ˜¯1ä¸ªæ§½ã€‚è¿™ä¼šç”Ÿæˆæ¢æŸ¥å‡½æ•°ï¼šP(K,i)=ciã€‚ ä¾‹å¦‚ï¼Œå¦‚æœå¸¸æ•°cæ˜¯2çš„è¯ï¼šå¦‚æœåŸºæ§½è¢«å ç”¨çš„è¯ï¼Œç¬¬ä¸€æ¬¡ä¼šæ‰¾åŸºæ§½+2çš„ä½ç½®ï¼Œçœ‹æ˜¯å¦è¢«å ç”¨ï¼Œå¦‚æœè¢«å ç”¨äº†ï¼Œç¬¬äºŒæ¬¡ä¼šæ‰¾åŸºæ§½+4çš„ä½ç½®ï¼Œå¦‚æœè¿˜æ˜¯è¢«å ç”¨ï¼Œåˆ™æ‰¾åŸºæ§½+6çš„ä½ç½®ï¼Œä»¥æ­¤ç±»æ¨ã€‚å³ä»åŸºæ§½å¼€å§‹çš„åç§»é‡å°†ä¼šä¸º2,4,6ã€‚ å¦ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨äºŒæ¬¡æ¢æŸ¥å‡½æ•°ï¼ˆå¯¹äºæŸäº›å¸¸æ•°c1,c2,c3ï¼‰ï¼šp(K,i)=c1i&lt;sup&gt;2&lt;/sup&gt;+c2i+c3ã€‚ä¸€ä¸ªæœ€ç®€å•çš„å˜ä½“å°±æ˜¯p(K,i)=i&lt;sup&gt;2&lt;/sup&gt;ã€‚ ä¾‹å¦‚ï¼Œå¯¹äºä¸€ä¸ªé•¿åº¦M=101çš„æ•£åˆ—è¡¨ï¼Œå‡å®šå¯¹äºå…³é”®ç k1å’Œk2ï¼Œh(k1)=30ï¼Œh(k2)=29ã€‚k1çš„æ¢æŸ¥åºåˆ—ä¸º30,31,34,39ï¼›k2çš„æ¢æŸ¥åºåˆ—ä¸º29,30,33,38ã€‚è¿™æ ·ï¼Œå°½ç®¡k2ä¼šåœ¨ç¬¬äºŒæ­¥æ¢æŸ¥k1çš„åŸºæ§½ï¼Œè¿™ä¸¤ä¸ªå…³é”®ç çš„æ¢æŸ¥åºåˆ—æ­¤åå°±ç«‹å³åˆ†å¼€äº†ã€‚ åŒæ•£åˆ—æ–¹æ³•å³ç”±ä¸¤ä¸ªæ•£åˆ—å‡½æ•°ï¼Œä¸€ä¸ªæ•£åˆ—å‡½æ•°ç”¨äºè®¡ç®—åŸºæ§½ï¼Œå¦ä¸€ä¸ªæ•£åˆ—å‡½æ•°ç”¨äºç¡®å®šçº¿æ€§æ¢æŸ¥ä¸­çš„å¸¸æ•°ã€‚å³çº¿æ€§æ¢æŸ¥æ­¤æ—¶çš„å½¢å¼ä¸ºï¼šp(K,i)=i*h2(K)ã€‚ ä¾‹å¦‚ï¼Œå‡å®šæ•£åˆ—è¡¨çš„é•¿åº¦æ˜¯M=101ï¼Œæœ‰3ä¸ªå…³é”®ç k1ï¼Œk2ï¼Œk3ï¼Œh(k1)=30ï¼Œh(k2)=28ï¼Œh(k3)=30ï¼Œh2(k1)=2ï¼Œh2(k2)=5ï¼Œh2(k3)=5ã€‚é‚£ä¹ˆk1çš„æ¢æŸ¥åºåˆ—ä¸ºï¼š30,32,34,36ç­‰ï¼›k2çš„æ¢æŸ¥åºåˆ—ä¸ºï¼š28,33,38,43ç­‰ï¼›k3çš„æ¢æŸ¥åºåˆ—ä¸ºï¼š30,35,40,45ç­‰ã€‚è¿™æ ·å…³é”®ç ä¹‹é—´å°±ä¸ä¼šå…±äº«åŒä¸€æ®µæ¢æŸ¥åºåˆ—äº†ã€‚","categories":[{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://delaprada.com/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}],"tags":[{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://delaprada.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"äº‹ä»¶ç»‘å®š äº‹ä»¶ç›‘å¬ äº‹ä»¶å§”æ‰˜","slug":"äº‹ä»¶ç»‘å®š-äº‹ä»¶ç›‘å¬-äº‹ä»¶å§”æ‰˜","date":"2020-01-18T08:58:07.000Z","updated":"2020-02-05T12:49:32.000Z","comments":true,"path":"2020/01/18/äº‹ä»¶ç»‘å®š-äº‹ä»¶ç›‘å¬-äº‹ä»¶å§”æ‰˜/","link":"","permalink":"http://delaprada.com/2020/01/18/%E4%BA%8B%E4%BB%B6%E7%BB%91%E5%AE%9A-%E4%BA%8B%E4%BB%B6%E7%9B%91%E5%90%AC-%E4%BA%8B%E4%BB%B6%E5%A7%94%E6%89%98/","excerpt":"","text":"äº‹ä»¶ç»‘å®šä¸ºäº†è®©JavaScriptå¯¹ç”¨æˆ·çš„æ“ä½œä½œå‡ºå“åº”ï¼Œé¦–å…ˆè¦å¯¹DOMå…ƒç´ ç»‘å®šäº‹ä»¶å¤„ç†å‡½æ•°ã€‚ ä¸‰ç§å¸¸ç”¨çš„ç»‘å®šäº‹ä»¶çš„æ–¹æ³•ï¼š åœ¨DOMå…ƒç´ ä¸­ç›´æ¥ç»‘å®š åœ¨JavaScriptä»£ç ä¸­ç»‘å®š ç»‘å®šäº‹ä»¶ç›‘å¬å‡½æ•° åœ¨DOMå…ƒç´ ä¸­ç›´æ¥ç»‘å®šæˆ‘ä»¬å¯ä»¥åœ¨DOMå…ƒç´ ä¸Šç»‘å®šonclickã€onmouseoverã€onmouseoutã€onmousedownã€onmouseupã€ondblclickã€onkeydownã€onkeypressã€onkeyupç­‰ã€‚ 123456&lt;input type=\"button\" value=\"click me\" onclick=\"hello()\"&gt;&lt;script&gt;function hello()&#123; alert(\"hello world!\");&#125;&lt;/script&gt; åœ¨JavaScriptä»£ç ä¸­ç»‘å®šäº‹ä»¶åœ¨JavaScriptä»£ç ä¸­ï¼ˆå³scriptæ ‡ç­¾å†…ï¼‰ç»‘å®šäº‹ä»¶å¯ä»¥ä½¿JavaScriptä»£ç ä¸HTMLæ ‡ç­¾åˆ†ç¦»ï¼Œæ–‡æ¡£ç»“æ„æ¸…æ™°ï¼Œä¾¿äºç®¡ç†å’Œå¼€å‘ã€‚ 123456&lt;input type=\"button\" value=\"click me\" id=\"btn\"&gt;&lt;script&gt;document.getElementById(\"btn\").onclick = function()&#123; alert(\"hello world!\");&#125;&lt;/script&gt; ä½¿ç”¨äº‹ä»¶ç›‘å¬ç»‘å®šäº‹ä»¶ç»‘å®šäº‹ä»¶çš„å¦ä¸€ç§æ–¹æ³•æ˜¯ç”¨ addEventListener() æˆ– attachEvent()æ¥ç»‘å®šäº‹ä»¶ç›‘å¬å‡½æ•°ã€‚ äº‹ä»¶ç›‘å¬çš„ä¼˜ç‚¹ï¼š å¯ä»¥ç»‘å®šå¤šä¸ªäº‹ä»¶ å¸¸è§„çš„äº‹ä»¶ç»‘å®šï¼ˆä¾‹å¦‚onclickï¼‰åªæ‰§è¡Œæœ€åç»‘å®šçš„äº‹ä»¶ï¼Œä¼šäº§ç”Ÿäº‹ä»¶è¦†ç›–ã€‚ 12345678910&lt;input type=\"button\" value=\"click me\" id=\"btn3\"&gt;&lt;script&gt;var btn3 = document.getElementById(\"btn3\");btn3.onclick = function()&#123; alert(\"hello 1\"); //ä¸æ‰§è¡Œ&#125;btn3.onclick = function()&#123; alert(\"hello 2\"); //æ‰§è¡Œ&#125;&lt;/script&gt; ä½¿ç”¨addEventListenerçš„è¯ä¸¤ä¸ªäº‹ä»¶éƒ½ä¼šæ‰§è¡Œï¼š 123456789101112&lt;input type=\"button\" value=\"click me\" id=\"btn4\"&gt;&lt;script&gt;var btn4 = document.getElementById(\"btn4\");btn4.addEventListener(\"click\",hello1);btn4.addEventListener(\"click\",hello2);function hello1()&#123; alert(\"hello 1\"); //æ‰§è¡Œ&#125;function hello2()&#123; alert(\"hello 2\"); //æ‰§è¡Œ&#125;&lt;/script&gt; å…³äºäº‹ä»¶ç›‘å¬ï¼Œæœ‰3ä¸ªäº‹ä»¶é˜¶æ®µï¼ˆäº‹ä»¶æµåŒ…æ‹¬ä¸‰ä¸ªçŠ¶æ€ï¼‰ï¼šæ•è·é˜¶æ®µï¼Œç›®æ ‡é˜¶æ®µï¼Œå†’æ³¡é˜¶æ®µã€‚è¿™ä¸‰ä¸ªé˜¶æ®µä¹Ÿå«ä½œäº‹ä»¶æµã€‚ äº‹ä»¶æ•è·å½“ä¸€ä¸ªäº‹ä»¶è§¦å‘åï¼Œä»windowå¯¹è±¡è§¦å‘ï¼Œä¸æ–­ç»è¿‡ä¸‹çº§èŠ‚ç‚¹ï¼Œç›´åˆ°ç›®æ ‡èŠ‚ç‚¹ã€‚åœ¨äº‹ä»¶åˆ°è¾¾ç›®æ ‡èŠ‚ç‚¹ä¹‹å‰çš„è¿‡ç¨‹å°±æ˜¯æ•è·é˜¶æ®µã€‚æ‰€æœ‰ç»è¿‡çš„èŠ‚ç‚¹ï¼Œéƒ½ä¼šè§¦å‘å¯¹åº”äº‹ä»¶ã€‚ äº‹ä»¶å†’æ³¡å½“äº‹ä»¶åˆ°è¾¾ç›®æ ‡èŠ‚ç‚¹åï¼Œä¼šæ²¿ç€æ•è·é˜¶æ®µè·¯çº¿åŸè·¯è¿”å›ã€‚åŒæ ·ï¼Œæ‰€æœ‰ç»è¿‡çš„èŠ‚ç‚¹ï¼Œéƒ½ä¼šè§¦å‘å¯¹åº”çš„äº‹ä»¶ã€‚ é€šè¿‡æ —å­æ¥ç†è§£ä¸¤ä¸ªäº‹ä»¶æœºåˆ¶ï¼š å‡è®¾æœ‰bodyå’ŒbodyèŠ‚ç‚¹ä¸‹çš„div1å‡æœ‰ç»‘å®šäº†ä¸€ä¸ªç‚¹å‡»äº‹ä»¶ã€‚ æ•ˆæœï¼š å½“ä¸ºäº‹ä»¶æ•è·(useCapture:true)æ—¶,å…ˆæ‰§è¡Œbodyçš„äº‹ä»¶,å†æ‰§è¡Œdivçš„äº‹ä»¶ å½“ä¸ºäº‹ä»¶å†’æ³¡(useCapture:false)æ—¶,å…ˆæ‰§è¡Œdivçš„äº‹ä»¶,å†æ‰§è¡Œbodyçš„äº‹ä»¶ï¼ˆé»˜è®¤æ˜¯falseï¼Œåœ¨äº‹ä»¶å†’æ³¡é˜¶æ®µæ‰§è¡Œï¼‰ useCaptureï¼šç”¨äºæŒ‡å®šäº‹ä»¶æ˜¯å¦åœ¨æ•è·æˆ–å†’æ³¡é˜¶æ®µæ‰§è¡Œ 12345678910111213141516171819//å½“useCaptureä¸ºé»˜è®¤falseæ—¶,ä¸ºäº‹ä»¶å†’æ³¡&lt;body&gt; &lt;div id=\"div1\"&gt;&lt;/div&gt;&lt;/body&gt;&lt;script&gt;window.onload = function()&#123; let body = document.querySelector('body'); let div1 = document.getElementById('div1'); body.addEventListener('click',function()&#123; console.log('æ‰“å°body') &#125;) div1.addEventListener('click',function()&#123; console.log('æ‰“å°div1') &#125;)&#125;&lt;/script&gt;//ç»“æœ:æ‰“å°div1 æ‰“å°body 1234567891011121314151617//å½“useCaptureä¸ºtrueæ—¶,ä¸ºäº‹ä»¶æ•è·&lt;body&gt; &lt;div id=\"div1\"&gt;&lt;/div&gt;&lt;/body&gt;&lt;script&gt;window.onload = function()&#123; let body = document.querySelector('body'); let div1 = document.getElementById('div1'); body.addEventListener('click',function()&#123; console.log('æ‰“å°body') &#125;,true) div1.addEventListener('click',function()&#123; console.log('æ‰“å°div1') &#125;)&#125;&lt;/script&gt;//ç»“æœ:æ‰“å°body æ‰“å°div1 äº‹ä»¶å§”æ‰˜åˆ©ç”¨å†’æ³¡åŸç†ï¼ŒæŠŠäº‹ä»¶åŠ åˆ°çˆ¶å…ƒç´ æˆ–ç¥–å…ˆå…ƒç´ ä¸Šï¼Œè§¦å‘æ‰§è¡Œæ•ˆæœã€‚ 12345678910111213141516171819202122&lt;script&gt; window.onload = function()&#123; let div = document.getElementById('div'); div.addEventListener('click',function(e)&#123; console.log(e.target) &#125;) let div3 = document.createElement('div'); div3.setAttribute('class','div3') div3.innerHTML = 'div3'; div.appendChild(div3) &#125;&lt;/script&gt;&lt;body&gt; &lt;div id=\"div\"&gt; &lt;div class=\"div1\"&gt;div1&lt;/div&gt; &lt;div class=\"div2\"&gt;div2&lt;/div&gt; &lt;/div&gt;&lt;/body&gt; è™½ç„¶æ²¡æœ‰ç»™div1å’Œdiv2æ·»åŠ ç‚¹å‡»äº‹ä»¶ï¼Œä½†æ˜¯æ— è®ºæ˜¯ç‚¹å‡»div1è¿˜æ˜¯div2éƒ½ä¼šæ‰“å°å½“å‰èŠ‚ç‚¹ï¼ˆconsole.log(e.target)ï¼‰ã€‚å› ä¸ºå…¶çˆ¶çº§ç»‘å®šäº†ç‚¹å‡»äº‹ä»¶ï¼Œç‚¹å‡»div1åå†’æ³¡ä¸Šå»çš„æ—¶å€™ï¼Œæ‰§è¡Œçˆ¶çº§çš„äº‹ä»¶ã€‚ ä¸¾ä¸ªæ —å­ï¼š åˆ†åˆ«ç‚¹å‡»div1ã€div2ã€div3ï¼š æ— è®ºåä»£æ–°å¢äº†å¤šå°‘ä¸ªèŠ‚ç‚¹ï¼Œä¸€æ ·å…·æœ‰ç‚¹å‡»äº‹ä»¶çš„åŠŸèƒ½ã€‚ä½†æ˜¯å¦‚æœæ˜¯ä¼ ç»Ÿçš„äº‹ä»¶ç»‘å®šçš„è¯æ— æ³•å¯¹åŠ¨æ€æ·»åŠ çš„å…ƒç´ è€ŒåŠ¨æ€åœ°æ·»åŠ äº‹ä»¶ã€‚ äº‹ä»¶å§”æ‰˜çš„ä¼˜ç‚¹ æé«˜æ€§èƒ½ï¼šæ¯ä¸€ä¸ªå‡½æ•°éƒ½ä¼šå ç”¨å†…å­˜ç©ºé—´ã€‚åªéœ€è¦æ·»åŠ ä¸€ä¸ªäº‹ä»¶å¤„ç†ç¨‹åºä»£ç†æ‰€æœ‰äº‹ä»¶ï¼Œæ‰€å ç”¨çš„å†…å­˜ç©ºé—´æ›´å°‘ã€‚ åŠ¨æ€ç›‘å¬ï¼šä½¿ç”¨äº‹ä»¶å§”æ‰˜å¯ä»¥è‡ªåŠ¨ç»‘å®šåŠ¨æ€æ·»åŠ çš„å…ƒç´ ã€‚å³æ–°å¢çš„èŠ‚ç‚¹ä¸éœ€è¦ä¸»åŠ¨æ·»åŠ ä¹Ÿå¯ä»¥ä¸€æ ·å…·æœ‰å’Œå…¶ä»–å…ƒç´ ä¸€æ ·çš„äº‹ä»¶ã€‚ å‚è€ƒï¼šhttps://www.cnblogs.com/soyxiaobi/p/9498357.html â€‹ http://blog.xieliqun.com/2016/08/12/event-delegate/","categories":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://delaprada.com/categories/JavaScript/"}],"tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://delaprada.com/tags/JavaScript/"}]},{"title":"åˆ†æparseInt()","slug":"åˆ†æparseInt","date":"2020-01-18T03:56:24.000Z","updated":"2020-01-18T07:05:52.000Z","comments":true,"path":"2020/01/18/åˆ†æparseInt/","link":"","permalink":"http://delaprada.com/2020/01/18/%E5%88%86%E6%9E%90parseInt/","excerpt":"","text":"parseInt()å…¬å¼1parseInt(string, radix) å‚æ•° æè¿° string å¿…éœ€ã€‚è¦è¢«è§£æçš„å­—ç¬¦ä¸²ã€‚ radix å¯é€‰ã€‚è¡¨ç¤ºè¦è§£æçš„æ•°å­—çš„åŸºæ•°ã€‚è¯¥å€¼ä»‹äº 2 ~ 36 ä¹‹é—´ã€‚ parseInt(071)å’ŒparseInt(&quot;071&quot;)çš„åŒºåˆ«parseInt(&quot;071&quot;)å°±æ˜¯ç®€å•å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•°å­—ï¼š å¦‚æœ string ä»¥ â€œ0xâ€ å¼€å¤´ï¼ŒparseInt() ä¼šæŠŠ string çš„å…¶ä½™éƒ¨åˆ†è§£æä¸ºåå…­è¿›åˆ¶çš„æ•´æ•°ã€‚ å¦‚æœ string ä»¥ 1 ~ 9 çš„æ•°å­—å¼€å¤´ï¼ŒparseInt() å°†æŠŠå®ƒè§£æä¸ºåè¿›åˆ¶çš„æ•´æ•°ã€‚ ä»¥0å¼€å¤´ä¹Ÿæ˜¯è½¬æ¢ä¸ºåè¿›åˆ¶ã€‚ä¹Ÿæœ‰è¯´è½¬æ¢ä¸ºåå…­è¿›åˆ¶æˆ–è€…å…«è¿›åˆ¶ï¼Œä½†æ˜¯åœ¨chromeä¸­å®è·µæ˜¯åè¿›åˆ¶ã€‚ parseInt(071)å°±æ˜¯å°†071ç”¨å…«è¿›åˆ¶è¿›è¡Œè½¬æ¢ï¼š åˆ¤æ–­[â€˜1â€™,â€™2â€™,â€™3â€™].map(parseInt)çš„è¾“å‡ºä½ å¯èƒ½è§‰å¾—ä¼šæ˜¯[1,2,3]ï¼Œä½†å®é™…ä¸Šæ˜¯[1,NaN,NaN]ã€‚æˆ‘ä»¬æ¥ä»”ç»†åˆ†æä¸€ä¸‹ï¼š mapçš„å‡½æ•°æ ¼å¼ 1map((item, index, thisArr) &#x3D;&gt; ( newArr )) å‚æ•°è§£æï¼š item: callback çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œæ•°ç»„ä¸­æ­£åœ¨å¤„ç†çš„å½“å‰å…ƒç´  index: callback çš„ç¬¬äºŒä¸ªå‚æ•°ï¼Œæ•°ç»„ä¸­æ­£åœ¨å¤„ç†çš„å½“å‰å…ƒç´ çš„ç´¢å¼• thisArr: callback çš„ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œmap æ–¹æ³•è¢«è°ƒç”¨çš„æ•°ç»„ parseIntçš„æ ¼å¼ ä¸Šé¢è®²åˆ°ï¼š 1parseInt(string, radix) é€šè¿‡ä¸Šè¿°å¯¹ map å’Œ parseInt å‡½æ•°çš„åˆ†æå¯ä»¥çŸ¥é“ï¼Œæ‰§è¡Œæ–¹æ³•æ—¶ï¼Œmapç»™parseIntä¼ é€’äº†ä¸‰ä¸ªå‚æ•°: 1parseInt(item, index, thisArr) å› æ­¤ï¼Œç´¢å¼•indexä¼šä¼ å…¥parseIntå‡½æ•°å½“åšåŸºæ•°radixã€‚ å…¶ä¸­ç¬¬ä¸‰ä¸ªå‚æ•°ä¼šè¢« parseInt å¿½ç•¥ï¼Œå› æ­¤ä¼šä¾æ¬¡æ‰§è¡Œï¼š 123456parseInt('1', 0)// radix ä¸º 0ï¼Œé»˜è®¤ä»¥åè¿›åˆ¶è§£æå­—ç¬¦ä¸²ï¼Œè¿”å› 1parseInt('2', 1)// radix ä¸º 1ï¼Œä¸åœ¨ 2 ~ 36 ä¹‹é—´ï¼Œè¿”å› NaNparseInt('3', 2)// radix ä¸º 2ï¼Œ å­—ç¬¦ä¸²å´ä¸º 3ï¼Œè¶…å‡ºäºŒè¿›åˆ¶çš„è¡¨ç¤ºèŒƒå›´ï¼Œå› æ­¤è¦è§£æçš„å­—ç¬¦ä¸²å’ŒåŸºæ•°çŸ›ç›¾ï¼Œè¿”å› NaN å‚è€ƒï¼šhttps://www.cnblogs.com/wx1993/p/8417817.html","categories":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://delaprada.com/categories/JavaScript/"}],"tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://delaprada.com/tags/JavaScript/"}]},{"title":"é˜²æŠ–ä¸èŠ‚æµ","slug":"é˜²æŠ–ä¸èŠ‚æµ","date":"2020-01-17T02:31:56.000Z","updated":"2020-01-17T02:35:24.000Z","comments":true,"path":"2020/01/17/é˜²æŠ–ä¸èŠ‚æµ/","link":"","permalink":"http://delaprada.com/2020/01/17/%E9%98%B2%E6%8A%96%E4%B8%8E%E8%8A%82%E6%B5%81/","excerpt":"","text":"é˜²æŠ–å’ŒèŠ‚æµå¦‚æœäº‹ä»¶å¤„ç†å‡½æ•°è°ƒç”¨çš„é¢‘ç‡æ— é™åˆ¶ï¼Œä¼šåŠ é‡æµè§ˆå™¨çš„è´Ÿæ‹…ï¼Œå¯¼è‡´ç”¨æˆ·ä½“éªŒéå¸¸ç³Ÿç³•ã€‚æ­¤æ—¶æˆ‘ä»¬å¯ä»¥é‡‡ç”¨é˜²æŠ–ï¼ˆdebounceï¼‰å’ŒèŠ‚æµï¼ˆthrottleï¼‰çš„æ–¹å¼æ¥å‡å°‘è°ƒç”¨é¢‘ç‡ï¼ŒåŒæ—¶åˆä¸å½±å“å®é™…æ•ˆæœã€‚ é˜²æŠ–å«ä¹‰ï¼šå½“æŒç»­è§¦å‘äº‹ä»¶æ—¶ï¼Œä¸€å®šæ—¶é—´æ®µå†…æ²¡æœ‰åœ¨è§¦å‘äº‹ä»¶ï¼Œäº‹ä»¶å¤„ç†å‡½æ•°æ‰ä¼šæ‰§è¡Œä¸€æ¬¡ï¼›å¦‚æœè®¾å®šçš„æ—¶é—´åˆ°æ¥ä¹‹å‰ï¼Œåˆä¸€æ¬¡è§¦å‘äº†äº‹ä»¶ï¼Œå°±é‡æ–°å¼€å§‹å»¶æ—¶ã€‚ ä»£ç å®ç°ï¼š 123456789101112131415function debounce(fn, wait) &#123; var timeout = null; return function() &#123; //å–æ¶ˆç”± setTimeout() æ–¹æ³•è®¾ç½®çš„ timeout if(timeout!==null) clearTimeout(timeout); timeout = setTimeout(fn, wait); &#125;&#125;// å¤„ç†å‡½æ•°function handle() &#123; console.log(Math.random()); &#125;// æ»šåŠ¨äº‹ä»¶window.addEventListener('scroll', debounce(handle, 1000)); é˜²æŠ–æ˜¯é€šè¿‡é—­åŒ…å®ç°çš„ï¼Œæ‰€ä»¥timeoutæ˜¯ä¼šè¢«ç¼“å­˜çš„ã€‚å¦‚æœåœ¨é¢‘ç¹è§¦å‘äº‹ä»¶ä¹‹åçš„ä¸€æ®µæ—¶é—´å†…ï¼Œåˆå†æ¬¡è§¦å‘äº†äº‹ä»¶ï¼Œé‚£å°±ä¼šä½¿ç”¨clearTimeoutæ¸…é™¤setTimoutè®¾ç½®çš„timoutï¼Œé‡æ–°è®¡æ—¶ã€‚ å…·ä½“å®Œæ•´ä»£ç ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576&lt;html lang=\"en\"&gt;&lt;head&gt; &lt;meta charset=\"UTF-8\"&gt; &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"&gt; &lt;meta http-equiv=\"X-UA-Compatible\" content=\"ie=edge\"&gt; &lt;title&gt;Document&lt;/title&gt; &lt;script&gt; function debounce(fn, wait) &#123; var timeout = null; return function() &#123; //å–æ¶ˆç”± setTimeout() æ–¹æ³•è®¾ç½®çš„ timeout if(timeout!==null) clearTimeout(timeout); timeout = setTimeout(fn, wait); &#125; &#125; // å¤„ç†å‡½æ•° function handle() &#123; console.log(Math.random()); &#125; // æ»šåŠ¨äº‹ä»¶ window.addEventListener('scroll', debounce(handle, 1000)); &lt;/script&gt;&lt;/head&gt;&lt;body&gt; &lt;div&gt; &lt;h1&gt;é˜²æŠ–æ¼”ç¤º1&lt;/h1&gt; &lt;/div&gt; &lt;div&gt; &lt;h1&gt;é˜²æŠ–æ¼”ç¤º2&lt;/h1&gt; &lt;/div&gt; &lt;div&gt; &lt;h1&gt;é˜²æŠ–æ¼”ç¤º3&lt;/h1&gt; &lt;/div&gt; &lt;div&gt; &lt;h1&gt;é˜²æŠ–æ¼”ç¤º4&lt;/h1&gt; &lt;/div&gt; &lt;div&gt; &lt;h1&gt;é˜²æŠ–æ¼”ç¤º5&lt;/h1&gt; &lt;/div&gt; &lt;div&gt; &lt;h1&gt;é˜²æŠ–æ¼”ç¤º6&lt;/h1&gt; &lt;/div&gt; &lt;div&gt; &lt;h1&gt;é˜²æŠ–æ¼”ç¤º7&lt;/h1&gt; &lt;/div&gt; &lt;div&gt; &lt;h1&gt;é˜²æŠ–æ¼”ç¤º8&lt;/h1&gt; &lt;/div&gt; &lt;div&gt; &lt;h1&gt;é˜²æŠ–æ¼”ç¤º9&lt;/h1&gt; &lt;/div&gt; &lt;div&gt; &lt;h1&gt;é˜²æŠ–æ¼”ç¤º10&lt;/h1&gt; &lt;/div&gt; &lt;div&gt; &lt;h1&gt;é˜²æŠ–æ¼”ç¤º11&lt;/h1&gt; &lt;/div&gt; &lt;div&gt; &lt;h1&gt;é˜²æŠ–æ¼”ç¤º12&lt;/h1&gt; &lt;/div&gt; &lt;div&gt; &lt;h1&gt;é˜²æŠ–æ¼”ç¤º13&lt;/h1&gt; &lt;/div&gt; &lt;div&gt; &lt;h1&gt;é˜²æŠ–æ¼”ç¤º14&lt;/h1&gt; &lt;/div&gt; &lt;div&gt; &lt;h1&gt;é˜²æŠ–æ¼”ç¤º15&lt;/h1&gt; &lt;/div&gt; &lt;div&gt; &lt;h1&gt;é˜²æŠ–æ¼”ç¤º16&lt;/h1&gt; &lt;/div&gt;&lt;/body&gt;&lt;/html&gt; åœ¨ç½‘é¡µè¿è¡Œçš„æ—¶å€™æˆ‘ä»¬ä¼šçœ‹åˆ°ï¼Œå½“åœ¨æ»šåŠ¨é¡µé¢æ“ä½œåœæ­¢å1sï¼Œæ§åˆ¶å°ä¼šæœ‰è¾“å‡ºã€‚è¿™å°±æ˜¯é˜²æŠ–ã€‚ èŠ‚æµå½“æŒç»­è§¦å‘äº‹ä»¶æ—¶ï¼Œä¿è¯æ¯éš”ä¸€å®šæ—¶é—´æ®µå†…åªè°ƒç”¨ä¸€æ¬¡äº‹ä»¶å¤„ç†å‡½æ•°ã€‚ ç”¨å®šæ—¶å™¨å®ç°èŠ‚æµï¼š 1234567891011121314151617var throttle=function(func,delay)&#123; var timer=null; return function()&#123; var context=this; var args=arguments; if(!timer)&#123; timer=setTimeout(function()&#123; func.apply(context,args); timer=null; &#125;,delay); &#125; &#125;&#125;function handle()&#123; console.log(Math.random());&#125;window.addEventListener('scroll',throttle(handle,1000)); èŠ‚æµä¹Ÿæ˜¯é€šè¿‡é—­åŒ…å®ç°çš„ã€‚æ‰€ä»¥ä¼šæŠŠtimerç¼“å­˜èµ·æ¥ï¼Œä½†æ˜¯ç”±äºæ¯æ¬¡æ‰§è¡ŒsetTimeoutå‡½æ•°æ—¶éƒ½è®¾ç½®timerä¸ºnullï¼Œæ‰€ä»¥æ¯æ¬¡è°ƒç”¨éƒ½å¯ä»¥æ‰§è¡Œifè¯­å¥å½“ä¸­çš„å†…å®¹ã€‚åŒæ—¶ï¼Œä¸‹ä¸€æ¬¡æ»šåŠ¨äº‹ä»¶ä¸ä¼šå½±å“ä¸Šä¸€æ¬¡çš„äº‹ä»¶å¤„ç†å‡½æ•°ï¼Œæ‰€ä»¥ä¸ä¼šé‡æ–°è®¡æ—¶ã€‚ å°†èŠ‚æµä»£ç æ”¾å…¥ä¸Šä¸ªä¾‹å­çš„å…·ä½“å®ç°ä¸­ä¼šå‘ç°ï¼Œæ‰§è¡Œæ»šåŠ¨é¡µé¢æ“ä½œåï¼Œéƒ½ä¼šä»¥åŒä¸€é¢‘ç‡åœ¨æ§åˆ¶å°ä¸­è¾“å‡ºå€¼ã€‚ å‚è€ƒï¼šhttps://mp.weixin.qq.com/s/Vkshf-nEDwo2ODUJhxgzVA","categories":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://delaprada.com/categories/JavaScript/"}],"tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://delaprada.com/tags/JavaScript/"}]},{"title":"https SSL/TLSæ¡æ‰‹è¿‡ç¨‹","slug":"https-SSL-TLSæ¡æ‰‹è¿‡ç¨‹","date":"2020-01-16T13:00:04.000Z","updated":"2020-01-16T13:05:08.000Z","comments":true,"path":"2020/01/16/https-SSL-TLSæ¡æ‰‹è¿‡ç¨‹/","link":"","permalink":"http://delaprada.com/2020/01/16/https-SSL-TLS%E6%8F%A1%E6%89%8B%E8%BF%87%E7%A8%8B/","excerpt":"","text":"SSL/TLS æ¡æ‰‹è¿‡ç¨‹è¯¦è§£httpåè®®æ˜¯æ˜æ–‡ä¼ è¾“ï¼Œä¸ç¡®è®¤é€šä¿¡æ–¹ï¼Œä¸ä¿è¯ä¼ è¾“æ•°æ®å®Œæ•´çš„åè®®ã€‚å®ƒå¸¦æ¥äº†ä¸‰å¤§é£é™©ï¼š ï¼ˆ1ï¼‰ çªƒå¬é£é™©ï¼ˆeavesdroppingï¼‰ï¼šç¬¬ä¸‰æ–¹å¯ä»¥è·çŸ¥é€šä¿¡å†…å®¹ã€‚ ï¼ˆ2ï¼‰ ç¯¡æ”¹é£é™©ï¼ˆtamperingï¼‰ï¼šç¬¬ä¸‰æ–¹å¯ä»¥ä¿®æ”¹é€šä¿¡å†…å®¹ã€‚ ï¼ˆ3ï¼‰ å†’å……é£é™©ï¼ˆpretendingï¼‰ï¼šç¬¬ä¸‰æ–¹å¯ä»¥å†’å……ä»–äººèº«ä»½å‚ä¸é€šä¿¡ã€‚ httpåè®®æ˜¯æ˜æ–‡ä¼ è¾“ï¼Œåœ¨å®‰å…¨æ€§æ–¹é¢æ¯”è¾ƒå·®ã€‚httpsåè®®ä½¿ç”¨äº†SSL/TLSåè®®æ¥è¿›è¡ŒåŠ å¯†ã€‚SSL/TLSæ¡æ‰‹æ˜¯ä¸ºäº†å®‰å…¨åœ°åå•†å‡ºä¸€ä»½å¯¹ç§°åŠ å¯†çš„ç§˜é’¥ã€‚ SSL/TLSæ¡æ‰‹è¿‡ç¨‹ Client Hello æ¡æ‰‹ç¬¬ä¸€æ­¥æ˜¯å®¢æˆ·ç«¯å‘æœåŠ¡ç«¯å‘é€Client Helloæ¶ˆæ¯ã€‚è¿™ä¸ªæ¶ˆæ¯é‡ŒåŒ…å«äº†ä¸€ä¸ªå®¢æˆ·ç«¯ç”Ÿæˆçš„éšæœºæ•°Random1ï¼Œå®¢æˆ·ç«¯æ”¯æŒçš„åŠ å¯†å¥—ä»¶ï¼ˆSupport Ciphersï¼‰å’ŒSSL Versionç­‰ä¿¡æ¯ã€‚ Server Hello ç¬¬äºŒæ­¥æ˜¯æœåŠ¡ç«¯æƒ³å®¢æˆ·ç«¯å‘é€Server Helloæ¶ˆæ¯ã€‚æ­¤æ—¶ä¼šç”Ÿæˆä¸€ä»½éšæœºæ•°Random2ï¼ŒåŒæ—¶è¿™ä¸ªæ¶ˆæ¯ä¼šä»Client Helloä¼ æ¥çš„Support Ciphersé‡Œç¡®å®šä¸€ä»½åŠ å¯†å¥—ä»¶ï¼Œè¿™ä¸ªå¥—ä»¶å†³å®šäº†åç»­åŠ å¯†å’Œç”Ÿæˆæ‘˜è¦æ—¶å…·ä½“ä½¿ç”¨å“ªäº›ç®—æ³•ã€‚ æ³¨æ„ï¼šè‡³æ­¤å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯éƒ½æ‹¥æœ‰äº†ä¸¤ä¸ªéšæœºæ•°ï¼ˆRandom1+Random2ï¼‰ï¼Œè¿™ä¸¤ä¸ªéšæœºæ•°ä¼šåœ¨åç»­ç”Ÿæˆå¯¹ç§°ç§˜é’¥æ—¶ç”¨åˆ°ã€‚ Certificate è¿™ä¸€æ­¥æ˜¯æœåŠ¡ç«¯å°†è‡ªå·±çš„è¯ä¹¦ä¸‹å‘ç»™å®¢æˆ·ç«¯ï¼Œè®©å®¢æˆ·ç«¯éªŒè¯è‡ªå·±çš„èº«ä»½ï¼Œå®¢æˆ·ç«¯éªŒè¯é€šè¿‡åå–å‡ºè¯ä¹¦ä¸­çš„å…¬é’¥ã€‚ Server Hello Done Server Hello Doneé€šçŸ¥å®¢æˆ·ç«¯Server Helloè¿‡ç¨‹ç»“æŸã€‚ Certificate Verify å®¢æˆ·ç«¯æ”¶åˆ°æœåŠ¡ç«¯ä¼ æ¥çš„è¯ä¹¦åï¼Œå…ˆä»CAéªŒè¯è¯¥è¯ä¹¦çš„åˆæ³•æ€§ï¼ŒéªŒè¯é€šè¿‡åå–å‡ºè¯ä¹¦ä¸­çš„æœåŠ¡ç«¯å…¬é’¥ï¼Œå†ç”Ÿæˆéšæœºæ•°Random3ï¼Œå†ç”¨æœåŠ¡ç«¯å…¬é’¥éå¯¹ç§°åŠ å¯†Random3ç”ŸæˆPreMaster Keyã€‚ httpsçš„æœåŠ¡ç«¯å¿…é¡»æ‹¥æœ‰ä¸€ä¸ªCAè®¤è¯åˆæ³•æˆæƒçš„è¯ä¹¦ï¼Œæ²¡æœ‰è¿™ä¸ªè¯ä¹¦ï¼Œå®¢æˆ·ç«¯åœ¨è®¿é—®è¯¥æœåŠ¡å™¨æ—¶ä¼šæé†’ç”¨æˆ·è¿™ä¸ªç½‘ç«™æ˜¯ä¸å—ä¿¡ä»»çš„ Client Key Exchange ä¸Šä¸€æ­¥ä¸­å®¢æˆ·ç«¯æ ¹æ®æœåŠ¡å™¨ä¼ æ¥çš„å…¬é’¥ç”Ÿæˆäº†PreMaster Keyï¼ŒClient Key Exchangeå°±æ˜¯å°†è¿™ä¸ªPreMaster Keyä¼ ç»™æœåŠ¡ç«¯ï¼ŒæœåŠ¡ç«¯å†ç”¨è‡ªå·±çš„ç§é’¥è§£å‡ºè¿™ä¸ªPreMaster Keyå¾—åˆ°å®¢æˆ·ç«¯ç”Ÿæˆçš„Random3ã€‚ è‡³æ­¤ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯éƒ½æ‹¥æœ‰Random1+Random2+Random3ï¼Œé‚£ä¹ˆä¸¤è¾¹å†æ ¹æ®åŒæ ·çš„ç®—æ³•å°±å¯ä»¥ç”Ÿæˆä¸€ä»½ç§˜é’¥ï¼Œæ¡æ‰‹ç»“æŸåçš„åº”ç”¨å±‚æ•°æ®éƒ½æ˜¯ä½¿ç”¨è¿™ä¸ªç§˜é’¥è¿›è¡Œå¯¹ç§°åŠ å¯†ã€‚ ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ä¸‰ä¸ªéšæœºæ•°ï¼Ÿ è¿™æ˜¯å› ä¸ºSSL/TLSæ¡æ‰‹è¿‡ç¨‹çš„æ•°æ®éƒ½æ˜¯æ˜æ–‡ä¼ è¾“çš„ï¼Œå¹¶ä¸”å¤šä¸ªéšæœºæ•°ç§å­æ¥ç”Ÿæˆç§˜é’¥ä¸å®¹æ˜“è¢«æš´åŠ›ç ´è§£ã€‚ æœ€é‡è¦ç†è§£å‰å…­æ­¥ Change Cipher Specï¼ˆClientï¼‰ è¿™ä¸€æ­¥å®¢æˆ·ç«¯é€šçŸ¥æœåŠ¡ç«¯åé¢å†å‘é€çš„æ¶ˆæ¯éƒ½ä¼šä½¿ç”¨å‰é¢åå•†å‡ºæ¥çš„ç§˜é’¥åŠ å¯†äº†ï¼Œè¿™æ˜¯ä¸€æ¡äº‹ä»¶æ¶ˆæ¯ã€‚ Encrypted Handshake Message(Client) è¿™ä¸€æ­¥å¯¹åº”çš„æ˜¯Client Finishæ¶ˆæ¯ï¼Œå®¢æˆ·ç«¯å°†å‰é¢çš„æ¡æ‰‹æ¶ˆæ¯ç”Ÿæˆæ‘˜è¦å†ç”¨åå•†å¥½çš„ç§˜é’¥åŠ å¯†ï¼Œè¿™æ˜¯å®¢æˆ·ç«¯å‘é€çš„ç¬¬ä¸€æ¡åŠ å¯†æ¶ˆæ¯ã€‚æœåŠ¡ç«¯æ¥æ”¶åä¼šç”¨ç§é’¥è§£å¯†ï¼Œèƒ½è§£å‡ºæ¥åˆ™è¯´æ˜å‰é¢çš„åå•†å‡ºæ¥çš„ç§˜é’¥æ˜¯ä¸€è‡´çš„ã€‚ Change Cipher Spec(Server) è¿™ä¸€æ­¥æ˜¯æœåŠ¡ç«¯é€šçŸ¥å®¢æˆ·ç«¯åé¢å†å‘é€çš„æ¶ˆæ¯éƒ½ä¼šä½¿ç”¨åŠ å¯†ï¼Œä¹Ÿæ˜¯ä¸€æ¡äº‹ä»¶æ¶ˆæ¯ã€‚ Encrypted Handshake Message(Server) è¿™ä¸€æ­¥å¯¹åº”çš„æ˜¯Server Finishæ¶ˆæ¯ï¼ŒæœåŠ¡ç«¯ä¹Ÿä¼šå°†æ¡æ‰‹è¿‡ç¨‹çš„æ¶ˆæ¯ç”Ÿæˆæ‘˜è¦å†ç”¨ç§˜é’¥åŠ å¯†ï¼Œè¿™æ˜¯æœåŠ¡ç«¯å‘å‡ºçš„ç¬¬ä¸€æ¡åŠ å¯†æ¶ˆæ¯ã€‚å®¢æˆ·ç«¯æ¥æ”¶åä¼šç”¨ç§˜é’¥è§£å¯†ï¼Œèƒ½è§£å‡ºæ¥è¯´æ˜åå•†çš„ç§˜é’¥æ˜¯ä¸€è‡´çš„ã€‚ Application Data åˆ°è¿™é‡Œï¼ŒåŒæ–¹å·²å®‰å…¨åå•†å‡ºåŒä¸€ä»½ç§˜é’¥ï¼Œæ‰€æœ‰çš„åº”ç”¨å±‚æ•°æ®éƒ½ä¼šç”¨è¿™ä¸ªç§˜é’¥åŠ å¯†åå†é€šè¿‡TCPè¿›è¡Œå¯é ä¼ è¾“ã€‚ å‚è€ƒï¼šhttp://www.ruanyifeng.com/blog/2014/02/ssl_tls.html â€‹ https://juejin.im/post/584b76d3a22b9d0058d5036f","categories":[{"name":"è®¡ç®—æœºç½‘ç»œ","slug":"è®¡ç®—æœºç½‘ç»œ","permalink":"http://delaprada.com/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/"}],"tags":[{"name":"è®¡ç®—æœºç½‘ç»œ","slug":"è®¡ç®—æœºç½‘ç»œ","permalink":"http://delaprada.com/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/"}]},{"title":"CSS åœ£æ¯å¸ƒå±€å’ŒåŒé£ç¿¼å¸ƒå±€","slug":"CSS-åœ£æ¯å¸ƒå±€å’ŒåŒé£ç¿¼å¸ƒå±€","date":"2020-01-15T08:49:17.000Z","updated":"2020-01-15T12:46:10.000Z","comments":true,"path":"2020/01/15/CSS-åœ£æ¯å¸ƒå±€å’ŒåŒé£ç¿¼å¸ƒå±€/","link":"","permalink":"http://delaprada.com/2020/01/15/CSS-%E5%9C%A3%E6%9D%AF%E5%B8%83%E5%B1%80%E5%92%8C%E5%8F%8C%E9%A3%9E%E7%BF%BC%E5%B8%83%E5%B1%80/","excerpt":"","text":"CSS åœ£æ¯å¸ƒå±€å’ŒåŒé£ç¿¼å¸ƒå±€ä¸¤ä¸ªå¸¸è§çš„å‰ç«¯å¸ƒå±€ã€‚åœ£æ¯å¸ƒå±€å’ŒåŒé£ç¿¼å¸ƒå±€ä½œä¸ºç»å…¸çš„ä¸‰æ å¼å¸ƒå±€æ˜¯é¢è¯•ä¸­çš„å¸¸å®¢ã€‚ä¸¤ç§å¸ƒå±€è¾¾åˆ°æ•ˆæœä¸ŠåŸºæœ¬ç›¸åŒï¼Œéƒ½æ˜¯ä¸¤è¾¹ä¸¤æ å®½åº¦å›ºå®šï¼Œä¸­é—´æ å®½åº¦è‡ªé€‚åº”ã€‚åœ¨HTMLç»“æ„ä¸Šä¸­é—´æ åœ¨æœ€å‰é¢ä¿è¯äº†æœ€å…ˆæ¸²æŸ“ä¸­é—´æå‡æ€§èƒ½ï¼ˆå› ä¸ºè¿™ä¸¤ç§å¸ƒå±€éƒ½æ¯”è¾ƒè€ï¼Œæˆ‘è®¤ä¸ºåœ¨ç°ä»£æµè§ˆå™¨ä¸­è¿™ç‚¹å„¿æ€§èƒ½ä¼˜åŒ–æ•ˆæœå¹¶ä¸æ˜¯å¾ˆå¤§ï¼‰ï¼Œå¹¶ä¸”å…¼å®¹æ€§è‰¯å¥½ã€‚ä¸¤ç§å¸ƒå±€çš„å®ç°æ–¹æ³•å‰åŠéƒ¨åˆ†ç›¸åŒï¼ŒååŠéƒ¨åˆ†çš„å®ç°å„æœ‰åˆ©å¼Šï¼Œä¸‹é¢ä¼šç®€å•ä»‹ç»ä¸¤è€…çš„åŒºåˆ«ã€‚ åœ£æ¯å¸ƒå±€ä»£ç å®ç°ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162&lt;html lang=\"en\"&gt;&lt;head&gt; &lt;meta charset=\"UTF-8\"&gt; &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"&gt; &lt;meta http-equiv=\"X-UA-Compatible\" content=\"ie=edge\"&gt; &lt;title&gt;Document&lt;/title&gt; &lt;style&gt; *&#123; margin:0; padding:0; text-align:center; &#125; .header, .footer&#123; background-color: skyblue; height:60px; line-height:60px; /*æ–‡å­—æ°´å¹³å‚ç›´å±…ä¸­*/ &#125; .container&#123; overflow:hidden; /*å› ä¸ºå†…éƒ¨éƒ½æ˜¯æµ®åŠ¨å…ƒç´ ï¼Œæ‰€ä»¥è¦è®¾ç½®overflowæ¥æ’‘èµ·çˆ¶å…ƒç´ */ padding:0 100px; /*å·¦å³å†…è¾¹è·ä¸º100px*/ &#125; .main&#123; width:100%; background-color: peachpuff; height:100px; line-height: 100px; float:left; &#125; .left&#123; background-color: lightgreen; width:100px; height:100px; line-height:100px; float:left; margin-left:-100%; /*è®©leftå‰ç§»ä¸€è¡Œ*/ position:relative; left:-100px; &#125; .right&#123; background-color: pink; width:100px; height:100px; line-height:100px; float:left; margin-left:-100px; /*rightåªéœ€è¦å‰ç§»rightçš„å®½åº¦å³å¯*/ position:relative; /*containerè®¾ç½®äº†padding,æ‰€ä»¥è¦ç›¸å¯¹å®šä½ç§»åŠ¨æ‰èƒ½å°†leftå’Œrightç§»åŠ¨åˆ°å¯¹åº”çš„ä½ç½®*/ right:-100px; &#125; &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;div class=\"header\"&gt;header&lt;/div&gt; &lt;div class=\"container\"&gt; &lt;div class=\"main\"&gt;main&lt;/div&gt; &lt;div class=\"left\"&gt;left&lt;/div&gt; &lt;div class=\"right\"&gt;right&lt;/div&gt; &lt;/div&gt; &lt;div class=\"footer\"&gt;footer&lt;/div&gt;&lt;/body&gt;&lt;/html&gt; æ•ˆæœå›¾ï¼š å®ç°åŸç†ï¼š è®¾ç½®çˆ¶å…ƒç´ containerä¸ºoverflow:hiddenï¼Œæ’‘èµ·çˆ¶å…ƒç´ ï¼Œå­å…ƒç´ mainã€leftã€rightå‡è®¾ä¸ºfloat:leftï¼Œæµ®åŠ¨èµ·æ¥ã€‚æ•ˆæœå¦‚ä¸‹ï¼š ä¸ºäº†è®©mainæ¨¡å—è‡ªé€‚åº”ï¼Œå°†å…¶è®¾ä¸º100% ä¸ºäº†è®©leftå’Œrightæ¨¡å—è·‘ä¸Šå»ï¼Œè®¾ç½®leftæ¨¡å—çš„margin:-100%ï¼Œå¯ä»¥ç†è§£ä¸ºï¼šè´Ÿçš„è¯å°±æ˜¯å‘ä¸Šå‰è¿›ï¼Œæ­£å€¼çš„è¯å°±æ˜¯ç›´æ¥çš„é—´éš”ï¼›rightæ¨¡å—å°±è®¾ç½®ä¸ºmargin:-100pxï¼Œå¤§å°ä¸ºrightæ¨¡å—çš„å®½åº¦ ä¸ºäº†ä½¿mainæ¨¡å—å¾€é‡Œæ”¶ï¼Œè®¾ç½®.container{ padding: 0 100px}ï¼Œå³è®¾ç½®å·¦å³å†…è¾¹è·ã€‚ åˆ©ç”¨ç›¸å¯¹å®šä½ç§»åŠ¨leftå’Œright åŒé£ç¿¼å¸ƒå±€ä»£ç å®ç°ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061&lt;html lang=\"en\"&gt;&lt;head&gt; &lt;meta charset=\"UTF-8\"&gt; &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"&gt; &lt;meta http-equiv=\"X-UA-Compatible\" content=\"ie=edge\"&gt; &lt;title&gt;Document&lt;/title&gt; &lt;style&gt; *&#123; margin:0; padding:0; text-align:center; &#125; .header, .footer&#123; height:60px; background-color: skyblue; line-height:60px; &#125; .container&#123; overflow:hidden; &#125; .main&#123; width:100%; height:100px; line-height:100px; float:left; background-color: peachpuff; &#125; .inner-main&#123; margin-left:100px; /*é€šè¿‡åœ¨mainå†…éƒ¨å†è®¾ç½®ä¸€ä¸ªdivæ¥è¿›è¡Œå·¦å³æ¨¡å—çš„é—´éš”å¸ƒå±€*/ margin-right:100px; &#125; .left&#123; background-color: lightgreen; width:100px; height:100px; line-height:100px; margin-left:-100%; float:left; &#125; .right&#123; background-color: yellow; width:100px; height:100px; line-height:100px; margin-left:-100px; float:left; &#125; &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;div class=\"header\"&gt;header&lt;/div&gt; &lt;div class=\"container\"&gt; &lt;div class=\"main\"&gt; &lt;div class=\"inner-main\"&gt;main&lt;/div&gt; &lt;/div&gt; &lt;div class=\"left\"&gt;left&lt;/div&gt; &lt;div class=\"right\"&gt;right&lt;/div&gt; &lt;/div&gt; &lt;div class=\"footer\"&gt;footer&lt;/div&gt;&lt;/body&gt;&lt;/html&gt; æ•ˆæœå›¾ï¼š å®ç°åŸç†ï¼š åŒé£ç¿¼å¸ƒå±€åˆ™ä¸è®¾ç½®containeré‡Œçš„paddingå±æ€§ï¼Œè€Œæ˜¯é€šè¿‡åœ¨mainæ¨¡å—ä¸­æ·»åŠ inner-mainæ¨¡å—ï¼Œç„¶åå¯¹è¿™ä¸ªdivè¿›è¡Œmargin-leftå’Œmargin-rightè®¡ç®—ã€‚ åœ£æ¯å¸ƒå±€å’ŒåŒé£ç¿¼å¸ƒå±€çš„ä¸»è¦åŒºåˆ«ï¼š åœ£æ¯å¸ƒå±€æ˜¯è®¾ç½®containerçš„paddingå±æ€§ä»¥åŠleftå’Œrightæ¨¡å—çš„position:relativeï¼Œleft:-100pxæˆ–right:-100px åŒé£ç¿¼å¸ƒå±€åˆ™ä¸è®¾ç½®containeré‡Œçš„paddingå±æ€§ï¼Œè€Œæ˜¯é€šè¿‡åœ¨mainæ¨¡å—ä¸­æ·»åŠ inner-mainæ¨¡å—ï¼Œç„¶åå¯¹è¿™ä¸ªdivè¿›è¡Œmargin-leftå’Œmargin-rightè®¡ç®— å‚è€ƒï¼šhttps://segmentfault.com/a/1190000004579886","categories":[{"name":"CSS","slug":"CSS","permalink":"http://delaprada.com/categories/CSS/"}],"tags":[{"name":"CSS","slug":"CSS","permalink":"http://delaprada.com/tags/CSS/"}]},{"title":"JavaScriptæ¨¡å—åŒ–ç¼–ç¨‹","slug":"JavaScriptæ¨¡å—åŒ–ç¼–ç¨‹","date":"2020-01-14T15:10:50.000Z","updated":"2020-01-14T15:11:32.000Z","comments":true,"path":"2020/01/14/JavaScriptæ¨¡å—åŒ–ç¼–ç¨‹/","link":"","permalink":"http://delaprada.com/2020/01/14/JavaScript%E6%A8%A1%E5%9D%97%E5%8C%96%E7%BC%96%E7%A8%8B/","excerpt":"","text":"æ¨¡å—åŒ–ç¼–ç¨‹ç›®å½•ï¼š AMD CMD commom.js ES6 Module AMDAMDæ˜¯ä¾èµ–å‰ç½®ï¼Œæå‰æ‰§è¡Œã€‚AMDä¸€å¼€å§‹æ˜¯CommonJSè§„èŒƒä¸­çš„ä¸€ä¸ªè‰æ¡ˆï¼Œå³å¼‚æ­¥æ¨¡å—åŠ è½½æœºåˆ¶ã€‚åæ¥ç”±è¯¥è‰æ¡ˆçš„ä½œè€…ä»¥RequireJSå®ç°äº†AMDè§„èŒƒï¼Œæ‰€ä»¥ä¸€èˆ¬è¯´AMDä¹Ÿæ˜¯æŒ‡RequireJSã€‚ AMDçš„åŸºæœ¬è¯­æ³•é€šè¿‡defineæ¥å®šä¹‰ä¸€ä¸ªæ¨¡å—ï¼Œä½¿ç”¨requireå¯ä»¥å¯¼å…¥å®šä¹‰çš„æ¨¡å—ã€‚ ç”¨defineå®šä¹‰æ— ä¾èµ–çš„æ¨¡å—ï¼š 12345//a.js//defineå¯ä»¥ä¼ å…¥ä¸‰ä¸ªå‚æ•°ï¼Œåˆ†åˆ«æ˜¯å­—ç¬¦ä¸²-æ¨¡å—åã€æ•°ç»„-ä¾èµ–æ¨¡å—ã€å‡½æ•°-å›è°ƒå‡½æ•°define(function()&#123; return 1;&#125;) ç”¨defineå®šä¹‰æœ‰ä¾èµ–çš„æ¨¡å—ï¼š 1234567define([\"alpha\"], function( alpha )&#123; return &#123; verb : function()&#123; return alpha.verb() + 1 ; &#125; &#125;&#125;); ç”¨requireè¿›è¡Œæ¨¡å—åŠ è½½ï¼š 123require(['math'], function(math) &#123; math.add(2, 3);&#125;); AMDçš„ç‰¹ç‚¹å¯¹äºä¾èµ–çš„æ¨¡å—ï¼ŒAMDæ¨å´‡ä¾èµ–å‰ç½®ï¼Œæå‰æ‰§è¡Œã€‚ä¹Ÿå°±æ˜¯å®šä¹‰æ¨¡å—å’ŒåŠ è½½æ¨¡å—éƒ½è¦åœ¨ä¸€å¼€å§‹å°±æŠŠä¾èµ–å†™å¥½ã€‚ä¾‹å¦‚defineå‡½æ•°å½“ä¸­çš„[&quot;alpha&quot;]ï¼Œå°±æ˜¯å®šä¹‰æ¨¡å—å½“ä¸­çš„ä¾èµ–ï¼›requireå‡½æ•°å½“ä¸­çš„[&quot;math&quot;]æ˜¯åŠ è½½æ¨¡å—å½“ä¸­çš„ä¾èµ–ã€‚ CMDCMDæ˜¯ä¾èµ–å°±è¿‘ï¼Œå»¶è¿Ÿæ‰§è¡Œã€‚ 1234567891011121314151617181920212223//AMDdefine(['./a','./b'], function (a, b) &#123; //ä¾èµ–ä¸€å¼€å§‹å°±å†™å¥½ a.test(); b.test();&#125;); //CMDdefine(function (requie, exports, module) &#123; //ä¾èµ–å¯ä»¥å°±è¿‘ä¹¦å†™ var a = require('./a'); a.test(); ... //è½¯ä¾èµ– if (status) &#123; var b = requie('./b'); b.test(); &#125;&#125;); CMDæ˜¯åœ¨ç”¨åˆ°äº†æŸä¸ªæ¨¡å—çš„æ—¶å€™å†å»requireï¼Œç±»ä¼¼æŒ‰éœ€åŠ è½½ã€‚ CMDçš„ç‰¹ç‚¹å¯¹äºä¾èµ–çš„æ¨¡å—ï¼ŒCMDæ¨å´‡ä¾èµ–å°±è¿‘ï¼Œå»¶è¿Ÿæ‰§è¡Œã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåªæœ‰åˆ°requireæ—¶ä¾èµ–æ¨¡å—æ‰æ‰§è¡Œã€‚ æ‘˜è‡ªï¼šhttps://segmentfault.com/a/1190000004873947 CommonJSåŸºæœ¬ç”¨æ³• é€šè¿‡module.exportsæˆ–è€…exportsæ¥è¾“å‡ºæ¨¡å— é€šè¿‡requireæ¥å¯¼å…¥æ¨¡å— 1234567891011121314151617181920//a.jsmodule.exports = function () &#123; console.log(\"hello world\")&#125;//b.jsvar a = require('./a');a();//\"hello world\"//æˆ–è€…//a2.jsexports.num = 1;exports.obj = &#123;xx: 2&#125;;//b2.jsvar a2 = require('./a2');console.log(a2);//&#123; num: 1, obj: &#123; xx: 2 &#125; &#125; CommonJSçš„ç‰¹ç‚¹ æ‰€æœ‰ä»£ç éƒ½è¿è¡Œåœ¨æ¨¡å—ä½œç”¨åŸŸï¼Œä¸ä¼šæ±¡æŸ“å…¨å±€ä½œç”¨åŸŸ æ¨¡å—éƒ½æ˜¯åŒæ­¥åŠ è½½çš„ï¼Œå³åªæœ‰åŠ è½½å®Œæˆï¼Œæ‰èƒ½æ‰§è¡Œåé¢çš„æ“ä½œ æ¨¡å—åœ¨é¦–æ¬¡æ‰§è¡Œåå°±ä¼šç¼“å­˜ï¼Œå†æ¬¡åŠ è½½åªè¿”å›ç¼“å­˜ç»“æœã€‚å¦‚æœæƒ³è¦å†æ¬¡æ‰§è¡Œï¼Œå¯æ¸…æ¥šç¼“å­˜ requireè¿”å›çš„å€¼æ˜¯è¢«è¾“å‡ºçš„å€¼çš„æ‹·è´ï¼Œæ¨¡å—å†…éƒ¨çš„å˜åŒ–ä¸ä¼šå½±å“è¿™ä¸ªå€¼ ES6 ModuleåŸºæœ¬ç”¨æ³•ï¼š exportæˆ–export defaultæ¥è¾“å‡ºæ¨¡å— importæ¥å¯¼å…¥æ¨¡å— ï¼ˆexport defaultå°±æ˜¯èƒ½å¤Ÿä¸ºå¯¼å…¥çš„æ¨¡å—è‡ªå®šä¹‰åç§°ï¼Œè¿™æ ·å°±ä¸ç”¨çŸ¥é“æ¨¡å—åœ¨åŸæœ¬çš„jsæ–‡ä»¶å½“ä¸­çš„åå­—ï¼ŒæŒ‰åå­—å¯¼å…¥äº†ï¼‰ 1234567891011//a.jsvar name = 'lin';var age = 13;var job = 'ninja';export &#123; name, age, job&#125;;//b.jsimport &#123; name, age, job&#125; from './a.js';console.log(name, age, job);// lin 13 ninja 12345678//a2.jsexport default function () &#123; console.log('default ');&#125;//b2.jsimport customName from './a2.js';customName(); // 'default' ES6 Moduleçš„ç‰¹ç‚¹ï¼ˆå¯¹æ¯”CommonJSï¼‰ CommonJSæ¨¡å—æ˜¯è¿è¡Œæ—¶åŠ è½½ï¼ŒES6 Moduleæ˜¯ç¼–è¯‘æ—¶è¾“å‡ºæ¥å£ï¼› CommonJSåŠ è½½çš„æ˜¯æ•´ä¸ªæ¨¡å—ï¼Œå°†æ‰€æœ‰çš„æ¥å£å…¨éƒ¨åŠ è½½è¿›æ¥ï¼ŒES6 Moduleå¯ä»¥å•ç‹¬åŠ è½½å…¶ä¸­çš„æŸä¸ªæ¥å£ï¼ˆå¯¹åº”åå­—å•ç‹¬åŠ è½½ï¼ŒåŠ è½½è¿™ä¸ªæ¨¡å—æƒ³=éœ€è¦çš„ï¼‰ï¼› CommonJSè¾“å‡ºæ˜¯å€¼çš„æ‹·è´ï¼ŒES6 Moduleè¾“å‡ºçš„æ˜¯å€¼çš„å¼•ç”¨ï¼Œè¢«è¾“å‡ºæ¨¡å—çš„å†…éƒ¨çš„æ”¹å˜ä¼šå½±å“å¼•ç”¨çš„æ”¹å˜ï¼› CommonJS thisæŒ‡å‘å½“å‰æ¨¡å—ï¼ŒES6 Module thisæŒ‡å‘undefined; å‚è€ƒï¼šhttps://juejin.im/post/5db95e3a6fb9a020704bcd8d","categories":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://delaprada.com/categories/JavaScript/"}],"tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://delaprada.com/tags/JavaScript/"}]},{"title":"å¼‚æ­¥ä»¥åŠå¼‚æ­¥ç¼–ç¨‹è§£å†³æ–¹æ¡ˆ","slug":"Generatorå‡½æ•°-asyncå‡½æ•°","date":"2020-01-14T12:43:59.000Z","updated":"2020-04-02T01:03:24.000Z","comments":true,"path":"2020/01/14/Generatorå‡½æ•°-asyncå‡½æ•°/","link":"","permalink":"http://delaprada.com/2020/01/14/Generator%E5%87%BD%E6%95%B0-async%E5%87%BD%E6%95%B0/","excerpt":"","text":"ä»€ä¹ˆæ˜¯å¼‚æ­¥æ‰€è°“â€å¼‚æ­¥â€ï¼Œç®€å•è¯´å°±æ˜¯ä¸€ä¸ªä»»åŠ¡ä¸æ˜¯è¿ç»­å®Œæˆçš„ï¼Œå¯ä»¥ç†è§£æˆè¯¥ä»»åŠ¡è¢«äººä¸ºåˆ†æˆä¸¤æ®µï¼Œå…ˆæ‰§è¡Œç¬¬ä¸€æ®µï¼Œç„¶åè½¬è€Œæ‰§è¡Œå…¶ä»–ä»»åŠ¡ï¼Œç­‰åšå¥½äº†å‡†å¤‡ï¼Œå†å›è¿‡å¤´æ‰§è¡Œç¬¬äºŒæ®µã€‚ ç›¸åº”åœ°ï¼Œè¿ç»­çš„æ‰§è¡Œå°±å«åšåŒæ­¥ã€‚ç”±äºæ˜¯è¿ç»­æ‰§è¡Œï¼Œä¸èƒ½æ’å…¥å…¶ä»–ä»»åŠ¡ã€‚ ä¾‹å¦‚ï¼š 1234setTimeout(function()&#123; XXX;&#125;,1000)console.log(\"XXX\"); setTimeoutå°±æ˜¯ä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡ï¼Œä»»åŠ¡åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼Œä¸€ä¸ªéƒ¨åˆ†æ˜¯å»¶è¿Ÿ1000msï¼Œå¦ä¸€ä¸ªéƒ¨åˆ†æ˜¯æ‰§è¡ŒXXXã€‚setTimeoutæ˜¯å…ˆæ‰§è¡Œ1000msçš„å»¶è¿Ÿï¼Œç„¶åå†å»¶è¿ŸæœŸé—´å°†æ‰§è¡Œæƒäº¤ç»™äº†console.logï¼Œè¾“å‡ºäº†â€œXXXâ€ä¹‹åï¼Œå†å»æ‰§è¡ŒsetTimeoutä»»åŠ¡çš„ç¬¬äºŒéƒ¨åˆ†ï¼Œæ‰§è¡ŒXXXã€‚ å¦‚æœæ˜¯åŒæ­¥çš„è¯ï¼Œå®ƒä¼šç­‰åˆ°1000msè¿‡å»ï¼Œæ‰§è¡ŒXXXä¹‹åï¼Œå†è¾“å‡ºâ€XXXâ€ï¼Œæ˜¾ç„¶JavaScriptä¸æƒ³è¿™æ ·æµªè´¹æ—¶é—´ã€‚ å¼‚æ­¥ç¼–ç¨‹æ–¹æ¡ˆå¼‚æ­¥ç¼–ç¨‹ä¹Ÿæœ‰å¤šç§è§£å†³æ–¹æ¡ˆï¼Œå…¶æ¼”å˜è¿‡ç¨‹æ˜¯ï¼šå›è°ƒå‡½æ•°â€”ã€‹Promiseâ€”ã€‹Generatorâ€”ã€‹async/awaitï¼Œæ¯ä¸ªæ¼”å˜éƒ½è§£å†³äº†ä¹‹å‰çš„ä¸€äº›ç—›ç‚¹ã€‚ å›è°ƒå‡½æ•°æ‰€è°“å›è°ƒå‡½æ•°ï¼Œå°±æ˜¯æŠŠä»»åŠ¡çš„ç¬¬äºŒæ®µå•ç‹¬å†™åœ¨ä¸€ä¸ªå‡½æ•°é‡Œé¢ï¼Œç­‰åˆ°é‡æ–°æ‰§è¡Œè¿™ä¸ªä»»åŠ¡çš„æ—¶å€™ï¼Œå°±ç›´æ¥è°ƒç”¨è¿™ä¸ªå‡½æ•°ã€‚callbackçš„æ„æ€å°±æ˜¯â€œé‡æ–°è°ƒç”¨â€ã€‚ è¯»å–æ–‡ä»¶è¿›è¡Œå¤„ç†ï¼Œæ˜¯è¿™æ ·å†™çš„ã€‚ 1234fs.readFile('/etc/passwd', 'utf-8', function (err, data) &#123; if (err) throw err; console.log(data);&#125;); ä¸Šé¢ä»£ç ä¸­ï¼ŒreadFileå‡½æ•°çš„ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œå°±æ˜¯å›è°ƒå‡½æ•°ï¼Œä¹Ÿå°±æ˜¯ä»»åŠ¡çš„ç¬¬äºŒæ®µã€‚ç­‰åˆ°æ“ä½œç³»ç»Ÿè¿”å›äº†/etc/passwdè¿™ä¸ªæ–‡ä»¶ä»¥åï¼Œå›è°ƒå‡½æ•°æ‰ä¼šæ‰§è¡Œã€‚ ä¹Ÿå°±æ˜¯è¯´åœ¨æ‰§è¡ŒreadFileçš„æ—¶å€™ï¼Œæ‰§è¡Œæƒäº¤ç»™äº†ä¸»çº¿ç¨‹æ‰§è¡Œæ ˆçš„åŒæ­¥ä»»åŠ¡ï¼ŒåŒæ­¥ä»»åŠ¡æ‰§è¡Œå®Œæ¯•åæ‰ä¼šæ‰§è¡Œè¿™ä¸ªreadFileçš„å›è°ƒã€‚ å›è°ƒå‡½æ•°çš„ç¼ºç‚¹å›è°ƒå‡½æ•°ä¼šå¯¼è‡´å›è°ƒåœ°ç‹±ã€‚ æ¯”å¦‚ç°åœ¨æœ‰å¤šä¸ªå¼‚æ­¥ä»»åŠ¡ï¼Œä¸”ä»»åŠ¡æœ‰ä¾èµ–å…³ç³»ï¼ˆä¸€ä¸ªä»»åŠ¡éœ€è¦æ‹¿åˆ°å¦ä¸€ä¸ªä»»åŠ¡æˆåŠŸåçš„ç»“æœæ‰èƒ½å¼€å§‹æ‰§è¡Œï¼‰çš„æ—¶å€™ï¼Œå›è°ƒçš„æ–¹å¼å†™å‡ºæ¥çš„ä»£ç å°±ä¼šåƒè¿™æ ·ï¼š 1234567891011getData1(data1 =&gt; &#123; getData2(data1, data2 =&gt; &#123; getData3(data2, data3 =&gt; &#123; getData4(data3, data4 =&gt; &#123; getData5(data4, data5 =&gt; &#123; // ç»ˆäºå–åˆ°data5äº† &#125;) &#125;) &#125;) &#125;)&#125;) è¿™ç§å¤šå±‚åµŒå¥—çš„ç»“æ„å°±æ˜¯å›è°ƒåœ°ç‹±ï¼Œè¿™ç§æƒ…å†µä¸‹ä»£ç çš„å¯è¯»æ€§å¾ˆå·®ã€‚ Promiseå› æ­¤å°±å‡ºç°äº†Promiseã€‚Promiseçš„å…³é”®ç‚¹å°±æ˜¯å°†å›è°ƒå‡½æ•°çš„åµŒå¥—æ”¹ä¸ºäº†é“¾å¼è°ƒç”¨ã€‚ æˆ‘ä»¬ä½¿ç”¨new Promiseå»åˆ›å»ºä¸€ä¸ªPromiseå®ä¾‹ï¼Œè¿™ä¸ªPromiseå®ä¾‹ä¼šä¼ å…¥ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œå‡½æ•°åˆæœ‰ä¸¤ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œåˆ†åˆ«æ˜¯ï¼šresolveã€rejectã€‚ æ‰§è¡Œresolveå‡½æ•°ï¼ŒPromiseå®ä¾‹çš„çŠ¶æ€ä¼šå˜ä¸ºfulfilledï¼Œåç»­å°±ä¼šå»æ‰§è¡Œ.thenå›è°ƒå‡½æ•° æ‰§è¡Œrejectå‡½æ•°ï¼ŒPromiseå®ä¾‹çš„çŠ¶æ€ä¼šå˜ä¸ºrejectedï¼Œåç»­å°±ä¼šå»æ‰§è¡Œ.catchå›è°ƒå‡½æ•°ï¼Œæˆ–è€….thençš„ç¬¬äºŒä¸ªå›è°ƒå‡½æ•°ã€‚ 3ç§çŠ¶æ€Promiseå®ä¾‹æœ‰ä¸‰ç§çŠ¶æ€ï¼š pendingï¼ˆè¿›è¡Œä¸­ï¼‰ fulfilledï¼ˆå·²æˆåŠŸï¼‰ rejectedï¼ˆå·²å¤±è´¥ï¼‰ fulfilledå’Œrejectedæœ‰å¯ä»¥è¯´æ˜¯å·²æˆåŠŸå’Œå·²å¤±è´¥ï¼Œè¿™ä¸¤ç§çŠ¶æ€åˆå½’ä¸ºå·²å®ŒæˆçŠ¶æ€ resolveå’Œrejectè°ƒç”¨resolveå’Œrejectèƒ½å°†åˆ†åˆ«å°†promiseå®ä¾‹çš„çŠ¶æ€å˜æˆfulfilledå’Œrejectedï¼Œåªæœ‰çŠ¶æ€å˜æˆå·²å®Œæˆï¼ˆå³fulfilledå’Œrejectedä¹‹ä¸€ï¼‰ï¼Œæ‰èƒ½è§¦å‘çŠ¶æ€çš„å›è°ƒã€‚resolveå’Œrejectä¸¤ç§å‡½æ•°åªä¼šæ‰§è¡Œä¸€ç§ï¼Œæ‰§è¡Œäº†å…¶ä¸­ä¸€ä¸ªä¹‹åå°±ä¸ä¼šæ‰§è¡Œå¦ä¸€ä¸ªäº†ã€‚ åŸºæœ¬ç»“æ„123456789101112131415let p = new Promise((resolve,reject)=&gt;&#123; //åšä¸€äº›äº‹æƒ… //ç„¶ååœ¨æŸäº›æ¡ä»¶ä¸‹resolveï¼Œæˆ–è€…rejectï¼ˆä»¥ä¸‹ä»£ç ï¼‰ if(/* æ¡ä»¶éšä¾¿å†™ */)&#123; resolve() &#125; else&#123; reject() &#125;&#125;)p.then(()=&gt;&#123; //å¦‚æœpçš„çŠ¶æ€è¢«resolveäº†ï¼Œå°±è¿›å…¥è¿™é‡Œ&#125;,()=&gt;&#123; //å¦‚æœpçš„çŠ¶æ€è¢«reject&#125;) ç®€å•æ¥è¯´ï¼Œè¿™ç§.then.then.thençš„ç¼–ç æ–¹å¼ï¼Œå°±æ˜¯Promiseã€‚ å®ƒçš„å¼‚æ­¥ä½“ç°åœ¨ï¼Œnew Promiseéƒ¨åˆ†æ˜¯ç«‹å³æ‰§è¡Œçš„ï¼Œé‚£æ‰§è¡Œå®Œæ¯•åï¼Œå°±ä¼šå°†æ‰§è¡Œæƒäº¤ç»™ä¸»çº¿ç¨‹æ‰§è¡Œæ ˆçš„åŒæ­¥ä»»åŠ¡ï¼ŒåŒæ­¥ä»»åŠ¡æ‰§è¡Œå®Œæ¯•åæ‰ä¼šå»æ‰§è¡Œ.thenå›è°ƒã€‚è¿™é‡Œæ¶‰åŠJavaScriptäº‹ä»¶æ‰§è¡Œæœºåˆ¶Eventloopã€‚ Promiseå®ç°å¤šä»»åŠ¡é¡ºåºæ‰§è¡Œ1234567891011121314var result=new Promise(function(resolve,reject)&#123; setTimeout(function()&#123; resolve(\"one\"); &#125;,3000)&#125;).then(function(data)&#123; console.log(data); return new Promise(function(resolve,reject)&#123; setTimeout(function()&#123; resolve(\"two\"); &#125;,3000) &#125;)&#125;).then(function(data)&#123; console.log(data);&#125;) éœ€è¦æ³¨æ„çš„æ˜¯ï¼šæ¯ä¸ª.thenä¸­è¦è¿”å›ä¸€ä¸ªnew Promiseå¯¹è±¡ï¼ŒæŠŠä»»åŠ¡æ”¾åœ¨Promiseä¸­ï¼Œåç»­æ‰èƒ½ç»§ç»­ä½¿ç”¨.thenå»æ‰§è¡Œåç»­æ“ä½œã€‚ Promiseå®ç°å¤šä»»åŠ¡å¹¶è¡Œï¼ˆå³Aã€Bä»»åŠ¡éƒ½æ‰§è¡Œå®Œæ¯•äº†æ‰èƒ½æ‰§è¡ŒCä»»åŠ¡ï¼‰ï¼š123456789101112var p1=new Promise((resolve,reject)=&gt;&#123; resolve('hello');&#125;)p1.then(result=&gt;result);var p2=new Promise((resolve,reject)=&gt;&#123; resolve('hi');&#125;)p1.then(result=&gt;result);var p=Promise.all([p1,p2]);p.then(result=&gt;console.log(result)); è¿™é‡Œä¸»è¦ç”¨åˆ°Promise.allè¿™ç§ç»“æ„ã€‚Promise.all([p1,p2])æ¥å—ä¸€ä¸ªæ•°ç»„ä½œä¸ºå‚æ•°ï¼Œæ•°ç»„çš„å…ƒç´ éƒ½æ˜¯Promiseå®ä¾‹ï¼Œåªæœ‰å½“æ•°ç»„ä¸­æ‰€æœ‰Promiseå®ä¾‹çš„çŠ¶æ€éƒ½å˜ä¸ºfulfilledçš„æ—¶å€™ï¼Œè¿™ä¸ªPromise.allçš„å®ä¾‹æ‰ä¼šå˜ä¸ºfulfilledï¼Œæ‰èƒ½æ‰§è¡Œåç»­çš„.thenæ“ä½œã€‚ å’ŒPromise.allç›¸å…³çš„è¿˜æœ‰Promise.raceï¼Œé‚£Promise.raceå®ä¾‹çš„çŠ¶æ€æ˜¯ç­‰äºå…¶å‚æ•°ä¸­ç¬¬ä¸€ä¸ªæ‰§è¡Œå®Œæ¯•çš„Promiseå®ä¾‹çš„çŠ¶æ€ï¼Œå®ƒæœ‰å¯èƒ½æ˜¯rejectedï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯fulfilledã€‚ Promiseçš„ç¼ºç‚¹Promiseçš„æœ€å¤§é—®é¢˜æ˜¯ä»£ç å†—ä½™ï¼šåŸæ¥çš„ä»»åŠ¡è¢« Promise åŒ…è£…äº†ä¸€ä¸‹ï¼Œä¸ç®¡ä»€ä¹ˆæ“ä½œï¼Œä¸€çœ¼çœ‹å»éƒ½æ˜¯ä¸€å †thenï¼ŒåŸæ¥çš„è¯­ä¹‰å˜å¾—å¾ˆä¸æ¸…æ¥šã€‚ GeneratorGenerator å‡½æ•°æ˜¯ ES6 æä¾›çš„ä¸€ç§å¼‚æ­¥ç¼–ç¨‹è§£å†³æ–¹æ¡ˆ,Generatorå°±èƒ½å¤Ÿè§£å†³ä¸Šè¿°Promiseä»£ç å†—ä½™çš„é—®é¢˜ã€‚å®ƒèƒ½å¤Ÿä»¥ä¸€ç§ç±»ä¼¼åŒæ­¥çš„å†™æ³•æ¥æ‰§è¡Œä¸€äº›å¼‚æ­¥æ“ä½œã€‚ å½¢å¼ä¸ŠGeneratorå‡½æ•°æ˜¯ä¸€ä¸ªæ™®é€šå‡½æ•°ï¼Œæœ‰ä¸¤ä¸ªç‰¹å¾ï¼š1ï¼‰functionå…³é”®å­—ä¸å‡½æ•°åä¹‹é—´æœ‰ä¸ªæ˜Ÿå·ï¼› 2ï¼‰å‡½æ•°å†…éƒ¨ä½¿ç”¨yieldè¡¨è¾¾å¼ï¼Œå®šä¹‰ä¸åŒçš„å†…éƒ¨çŠ¶æ€ æ‰§è¡ŒGeneratorå‡½æ•°ä¼šè¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡ è°ƒç”¨Generatorå‡½æ•°åï¼Œè¯¥å‡½æ•°å¹¶ä¸æ‰§è¡Œï¼Œè¿”å›çš„ä¸æ˜¯å‡½æ•°è¿è¡Œç»“æœï¼Œè€Œæ˜¯ä¸€ä¸ªæŒ‡å‘å†…éƒ¨çŠ¶æ€çš„æŒ‡é’ˆå¯¹è±¡ å¿…é¡»è°ƒç”¨éå†å™¨å¯¹è±¡çš„nextæ–¹æ³•ï¼Œä½¿å¾—æŒ‡é’ˆç§»å‘ä¸‹ä¸€ä¸ªçŠ¶æ€ï¼Œè¾“å‡ºè¿”å›çš„ç»“æœ Generatorå‡½æ•°çš„å†™æ³•1234567function* helloWorldGenerator() &#123; yield 'hello'; yield 'world'; return 'ending';&#125;var hw = helloWorldGenerator(); 1234567891011hw.next()// &#123; value: 'hello', done: false &#125;hw.next()// &#123; value: 'world', done: false &#125;hw.next()// &#123; value: 'ending', done: true &#125;hw.next()// &#123; value: undefined, done: true &#125; å¼‚æ­¥åº”ç”¨å› ä¸ºyieldèƒ½å¤Ÿä¸­æ–­æ‰§è¡Œä»£ç çš„ç‰¹æ€§ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬æ¥æ§åˆ¶å¼‚æ­¥ä»£ç çš„æ‰§è¡Œé¡ºåºã€‚ ä¾‹å¦‚æœ‰ä¸¤ä¸ªå¼‚æ­¥çš„å‡½æ•° A å’Œ B, å¹¶ä¸” B çš„å‚æ•°æ˜¯ A çš„è¿”å›å€¼ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœ A æ²¡æœ‰æ‰§è¡Œç»“æŸï¼Œæˆ‘ä»¬ä¸èƒ½æ‰§è¡Œ Bã€‚ é‚£è¿™æ—¶å€™æˆ‘ä»¬å†™ä¸€æ®µä¼ªä»£ç ï¼š 12345function* effect() &#123; const &#123; param &#125; = yield A(); const &#123; result &#125; = yield B(param); console.table(result);&#125; è¿™æ—¶å€™æˆ‘ä»¬å¦‚æœéœ€è¦å¾—åˆ° result é‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦: 123const iterator = effect()iterator.next()iterator.next() coåº“å¯ä»¥ç”¨æ¥æ¯æ¬¡æ‰§è¡ŒA()/b()çš„è¯·æ±‚ç»“æŸä¹‹åï¼Œéƒ½ä¼šè‡ªåŠ¨æ‰§è¡Œnext()æ–¹æ³•ã€‚ ä½¿ç”¨Generatorå»å®ç°Promiseçš„ä»»åŠ¡é¡ºåºæ‰§è¡Œï¼šæˆ‘ä»¬å†å›é¡¾ä¸€ä¸‹Promiseç‰ˆæœ¬ï¼š 1234567891011121314var result=new Promise(function(resolve,reject)&#123; setTimeout(function()&#123; resolve(\"one\"); &#125;,3000)&#125;).then(function(data)&#123; console.log(data); return new Promise(function(resolve,reject)&#123; setTimeout(function()&#123; resolve(\"two\"); &#125;,3000) &#125;)&#125;).then(function(data)&#123; console.log(data);&#125;) Generatorç‰ˆæœ¬ï¼š 123456789101112131415161718192021function f1() &#123; setTimeout(function() &#123; g.next(\"one\"); //å°†å‚æ•°ä¼ ç»™data1 &#125;, 3000);&#125;function f2(data1) &#123; console.log(\"æ¥æ”¶åˆ°äº†\" + data1); setTimeout(function()&#123; g.next(\"two\"); //å°†å‚æ•°ä¼ ç»™data2 &#125;,3000)&#125;function* mygenerator() &#123; var data1 = yield f1(); var data2=yield f2(data1); console.log(data2);&#125;var g = mygenerator();g.next(); çœ‹èµ·æ¥å°±å¾ˆåƒåŒæ­¥æ“ä½œã€‚ è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼šæ‰§è¡Œyield f1()çš„æ—¶å€™æ˜¯ä¸ä¼šå°†è¿”å›çš„ç»“æœè¿”å›ç»™data1çš„ã€‚nextæ–¹æ³•å¯ä»¥æ¥å—å‚æ•°ï¼Œè¿™æ˜¯å‘ Generator å‡½æ•°ä½“å†…è¾“å…¥æ•°æ®ã€‚ ç¬¬äºŒä¸ªnextçš„æ—¶å€™ä¼ å…¥å‚æ•°ï¼Œå°±èƒ½è¢«å˜é‡data1å°±èƒ½å¤Ÿæ¥æ”¶åˆ°ã€‚ è€Œä¸”ä¸èƒ½åœ¨f1ä¸­ç›´æ¥è°ƒç”¨g.next()ï¼Œè¦åœ¨å¼‚æ­¥å‡½æ•°å†…è°ƒç”¨ï¼ˆè¿™é‡Œè¿˜ä¸æ˜¯å¾ˆæ‡‚ä¸ºä»€ä¹ˆâ€¦ï¼‰ã€‚ æ‰§è¡Œé¡ºåºå¦‚ä¸‹ï¼š å†çœ‹ä¸ªæ —å­ç†è§£ï¼š 12345678910111213function* G() &#123; const a = yield 100 console.log('a', a) // a aaa const b = yield 200 console.log('b', b) // b bbb const c = yield 300 console.log('c', c) // c ccc&#125;const g = G()g.next() // value: 100, done: falseg.next('aaa') // a aaa value: 200, done: false g.next('bbb') // b bbb value: 300, done: falseg.next('ccc') //c ccc value: undefined, done: true æ•è·é”™è¯¯12345678910111213function* gen(x)&#123; try &#123; var y = yield x + 2; &#125; catch (e)&#123; console.log(e); &#125; return y;&#125;var g = gen(1);g.next();g.throw('å‡ºé”™äº†');// å‡ºé”™äº† ä½¿ç”¨try...catchã€‚ asyncå’Œawaitasyncå‡½æ•°å°±æ˜¯Generatorçš„è¯­æ³•ç³–ã€‚ å½¢å¼ä¸Šçš„ä¸åŒï¼š asyncå‡½æ•°å°†Generatorå‡½æ•°çš„æ˜Ÿå·ï¼ˆ*ï¼‰æ›¿æ¢æˆasync å°†yieldæ›¿æ¢æˆawait asyncå‡½æ•°å¯¹Generatorå‡½æ•°çš„æ”¹è¿›ä½“ç°åœ¨ä»¥ä¸‹3ç‚¹ï¼š å†…ç½®æ‰§è¡Œå™¨ ä¹Ÿå°±æ˜¯è¯´asyncå‡½æ•°çš„æ‰§è¡Œï¼Œå’Œæ™®é€šå‡½æ•°ä¸€æ ·ï¼Œåªéœ€è¦ä¸€è¡Œå°±å¯ä»¥ã€‚ä¸ç”¨åƒGeneratorå‡½æ•°éœ€è¦è°ƒç”¨nextæ–¹æ³•æ‰èƒ½çœŸæ­£æ‰§è¡Œã€‚ ä¾‹å¦‚å¯¹äºä¸€ä¸ªasyncå‡½æ•°æ¥è¯´ï¼š 123456const asyncReadFile = async function () &#123; const f1 = await readFile('/etc/fstab'); const f2 = await readFile('/etc/shells'); console.log(f1.toString()); console.log(f2.toString());&#125;; è°ƒç”¨æ—¶åªéœ€è¦ï¼š 1asyncReadFile(); æ›´å¥½çš„è¯­ä¹‰ asyncå’Œawaitæ¯”èµ·æ˜Ÿå·å’Œyieldï¼Œè¯­ä¹‰æ›´åŠ æ¸…æ¥šäº†ã€‚asyncè¡¨ç¤ºå‡½æ•°é‡Œæœ‰å¼‚æ­¥æ“ä½œï¼Œawaitè¡¨ç¤ºç´§è·Ÿåœ¨åé¢çš„è¡¨è¾¾å¼éœ€è¦ç­‰å¾…ç»“æœã€‚ è¿”å›å€¼æ˜¯Promise asyncå‡½æ•°çš„è¿”å›å€¼æ˜¯ Promise å¯¹è±¡ï¼Œè¿™æ¯” Generator å‡½æ•°çš„è¿”å›å€¼æ˜¯ Iterator å¯¹è±¡æ–¹ä¾¿å¤šäº†ã€‚ä½ å¯ä»¥ç”¨thenæ–¹æ³•æŒ‡å®šä¸‹ä¸€æ­¥çš„æ“ä½œã€‚ asyncå‡½æ•°åŸºæœ¬ç”¨æ³•asyncå‡½æ•°è¿”å›ä¸€ä¸ª Promise å¯¹è±¡ï¼Œå¯ä»¥ä½¿ç”¨thenæ–¹æ³•æ·»åŠ å›è°ƒå‡½æ•°ã€‚å½“å‡½æ•°æ‰§è¡Œçš„æ—¶å€™ï¼Œä¸€æ—¦é‡åˆ°awaitå°±ä¼šå…ˆè¿”å›ï¼Œç­‰åˆ°å¼‚æ­¥æ“ä½œå®Œæˆï¼Œå†æ¥ç€æ‰§è¡Œå‡½æ•°ä½“å†…åé¢çš„è¯­å¥ã€‚ 123456789async function getStockPriceByName(name) &#123; const symbol = await getStockSymbol(name); const stockPrice = await getStockPrice(symbol); return stockPrice;&#125;getStockPriceByName('goog').then(function (result) &#123; console.log(result);&#125;); å…ˆæ‰§è¡Œäº†ç¬¬ä¸€ä¸ªawaitåçš„getStockSymbol(name)å‡½æ•°ï¼›å¾—åˆ°äº†è‚¡ç¥¨çš„åç§°symbolåï¼Œå°†symbolä¼ ç»™ç¬¬äºŒä¸ªawaitåé¢çš„getStockPrice(symbol)ä½œä¸ºå‚æ•°ï¼›æœ€åè¿”å›è‚¡ç¥¨ä»·æ ¼stockPriceã€‚ async/awaité”™è¯¯å¤„ç†try/catch ä½¿ç”¨tryå°†awaitè¯­å¥åŒ…å«èµ·æ¥ï¼Œå¦‚æœawaitåçš„è¯­å¥æ‰§è¡Œé”™è¯¯ï¼Œåˆ™é”™è¯¯ä¼šè¢«catchæ•è·ï¼š 123456789run();async function run() &#123; try &#123; await Promise.reject(new Error(\"Oops!\")); &#125; catch (error) &#123; error.message; // \"Oops!\" &#125;&#125; 123456789101112run();async function run() &#123; const v = null; try &#123; await Promise.resolve(\"foo\"); v.thisWillThrow; &#125; catch (error) &#123; // \"TypeError: Cannot read property 'thisWillThrow' of null\" error.message; &#125;&#125; å‚è€ƒï¼šhttps://blog.fundebug.com/2019/07/24/async-await-error-handling-in-js/ â€‹ https://segmentfault.com/a/1190000012767617 æ‰§è¡Œé¡ºåºé—®é¢˜1234567891011121314async function async1()&#123; console.log('async1 start'); await async2(); console.log('async1 end')&#125;async function async2()&#123; console.log('async2')&#125;console.log('script start');async1();console.log('script end')// è¾“å‡ºé¡ºåºï¼šscript start-&gt;async1 start-&gt;async2-&gt;script end-&gt;async1 end å½“asyncå‡½æ•°æ‰§è¡Œçš„æ—¶å€™ï¼Œä¸€æ—¦é‡åˆ°awaitå°±ä¼šå…ˆè¿”å›ï¼Œç­‰åˆ°è§¦å‘çš„å¼‚æ­¥æ“ä½œå®Œæˆåï¼Œå†æ‰§è¡Œå‡½æ•°ä½“åé¢çš„è¯­å¥ã€‚å¯ä»¥ç†è§£ä¸ºï¼Œæ˜¯è®©å‡ºäº†çº¿ç¨‹ï¼Œè·³å‡ºäº†asyncå‡½æ•°ä½“ã€‚ 1234567891011121314151617181920async function async1() &#123; console.log('async1 start'); await async2(); console.log('async1 end');&#125;async function async2() &#123; console.log('async2');&#125;console.log('script start');setTimeout(function() &#123; console.log('setTimeout');&#125;, 0)async1();new Promise(function(resolve) &#123; console.log('promise1'); resolve();&#125;).then(function() &#123; console.log('promise2');&#125;);console.log('script end'); æ‰§è¡Œé¡ºåºä¸ºï¼š æ‰§è¡Œasync1çš„æ—¶å€™é‡åˆ°awaitå…ˆå»æ‰§è¡Œasync2ï¼Œç„¶åè·³å‡ºäº†å‡½æ•°ä½“ï¼Œå»æ‰§è¡Œåç»­çš„ä»£ç ï¼Œç„¶åå†å›åˆ°å½“å‰async1å‡½æ•°å½“ä¸­æ‰§è¡Œawaitåç»­è¯­å¥ã€‚","categories":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://delaprada.com/categories/JavaScript/"}],"tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://delaprada.com/tags/JavaScript/"}]},{"title":"å‡½æ•°æŸ¯é‡ŒåŒ–","slug":"å‡½æ•°æŸ¯é‡ŒåŒ–","date":"2020-01-14T06:27:55.000Z","updated":"2020-02-18T07:59:42.000Z","comments":true,"path":"2020/01/14/å‡½æ•°æŸ¯é‡ŒåŒ–/","link":"","permalink":"http://delaprada.com/2020/01/14/%E5%87%BD%E6%95%B0%E6%9F%AF%E9%87%8C%E5%8C%96/","excerpt":"","text":"å‡½æ•°æŸ¯é‡ŒåŒ–æŸ¯é‡ŒåŒ–çš„æ¦‚å¿µï¼šåªä¼ é€’ç»™å‡½æ•°ä¸€éƒ¨åˆ†å‚æ•°æ¥è°ƒç”¨å®ƒï¼Œè®©å®ƒè¿”å›ä¸€ä¸ªå‡½æ•°å»å¤„ç†å‰©ä¸‹çš„å‚æ•°ã€‚ çœ‹ä¸€ä¸ªæ —å­ï¼š 1234567891011121314var add = function(x) &#123; return function(y) &#123; return x + y; &#125;;&#125;;var increment = add(1);var addTen = add(10);increment(2);// 3addTen(2);// 12 æˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªaddå‡½æ•°ï¼Œå®ƒæ¥å—ä¸€ä¸ªå‚æ•°å¹¶è¿”å›ä¸€ä¸ªæ–°çš„å‡½æ•°ã€‚è°ƒç”¨äº†addä¹‹åï¼Œè¿”å›çš„å‡½æ•°å°±é€šè¿‡é—­åŒ…çš„æ–¹å¼è®°ä½äº†addçš„ç¬¬ä¸€ä¸ªå‚æ•°ã€‚ å› ä¸ºä¸€æ¬¡æ€§åœ°è°ƒç”¨å®ƒæœ‰ç‚¹ç¹çï¼Œæ‰€ä»¥ä½¿ç”¨ä¸€ä¸ªç‰¹æ®Šçš„curryå¸®åŠ©å‡½æ•°ä½¿å¾—è¿™ç±»å‡½æ•°çš„å®šä¹‰å’Œè°ƒç”¨æ›´åŠ å®¹æ˜“ã€‚ ä¸€äº›æŸ¯é‡Œå‡½æ•°å®ä¾‹ï¼š 12345var curry = require('lodash').curry;var match = curry(function(what, str) &#123; return str.match(what);&#125;); 12345match(/\\s+/g, \"hello world\");// [ ' ' ]match(/\\s+/g)(\"hello world\");// [ ' ' ] ä»¥ä¸Šä¸¤ç§æ–¹æ³•éƒ½å¯ä»¥æ‰§è¡Œã€‚ç¬¬äºŒç§æ–¹æ³•æ˜¯æ¯”è¾ƒå¸¸è§çš„æŸ¯é‡ŒåŒ–æ–¹æ³•ã€‚å…ˆä¼ é€’ä¸€éƒ¨åˆ†å‚æ•°ï¼ˆé¢˜ç›®ä¸­ä¸ºæ­£åˆ™è¡¨è¾¾å¼ï¼‰æ¥è°ƒç”¨å‡½æ•°ï¼Œç„¶åè¿”å›ä¸€ä¸ªå‡½æ•°ï¼ˆé¢˜ç›®ä¸­ä¸ºstr.match()æ¥å¤„ç†å‰©ä¸‹çš„å‡½æ•°ï¼‰ã€‚ï¼ˆé¢˜ç›®ä¸­æ˜¯åŒ¹é…ç©ºæ ¼ï¼‰ ä»¥ä¸Šçš„å½¢å¼å¯ä»¥æ›´åŠ å…·ä½“åŒ–ï¼š 12345var hasSpaces = match(/\\s+/g);// function(x) &#123; return x.match(/\\s+/g) &#125;hasSpaces(\"hello world\");// [ ' ' ] è¿™é‡Œè¡¨æ˜çš„æ˜¯ä¸€ç§â€œé¢„åŠ è½½â€å‡½æ•°çš„èƒ½åŠ›ï¼Œé€šè¿‡ä¼ é€’ä¸€åˆ°ä¸¤ä¸ªå‚æ•°è°ƒç”¨å‡½æ•°ï¼Œå°±èƒ½å¾—åˆ°ä¸€ä¸ªè®°ä½äº†è¿™äº›å‚æ•°çš„æ–°å‡½æ•°ã€‚ å†ä¸¾ä¸€ä¸ªéå¸¸å¸¸è§çš„ä¾‹å­ï¼š å¦‚æœæˆ‘ä»¬æƒ³è¦éªŒè¯ä¸€ä¸²æ•°å­—æ˜¯å¦æ˜¯æ­£ç¡®çš„æ‰‹æœºå·ï¼ŒæŒ‰ç…§æ™®é€šçš„æ€è·¯æ¥åšï¼Œå¤§å®¶å¯èƒ½æ˜¯è¿™æ ·å°è£…ï¼Œå¦‚ä¸‹ï¼š 123function checkPhone(phoneNumber) &#123; return /^1[34578]\\d&#123;9&#125;$/.test(phoneNumber);&#125; è€Œå¦‚æœæƒ³è¦éªŒè¯æ˜¯å¦æ˜¯é‚®ç®±å‘¢ï¼Ÿè¿™ä¹ˆå°è£…ï¼š 123function checkEmail(email) &#123; return /^(\\w)+(\\.\\w+)*@(\\w)+((\\.\\w+)+)$/.test(email);&#125; æˆ‘ä»¬è¿˜å¯èƒ½ä¼šé‡åˆ°éªŒè¯èº«ä»½è¯å·ï¼ŒéªŒè¯å¯†ç ç­‰å„ç§éªŒè¯ä¿¡æ¯ï¼Œå› æ­¤åœ¨å®è·µä¸­ï¼Œä¸ºäº†ç»Ÿä¸€é€»è¾‘ï¼Œæˆ‘ä»¬å°±ä¼šå°è£…ä¸€ä¸ªæ›´ä¸ºé€šç”¨çš„å‡½æ•°ï¼Œå°†ç”¨äºéªŒè¯çš„æ­£åˆ™ä¸å°†è¦è¢«éªŒè¯çš„å­—ç¬¦ä¸²ä½œä¸ºå‚æ•°ä¼ å…¥ï¼š 123function check(targetString, reg) &#123; return reg.test(targetString);&#125; ä½†æ˜¯è¿™æ ·å°è£…ä¹‹åï¼Œåœ¨ä½¿ç”¨æ—¶åˆä¼šç¨å¾®éº»çƒ¦ä¸€ç‚¹ï¼Œå› ä¸ºä¼šæ€»æ˜¯è¾“å…¥ä¸€ä¸²æ­£åˆ™ï¼Œè¿™æ ·å°±å¯¼è‡´äº†ä½¿ç”¨æ—¶çš„æ•ˆç‡ä½ä¸‹ï¼š 12check(/^1[34578]\\d&#123;9&#125;$/, '14900000088');check(/^(\\w)+(\\.\\w+)*@(\\w)+((\\.\\w+)+)$/, 'test@163.com'); è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å°±å¯ä»¥å€ŸåŠ©æŸ¯é‡ŒåŒ–ï¼Œåœ¨checkçš„åŸºç¡€ä¸Šå†åšä¸€å±‚å°è£…ï¼Œä»¥ç®€åŒ–ä½¿ç”¨ï¼š 1234var _check = createCurry(check);var checkPhone = _check(/^1[34578]\\d&#123;9&#125;$/);var checkEmail = _check(/^(\\w)+(\\.\\w+)*@(\\w)+((\\.\\w+)+)$/); æœ€ååœ¨ä½¿ç”¨çš„æ—¶å€™å°±ä¼šå˜å¾—æ›´åŠ ç›´è§‚ä¸ç®€æ´äº†ï¼š 12checkPhone('183888888');checkEmail('xxxxx@test.com'); å†çœ‹ä¸€ä¸ªå‰ç«¯é¢è¯•ä¸­å¸¸è€ƒçš„é¢˜ç›®ï¼š 1å¦‚ä½•å®ç°add(2)(3)(4) &#x3D; 9 å‡½æ•°æŸ¯é‡ŒåŒ–è§£å†³è¿™ä¸ªé—®é¢˜ï¼š 12345678910111213141516171819let myAdd = (a, b, c) =&gt; a+b+c;function curry(fn, args)&#123; let len = fn.length; let _this = this; let _args = args || []; return function()&#123; let args = Array.prototype.slice.apply(arguments); args = Array.prototype.concat.call(_args, args); // å½“æ¥æ”¶åˆ°çš„å‚æ•°å°äºfnæ‰€éœ€å‚æ•°ä¸ªæ•°æ—¶ï¼Œç»§ç»­æ¥æ”¶å‚æ•° if(args.length &lt; len)&#123; return curry.call(_this, fn, args); &#125; return fn.apply(this, args); &#125;&#125;let add = curry(myAdd);console.log(add(2)(3)(4)); // 9console.loh(add(2,3)(4)); // 9console.log(add(2,3,4)); // 9 ä½†æ˜¯è¿™ä¸ªä¾‹å­ä¸å…·æœ‰æ™®éæ€§ã€‚å¦‚æœä¼ å…¥çš„å‚æ•°ä¸æ˜¯3ä¸ªçš„è¯ä¸èƒ½è¿™ä¹ˆç”¨ã€‚ æ‰€ä»¥æœ‰äº†ä¸‹é¢çš„è¿›åŒ–ä¹‹åçš„ä»£ç ï¼š 1234567891011121314151617181920212223function add() &#123; // ç¬¬ä¸€æ¬¡æ‰§è¡Œæ—¶ï¼Œå®šä¹‰ä¸€ä¸ªæ•°ç»„ä¸“é—¨ç”¨æ¥å­˜å‚¨æ‰€æœ‰çš„å‚æ•° var _args = Array.prototype.slice.call(arguments); // åœ¨å†…éƒ¨å£°æ˜ä¸€ä¸ªå‡½æ•°ï¼Œåˆ©ç”¨é—­åŒ…çš„ç‰¹æ€§ä¿å­˜_argså¹¶æ”¶é›†æ‰€æœ‰çš„å‚æ•°å€¼ var _adder = function() &#123; _args.push(...arguments); return _adder; &#125;; // åˆ©ç”¨toStringéšå¼è½¬æ¢çš„ç‰¹æ€§ï¼Œå½“æœ€åæ‰§è¡Œæ—¶éšå¼è½¬æ¢ï¼Œå¹¶è®¡ç®—æœ€ç»ˆçš„å€¼è¿”å› _adder.toString = function () &#123; return _args.reduce(function (a, b) &#123; return a + b; &#125;); &#125; return _adder;&#125;add(1)(2)(3).toString() // 6add(1, 2, 3)(4).toString() // 10add(1)(2)(3)(4)(5).toString() // 15add(2, 6)(1).toString() // 9 å‚è€ƒçš„åšå®¢è¯´éšå¼è½¬æ¢çš„åŸå› æ˜¯å› ä¸ºå‡½æ•°è¿›è¡Œè®¡ç®—çš„æ—¶å€™ä¼šå˜ä¸ºå­—ç¬¦ä¸²ï¼Œä½†ç†è§£äº†ä»£ç ä¹‹åè§‰å¾—å¹¶ä¸æ˜¯è¿™ä¹ˆå›äº‹ã€‚æ¯æ¬¡è°ƒç”¨å‡½æ•°çš„æ—¶å€™æ‰§è¡Œçš„æ˜¯è¿™ä¸ªè¯­å¥ä½“ï¼š 1234var _adder = function() &#123; _args.push(...arguments); return _adder;&#125;; è¿™ä¸ªè¯­å¥ä½“å®é™…ä¸Šæ˜¯ç”¨äºå°†æ‰€æœ‰ä¼ å…¥çš„å®å‚æ”¾è¿›æ•°ç»„argsä¸­ã€‚æœ€åæ‰§è¡ŒtoStringæ–¹æ³•çš„æ—¶å€™æ˜¯å°†æ•°ç»„argsçš„æ¯ä¸ªå…ƒç´ é€šè¿‡reduceå‡½æ•°æ±‚å’Œï¼Œè¿”å›æ±‚å’Œçš„å€¼ã€‚å•çº¯æ‰§è¡Œ_adderå‡½æ•°å’Œæ‰§è¡ŒtoString()å‡½æ•°åšçš„äº‹æƒ…æ˜¯ä¸ä¸€æ ·çš„ã€‚ çœ‹åˆ°ä¸€ä¸ªé¢è¯•é¢˜ç›®ï¼š å®ç°ä¸€ä¸ªsumå‡½æ•°ä½¿å¾—sum(1, 2, 3).valueOf()å’Œsum(1)(2)(3).valueOf()æ‰§è¡Œè¾“å‡ºçš„ç»“æœéƒ½ç­‰äº6 ã€‚ è§£æ³•å’Œä¸Šé¢ä¸€è‡´ï¼Œåªéœ€è¦æŠŠtoString()æ”¹ä¸ºvalueOf()å°±å¯ä»¥äº†ã€‚ 1234567891011121314151617var sum=function()&#123; var args=[].slice.call(arguments); var _adder=function()&#123; args.push(...arguments); return _adder; &#125; _adder.valueOf=function()&#123; return args.reduce(function(a,b)&#123; return a+b; &#125;); &#125; return _adder;&#125;console.log(sum(1,2,3).valueOf());console.log(sum(1)(2)(3).valueOf()); ä¸ºä»€ä¹ˆè¦è¿›è¡Œéšå¼è½¬åŒ–ï¼Ÿ å› ä¸ºå½“æˆ‘ä»¬å°†å‡½æ•°å‚ä¸å…¶ä»–çš„è®¡ç®—æ—¶ï¼Œå‡½æ•°ä¼šé»˜è®¤è°ƒç”¨toStringæ–¹æ³•ï¼Œç›´æ¥å°†å‡½æ•°ä½“è½¬æ¢ä¸ºå­—ç¬¦ä¸²å‚ä¸è®¡ç®—ã€‚ 12function fn() &#123; return 20 &#125;console.log(fn + 10); // è¾“å‡ºç»“æœ function fn() &#123; return 20 &#125;10 æˆ‘ä»¬å¯ä»¥é‡å†™å‡½æ•°çš„toStringæ–¹æ³•ï¼Œè®©å‡½æ•°å‚ä¸è®¡ç®—ï¼Œè¾“å‡ºæˆ‘ä»¬æƒ³è¦çš„ç»“æœï¼š 1234function fn() &#123; return 20; &#125;fn.toString = function() &#123; return 30 &#125;console.log(fn + 10); // 40 é™¤æ­¤ä¹‹å¤–ï¼Œå½“æˆ‘ä»¬é‡å†™å‡½æ•°çš„valueOfæ–¹æ³•ä¹Ÿèƒ½å¤Ÿæ”¹å˜å‡½æ•°çš„éšå¼è½¬æ¢ç»“æœï¼š 1234function fn() &#123; return 20; &#125;fn.valueOf = function() &#123; return 60 &#125;console.log(fn + 10); // 70 å‚è€ƒåšå®¢ï¼š https://www.jianshu.com/p/5e1899fe7d6b https://www.cnblogs.com/hmchen/p/11564394.html https://llh911001.gitbooks.io/mostly-adequate-guide-chinese/content/ch4.html#%E4%B8%8D%E4%BB%85%E4%BB%85%E6%98%AF%E5%8F%8C%E5%85%B3%E8%AF%AD%E5%92%96%E5%96%B1","categories":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://delaprada.com/categories/JavaScript/"}],"tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://delaprada.com/tags/JavaScript/"}]},{"title":"JavaScript thisè§£æ","slug":"JavaScript-thiså…¨é¢è§£æ","date":"2020-01-13T03:12:48.000Z","updated":"2020-03-07T12:09:24.000Z","comments":true,"path":"2020/01/13/JavaScript-thiså…¨é¢è§£æ/","link":"","permalink":"http://delaprada.com/2020/01/13/JavaScript-this%E5%85%A8%E9%9D%A2%E8%A7%A3%E6%9E%90/","excerpt":"","text":"ä¸ºä»€ä¹ˆè¦ä½¿ç”¨thisthisæä¾›äº†ä¸€ç§æ›´ä¼˜é›…çš„æ–¹å¼æ¥éšå¼â€œä¼ é€’â€ä¸€ä¸ªå¯¹è±¡å¼•ç”¨ã€‚ çœ‹ä¸‹é¢çš„ä¾‹å­ï¼š æ²¡æœ‰ä½¿ç”¨thisçš„æƒ…å†µä¸‹ï¼š 1234567891011121314151617var me=&#123; name:\"Kyle\"&#125;var you=&#123; name:\"Reader\"&#125;function identify(context)&#123; return context.name.toUpperCase();&#125;function speak(context)&#123; var greeting=\"Hello, I'm \"+identify(context); console.log(greeting);&#125;identify(you); //READERspeak(me); //hello, I'm KYLE ä½¿ç”¨äº†thisçš„æƒ…å†µï¼š 123456789101112function identify()&#123; return this.name.toUpperCase();&#125;function speak()&#123; var greeting=\"Hello, I'm \"+identify.call(this); console.log(greeting);&#125;identify.call(me); //KYLEidentify.call(you); //READERspeak.call(me); //Hello, I'm KYLEspeak.call(you); //Hello, I'm READER è¡¨è¾¾ä¸Šæ›´åŠ çš„ç®€æ´ã€‚å¦‚æœä¸ä½¿ç”¨thisçš„è¯ï¼Œå°±éœ€è¦ç»™identify()å’Œspeak()æ˜¾å¼ä¼ å…¥ä¸€ä¸ªä¸Šä¸‹æ–‡å¯¹è±¡ã€‚ thisç»‘å®šå¯¹è±¡çš„è§„åˆ™æˆ‘ä»¬å¯ä»¥é¡ºåºåº”ç”¨ä¸‹é¢å››æ¡è§„åˆ™æ¥åˆ¤æ–­thisçš„ç»‘å®šå¯¹è±¡ï¼š å¦‚æœæ˜¯ç”±newè°ƒç”¨ï¼Œç»‘å®šåˆ°æ–°åˆ›å»ºçš„å¯¹è±¡ã€‚ å¦‚æœæ˜¯ç”±callæˆ–è€…applyã€bindè°ƒç”¨ï¼Œç»‘å®šåˆ°æŒ‡å®šçš„å¯¹è±¡ä¸Šã€‚ å¦‚æœæ˜¯ç”±ä¸Šä¸‹æ–‡å¯¹è±¡è°ƒç”¨ï¼ˆå³thisæ˜¯å¯¹è±¡ä¸­çš„æ–¹æ³•é‡Œä½¿ç”¨çš„ï¼‰ï¼Œç»‘å®šåˆ°é‚£ä¸ªä¸Šä¸‹æ–‡å¯¹è±¡ä¸Šã€‚ å¦‚æœæ˜¯é»˜è®¤æƒ…å†µä¸‹ï¼Œä¸¥æ ¼æ¨¡å¼ç»‘å®šåˆ°undefinedï¼Œå¦åˆ™ç»‘å®šåˆ°å…¨å±€å¯¹è±¡ä¸Šã€‚ ä½†æ˜¯ES6ä¸­çš„ç®­å¤´å‡½æ•°å¹¶ä¸ä¼šä½¿ç”¨è€…å››æ¡æ ‡å‡†çš„ç»‘å®šè§„åˆ™ã€‚ç®­å¤´å‡½æ•°ä¼šç»§æ‰¿å¤–å±‚å‡½æ•°è°ƒç”¨çš„thisç»‘å®šã€‚ newç»‘å®š12345function foo(a)&#123; this.a=a;&#125;var bar=new foo(2);console.log(bar.a); //2 æˆ‘ä»¬ä½¿ç”¨newæ¥è°ƒç”¨foo(â€¦)æ—¶ï¼Œä¼šæ„é€ ä¸€ä¸ªæ–°å¯¹è±¡å¹¶æŠŠå®ƒç»‘å®šåˆ°foo(â€¦)è°ƒç”¨ä¸­çš„thisä¸Šã€‚ æ˜¾å¼ç»‘å®šcallã€applyã€bind1234567function foo()&#123; console.log(this.a);&#125;var obj=&#123; a:2;&#125;;foo.call(obj); //2 callç”¨æ¥å°†å‡½æ•°fooä¸­çš„thisç»‘å®šåˆ°objä¸Šã€‚ éšå¼ç»‘å®šï¼ˆä¸Šä¸‹æ–‡å¯¹è±¡è°ƒç”¨ï¼‰å¦‚æœthisæ‰€åœ¨çš„å‡½æ•°æ˜¯å¯¹è±¡ä¸­çš„æ–¹æ³•çš„è¯ï¼Œthiså°±ä¼šæŒ‡å‘è¿™ä¸ªå¯¹è±¡ã€‚ 12345678function foo()&#123; console.log(this.a);&#125;var obj=&#123; a:2, foo:foo&#125;;obj.foo(); //2 fooæ­¤æ—¶æ˜¯objå¯¹è±¡çš„ä¸€ä¸ªæ–¹æ³•ï¼Œæ‰€ä»¥thiså°±ä¼šæŒ‡å‘objã€‚ ä½†æ˜¯å¯¹è±¡å±æ€§å¼•ç”¨é“¾ä¸­åªæœ‰ä¸Šä¸€å±‚æˆ–è€…è¯´æœ€åä¸€å±‚åœ¨è°ƒç”¨ä½ç½®ä¸­èµ·ä½œç”¨ï¼š 123456789101112function foo()&#123; console.log(this.a);&#125;var obj2=&#123; a:42, foo:foo&#125;;var obj1=&#123; a:2, obj2:obj2&#125;;obj1.obj2.foo(); //42 éšå¼ä¸¢å¤±ä¹Ÿæ˜¯thiséšå¼ç»‘å®šä¸­å¸¸è§çš„é—®é¢˜ï¼š 12345678910function foo()&#123; console.log(this.a);&#125;var obj=&#123; a:2, foo:foo&#125;;var bar=obj.foo; //å‡½æ•°åˆ«åï¼var a=\"oops, global\"; //aæ˜¯å…¨å±€å¯¹è±¡çš„å±æ€§bar(); //â€œoops, globalâ€ æ­¤æ—¶baræ˜¯obj.fooçš„ä¸€ä¸ªå¼•ç”¨ï¼Œä½†å®é™…ä¸Šå®ƒå¼•ç”¨çš„æ˜¯fooå‡½æ•°æœ¬èº«ï¼Œå› æ­¤æ­¤æ—¶çš„bar()å…¶å®æ˜¯ä¸€ä¸ªä¸å¸¦ä»»ä½•ä¿®é¥°çš„å‡½æ•°è°ƒç”¨ï¼Œå› æ­¤åº”ç”¨äº†é»˜è®¤ç»‘å®šã€‚ å›è°ƒå‡½æ•°ä¸¢å¤±thisç»‘å®šæ˜¯ä¹Ÿæ˜¯éå¸¸å¸¸è§çš„é—®é¢˜ï¼š 123456789101112function foo()&#123; console.log(this.a);&#125;function doFoo(fn)&#123; fn(); //è°ƒç”¨ä½ç½®&#125;var obj=&#123; a:2, foo:foo&#125;;var a=\"oops global\"; //å…¨å±€å¯¹è±¡å±æ€§doFoo(obj.foo); //\"oops global\" å‡½æ•°doFooä¼ å…¥äº†å‡½æ•°ä½œä¸ºå‚æ•°ï¼Œå¹¶åœ¨doFooä¸­è°ƒç”¨ã€‚æˆ‘ä»¬å¯ä»¥æŠŠå®ƒçœ‹åšå°†å‡½æ•°copyåˆ°äº†doFooå‡½æ•°ä½“ä¸­ï¼Œè°ƒç”¨çš„æ—¶å€™thisæŒ‡å‘çš„æ˜¯å…¨å±€ä½œç”¨åŸŸã€‚ éšå¼ä¸¢å¤±ä¸€ä¸ªæœ€å¸¸è§çš„thisç»‘å®šé—®é¢˜å°±æ˜¯è¢«éšå¼ç»‘å®šçš„å‡½æ•°ä¼šä¸¢å¤±ç»‘å®šå¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒä¼šåº”ç”¨é»˜è®¤ç»‘å®šï¼Œä»è€ŒæŠŠthisç»‘å®šåˆ°å…¨å±€å¯¹è±¡æˆ–è€…undefinedä¸Šï¼Œå–å†³äºæ˜¯å¦æ˜¯ä¸¥æ ¼æ¨¡å¼ã€‚ ä¾‹ä¸€ï¼š 12345678910function foo()&#123; console.log(this.a);&#125;var obj=&#123; a:2, foo:foo&#125;var bar=obj.foo; //å‡½æ•°åˆ«åï¼æŠŠå‡½æ•°ä½“èµ‹å€¼äº†var a=\"oops,global\"; //aæ˜¯å…¨å±€å¯¹è±¡çš„å±æ€§bar(); \"oops, global\" barå®é™…ä¸Šå®ƒå¼•ç”¨çš„æ˜¯fooå‡½æ•°æœ¬èº«ã€‚ ä¾‹äºŒï¼š 123456789101112131415function foo()&#123; console.log(this.a);&#125;function doFoo(fn)&#123; fn();&#125;var obj=&#123; a:2, foo:foo&#125;var a=\"oops, global\"; //aæ˜¯å…¨å±€å¯¹è±¡çš„å±æ€§doFoo(obj.foo); //\"oops, global\" å‚æ•°ä¼ é€’å®é™…ä¸Šæ˜¯ä¸€ç§éšå¼èµ‹å€¼ï¼Œå› æ­¤æˆ‘ä»¬ä¼ å…¥å‡½æ•°æ—¶ä¹Ÿä¼šè¢«éšå¼èµ‹å€¼ã€‚ ä¾‹ä¸‰ï¼š 123456789function foo()&#123; console.log(this.a);&#125;var obj=&#123; a:2, foo: foo&#125;var a=\"oops, global\";setTimeout(obj.foo,100); //\"oops, global\" å›è°ƒå‡½æ•°ä¸¢å¤±thisç»‘å®šæ˜¯éå¸¸å¸¸è§çš„ï¼ æ —å­ï¼š 123456789var obj = &#123; id: \"a\", cool: function coolFn() &#123; console.log( this.id ); &#125;&#125;;var id = \"b\"obj.cool(); // asetTimeout( obj.cool, 100 ); // b é»˜è®¤ç»‘å®š12345function foo()&#123; console.log(this.a);&#125;var a=2;foo(); //2 åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå‡½æ•°è°ƒç”¨åº”ç”¨äº†thisçš„é»˜è®¤ç»‘å®šï¼ŒthisæŒ‡å‘å…¨å±€å¯¹è±¡ã€‚ å¦‚æœä½¿ç”¨ä¸¥æ ¼æ¨¡å¼ï¼ˆstrict modeï¼‰ï¼Œåˆ™ä¸èƒ½å°†å…¨å±€å¯¹è±¡ç”¨äºé»˜è®¤ç»‘å®šï¼Œthisä¼šç»‘å®šåˆ°undefinedã€‚ 123456function foo()&#123; \"use strict\"; console.log(this.a);&#125;var a=2;foo(); //TypeError: this is undefined ç®­å¤´å‡½æ•°ä¸­çš„thisç®­å¤´å‡½æ•°ä¸ä¼šåˆ›å»ºè‡ªå·±çš„thisï¼Œå®ƒåªä¼šä»è‡ªå·±çš„ä½œç”¨åŸŸé“¾çš„ä¸Šä¸€å±‚ç»§æ‰¿thisã€‚ 12345678910111213function foo()&#123; return (a)=&gt;&#123; console.log(this.a); &#125;&#125;var obj1=&#123; a:2&#125;;var obj2=&#123; a:3&#125;;var bar=foo.call(obj1);bar.call(obj2); //2,ä¸æ˜¯3ï¼ foo()å†…éƒ¨åˆ›å»ºçš„ç®­å¤´å‡½æ•°ä¼šæ•è·è°ƒç”¨æ—¶foo()çš„thisã€‚ç”±äºfoo()çš„thisç»‘å®šåˆ°obj1ï¼Œæ‰€ä»¥barï¼ˆå¼•ç”¨ç®­å¤´å‡½æ•°ï¼‰çš„thisä¹Ÿä¼šç»‘å®šåˆ°obj1ï¼Œç®­å¤´å‡½æ•°çš„ç»‘å®šæ— æ³•è¢«ä¿®æ”¹ã€‚ å†çœ‹ä¸€ä¸ªä¾‹å­ï¼š 12345678910function foo() &#123; setTimeout(() =&gt; &#123; console.log('id:', this.id); &#125;, 100);&#125;var id = 21;foo.call(&#123; id: 42 &#125;);// id: 42 fooè°ƒç”¨æ—¶ä¼ å…¥çš„æ˜¯ä»€ä¹ˆå¯¹è±¡ï¼Œthiså°±æŒ‡å‘è°ã€‚å¦‚æœæ˜¯æ™®é€šå‡½æ•°ï¼Œæ‰§è¡Œæ—¶thisåº”è¯¥æŒ‡å‘å…¨å±€å¯¹è±¡windowï¼Œè¿™æ—¶åº”è¯¥è¾“å‡º21ï¼ˆä¸¥æ ¼æ¨¡å¼åˆ™è¾“å‡ºundefinedï¼‰ã€‚ å¦‚æœfooå‡½æ•°å†…éƒ¨æ˜¯æ™®é€šå‡½æ•°çš„è¯ï¼š ç”±æ­¤å¯ä»¥çœ‹å‡ºï¼Œfooå‡½æ•°çš„thisæ˜¯æŒ‡å‘callä¼ å…¥çš„å¯¹è±¡{id:42}ï¼Œä½†æ˜¯fooå‡½æ•°å†…éƒ¨çš„setTimeoutå‡½æ•°ä¸­çš„thisæ˜¯æŒ‡å‘å…¨å±€çš„ã€‚ å‚è€ƒä¹¦ç±ï¼šã€Šä½ ä¸çŸ¥é“çš„JavaScriptã€‹","categories":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://delaprada.com/categories/JavaScript/"}],"tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://delaprada.com/tags/JavaScript/"}]},{"title":"JavaScriptåŸºæœ¬çŸ¥è¯†","slug":"JavaScriptåŸºæœ¬çŸ¥è¯†","date":"2019-12-30T02:14:24.000Z","updated":"2019-12-30T02:30:32.000Z","comments":true,"path":"2019/12/30/JavaScriptåŸºæœ¬çŸ¥è¯†/","link":"","permalink":"http://delaprada.com/2019/12/30/JavaScript%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86/","excerpt":"","text":"JavaScriptES6å’ŒJavaScriptçš„å…³ç³»ES6çš„å…¨ç§°ä¸ºECMAScript 6.0ï¼Œæ˜¯JavaScriptè¯­è¨€ä¸‹ä¸€ä»£çš„æ ‡å‡†ï¼Œæ˜¯ä½¿å¾—JavaScriptå¯ä»¥ç”¨æ¥ç¼–å†™å¤æ‚çš„å¤§å‹åº”ç”¨ç¨‹åºï¼Œç§°ä¸ºä¼ä¸šçº§å¼€å‘è¯­è¨€ã€‚ECMAScriptå’ŒJavaScriptçš„å…³ç³»æ˜¯ï¼Œå‰è€…æ˜¯åè€…çš„è§„æ ¼ï¼Œåè€…æ˜¯å‰è€…çš„ä¸€ç§å®ç°ã€‚ JavaScriptå‰è¨€JavaScriptæ˜¯ä¸–ç•Œä¸Šæœ€æµè¡Œçš„è„šæœ¬è¯­è¨€ï¼Œæ˜¯ä¸€ç§è¿è¡Œåœ¨æµè§ˆå™¨ä¸­çš„è§£é‡Šå‹çš„ç¼–ç¨‹è¯­è¨€ã€‚åœ¨Webä¸–ç•Œé‡Œï¼Œåªæœ‰JavaScriptèƒ½è·¨å¹³å°ã€è·¨æµè§ˆå™¨é©±åŠ¨ç½‘é¡µï¼Œä¸ç”¨æˆ·äº¤äº’ã€‚ JavaScriptå¼•å…¥ ç”¨ç›´æ¥åŒ…å«jsä»£ç  æŠŠjsä»£ç æ”¾åˆ°ä¸€ä¸ªå•ç‹¬çš„.jsæ–‡ä»¶ï¼Œåœ¨htmlä¸­é€šè¿‡å¼•å…¥è¿™ä¸ªæ–‡ä»¶ï¼Œè¿™ä¹ˆåšæ›´æœ‰åˆ©äºä»£ç ç»´æŠ¤ JavaScriptåŸºæœ¬è¯­æ³• JavaScriptçš„è¯­æ³•å’ŒJavaç±»ä¼¼ï¼Œæ¯ä¸ªè¯­å¥ä»¥ï¼›ç»“æŸ JavaScriptä¸¥æ ¼åŒºåˆ†å¤§å°å†™ JavaScriptçš„æ•°æ®ç±»å‹åŸºæœ¬æ•°æ®ç±»å‹ï¼šNumber, String, Boolean, null, undefined, Symbolï¼ˆES6ä¸­æ–°æ·»åŠ çš„ç±»å‹ï¼Œä¸€ç§å®ä¾‹æ˜¯å”¯ä¸€ä¸”ä¸å¯æ”¹å˜çš„æ•°æ®ç±»å‹ï¼‰ NumberJavaScriptä¸åŒºåˆ†æ•´æ•°å’Œæµ®ç‚¹æ•°ï¼Œç»Ÿä¸€ç”¨Numberè¡¨ç¤ºã€‚å¯ä»¥è¡¨ç¤º æ•´æ•° æµ®ç‚¹æ•° ç§‘å­¦è®¡æ•°æ³• è´Ÿæ•° NaNï¼ˆè¡¨ç¤ºNot a Numberï¼Œå½“æ— æ³•è®¡ç®—ç»“æœæ—¶ç”¨NaNè¡¨ç¤ºï¼‰ Infinityï¼ˆè¡¨ç¤ºæ— é™å¤§ï¼Œå½“æ•°å€¼è¶…è¿‡äº†JavaScriptçš„Numberæ‰€èƒ½è¡¨ç¤ºçš„æœ€å¤§å€¼æ—¶ï¼Œå°±è¡¨ç¤ºä¸ºInfinityï¼‰ Stringå­—ç¬¦ä¸²æ˜¯ä»¥å•å¼•å·æˆ–åŒå¼•å·æ‹¬èµ·æ¥çš„æ–‡æœ¬ã€‚ æ¨¡æ¿å­—ç¬¦ä¸²è¦æŠŠå¤šä¸ªå­—ç¬¦ä¸²è¿æ¥èµ·æ¥ï¼Œå¯ä»¥ç”¨+å·è¿æ¥ï¼š 1234var name = 'å°æ˜';var age = 20;var message = 'ä½ å¥½, ' + name + ', ä½ ä»Šå¹´' + age + 'å²äº†!';alert(message); å¦‚æœæœ‰å¾ˆå¤šå˜é‡éœ€è¦è¿æ¥ï¼Œç”¨+å·å°±æ¯”è¾ƒéº»çƒ¦ã€‚ES6æ–°å¢äº†ä¸€ç§æ¨¡æ¿å­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºæ–¹æ³•å’Œä¸Šé¢çš„å¤šè¡Œå­—ç¬¦ä¸²ä¸€æ ·ï¼Œä½†æ˜¯å®ƒä¼šè‡ªåŠ¨æ›¿æ¢å­—ç¬¦ä¸²ä¸­çš„å˜é‡ï¼š 1234var name = 'å°æ˜';var age = 20;var message = `ä½ å¥½, $&#123;name&#125;, ä½ ä»Šå¹´$&#123;age&#125;å²äº†!`;alert(message); æ“ä½œå­—ç¬¦ä¸²è·å–å­—ç¬¦ä¸²é•¿åº¦ï¼š 12var s = 'Hello, world!';s.length; // 13 è¦è·å–å­—ç¬¦ä¸²æŸä¸ªæŒ‡å®šä½ç½®çš„å­—ç¬¦ï¼Œä½¿ç”¨ç±»ä¼¼Arrayçš„ä¸‹æ ‡æ“ä½œï¼Œç´¢å¼•å·ä»0å¼€å§‹ï¼š 1234567var s = 'Hello, world!';s[0]; // 'H's[6]; // ' 's[7]; // 'w's[12]; // '!'s[13]; // undefined è¶…å‡ºèŒƒå›´çš„ç´¢å¼•ä¸ä¼šæŠ¥é”™ï¼Œä½†ä¸€å¾‹è¿”å›undefined éœ€è¦ç‰¹åˆ«æ³¨æ„çš„æ˜¯ï¼Œå­—ç¬¦ä¸²æ˜¯ä¸å¯å˜çš„ï¼Œå¦‚æœå¯¹å­—ç¬¦ä¸²çš„æŸä¸ªç´¢å¼•èµ‹å€¼ï¼Œä¸ä¼šæœ‰ä»»ä½•é”™è¯¯ï¼Œä½†æ˜¯ï¼Œä¹Ÿæ²¡æœ‰ä»»ä½•æ•ˆæœï¼š 123var s = 'Test';s[0] = 'X';alert(s); // sä»ç„¶ä¸º'Test' å­—ç¬¦ä¸²å¸¸ç”¨æ–¹æ³•ï¼šæ³¨æ„ï¼Œè°ƒç”¨è¿™äº›æ–¹æ³•æœ¬èº«ä¸ä¼šæ”¹å˜åŸæœ‰å­—ç¬¦ä¸²çš„å†…å®¹ï¼Œè€Œæ˜¯è¿”å›ä¸€ä¸ªæ–°å­—ç¬¦ä¸²ï¼š toUpperCaseï¼š toUpperCase()æŠŠä¸€ä¸ªå­—ç¬¦ä¸²å…¨éƒ¨å˜ä¸ºå¤§å†™ï¼š 12var s = 'Hello';s.toUpperCase(); // è¿”å›'HELLO' toLowerCaseï¼š toLowerCase()æŠŠä¸€ä¸ªå­—ç¬¦ä¸²å…¨éƒ¨å˜ä¸ºå°å†™ï¼š 123var s = 'Hello';var lower = s.toLowerCase(); // è¿”å›'hello'å¹¶èµ‹å€¼ç»™å˜é‡lowerlower; // 'hello' substring: substring()è¿”å›æŒ‡å®šç´¢å¼•åŒºé—´çš„å­ä¸²ï¼š 123var s = 'hello, world's.substring(0, 5); // ä»ç´¢å¼•0å¼€å§‹åˆ°5ï¼ˆä¸åŒ…æ‹¬5ï¼‰ï¼Œè¿”å›'hello's.substring(7); // ä»ç´¢å¼•7å¼€å§‹åˆ°ç»“æŸï¼Œè¿”å›'world' Booleantrueæˆ–è€…false æ¯”è¾ƒè¿ç®—ç¬¦å½“æˆ‘ä»¬å¯¹Numberåšæ¯”è¾ƒæ—¶ï¼Œå¯ä»¥é€šè¿‡æ¯”è¾ƒè¿ç®—ç¬¦å¾—åˆ°ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¦ç‰¹åˆ«æ³¨æ„æ¯”è¾ƒè¿ç®—ç¬¦==å’Œ===ï¼š ==æ¯”è¾ƒï¼šå®ƒä¼šè‡ªåŠ¨è½¬æ¢æ•°æ®ç±»å‹å†æ¯”è¾ƒï¼Œå¾ˆå¤šæ—¶å€™ä¼šå¾—åˆ°å¾ˆå¥‡æ€ªçš„ç»“æœ ===æ¯”è¾ƒï¼Œå®ƒä¸ä¼šè‡ªåŠ¨è½¬æ¢æ•°æ®ç±»å‹ï¼Œå¦‚æœæ•°æ®ç±»å‹ä¸ä¸€è‡´ï¼Œè¿”å›falseï¼Œå¦‚æœä¸€è‡´ï¼Œå†æ¯”è¾ƒã€‚ ç”±äºJavaScriptè¿™ä¸ªè®¾è®¡ç¼ºé™·ï¼Œä¸è¦ä½¿ç”¨==æ¯”è¾ƒï¼Œå§‹ç»ˆåšæŒä½¿ç”¨===æ¯”è¾ƒ å¦ä¸€ä¸ªä¾‹å¤–æ˜¯NaNè¿™ä¸ªç‰¹æ®Šçš„Numberä¸æ‰€æœ‰å…¶ä»–å€¼éƒ½ä¸ç›¸ç­‰ï¼ŒåŒ…æ‹¬å®ƒè‡ªå·±ï¼š NaN===NaN //false å”¯ä¸€èƒ½åˆ¤æ–­NaNçš„æ–¹æ³•æ˜¯é€šè¿‡isNaN()å‡½æ•°ï¼šisNaN(NaN) //true æœ€åè¦æ³¨æ„æµ®ç‚¹æ•°çš„ç›¸ç­‰æ¯”è¾ƒï¼š 1 / 3 === (1 - 2 / 3); // false æ¯”è¾ƒä¸¤ä¸ªæµ®ç‚¹æ•°æ˜¯å¦ç›¸ç­‰ï¼Œåªèƒ½è®¡ç®—å®ƒä»¬ä¹‹å·®çš„ç»å¯¹å€¼ï¼Œçœ‹æ˜¯å¦å°äºæŸä¸ªé˜ˆå€¼ï¼š 1Math.abs(1 &#x2F; 3 - (1 - 2 &#x2F; 3)) &lt; 0.0000001; &#x2F;&#x2F; true nullå’Œundefined nullè¡¨ç¤ºä¸€ä¸ªâ€œç©ºâ€çš„å€¼ã€è¡¨ç¤ºâ€œæ— â€çš„å¯¹è±¡ï¼Œè½¬ä¸ºæ•°å€¼æ˜¯ä¸º0ï¼›undefinedæ˜¯ä¸€ä¸ªè¡¨ç¤ºâ€œæ— â€çš„åŸå§‹å€¼ï¼Œè½¬ä¸ºæ•°å€¼æ˜¯NaNï¼Œå½“å£°æ˜çš„å˜é‡è¿˜æœªè¢«åˆå§‹åŒ–æ—¶ï¼Œå˜é‡çš„é»˜è®¤å€¼ä¸ºundefinedã€‚ Nullç”¨æ¥è¡¨ç¤ºå°šæœªå­˜åœ¨çš„å¯¹è±¡ï¼Œå¸¸ç”¨æ¥è¡¨ç¤ºå‡½æ•°ä¼å›¾è¿”å›ä¸€ä¸ªä¸å­˜åœ¨çš„å¯¹è±¡ Undefinedè¡¨ç¤ºâ€ç¼ºå°‘å€¼â€,å°±æ˜¯æ­¤å¤„åº”è¯¥æœ‰ä¸€ä¸ªå€¼,ä½†æ˜¯è¿˜æ²¡æœ‰å®šä¹‰ï¼Œå…¸å‹ç”¨æ³•æ˜¯ï¼š å˜é‡è¢«å£°æ˜äº†ï¼Œä½†æ²¡æœ‰èµ‹å€¼æ—¶ï¼Œå°±ç­‰äºundefined è°ƒç”¨å‡½æ•°æ—¶ï¼Œåº”è¯¥æä¾›çš„å‚æ•°æ²¡æœ‰æä¾›ï¼Œè¯¥å‚æ•°ç­‰äºundefined å¯¹è±¡æ²¡æœ‰èµ‹å€¼å±æ€§ï¼Œè¯¥å±æ€§çš„å€¼ä¸ºundefined å‡½æ•°æ²¡æœ‰è¿”å›å€¼æ—¶ï¼Œé»˜è®¤è¿”å›undefined nullè¡¨ç¤ºâ€æ²¡æœ‰å¯¹è±¡â€ï¼Œå³è¯¥å¤„ä¸åº”è¯¥æœ‰å€¼ã€‚å…¸å‹ç”¨æ³•æ˜¯ï¼š ä½œä¸ºå‡½æ•°çš„å‚æ•°ï¼Œè¡¨ç¤ºè¯¥å‡½æ•°çš„å‚æ•°ä¸æ˜¯å¯¹è±¡ ä½œä¸ºå¯¹è±¡åŸå‹é“¾çš„ç»ˆç‚¹ æ•°ç»„æ•°ç»„æ˜¯ä¸€ç»„æŒ‰é¡ºåºæ’åˆ—çš„é›†åˆï¼Œé›†åˆçš„æ¯ä¸ªå€¼ç§°ä¸ºå…ƒç´ ã€‚JavaScriptçš„æ•°ç»„å¯ä»¥åŒ…æ‹¬ä»»æ„æ•°æ®ç±»å‹ã€‚ä¾‹å¦‚ï¼š 1[1, 2, 3.14, &#39;Hello&#39;, null, true]; ä¸Šè¿°æ•°ç»„åŒ…å«6ä¸ªå…ƒç´ ã€‚æ•°ç»„ç”¨[]è¡¨ç¤ºï¼Œå…ƒç´ ä¹‹é—´ç”¨,åˆ†éš”ã€‚ å¦ä¸€ç§åˆ›å»ºæ•°ç»„çš„æ–¹æ³•æ˜¯é€šè¿‡Array()å‡½æ•°å®ç°ï¼š 1new Array(1, 2, 3); &#x2F;&#x2F; åˆ›å»ºäº†æ•°ç»„[1, 2, 3] ç„¶è€Œï¼Œå‡ºäºä»£ç çš„å¯è¯»æ€§è€ƒè™‘ï¼Œå¼ºçƒˆå»ºè®®ç›´æ¥ä½¿ç”¨[]ã€‚ æ•°ç»„çš„å…ƒç´ å¯ä»¥é€šè¿‡ç´¢å¼•æ¥è®¿é—®ã€‚è¯·æ³¨æ„ï¼Œç´¢å¼•çš„èµ·å§‹å€¼ä¸º0ï¼š 1234var arr &#x3D; [1, 2, 3.14, &#39;Hello&#39;, null, true];arr[0]; &#x2F;&#x2F; è¿”å›ç´¢å¼•ä¸º0çš„å…ƒç´ ï¼Œå³1arr[5]; &#x2F;&#x2F; è¿”å›ç´¢å¼•ä¸º5çš„å…ƒç´ ï¼Œå³truearr[6]; &#x2F;&#x2F; ç´¢å¼•è¶…å‡ºäº†èŒƒå›´ï¼Œè¿”å›undefined è¦å–å¾—Arrayçš„é•¿åº¦ï¼Œç›´æ¥è®¿é—®lengthå±æ€§ï¼š 12var arr = [1, 2, 3.14, 'Hello', null, true];arr.length; // 6 è¯·æ³¨æ„ï¼Œç›´æ¥ç»™Arrayçš„lengthèµ‹ä¸€ä¸ªæ–°çš„å€¼ä¼šå¯¼è‡´Arrayå¤§å°çš„å˜åŒ–ï¼š 123456var arr = [1, 2, 3];arr.length; // 3arr.length = 6;arr; // arrå˜ä¸º[1, 2, 3, undefined, undefined, undefined]arr.length = 2;arr; // arrå˜ä¸º[1, 2] Arrayå¯ä»¥é€šè¿‡ç´¢å¼•æŠŠå¯¹åº”çš„å…ƒç´ ä¿®æ”¹ä¸ºæ–°çš„å€¼ï¼Œå› æ­¤ï¼Œå¯¹Arrayçš„ç´¢å¼•è¿›è¡Œèµ‹å€¼ä¼šç›´æ¥ä¿®æ”¹è¿™ä¸ªArrayï¼š 123var arr = ['A', 'B', 'C'];arr[1] = 99;arr; // arrç°åœ¨å˜ä¸º['A', 99, 'C'] (æ³¨æ„æ­¤å¤„ä¸Stringçš„ä¸åŒï¼ŒStringæ˜¯ä¸å¯å˜çš„) è¯·æ³¨æ„ï¼Œå¦‚æœé€šè¿‡ç´¢å¼•èµ‹å€¼æ—¶ï¼Œç´¢å¼•è¶…è¿‡äº†èŒƒå›´ï¼ŒåŒæ ·ä¼šå¼•èµ·Arrayå¤§å°çš„å˜åŒ–ï¼š 123var arr = [1, 2, 3];arr[5] = 'x';arr; // arrå˜ä¸º[1, 2, 3, undefined, undefined, 'x'] å¤§å¤šæ•°å…¶ä»–ç¼–ç¨‹è¯­è¨€ä¸å…è®¸ç›´æ¥æ”¹å˜æ•°ç»„çš„å¤§å°ï¼Œè¶Šç•Œè®¿é—®ç´¢å¼•ä¼šæŠ¥é”™ã€‚ç„¶è€Œï¼ŒJavaScriptçš„Arrayå´ä¸ä¼šæœ‰ä»»ä½•é”™è¯¯ã€‚åœ¨ç¼–å†™ä»£ç æ—¶ï¼Œä¸å»ºè®®ç›´æ¥ä¿®æ”¹Arrayçš„å¤§å°ï¼Œè®¿é—®ç´¢å¼•æ—¶è¦ç¡®ä¿ç´¢å¼•ä¸ä¼šè¶Šç•Œã€‚ indexOf ä¸Stringç±»ä¼¼ï¼ŒArrayä¹Ÿå¯ä»¥é€šè¿‡indexOf()æ¥æœç´¢ä¸€ä¸ªæŒ‡å®šçš„å…ƒç´ çš„ä½ç½®ï¼š 12345var arr = [10, 20, '30', 'xyz'];arr.indexOf(10); // å…ƒç´ 10çš„ç´¢å¼•ä¸º0arr.indexOf(20); // å…ƒç´ 20çš„ç´¢å¼•ä¸º1arr.indexOf(30); // å…ƒç´ 30æ²¡æœ‰æ‰¾åˆ°ï¼Œè¿”å›-1arr.indexOf('30'); // å…ƒç´ '30'çš„ç´¢å¼•ä¸º2 æ³¨æ„äº†ï¼Œæ•°å­—30å’Œå­—ç¬¦ä¸²&#39;30&#39;æ˜¯ä¸åŒçš„å…ƒç´ ã€‚ slice slice()å°±æ˜¯å¯¹åº”Stringçš„substring()ç‰ˆæœ¬ï¼Œå®ƒæˆªå–Arrayçš„éƒ¨åˆ†å…ƒç´ ï¼Œç„¶åè¿”å›ä¸€ä¸ªæ–°çš„Arrayï¼š 123var arr = ['A', 'B', 'C', 'D', 'E', 'F', 'G'];arr.slice(0, 3); // ä»ç´¢å¼•0å¼€å§‹ï¼Œåˆ°ç´¢å¼•3ç»“æŸï¼Œä½†ä¸åŒ…æ‹¬ç´¢å¼•3: ['A', 'B', 'C']arr.slice(3); // ä»ç´¢å¼•3å¼€å§‹åˆ°ç»“æŸ: ['D', 'E', 'F', 'G'] å¦‚æœä¸ç»™slice()ä¼ é€’ä»»ä½•å‚æ•°ï¼Œå®ƒå°±ä¼šä»å¤´åˆ°å°¾æˆªå–æ‰€æœ‰å…ƒç´ ã€‚åˆ©ç”¨è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“åœ°å¤åˆ¶ä¸€ä¸ªArrayï¼š 1234var arr = ['A', 'B', 'C', 'D', 'E', 'F', 'G'];var aCopy = arr.slice();aCopy; // ['A', 'B', 'C', 'D', 'E', 'F', 'G']aCopy === arr; // false pushå’Œpop push()å‘Arrayçš„æœ«å°¾æ·»åŠ è‹¥å¹²å…ƒç´ ï¼Œpop()åˆ™æŠŠArrayçš„æœ€åä¸€ä¸ªå…ƒç´ åˆ é™¤æ‰ï¼š 123456789var arr = [1, 2];arr.push('A', 'B'); // è¿”å›Arrayæ–°çš„é•¿åº¦: 4arr; // [1, 2, 'A', 'B']arr.pop(); // pop()è¿”å›'B'arr; // [1, 2, 'A']arr.pop(); arr.pop(); arr.pop(); // è¿ç»­pop 3æ¬¡arr; // []arr.pop(); // ç©ºæ•°ç»„ç»§ç»­popä¸ä¼šæŠ¥é”™ï¼Œè€Œæ˜¯è¿”å›undefinedarr; // [] unshiftå’Œshift å¦‚æœè¦å¾€Arrayçš„å¤´éƒ¨æ·»åŠ è‹¥å¹²å…ƒç´ ï¼Œä½¿ç”¨unshift()æ–¹æ³•ï¼Œshift()æ–¹æ³•åˆ™æŠŠArrayçš„ç¬¬ä¸€ä¸ªå…ƒç´ åˆ æ‰ï¼š 123456789var arr = [1, 2];arr.unshift('A', 'B'); // è¿”å›Arrayæ–°çš„é•¿åº¦: 4arr; // ['A', 'B', 1, 2]arr.shift(); // 'A'arr; // ['B', 1, 2]arr.shift(); arr.shift(); arr.shift(); // è¿ç»­shift 3æ¬¡arr; // []arr.shift(); // ç©ºæ•°ç»„ç»§ç»­shiftä¸ä¼šæŠ¥é”™ï¼Œè€Œæ˜¯è¿”å›undefinedarr; // [] sort 123var arr = ['B', 'C', 'A'];arr.sort();arr; // ['A', 'B', 'C'] reverse reverse()æŠŠæ•´ä¸ªArrayçš„å…ƒç´ ç»™æ‰ä¸ªä¸ªï¼Œä¹Ÿå°±æ˜¯åè½¬ï¼š 123var arr = ['one', 'two', 'three'];arr.reverse(); arr; // ['three', 'two', 'one'] splice splice()æ–¹æ³•æ˜¯ä¿®æ”¹Arrayçš„â€œä¸‡èƒ½æ–¹æ³•â€ï¼Œå®ƒå¯ä»¥ä»æŒ‡å®šçš„ç´¢å¼•å¼€å§‹åˆ é™¤è‹¥å¹²å…ƒç´ ï¼Œç„¶åå†ä»è¯¥ä½ç½®æ·»åŠ è‹¥å¹²å…ƒç´ ï¼š 12345678910var arr = ['Microsoft', 'Apple', 'Yahoo', 'AOL', 'Excite', 'Oracle'];// ä»ç´¢å¼•2å¼€å§‹åˆ é™¤3ä¸ªå…ƒç´ ,ç„¶åå†æ·»åŠ ä¸¤ä¸ªå…ƒç´ :arr.splice(2, 3, 'Google', 'Facebook'); // è¿”å›åˆ é™¤çš„å…ƒç´  ['Yahoo', 'AOL', 'Excite']arr; // ['Microsoft', 'Apple', 'Google', 'Facebook', 'Oracle']// åªåˆ é™¤,ä¸æ·»åŠ :arr.splice(2, 2); // ['Google', 'Facebook']arr; // ['Microsoft', 'Apple', 'Oracle']// åªæ·»åŠ ,ä¸åˆ é™¤:arr.splice(2, 0, 'Google', 'Facebook'); // è¿”å›[],å› ä¸ºæ²¡æœ‰åˆ é™¤ä»»ä½•å…ƒç´ arr; // ['Microsoft', 'Apple', 'Google', 'Facebook', 'Oracle'] concat concat()æ–¹æ³•æŠŠå½“å‰çš„Arrayå’Œå¦ä¸€ä¸ªArrayè¿æ¥èµ·æ¥ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ–°çš„Arrayï¼š 1234var arr = ['A', 'B', 'C'];var added = arr.concat([1, 2, 3]);added; // ['A', 'B', 'C', 1, 2, 3]arr; // ['A', 'B', 'C'] è¯·æ³¨æ„ï¼Œconcat()æ–¹æ³•å¹¶æ²¡æœ‰ä¿®æ”¹å½“å‰Arrayï¼Œè€Œæ˜¯è¿”å›äº†ä¸€ä¸ªæ–°çš„Arrayã€‚ å®é™…ä¸Šï¼Œconcat()æ–¹æ³•å¯ä»¥æ¥æ”¶ä»»æ„ä¸ªå…ƒç´ å’ŒArrayï¼Œå¹¶ä¸”è‡ªåŠ¨æŠŠArrayæ‹†å¼€ï¼Œç„¶åå…¨éƒ¨æ·»åŠ åˆ°æ–°çš„Arrayé‡Œï¼š 12var arr = ['A', 'B', 'C'];arr.concat(1, 2, [3, 4]); // ['A', 'B', 'C', 1, 2, 3, 4] join join()æ–¹æ³•æ˜¯ä¸€ä¸ªéå¸¸å®ç”¨çš„æ–¹æ³•ï¼Œå®ƒæŠŠå½“å‰Arrayçš„æ¯ä¸ªå…ƒç´ éƒ½ç”¨æŒ‡å®šçš„å­—ç¬¦ä¸²è¿æ¥èµ·æ¥ï¼Œç„¶åè¿”å›è¿æ¥åçš„å­—ç¬¦ä¸²ï¼š 12var arr = ['A', 'B', 'C', 1, 2, 3];arr.join('-'); // 'A-B-C-1-2-3' å¦‚æœArrayçš„å…ƒç´ ä¸æ˜¯å­—ç¬¦ä¸²ï¼Œå°†è‡ªåŠ¨è½¬æ¢ä¸ºå­—ç¬¦ä¸²åå†è¿æ¥ã€‚ å¯¹è±¡JavaScriptçš„å¯¹è±¡æ˜¯ä¸€ç»„ç”±é”®-å€¼ç»„æˆçš„æ— åºé›†åˆï¼Œç”¨ä¸€ä¸ª{...}è¡¨ç¤ºä¸€ä¸ªå¯¹è±¡ï¼Œä¾‹å¦‚ï¼š 12345678var person = &#123; name: 'Bob', age: 20, tags: ['js', 'web', 'mobile'], city: 'Beijing', hasCar: true, zipcode: null&#125;; æ³¨æ„ï¼Œæœ€åä¸€ä¸ªé”®å€¼å¯¹ä¸éœ€è¦åœ¨æœ«å°¾åŠ ,ï¼Œå¦‚æœåŠ äº†ï¼Œæœ‰çš„æµè§ˆå™¨ï¼ˆå¦‚ä½ç‰ˆæœ¬çš„IEï¼‰å°†æŠ¥é”™ã€‚ JavaScriptå¯¹è±¡çš„é”®éƒ½æ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œå€¼å¯ä»¥æ˜¯ä»»æ„æ•°æ®ç±»å‹ã€‚ä¸Šè¿°personå¯¹è±¡ä¸€å…±å®šä¹‰äº†6ä¸ªé”®å€¼å¯¹ï¼Œå…¶ä¸­æ¯ä¸ªé”®åˆç§°ä¸ºå¯¹è±¡çš„å±æ€§ï¼Œä¾‹å¦‚ï¼Œpersonçš„nameå±æ€§ä¸º&#39;Bob&#39;ï¼Œzipcodeå±æ€§ä¸ºnullã€‚ è¦è·å–ä¸€ä¸ªå¯¹è±¡çš„å±æ€§ï¼Œæˆ‘ä»¬ç”¨å¯¹è±¡å˜é‡.å±æ€§åçš„æ–¹å¼ï¼š 12person.name; // 'Bob'person.zipcode; // null è®¿é—®å±æ€§æ˜¯é€šè¿‡.æ“ä½œç¬¦å®Œæˆçš„ï¼Œä½†è¿™è¦æ±‚å±æ€§åå¿…é¡»æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„å˜é‡åã€‚å¦‚æœå±æ€§ååŒ…å«ç‰¹æ®Šå­—ç¬¦ï¼Œå°±å¿…é¡»ç”¨&#39;&#39;æ‹¬èµ·æ¥ï¼š 1234var xiaohong = &#123; name: 'å°çº¢', 'middle-school': 'No.1 Middle School'&#125;; xiaohongçš„å±æ€§åmiddle-schoolä¸æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„å˜é‡ï¼Œå°±éœ€è¦ç”¨&#39;&#39;æ‹¬èµ·æ¥ã€‚è®¿é—®è¿™ä¸ªå±æ€§ä¹Ÿæ— æ³•ä½¿ç”¨.æ“ä½œç¬¦ï¼Œå¿…é¡»ç”¨[&#39;xxx&#39;]æ¥è®¿é—®ï¼š 123xiaohong['middle-school']; // 'No.1 Middle School'xiaohong['name']; // 'å°çº¢'xiaohong.name; // 'å°çº¢' å®é™…ä¸ŠJavaScriptå¯¹è±¡çš„æ‰€æœ‰å±æ€§éƒ½æ˜¯å­—ç¬¦ä¸²ï¼Œä¸è¿‡å±æ€§å¯¹åº”çš„å€¼å¯ä»¥æ˜¯ä»»æ„æ•°æ®ç±»å‹ã€‚ å¦‚æœè®¿é—®ä¸€ä¸ªä¸å­˜åœ¨çš„å±æ€§ä¼šè¿”å›ä»€ä¹ˆå‘¢ï¼ŸJavaScriptè§„å®šï¼Œè®¿é—®ä¸å­˜åœ¨çš„å±æ€§ä¸æŠ¥é”™ï¼Œè€Œæ˜¯è¿”å›undefined ç”±äºJavaScriptçš„å¯¹è±¡æ˜¯åŠ¨æ€ç±»å‹ï¼Œä½ å¯ä»¥è‡ªç”±åœ°ç»™ä¸€ä¸ªå¯¹è±¡æ·»åŠ æˆ–åˆ é™¤å±æ€§ï¼š 1234567891011var xiaoming = &#123; name: 'å°æ˜'&#125;;xiaoming.age; // undefinedxiaoming.age = 18; // æ–°å¢ä¸€ä¸ªageå±æ€§xiaoming.age; // 18delete xiaoming.age; // åˆ é™¤ageå±æ€§xiaoming.age; // undefineddelete xiaoming['name']; // åˆ é™¤nameå±æ€§xiaoming.name; // undefineddelete xiaoming.school; // åˆ é™¤ä¸€ä¸ªä¸å­˜åœ¨çš„schoolå±æ€§ä¹Ÿä¸ä¼šæŠ¥é”™ å¦‚æœæˆ‘ä»¬è¦æ£€æµ‹xiaomingæ˜¯å¦æ‹¥æœ‰æŸä¸€å±æ€§ï¼Œå¯ä»¥ç”¨inæ“ä½œç¬¦ï¼š 12345678910var xiaoming = &#123; name: 'å°æ˜', birth: 1990, school: 'No.1 Middle School', height: 1.70, weight: 65, score: null&#125;;'name' in xiaoming; // true'grade' in xiaoming; // false ä¸è¿‡è¦å°å¿ƒï¼Œå¦‚æœinåˆ¤æ–­ä¸€ä¸ªå±æ€§å­˜åœ¨ï¼Œè¿™ä¸ªå±æ€§ä¸ä¸€å®šæ˜¯xiaomingçš„ï¼Œå®ƒå¯èƒ½æ˜¯xiaomingç»§æ‰¿å¾—åˆ°çš„ï¼š 1'toString' in xiaoming; // true å› ä¸ºtoStringå®šä¹‰åœ¨objectå¯¹è±¡ä¸­ï¼Œè€Œæ‰€æœ‰å¯¹è±¡æœ€ç»ˆéƒ½ä¼šåœ¨åŸå‹é“¾ä¸ŠæŒ‡å‘objectï¼Œæ‰€ä»¥xiaomingä¹Ÿæ‹¥æœ‰toStringå±æ€§ã€‚ è¦åˆ¤æ–­ä¸€ä¸ªå±æ€§æ˜¯å¦æ˜¯xiaomingè‡ªèº«æ‹¥æœ‰çš„ï¼Œè€Œä¸æ˜¯ç»§æ‰¿å¾—åˆ°çš„ï¼Œå¯ä»¥ç”¨hasOwnProperty()æ–¹æ³•ï¼š 12345var xiaoming = &#123; name: 'å°æ˜'&#125;;xiaoming.hasOwnProperty('name'); // truexiaoming.hasOwnProperty('toString'); // false å˜é‡å˜é‡åœ¨JavaScriptä¸­å°±æ˜¯ç”¨ä¸€ä¸ªå˜é‡åè¡¨ç¤ºï¼Œå˜é‡åæ˜¯å¤§å°å†™è‹±æ–‡ã€æ•°å­—ã€$å’Œ_çš„ç»„åˆï¼Œä¸”ä¸èƒ½ç”¨æ•°å­—å¼€å¤´ã€‚å˜é‡åä¹Ÿä¸èƒ½æ˜¯JavaScriptçš„å…³é”®å­—ï¼Œå¦‚ifã€whileç­‰ã€‚ç”³æ˜ä¸€ä¸ªå˜é‡ç”¨varè¯­å¥ï¼Œæ¯”å¦‚ï¼š 12345var a; &#x2F;&#x2F; ç”³æ˜äº†å˜é‡aï¼Œæ­¤æ—¶açš„å€¼ä¸ºundefinedvar $b &#x3D; 1; &#x2F;&#x2F; ç”³æ˜äº†å˜é‡$bï¼ŒåŒæ—¶ç»™$bèµ‹å€¼ï¼Œæ­¤æ—¶$bçš„å€¼ä¸º1var s_007 &#x3D; &#39;007&#39;; &#x2F;&#x2F; s_007æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²var Answer &#x3D; true; &#x2F;&#x2F; Answeræ˜¯ä¸€ä¸ªå¸ƒå°”å€¼truevar t &#x3D; null; &#x2F;&#x2F; tçš„å€¼æ˜¯null åœ¨JavaScriptä¸­ï¼Œä½¿ç”¨ç­‰å·=å¯¹å˜é‡è¿›è¡Œèµ‹å€¼ã€‚å¯ä»¥æŠŠä»»æ„æ•°æ®ç±»å‹èµ‹å€¼ç»™å˜é‡ï¼ŒåŒä¸€ä¸ªå˜é‡å¯ä»¥åå¤èµ‹å€¼ï¼Œè€Œä¸”å¯ä»¥æ˜¯ä¸åŒç±»å‹çš„å˜é‡ï¼Œä½†æ˜¯è¦æ³¨æ„åªèƒ½ç”¨varç”³æ˜ä¸€æ¬¡ï¼Œä¾‹å¦‚ï¼š 12var a &#x3D; 123; &#x2F;&#x2F; açš„å€¼æ˜¯æ•´æ•°123a &#x3D; &#39;ABC&#39;; &#x2F;&#x2F; aå˜ä¸ºå­—ç¬¦ä¸² è¿™ç§å˜é‡æœ¬èº«ç±»å‹ä¸å›ºå®šçš„è¯­è¨€ç§°ä¹‹ä¸ºåŠ¨æ€è¯­è¨€ï¼Œä¸ä¹‹å¯¹åº”çš„æ˜¯é™æ€è¯­è¨€ï¼ˆä¾‹å¦‚intï¼‰ ä½¿ç”¨varç”³æ˜çš„å˜é‡åˆ™ä¸æ˜¯å…¨å±€å˜é‡ï¼Œå®ƒçš„èŒƒå›´è¢«é™åˆ¶åœ¨è¯¥å˜é‡è¢«ç”³æ˜çš„å‡½æ•°ä½“å†…ï¼ˆå‡½æ•°çš„æ¦‚å¿µå°†ç¨åè®²è§£ï¼‰ï¼ŒåŒåå˜é‡åœ¨ä¸åŒçš„å‡½æ•°ä½“å†…äº’ä¸å†²çªã€‚ å¾ªç¯forâ€¦inforå¾ªç¯çš„ä¸€ä¸ªå˜ä½“æ˜¯for ... inå¾ªç¯ï¼Œå®ƒå¯ä»¥æŠŠä¸€ä¸ªå¯¹è±¡çš„æ‰€æœ‰å±æ€§ä¾æ¬¡å¾ªç¯å‡ºæ¥ï¼š 12345678var o = &#123; name: 'Jack', age: 20, city: 'Beijing'&#125;;for (var key in o) &#123; console.log(key); // 'name', 'age', 'city'&#125; è¦è¿‡æ»¤æ‰å¯¹è±¡ç»§æ‰¿çš„å±æ€§ï¼Œç”¨hasOwnProperty()æ¥å®ç°ï¼š 12345678910var o = &#123; name: 'Jack', age: 20, city: 'Beijing'&#125;;for (var key in o) &#123; if (o.hasOwnProperty(key)) &#123; console.log(key); // 'name', 'age', 'city' &#125;&#125; ç”±äºArrayä¹Ÿæ˜¯å¯¹è±¡ï¼Œè€Œå®ƒçš„æ¯ä¸ªå…ƒç´ çš„ç´¢å¼•è¢«è§†ä¸ºå¯¹è±¡çš„å±æ€§ï¼Œå› æ­¤ï¼Œfor ... inå¾ªç¯å¯ä»¥ç›´æ¥å¾ªç¯å‡ºArrayçš„ç´¢å¼•ï¼š 12345var a = ['A', 'B', 'C'];for (var i in a) &#123; console.log(i); // '0', '1', '2' console.log(a[i]); // 'A', 'B', 'C'&#125; è¯·æ³¨æ„ï¼Œfor ... inå¯¹Arrayçš„å¾ªç¯å¾—åˆ°çš„æ˜¯Stringè€Œä¸æ˜¯Numberã€‚ MapMapæ˜¯ä¸€ç»„é”®å€¼å¯¹çš„ç»“æ„ï¼Œå…·æœ‰æå¿«çš„æŸ¥æ‰¾é€Ÿåº¦ã€‚ ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾è¦æ ¹æ®åŒå­¦çš„åå­—æŸ¥æ‰¾å¯¹åº”çš„æˆç»©ï¼Œå¦‚æœç”¨Arrayå®ç°ï¼Œéœ€è¦ä¸¤ä¸ªArrayï¼š 12var names = ['Michael', 'Bob', 'Tracy'];var scores = [95, 75, 85]; ç»™å®šä¸€ä¸ªåå­—ï¼Œè¦æŸ¥æ‰¾å¯¹åº”çš„æˆç»©ï¼Œå°±å…ˆè¦åœ¨namesä¸­æ‰¾åˆ°å¯¹åº”çš„ä½ç½®ï¼Œå†ä»scoreså–å‡ºå¯¹åº”çš„æˆç»©ï¼ŒArrayè¶Šé•¿ï¼Œè€—æ—¶è¶Šé•¿ã€‚ å¦‚æœç”¨Mapå®ç°ï¼Œåªéœ€è¦ä¸€ä¸ªâ€œåå­—â€-â€œæˆç»©â€çš„å¯¹ç…§è¡¨ï¼Œç›´æ¥æ ¹æ®åå­—æŸ¥æ‰¾æˆç»©ï¼Œæ— è®ºè¿™ä¸ªè¡¨æœ‰å¤šå¤§ï¼ŒæŸ¥æ‰¾é€Ÿåº¦éƒ½ä¸ä¼šå˜æ…¢ã€‚ç”¨JavaScriptå†™ä¸€ä¸ªMapå¦‚ä¸‹ï¼š 12var m = new Map([['Michael', 95], ['Bob', 75], ['Tracy', 85]]);m.get('Michael'); // 95 åˆå§‹åŒ–Mapéœ€è¦ä¸€ä¸ªäºŒç»´æ•°ç»„ï¼Œæˆ–è€…ç›´æ¥åˆå§‹åŒ–ä¸€ä¸ªç©ºMapã€‚Mapå…·æœ‰ä»¥ä¸‹æ–¹æ³•ï¼š 1234567var m = new Map(); // ç©ºMapm.set('Adam', 67); // æ·»åŠ æ–°çš„key-valuem.set('Bob', 59);m.has('Adam'); // æ˜¯å¦å­˜åœ¨key 'Adam': truem.get('Adam'); // 67m.delete('Adam'); // åˆ é™¤key 'Adam'm.get('Adam'); // undefined ç”±äºä¸€ä¸ªkeyåªèƒ½å¯¹åº”ä¸€ä¸ªvalueï¼Œæ‰€ä»¥ï¼Œå¤šæ¬¡å¯¹ä¸€ä¸ªkeyæ”¾å…¥valueï¼Œåé¢çš„å€¼ä¼šæŠŠå‰é¢çš„å€¼å†²æ‰ï¼š 1234var m = new Map();m.set('Adam', 67);m.set('Adam', 88);m.get('Adam'); // 88 SetSetå’ŒMapç±»ä¼¼ï¼Œä¹Ÿæ˜¯ä¸€ç»„keyçš„é›†åˆï¼Œä½†ä¸å­˜å‚¨valueã€‚ç”±äºkeyä¸èƒ½é‡å¤ï¼Œæ‰€ä»¥ï¼Œåœ¨Setä¸­ï¼Œæ²¡æœ‰é‡å¤çš„keyã€‚ è¦åˆ›å»ºä¸€ä¸ªSetï¼Œéœ€è¦æä¾›ä¸€ä¸ªArrayä½œä¸ºè¾“å…¥ï¼Œæˆ–è€…ç›´æ¥åˆ›å»ºä¸€ä¸ªç©ºSetï¼š 12var s1 = new Set(); // ç©ºSetvar s2 = new Set([1, 2, 3]); // å«1, 2, 3 é‡å¤å…ƒç´ åœ¨Setä¸­è‡ªåŠ¨è¢«è¿‡æ»¤ï¼š 12var s = new Set([1, 2, 3, 3, '3']);s; // Set &#123;1, 2, 3, \"3\"&#125; æ³¨æ„æ•°å­—3å’Œå­—ç¬¦ä¸²&#39;3&#39;æ˜¯ä¸åŒçš„å…ƒç´ ã€‚ é€šè¿‡add(key)æ–¹æ³•å¯ä»¥æ·»åŠ å…ƒç´ åˆ°Setä¸­ï¼Œå¯ä»¥é‡å¤æ·»åŠ ï¼Œä½†ä¸ä¼šæœ‰æ•ˆæœï¼š 1234s.add(4);s; // Set &#123;1, 2, 3, 4&#125;s.add(4);s; // ä»ç„¶æ˜¯ Set &#123;1, 2, 3, 4&#125; é€šè¿‡delete(key)æ–¹æ³•å¯ä»¥åˆ é™¤å…ƒç´ ï¼š 1234var s = new Set([1, 2, 3]);s; // Set &#123;1, 2, 3&#125;s.delete(3);s; // Set &#123;1, 2&#125; iterableéå†Arrayå¯ä»¥é‡‡ç”¨ä¸‹æ ‡å¾ªç¯ï¼Œéå†Mapå’ŒSetå°±æ— æ³•ä½¿ç”¨ä¸‹æ ‡ã€‚ä¸ºäº†ç»Ÿä¸€é›†åˆç±»å‹ï¼ŒES6æ ‡å‡†å¼•å…¥äº†æ–°çš„iterableç±»å‹ï¼ŒArrayã€Mapå’ŒSetéƒ½å±äºiterableç±»å‹ã€‚ å…·æœ‰iterableç±»å‹çš„é›†åˆå¯ä»¥é€šè¿‡æ–°çš„for ... ofå¾ªç¯æ¥éå†ã€‚ for...inå’Œfor...ofçš„åŒºåˆ«ï¼š for in å¾ªç¯çš„æ˜¯å¯¹è±¡çš„å±æ€§ï¼ˆæ™®é€šæ•°ç»„çš„å±æ€§å°±æ˜¯indexï¼‰ for of å¾ªç¯çš„æ˜¯è¿­ä»£å™¨ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´  ç”¨for ... ofå¾ªç¯éå†é›†åˆï¼Œç”¨æ³•å¦‚ä¸‹ï¼š 123456789101112var a = ['A', 'B', 'C'];var s = new Set(['A', 'B', 'C']);var m = new Map([[1, 'x'], [2, 'y'], [3, 'z']]);for (var x of a) &#123; // éå†Array console.log(x);&#125;for (var x of s) &#123; // éå†Set console.log(x);&#125;for (var x of m) &#123; // éå†Map console.log(x[0] + '=' + x[1]);&#125; ä½ å¯èƒ½ä¼šæœ‰ç–‘é—®ï¼Œfor ... ofå¾ªç¯å’Œfor ... inå¾ªç¯æœ‰ä½•åŒºåˆ«ï¼Ÿ å½“æˆ‘ä»¬æ‰‹åŠ¨ç»™Arrayå¯¹è±¡æ·»åŠ äº†é¢å¤–çš„å±æ€§åï¼Œfor ... inå¾ªç¯å°†å¸¦æ¥æ„æƒ³ä¸åˆ°çš„æ„å¤–æ•ˆæœï¼š 12345var a = ['A', 'B', 'C'];a.name = 'Hello';for (var x in a) &#123; console.log(x); // '0', '1', '2', 'name'&#125; for ... inå¾ªç¯å°†æŠŠnameåŒ…æ‹¬åœ¨å†…ï¼Œä½†Arrayçš„lengthå±æ€§å´ä¸åŒ…æ‹¬åœ¨å†…ã€‚ for ... ofå¾ªç¯åˆ™å®Œå…¨ä¿®å¤äº†è¿™äº›é—®é¢˜ï¼Œå®ƒåªå¾ªç¯é›†åˆæœ¬èº«çš„å…ƒç´ ï¼š 12345var a = ['A', 'B', 'C'];a.name = 'Hello';for (var x of a) &#123; console.log(x); // 'A', 'B', 'C'&#125; ç„¶è€Œï¼Œæ›´å¥½çš„æ–¹å¼æ˜¯ç›´æ¥ä½¿ç”¨iterableå†…ç½®çš„forEachæ–¹æ³•ï¼Œå®ƒæ¥æ”¶ä¸€ä¸ªå‡½æ•°ï¼Œæ¯æ¬¡è¿­ä»£å°±è‡ªåŠ¨å›è°ƒè¯¥å‡½æ•°ã€‚ä»¥Arrayä¸ºä¾‹ï¼š 12345678'use strict';var a = ['A', 'B', 'C'];a.forEach(function (element, index, array) &#123; // element: æŒ‡å‘å½“å‰å…ƒç´ çš„å€¼ // index: æŒ‡å‘å½“å‰ç´¢å¼• // array: æŒ‡å‘Arrayå¯¹è±¡æœ¬èº« console.log(element + ', index = ' + index);&#125;); Setä¸Arrayç±»ä¼¼ï¼Œä½†Setæ²¡æœ‰ç´¢å¼•ï¼Œå› æ­¤å›è°ƒå‡½æ•°çš„å‰ä¸¤ä¸ªå‚æ•°éƒ½æ˜¯å…ƒç´ æœ¬èº«ï¼š 1234var s = new Set(['A', 'B', 'C']);s.forEach(function (element, sameElement, set) &#123; console.log(element);&#125;); Mapçš„å›è°ƒå‡½æ•°å‚æ•°ä¾æ¬¡ä¸ºvalueã€keyå’Œmapæœ¬èº«ï¼š 1234var m = new Map([[1, 'x'], [2, 'y'], [3, 'z']]);m.forEach(function (value, key, map) &#123; console.log(value);&#125;); å¦‚æœå¯¹æŸäº›å‚æ•°ä¸æ„Ÿå…´è¶£ï¼Œç”±äºJavaScriptçš„å‡½æ•°è°ƒç”¨ä¸è¦æ±‚å‚æ•°å¿…é¡»ä¸€è‡´ï¼Œå› æ­¤å¯ä»¥å¿½ç•¥å®ƒä»¬ã€‚ä¾‹å¦‚ï¼Œåªéœ€è¦è·å¾—Arrayçš„elementï¼š 1234var a = ['A', 'B', 'C'];a.forEach(function (element) &#123; console.log(element);&#125;); å‚è€ƒåŸºæœ¬æ•°æ®ç±»å‹å’Œå¼•ç”¨æ•°æ®ç±»å‹çš„åŒºåˆ«ï¼šhttps://www.cnblogs.com/c2016c/articles/9328725.html","categories":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://delaprada.com/categories/JavaScript/"}],"tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"http://delaprada.com/tags/JavaScript/"}]},{"title":"hexoå¸¸ç”¨æŒ‡ä»¤åŠç¾åŒ–åšå®¢é¡µé¢","slug":"hexoå¸¸ç”¨æŒ‡ä»¤åŠç¾åŒ–åšå®¢é¡µé¢","date":"2019-12-26T09:54:44.000Z","updated":"2020-01-15T12:46:58.000Z","comments":true,"path":"2019/12/26/hexoå¸¸ç”¨æŒ‡ä»¤åŠç¾åŒ–åšå®¢é¡µé¢/","link":"","permalink":"http://delaprada.com/2019/12/26/hexo%E5%B8%B8%E7%94%A8%E6%8C%87%E4%BB%A4%E5%8F%8A%E7%BE%8E%E5%8C%96%E5%8D%9A%E5%AE%A2%E9%A1%B5%E9%9D%A2/","excerpt":"","text":"hexoå¸¸ç”¨å‘½ä»¤Hexoçš„å‘½ä»¤æ€»ä½“æ¥è¯´æ¯”è¾ƒç®€å•ï¼Œå®‰è£…æˆåŠŸä¹‹ååªéœ€è¦è®°ä½å¸¸ç”¨çš„å››ç§å³å¯ã€‚åœ¨å½“å‰blogæ–‡ä»¶å¤¹æ ¹ç›®å½•ä¸‹å³é”®ç‚¹å‡»git bashï¼š hexo sï¼šserverå¯åŠ¨æœåŠ¡å™¨ hexo cleanï¼šcleanæ¸…é™¤ç¼“å­˜æ–‡ä»¶ï¼ˆdb.jsonï¼‰å’Œå·²ç”Ÿæˆçš„é™æ€æ–‡ä»¶ï¼ˆpublicï¼‰ hexo generateæˆ–hexo gï¼šgenerateç”Ÿæˆé™æ€æ–‡ä»¶ hexo deployæˆ–hexo dï¼šdeployéƒ¨ç½²ç½‘ç«™ï¼Œéƒ¨ç½²ç½‘ç«™å‰éœ€é¢„å…ˆç”Ÿæˆé™æ€æ–‡ä»¶ ä¸€èˆ¬æ›´æ”¹å®Œåæ‰§è¡Œä¸‰æ¡æŒ‡ä»¤ï¼šhexo cleanï¼Œhexo generateï¼Œhexo deployå³å¯ï¼ˆæŒ‰é¡ºåºï¼‰ å¦‚æœè¦è¿›è¡Œæ–‡ä»¶å‹ç¼©ï¼Œåœ¨hexo generateæŒ‡ä»¤åï¼Œæ‰§è¡ŒgulpæŒ‡ä»¤ã€‚ å‚è€ƒhttps://yfzhou.coding.me/2018/08/27/Hexo-Next%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%EF%BC%88%E4%B8%BB%E9%A2%98%E4%BC%98%E5%8C%96%EF%BC%89/ hexoå„ç§ç¾åŒ–æ–°å»ºpage1hexo new &quot;æ–‡ç« åç§°&quot; ä¼šåœ¨sourceæ–‡ä»¶å¤¹ä¸‹_postä¸­æ–°å»ºæ–‡ä»¶å¤¹å’Œ.mdæ–‡ä»¶ ä¾§æ å¢åŠ æ ‡ç­¾å’Œåˆ†ç±»é¡µé¢åˆ›å»ºæ ‡ç­¾é¡µé¢ åˆ›å»ºæ ‡ç­¾é¡µé¢ 1hexo new page tags åŸºæœ¬è®¾ç½® 123title: tagsdate: 2017-12-02 21:01:24type: &quot;tags&quot; åˆ›å»ºåˆ†ç±»é¡µé¢ åˆ›å»ºåˆ†ç±»é¡µé¢ 1hexo new page categories åŸºæœ¬è®¾ç½® 123title: categoriesdate: 2017-12-02 21:01:24type: &quot;categories&quot; æ–‡ç« ä¸­æ’å…¥å›¾ç‰‡ å°†å›¾ç‰‡æ”¾ç½®åœ¨é¡µé¢å¯¹åº”çš„æ–‡ä»¶å¤¹ä¸­ åœ¨æ–‡ç« ä¸­å¼•å…¥ï¼š 1&#123;% asset_img å›¾ç‰‡åç§° %&#125; è®¾ç½®ç«™ç‚¹å›¾æ ‡ å…ˆåœ¨imagesæ–‡ä»¶å¤¹ä¸‹æ”¾å…¥ä½ çš„å›¾æ ‡ åœ¨ä¸»é¢˜é…ç½®é¡µé¢_config.ymlä¸­æœç´¢faviconï¼Œæ‰¾åˆ°ä»¥ä¸‹ä½ç½®ï¼Œå¹¶å°†è·¯å¾„ä¿®æ”¹ä¸ºä½ çš„å›¾æ ‡ï¼š éƒ¨ç½²ä¹‹åå°±å¯ä»¥çœ‹åˆ°æ•ˆæœäº†ï¼ŒæŸ¥çœ‹æ•ˆæœï¼šhttp://delaprada.com è®¾ç½®å¤´åƒ åœ¨imagesæ–‡ä»¶å¤¹ä¸­æ”¾å…¥ä½ çš„å¤´åƒå›¾ç‰‡ åœ¨ä¸»é¢˜é…ç½®é¡µé¢ä¸­ä¿®æ”¹avatarä¸ºä½ çš„å›¾ç‰‡åœ°å€ï¼š é¦–é¡µæ–‡ç« ä¸æ˜¾ç¤ºå…¨æ–‡åªæ˜¾ç¤ºæ‘˜è¦ä¿®æ”¹/themes/next/_config.ymlä¸»é¢˜é…ç½®æ–‡ä»¶ä¸­ï¼š 1234567scroll_to_more: true #å¦‚æœæ–‡ç« æœ‰æ‘˜è¦,ä¼šè‡ªåŠ¨æ»šåŠ¨åˆ°æ‘˜è¦ä¸‹é¢save_scroll: true #é€šè¿‡cookiesæ¥ç¼“å­˜é˜…è¯»è¿›åº¦excerpt_description: true #è‡ªåŠ¨æ‘˜å½•æè¿°ä½œä¸ºåºè¨€auto_excerpt: #è®¾ç½®é˜…è¯»å…¨æ–‡ enable: true length: 150 #æ‘˜è¦æ¬¡æ•°read_more_btn: true #é˜…è¯»å…¨æ–‡æŒ‰é’® ä¿®æ”¹æ–‡ç« åº•éƒ¨çš„å¸¦#çš„æ ‡ç­¾ä¿®æ”¹æ¨¡æ¿/themes/next/layout/_macro/post.swigï¼Œæœç´¢rel=&quot;tag&quot;&gt;#ï¼Œå°†#æ”¹ä¸º&lt;i class=&quot;fa fa-tag&quot;&gt;&lt;/i&gt;ï¼ˆå¦‚æœæƒ³æ¢æˆå…¶ä»–å›¾æ ‡å¯åˆ°font-awesomeä¸­æ–‡ç½‘æŸ¥çœ‹ï¼‰ åœ¨æ¯ç¯‡æ–‡ç« æœ«å°¾ç»Ÿä¸€æ·»åŠ â€œæœ¬æ–‡ç»“æŸâ€æ ‡è®°åœ¨\\themes\\next\\layout\\_macroä¸­æ–°å»ºpassage-end-tag.swigï¼Œå¹¶åŠ å…¥ä»¥ä¸‹å†…å®¹ï¼š 12345&lt;div&gt; &#123;% if not is_index %&#125; &lt;div style=\"text-align:center;color: #ccc;font-size:15px;\"&gt;-------æœ¬&amp;nbsp;æ–‡&amp;nbsp; ç»“&amp;nbsp;æŸ&amp;nbsp;&amp;nbsp;&lt;i class=\"fa fa-heart\" aria-hidden=\"true\"&gt;&lt;/i&gt;&amp;nbsp;&amp;nbsp;æ„Ÿ &amp;nbsp;è°¢&amp;nbsp;æ‚¨&amp;nbsp;çš„&amp;nbsp;é˜…&amp;nbsp;è¯»-------&lt;/div&gt; &#123;% endif %&#125;&lt;/div&gt; æ¥ç€æ‰“å¼€\\themes\\next\\layout\\_macro\\post.swigæ–‡ä»¶ï¼Œåœ¨post-bodyæ ‡ç­¾ä¹‹åï¼Œpost-footeræ ‡ç­¾ä¹‹å‰ï¼Œæ·»åŠ å¦‚ä¸‹ä»£ç ï¼š 12345&lt;div&gt; &#123;% if not is_index %&#125; &#123;% include &#39;passage-end-tag.swig&#39; %&#125; &#123;% endif %&#125;&lt;&#x2F;div&gt; ä¿®æ”¹ç½‘é¡µèƒŒæ™¯é¢œè‰²å’Œä¾§æ ä¸Šæ–¹brandçš„é¢œè‰²æ‰“å¼€themes/next/layout/source/css/_custom/custom.stylï¼ŒåŠ å…¥ä»¥ä¸‹ä»£ç ï¼š 12345678910111213141516171819202122&#x2F;&#x2F;ä¿®æ”¹ç½‘é¡µèƒŒæ™¯é¢œè‰²body &#123; background-color: #F0F8FF&#125;#footer a &#123; color:#eee;&#125;&#x2F;&#x2F; ä¿®æ”¹ç½‘ç«™å¤´éƒ¨é¢œè‰².headband &#123; height: 3px; background: #ADD8E6;&#125;.site-meta &#123; padding: 20px 0; color: #fff; background: #ADD8E6;&#125;.site-title &#123; color: #fff;&#125; ä¾§è¾¹æ ç¤¾äº¤è®¾ç½®å’Œå‹æƒ…é“¾æ¥ä¿®æ”¹ä¸»é¢˜é…ç½®é¡µé¢ï¼šthemes/next/_config.ymlï¼š 12345678910111213141516171819202122232425262728293031site_state: true# Social Links# Usage: `Key: permalink || icon`# Key is the link label showing to end users.# Value before `||` delimeter is the target permalink.# Value after `||` delimeter is the name of FontAwesome icon. If icon (with or without delimeter) is not specified, globe icon will be loaded.social: CSDN: https://blog.csdn.net/weixin_41973410 || copyright GitHub: https://github.com/delaprada || githubsocial_icons: #è¿™é‡Œæ˜¯ä¸Šé¢ç¤¾äº¤é“¾æ¥çš„å¯¹åº”å›¾æ ‡ enable: true CSDN: copyright Github: github icons_only: false transition: true# Follow me on GitHub banner in right-top corner.# Usage: `permalink || title`# Value before `||` delimeter is the target permalink.# Value after `||` delimeter is the title and aria-label name.#github_banner: https://github.com/Fitz1318 || Follow me on GitHub# Blog rolls #è¿™é‡Œæ—¶è®¾ç½®ä¸€äº›ç›¸å…³é“¾æ¥ æˆ‘è¿™é‡Œè®¾ç½®äº†ä¸€äº›æ¨èé˜…è¯»çš„ç½‘ç«™#links_icon: linklinks_title: å®ç”¨ç½‘ç«™#links_layout: blocklinks_layout: inlinelinks: W3Cschool: http://www.w3school.com.cn/","categories":[{"name":"Hexo","slug":"Hexo","permalink":"http://delaprada.com/categories/Hexo/"}],"tags":[{"name":"Hexo","slug":"Hexo","permalink":"http://delaprada.com/tags/Hexo/"}]},{"title":"hexo categorieså’Œtagsé¡µé¢ä¸æ˜¾ç¤ºè§£å†³åŠæ³•","slug":"hexo-categorieså’Œtagsé¡µé¢ä¸æ˜¾ç¤ºè§£å†³åŠæ³•","date":"2019-12-25T02:53:13.000Z","updated":"2019-12-26T09:55:46.000Z","comments":true,"path":"2019/12/25/hexo-categorieså’Œtagsé¡µé¢ä¸æ˜¾ç¤ºè§£å†³åŠæ³•/","link":"","permalink":"http://delaprada.com/2019/12/25/hexo-categories%E5%92%8Ctags%E9%A1%B5%E9%9D%A2%E4%B8%8D%E6%98%BE%E7%A4%BA%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95/","excerpt":"","text":"å®˜ç½‘ä¹Ÿæœ‰ç»™å‡ºå…·ä½“æ­¥éª¤ï¼Œä½†æ˜¯æœ‰å‘Hexoå®˜ç½‘æ•™ç¨‹ ç¬¬ä¸€æ­¥ åœ¨ç»ˆç«¯çª—å£ä¸‹ï¼Œå®šä½åˆ° Hexo ç«™ç‚¹ç›®å½•ä¸‹ã€‚ä½¿ç”¨ hexo new pageæŒ‡ä»¤æ–°å»ºä¸€ä¸ªé¡µé¢ï¼Œå‘½åä¸º categories ï¼š12cd hexo //æ ¹ç›®å½•hexo new page categories //tagså’Œè¿™ä¸ªæ“ä½œä¸€è‡´ ç¬¬äºŒæ­¥ æ‰¾åˆ°æ–°å»ºçš„é¡µé¢ï¼Œæ·»åŠ typeæ–°å»ºçš„é¡µé¢ä¸€èˆ¬åœ¨source/categories/index.mdä¸­ï¼Œæ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š 1234title: categoriesdate: 2019-12-25 09:15:45type: \"categories\"layout: \"categories\" ç¬¬ä¸‰æ­¥ ç»™ä½ çš„é¡µé¢æ·»åŠ åˆ†ç±»æ‰¾åˆ°ä½ çš„é¡µé¢ï¼Œåœ¨é¡µé¢ä¸Šæ–¹æ·»åŠ å¦‚ä¸‹å†…å®¹ 123456title: åˆ©ç”¨gitpages+hexoæ­å»ºè‡ªå·±çš„åšå®¢date: 2019-12-25 09:12:55categories:- Hexotags:- å‰ç«¯ ä½†æ­¤æ—¶éƒ¨ç½²åˆ°githubä¸Šåï¼Œæ‰“å¼€ç½‘é¡µç‚¹å‡»åˆ†ç±»å’Œæ ‡ç­¾é¡µé¢è¿˜æ˜¯å‡ºç°404ï¼ ç¬¬å››æ­¥ è§£å†³æ–¹æ¡ˆå®å±å®˜æ–¹å‘äººç³»åˆ—ï¼ï¼ä¸»é¢˜é…ç½®æ–‡ä»¶_config.ymlä¸­çš„menuï¼šæŠŠ / åé¢çš„ç©ºæ ¼å…¨éƒ¨å»æ‰ï¼ˆåˆšå¼€å§‹çš„æ—¶å€™é»˜è®¤åé¢æ˜¯åŠ äº†ç©ºæ ¼å¯¼è‡´ç‚¹å‡»é¡µé¢å‡ºç°404ï¼‰","categories":[{"name":"Hexo","slug":"Hexo","permalink":"http://delaprada.com/categories/Hexo/"}],"tags":[{"name":"Hexo","slug":"Hexo","permalink":"http://delaprada.com/tags/Hexo/"}]},{"title":"åˆ©ç”¨gitpages+hexoæ­å»ºè‡ªå·±çš„åšå®¢","slug":"åˆ©ç”¨gitpages+hexoæ­å»ºè‡ªå·±çš„åšå®¢","date":"2019-12-25T01:12:55.000Z","updated":"2020-01-15T12:50:58.000Z","comments":true,"path":"2019/12/25/åˆ©ç”¨gitpages+hexoæ­å»ºè‡ªå·±çš„åšå®¢/","link":"","permalink":"http://delaprada.com/2019/12/25/%E5%88%A9%E7%94%A8gitpages+hexo%E6%90%AD%E5%BB%BA%E8%87%AA%E5%B7%B1%E7%9A%84%E5%8D%9A%E5%AE%A2/","excerpt":"","text":"å‰è¨€ä»å¼€å§‹å¼€å§‹ç€æ‰‹æ­å»ºåˆ°å®Œæˆå¤§æ¦‚èŠ±äº†ä¸€ä¸ªä¸‹åˆçš„æ—¶é—´ï¼Œé‡‡å‘ä¸å°‘ï¼Œåœ¨æ­¤è®°å½•ä¸€ä¸‹ ç¬¬ä¸€æ­¥ å‡†å¤‡å·¥ä½œnode.jsä¸‹è½½å¥½ï¼Œgithubæœ‰å·²æ³¨å†Œçš„è´¦å·åœ¨githubä¸­æ–°å»ºä¸€ä¸ªrepositoryï¼Œå‘½åä¸ºï¼šä½ çš„githubåç§°.github.ioï¼ˆä¸‹é¢æ˜¯æˆ‘çš„ä»“åº“åç§°ï¼‰ï¼š ï¼ˆæœ‰äº›åšå®¢ç›´æ¥è®©æˆ‘ä»¬forkå®ƒä»¬çš„é¡¹ç›®ï¼Œä¸ªäººæ„Ÿè§‰è¿™ä¹ˆåšä¸å¤ªå¥½ï¼Œå¾ˆå¤šä¸œè¥¿è‡ªå·±åŠ¨æ‰‹åšä¸€éæ›´å¥½ï¼‰ ç¬¬äºŒæ­¥ å®‰è£…HexoHexoå°±æ˜¯ä¸€ä¸ªåšå®¢æ¡†æ¶ï¼Œå®˜ç½‘ä¸Šä¹Ÿæœ‰å®‰è£…æ•™ç¨‹Hexoå®˜ç½‘ step1ï¼šwindowsç³»ç»Ÿé¼ æ ‡å³é”®git bashï¼Œè¾“å…¥ä¸¤ä¸ªå®‰è£…æŒ‡ä»¤ï¼š 12npm install hexo-cli -g &#x2F;&#x2F;ç”¨äºå®‰è£…hexonpm install hexo-deployer-git --save &#x2F;&#x2F;ç”¨äºå®‰è£…hexoéƒ¨ç½²åˆ°git pageçš„deployer step2ï¼šåˆ›å»ºhexoæ–‡ä»¶å¤¹hexoå®‰è£…å®Œæˆä¹‹åï¼Œåœ¨ç”µè„‘ä¸­æ–°å»ºä¸€ä¸ªhexoæ–‡ä»¶å¤¹ï¼š å³é”®ç‚¹å‡»git bashï¼Œè¾“å…¥ä¸¤ä¸ªå‘½ä»¤ï¼š 12hexo initnpm install &#x2F;&#x2F;å®‰è£…æ‰€æœ‰package.jsoné‡Œçš„åŒ… æ‰§è¡Œå®Œæˆåï¼Œhexoæ–‡ä»¶å¤¹ä¸­ä¼šå¤šå‡ºä¸€äº›æ–‡ä»¶ï¼š å¦‚æœæƒ³çœ‹æœ¬åœ°æ•ˆæœçš„è¯ï¼Œæ‰§è¡Œä»¥ä¸‹æŒ‡ä»¤ï¼š 12hexo generate &#x2F;&#x2F;è‡ªåŠ¨å°†mdæ–‡ä»¶ç”Ÿæˆé™æ€htmlï¼Œcssæ–‡ä»¶hexo server &#x2F;&#x2F;å¯åŠ¨æœ¬åœ°hexoæœåŠ¡å™¨ï¼ˆlocalhost:4000ï¼‰ æ‰“å¼€ localhost:4000å°±å¯ä»¥çœ‹åˆ°é¡µé¢å•¦ï¼š ï¼ˆé¡µé¢ä¼šä¸å¤ªä¸€æ ·ï¼Œæˆ‘çš„é…äº†ä¸€ä¸‹ä¸»é¢˜ï¼‰ ç¬¬ä¸‰æ­¥ äº†è§£hexoæ–‡ä»¶å¤¹ä¸­çš„_config.ymlhexoæ–‡ä»¶å¤¹ä¸­æ¯”è¾ƒé‡è¦çš„æ–‡ä»¶æ˜¯ï¼š_config.ymlï¼š å®ƒæ˜¯ä¸€ä¸ªå…¨å±€é…ç½®æ–‡ä»¶ï¼ŒåŒ…æ‹¬å’Œgithubä¸Šä¼ é“¾æ¥éƒ½åœ¨è¿™é‡Œé…ç½®ï¼Œä¾‹å¦‚titleä¹‹ç±»çš„ï¼š ç¬¬å››æ­¥ æœ¬åœ°ä¸Šä¼ åˆ°githubstep1ï¼šæ‰§è¡Œå‘½ä»¤ï¼Œå®‰è£…deploy.gitæ’ä»¶ 1npm install hexo-deployer-git --save step2ï¼šåœ¨ä¸»é¢˜é…ç½®æ–‡ä»¶_config.ymlä¸­ä¿®æ”¹ä»“åº“åœ°å€ï¼Œåœ¨_config.ymlæœ€ä¸‹é¢ä¸€è¡Œï¼ˆæ³¨æ„æ¯ä¸ªå†’å·åé¢éƒ½æœ‰ä¸€ä¸ªç©ºæ ¼ï¼‰ step3ï¼šé…ç½®æäº¤githubè®¤è¯æ–¹å¼æ‰§è¡ŒæŒ‡ä»¤ï¼š 1hexo d ç›´æ¥æäº¤åˆ°githubä»“åº“ä¸­ï¼Œå¦‚æœæ²¡æœ‰è®¤è¯githubå’Œæœ¬åœ°çš„å…³ç³»ï¼Œä¼šæç¤ºè¾“å…¥ç”¨æˆ·åå’Œå¯†ç  æ­¤æ—¶æ‰“å¼€githubçš„é¡¹ç›®ä¼šå‘ç°åŸæœ¬æ˜¯ç©ºçš„é¡¹ç›®ç°åœ¨æœ‰äº†åˆšåˆšä¸Šä¼ çš„æ–‡ä»¶ ç¬¬äº”æ­¥ æ·»åŠ åŸŸååœ¨é˜¿é‡Œäº‘ä¸­è´­ä¹°äº†ä¸€ä¸ª.comçš„åŸŸåï¼ˆåŠ ä¼˜æƒ ä¸€å¹´23å—ï¼Œè™½ç„¶æ¯”å…¶ä»–è´µä¸€äº›ä½†æ˜¯è§‰å¾—.comå¥½å¬ä¸€äº›(#^ . ^#)ï¼‰ step1ï¼šcmd pingä¸€ä¸‹github.ioè·å¾—çœŸå®ipåœ°å€ step2ï¼šç„¶åå†åŸŸåæ“ä½œæ ç‚¹å‡»è§£æï¼Œæ·»åŠ è®°å½• æ³¨æ„è¦ä¸¤ä¸ªéƒ½è¦æ·»åŠ ï¼ˆä¹‹å‰ä¸€å¼€å§‹åªæ·»åŠ äº†wwwä¸çŸ¥é“ä¸ºå•¥å°±æ˜¾ç¤ºä¸å‡ºæ¥ï¼‰ step3ï¼šå»hexoæ–‡ä»¶å¤¹çš„sourceç›®å½•ä¸‹æ–°å»ºåä¸ºCNAMEçš„æ–‡ä»¶ï¼Œæ·»åŠ æ–‡ä»¶å†…å®¹ä¸ºä½ åˆšæ‰è´­ä¹°çš„åŸŸåï¼Œä¸è¦æ·»åŠ www step4ï¼šç„¶åéƒ¨ç½² 1231. hexo clean2. hexo generate3. hexo deploy ï¼ˆæ¯æ¬¡åšå‡ºæ›´æ”¹å»ºè®®éƒ½éƒ¨ç½²ä¸€éï¼‰ step5ï¼šç‚¹å‡»è®¾ç½®ï¼Œæ‹‰åˆ°ä¸‹é¢ï¼Œåœ¨custom domainä¸­è¾“å…¥ä½ çš„åŸŸåã€‚å¦‚æœä¸Šé¢çš„ä¿¡æ¯ä¸æ˜¯æ˜¾ç¤ºYour site is published at https://xxx.com/ï¼Œè€Œæ˜¯dnsçš„ä¹‹ç±»çš„é”™è¯¯ï¼Œå¯èƒ½æ˜¯åŸŸåè¿˜æ²¡æœ‰å®åè®¤è¯ è¾“å…¥åŸŸåï¼ŒæˆåŠŸï¼š","categories":[{"name":"Hexo","slug":"Hexo","permalink":"http://delaprada.com/categories/Hexo/"}],"tags":[{"name":"Hexo","slug":"Hexo","permalink":"http://delaprada.com/tags/Hexo/"}]}],"categories":[{"name":"Artificial Intelligence","slug":"Artificial-Intelligence","permalink":"http://delaprada.com/categories/Artificial-Intelligence/"},{"name":"leetcode","slug":"leetcode","permalink":"http://delaprada.com/categories/leetcode/"},{"name":"JavaScript","slug":"JavaScript","permalink":"http://delaprada.com/categories/JavaScript/"},{"name":"React","slug":"React","permalink":"http://delaprada.com/categories/React/"},{"name":"å°ç¨‹åº","slug":"å°ç¨‹åº","permalink":"http://delaprada.com/categories/%E5%B0%8F%E7%A8%8B%E5%BA%8F/"},{"name":"æ•°æ®åº“","slug":"æ•°æ®åº“","permalink":"http://delaprada.com/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"},{"name":"Node.js","slug":"Node-js","permalink":"http://delaprada.com/categories/Node-js/"},{"name":"è®¡ç®—æœºç½‘ç»œ","slug":"è®¡ç®—æœºç½‘ç»œ","permalink":"http://delaprada.com/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/"},{"name":"æµè§ˆå™¨","slug":"æµè§ˆå™¨","permalink":"http://delaprada.com/categories/%E6%B5%8F%E8%A7%88%E5%99%A8/"},{"name":"Vue","slug":"Vue","permalink":"http://delaprada.com/categories/Vue/"},{"name":"æ¯æ—¥ä¸€é¢˜","slug":"æ¯æ—¥ä¸€é¢˜","permalink":"http://delaprada.com/categories/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98/"},{"name":"CSS","slug":"CSS","permalink":"http://delaprada.com/categories/CSS/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://delaprada.com/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"},{"name":"Hexo","slug":"Hexo","permalink":"http://delaprada.com/categories/Hexo/"}],"tags":[{"name":"Artificial Intelligence","slug":"Artificial-Intelligence","permalink":"http://delaprada.com/tags/Artificial-Intelligence/"},{"name":"leetcode","slug":"leetcode","permalink":"http://delaprada.com/tags/leetcode/"},{"name":"JavaScript","slug":"JavaScript","permalink":"http://delaprada.com/tags/JavaScript/"},{"name":"React","slug":"React","permalink":"http://delaprada.com/tags/React/"},{"name":"å°ç¨‹åº","slug":"å°ç¨‹åº","permalink":"http://delaprada.com/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F/"},{"name":"æ•°æ®åº“","slug":"æ•°æ®åº“","permalink":"http://delaprada.com/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"},{"name":"Node.js","slug":"Node-js","permalink":"http://delaprada.com/tags/Node-js/"},{"name":"è®¡ç®—æœºç½‘ç»œ","slug":"è®¡ç®—æœºç½‘ç»œ","permalink":"http://delaprada.com/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/"},{"name":"æµè§ˆå™¨","slug":"æµè§ˆå™¨","permalink":"http://delaprada.com/tags/%E6%B5%8F%E8%A7%88%E5%99%A8/"},{"name":"Vue","slug":"Vue","permalink":"http://delaprada.com/tags/Vue/"},{"name":"æ¯æ—¥ä¸€é¢˜","slug":"æ¯æ—¥ä¸€é¢˜","permalink":"http://delaprada.com/tags/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98/"},{"name":"CSS","slug":"CSS","permalink":"http://delaprada.com/tags/CSS/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"http://delaprada.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"},{"name":"Hexo","slug":"Hexo","permalink":"http://delaprada.com/tags/Hexo/"}]}